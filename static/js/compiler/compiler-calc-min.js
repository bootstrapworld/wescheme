var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,d){a!=Array.prototype&&a!=Object.prototype&&(a[c]=d.value)};$jscomp.getGlobal=function(a){a=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var c=0;c<a.length;++c){var d=a[c];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,c){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:c})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function a(d){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(d||"")+"_"+c++,d)}var c=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var d=0,k={next:function(){if(d<a.length){var n=d++;return{value:c(n,a[n]),done:!1}}k.next=function(){return{done:!0,value:void 0}};return k.next()}};k[Symbol.iterator]=function(){return k};return k};
$jscomp.polyfill=function(a,c,d,k){if(c){d=$jscomp.global;a=a.split(".");for(k=0;k<a.length-1;k++){var n=a[k];n in d||(d[n]={});d=d[n]}a=a[a.length-1];k=d[a];c=c(k);c!=k&&null!=c&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,d){return d})}},"es8","es3");var COMPILED=!0,goog=goog||{};goog.global=this;goog.DEBUG=!0;goog.LOCALE="en";goog.provide=function(a){if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a];for(var c=a;(c=c.substring(0,c.lastIndexOf(".")))&&!goog.getObjectByName(c);)goog.implicitNamespaces_[c]=!0}goog.exportPath_(a)};
goog.setTestOnly=function(a){if(COMPILED&&!goog.DEBUG)throw a=a||"",Error("Importing test-only code into non-debug environment"+a?": "+a:".");};COMPILED||(goog.isProvided_=function(a){return!goog.implicitNamespaces_[a]&&!!goog.getObjectByName(a)},goog.implicitNamespaces_={});goog.exportPath_=function(a,c,d){a=a.split(".");d=d||goog.global;a[0]in d||!d.execScript||d.execScript("var "+a[0]);for(var k;a.length&&(k=a.shift());)!a.length&&goog.isDef(c)?d[k]=c:d=d[k]?d[k]:d[k]={}};
goog.getObjectByName=function(a,c){a=a.split(".");c=c||goog.global;for(var d;d=a.shift();)if(goog.isDefAndNotNull(c[d]))c=c[d];else return null;return c};goog.globalize=function(a,c){c=c||goog.global;for(var d in a)c[d]=a[d]};
goog.addDependency=function(a,c,d){if(!COMPILED){var k;a=a.replace(/\\/g,"/");for(var n=goog.dependencies_,z=0;k=c[z];z++)n.nameToPath[k]=a,a in n.pathToNames||(n.pathToNames[a]={}),n.pathToNames[a][k]=!0;for(k=0;c=d[k];k++)a in n.requires||(n.requires[a]={}),n.requires[a][c]=!0}};goog.ENABLE_DEBUG_LOADER=!0;
goog.require=function(a){if(!COMPILED&&!goog.isProvided_(a)){if(goog.ENABLE_DEBUG_LOADER){var c=goog.getPathFromDeps_(a);if(c){goog.included_[c]=!0;goog.writeScripts_();return}}a="goog.require could not find: "+a;goog.global.console&&goog.global.console.error(a);throw Error(a);}};goog.basePath="";goog.nullFunction=function(){};goog.identityFunction=function(a){return a};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};
goog.addSingletonGetter=function(a){a.getInstance=function(){return a.instance_||(a.instance_=new a)}};
!COMPILED&&goog.ENABLE_DEBUG_LOADER&&(goog.included_={},goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return"undefined"!=typeof a&&"write"in a},goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document.getElementsByTagName("script"),c=a.length-1;0<=c;--c){var d=a[c].src,k=d.lastIndexOf("?");k=
-1==k?d.length:k;if("base.js"==d.substr(k-7,7)){goog.basePath=d.substr(0,k-7);break}}},goog.importScript_=function(a){var c=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;!goog.dependencies_.written[a]&&c(a)&&(goog.dependencies_.written[a]=!0)},goog.writeScriptTag_=function(a){return goog.inHtmlDocument_()?(goog.global.document.write('<script type="text/javascript" src="'+a+'">\x3c/script>'),!0):!1},goog.writeScripts_=function(){function a(n){if(!(n in k.written)){if(!(n in k.visited)&&(k.visited[n]=
!0,n in k.requires))for(var z in k.requires[n])if(!goog.isProvided_(z))if(z in k.nameToPath)a(k.nameToPath[z]);else throw Error("Undefined nameToPath for "+z);n in d||(d[n]=!0,c.push(n))}}var c=[],d={},k=goog.dependencies_,n;for(n in goog.included_)k.written[n]||a(n);for(n=0;n<c.length;n++)if(c[n])goog.importScript_(goog.basePath+c[n]);else throw Error("Undefined script input");},goog.getPathFromDeps_=function(a){return a in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_(),
goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));
goog.typeOf=function(a){var c=typeof a;if("object"==c)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return c;var d=Object.prototype.toString.call(a);if("[object Window]"==d)return"object";if("[object Array]"==d||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==d||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==c&&"undefined"==typeof a.call)return"object";return c};goog.propertyIsEnumerableCustom_=function(a,c){if(c in a)for(var d in a)if(d==c&&Object.prototype.hasOwnProperty.call(a,c))return!0;return!1};goog.propertyIsEnumerable_=function(a,c){return a instanceof Object?Object.prototype.propertyIsEnumerable.call(a,c):goog.propertyIsEnumerableCustom_(a,c)};goog.isDef=function(a){return void 0!==a};goog.isNull=function(a){return null===a};
goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var c=goog.typeOf(a);return"array"==c||"object"==c&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isString=function(a){return"string"==typeof a};goog.isBoolean=function(a){return"boolean"==typeof a};goog.isNumber=function(a){return"number"==typeof a};
goog.isFunction=function(a){return"function"==goog.typeOf(a)};goog.isObject=function(a){a=goog.typeOf(a);return"object"==a||"array"==a||"function"==a};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(c){}};goog.UID_PROPERTY_="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36);goog.uidCounter_=0;
goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var c=goog.typeOf(a);if("object"==c||"array"==c){if(a.clone)return a.clone();c="array"==c?[]:{};for(var d in a)c[d]=goog.cloneObject(a[d]);return c}return a};goog.bindNative_=function(a,c,d){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,c,d){if(!a)throw Error();if(2<arguments.length){var k=Array.prototype.slice.call(arguments,2);return function(){var d=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(d,k);return a.apply(c,d)}}return function(){return a.apply(c,arguments)}};goog.bind=function(a,c,d){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,c){var d=Array.prototype.slice.call(arguments,1);return function(){var c=Array.prototype.slice.call(arguments);c.unshift.apply(c,d);return a.apply(this,c)}};goog.mixin=function(a,c){for(var d in c)a[d]=c[d]};goog.now=Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval)if(null==goog.evalWorksForGlobals_&&(goog.global.eval("var _et_ = 1;"),"undefined"!=typeof goog.global._et_?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1),goog.evalWorksForGlobals_)goog.global.eval(a);else{var c=goog.global.document,d=c.createElement("script");d.type="text/javascript";d.defer=!1;d.appendChild(c.createTextNode(a));c.body.appendChild(d);
c.body.removeChild(d)}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;goog.getCssName=function(a,c){var d=function(a){return goog.cssNameMapping_[a]||a},k=function(a){a=a.split("-");for(var c=[],k=0;k<a.length;k++)c.push(d(a[k]));return c.join("-")};k=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?d:k:function(a){return a};return c?a+"-"+k(c):k(a)};goog.setCssNameMapping=function(a,c){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=c};
!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,c){c=c||{};for(var d in c){var k=(""+c[d]).replace(/\$/g,"$$$$");a=a.replace(new RegExp("\\{\\$"+d+"\\}","gi"),k)}return a};goog.exportSymbol=function(a,c,d){goog.exportPath_(a,c,d)};goog.exportProperty=function(a,c,d){a[c]=d};goog.inherits=function(a,c){function d(){}d.prototype=c.prototype;a.superClass_=c.prototype;a.prototype=new d;a.prototype.constructor=a};
goog.base=function(a,c,d){var k=arguments.callee.caller;if(k.superClass_)return k.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var n=Array.prototype.slice.call(arguments,2),z=!1,F=a.constructor;F;F=F.superClass_&&F.superClass_.constructor)if(F.prototype[c]===k)z=!0;else if(z)return F.prototype[c].apply(a,n);if(a[c]===k)return a.constructor.prototype[c].apply(a,n);throw Error("goog.base called from a method of one name to a method of a different name");};
goog.scope=function(a){a.call(goog.global)};var plt={compiler:{}};plt.compiler.throwError={};plt.compiler.Program={};plt.compiler.comment={};plt.compiler.couple={};plt.compiler.defFunc={};plt.compiler.defVar={};plt.compiler.defVars={};plt.compiler.defStruct={};plt.compiler.beginExpr={};plt.compiler.lambdaExpr={};plt.compiler.localExpr={};plt.compiler.letrecExpr={};plt.compiler.letExpr={};plt.compiler.letStarExpr={};plt.compiler.condExpr={};plt.compiler.caseExpr={};plt.compiler.andExpr={};
plt.compiler.orExpr={};plt.compiler.callExpr={};plt.compiler.ifExpr={};plt.compiler.whenUnlessExpr={};plt.compiler.symbolExpr={};plt.compiler.literal={};plt.compiler.quotedExpr={};plt.compiler.unquotedExpr={};plt.compiler.quasiquotedExpr={};plt.compiler.unquoteSplice={};plt.compiler.requireExpr={};plt.compiler.provideStatement={};plt.compiler.unsupportedExpr={};plt.compiler.pinfo={};plt.compiler.getBasePinfo={};plt.compiler.isExpression={};plt.compiler.isDefinition={};plt.compiler.env={};
plt.compiler.emptyEnv={};plt.compiler.localEnv={};plt.compiler.globalEnv={};plt.compiler.moduleBinding={};plt.compiler.functionBinding={};plt.compiler.constantBinding={};plt.compiler.structBinding={};plt.compiler.unnamedEnv={};window.plt=window.plt||{};plt.compiler=plt.compiler||{};
(function(){function a(a,c,d){c.source=c.source||"<unknown>";a.args=a.args.map(function(a){if("string"===typeof a)return a;if(a instanceof I)return'["span", [["class", "SchemeValue-Symbol"]], '+a.val+"]";if(void 0!==a.location)return{text:a.text,type:"ColoredPart",loc:a.location.toString(),toString:function(){return a.text}};if(void 0!==a.locations)return{text:a.text,type:"MultiPart",solid:a.solid,locs:a.locations.map(function(a){return a.toString()}),toString:function(){return a.text}}});a={type:"moby-failure",
"dom-message":["span",[["class","Error"]],["span",[["class",d||"Message"]]].concat(d?[["span",[["class","Error.reason"]],a.toString()],["span",[["class",(d||"message")+("Error-GenericReadError"===d?".locations":".otherLocations")]]]]:a.args.map(function(a){return a.toString()})),["br",[],""],["span",[["class","Error.location"]],["span",[["class","location-reference"],["style","display:none"]],["span",[["class","location-offset"]],(c.startChar+1).toString()],["span",[["class","location-line"]],c.startRow.toString()],
["span",[["class","location-column"]],c.startCol.toString()],["span",[["class","location-span"]],c.span.toString()],["span",[["class","location-id"]],c.source.toString()]]]],"structured-error":JSON.stringify({message:d?!1:a.args,location:c.toString()})};throw JSON.stringify(a);}function c(a){h.call(this);this.txt=a;this.toString=function(){return";"+this.txt}}function d(a,c,d,D){h.call(this);this.name=a;this.args=c;this.body=d;this.stx=D;this.toString=function(){return"(define ("+this.name.toString()+
" "+this.args.join(" ")+")\n    "+this.body.toString()+")"}}function k(a,c,d){h.call(this);this.name=a;this.expr=c;this.stx=d;this.toString=function(){return"(define "+this.name.toString()+" "+this.expr.toString()+")"}}function n(a,c,d){h.call(this);this.names=a;this.expr=c;this.stx=d;this.toString=function(){return"(define-values ("+this.names.join(" ")+") "+this.expr.toString()+")"}}function z(a,c,d){h.call(this);this.name=a;this.fields=c;this.stx=d;this.toString=function(){return"(define-struct "+
this.name.toString()+" ("+this.fields.toString()+"))"}}function F(a,c){h.call(this);this.exprs=a;this.stx=c;this.toString=function(){return"(begin "+this.exprs.join(" ")+")"}}function U(a,c,d){h.call(this);this.args=a;this.body=c;this.stx=d;this.toString=function(){return"(lambda ("+this.args.join(" ")+") "+this.body.toString()+")"}}function K(a,c,d){h.call(this);this.defs=a;this.body=c;this.stx=d;this.toString=function(){return"(local ("+this.defs.toString()+") "+this.body.toString()+")"}}function J(a,
c,d){h.call(this);this.expr=a;this.clauses=c;this.stx=d;this.toString=function(){return"(case "+this.expr.toString()+"\n    "+this.clauses.join("\n    ")+")"}}function t(a,c,d){h.call(this);this.func=a;this.args=c;this.stx=d;this.toString=function(){return"("+[this.func].concat(this.args).join(" ")+")"}}function P(a,c,d,D){h.call(this);this.predicate=a;this.consequence=c;this.alternative=d;this.stx=D;this.toString=function(){return"(if "+this.predicate.toString()+" "+this.consequence.toString()+" "+
this.alternative.toString()+")"}}function v(a,c,d){h.call(this);this.predicate=a;this.exprs=c;this.stx=d;this.toString=function(){return"("+this.stx[0]+" "+this.predicate.toString()+" "+this.exprs.toString()+")"}}function I(a,c){h.call(this);this.val=a;this.stx=c}function O(a){h.call(this);this.val=a;this.toString=function(){if(!0===this.val)return"#t";if(!1===this.val)return"#f";if(this.val instanceof Char){var a=this.val.val;return"\b"===a?"#\\backspace":"\t"===a?"#\\tab":"\n"===a?"#\\newline":
" "===a?"#\\space":"\v"===a?"#\\vtab":this.val.toWrittenString()}return types.toWrittenString(this.val)}}function M(a){h.call(this);this.val=a;this.toString=function(){function a(a){a=a.val;if("quasiquote"===a)a="`";else if("quote"===a)a="'";else if("unquote"===a)a=",";else{if("unquote-splicing"!==a)throw"impossible quote-like string";a=",@"}return a}function c(d){return d instanceof Array&&2===d.length&&d[0]instanceof I&&("quasiquote"===d[0].val||"quote"===d[0].val||"unquote"===d[0].val||"unquote-splicing"===
d[0].val)?a(d[0]).concat(c(d[1])):d instanceof Array?d.reduce(function(a,w){return a.concat(c(w))},"(").concat(")"):d.toString()}return"'"+c(this.val)}}function R(a){h.call(this);this.val=a;this.toString=function(){return","+this.val.toString()}}function N(a){h.call(this);this.val=a;this.toString=function(){return this.val instanceof Array?"`("+this.val.toString()+")":"`"+this.val.toString()}}function Q(a){h.call(this);this.val=a;this.toString=function(){return",@"+this.val.toString()}}function y(a,
c){h.call(this);this.spec=a;this.stx=c;this.toString=function(){return"(require "+this.spec.toString()+")"}}function S(a,c){h.call(this);this.clauses=a;this.stx=c;this.toString=function(){return"(provide "+this.clauses.toString()+")"}}function T(a,c,d){h.call(this);this.val=a;this.errorMsg=c;this.errorSpan=d;this.toString=function(){return this.val.toString()}}function W(a,c,d,h){this.name=a;this.moduleSource=c;this.permissions=d;this.loc=h;this.toString=function(){return this.name};return this}function G(a,
c,d,h,q,w,l){this.name=a;this.moduleSource=c;this.minArity=d;this.isVarArity=h;this.permissions=q;this.isCps=w;this.loc=l;this.toString=function(){return this.name};return this}function B(a,c,d,h,q,w,l,k,n){this.name=a;this.moduleSource=c;this.fields=d;this.constructor=h;this.predicate=q;this.accessors=w;this.mutators=l;this.permissions=k;this.loc=n;this.toString=function(){return this.name};return this}function C(a){var c=this;this.bindings=a||L();this.lookup=function(a){return this.bindings.containsKey(a)?
this.bindings.get(a):!1};this.peek=function(a){return 0==a?this:this instanceof H?"IMPOSSIBLE - peeked at an emptyEnv!":this.parent.peek(a-1)};this.contains=function(a){return!1!==this.lookup(a)};this.keys=this.bindings.keys;this.extend=function(a){this.bindings.put(a.name,a);return new plt.compiler.env(this.bindings)};this.extendFunction=function(a,c,d,w,l){return this.extend(new G(a,c,d,w,[],!1,l))};this.extendConstant=function(a,c,d){return this.extend(new W(a,c,[],d))};this.lookup_context=function(a){return a.context instanceof
C?a.context.contains(a)?a.context.lookup(a):!1:c.contains(a)?c.lookup(a):!1};this.extendEnv_moduleBinding=function(a){return a.bindings.reduceRight(function(a,c){return a.extend(c)},this)};this.toString=function(){return this.bindings.values().reduce(function(a,c){return a+"\n  |---"+c.name},"")}}function H(){C.call(this);this.lookup=function(a,c){return new plt.compiler.unboundStackReference(a)}}function X(a){C.call(this);this.parent=a;this.lookup=function(a,c){return this.parent.lookup(a,c+1)}}
function A(a,c,d){C.call(this);this.name=a;this.boxed=c;this.parent=d;this.lookup=function(a,c){return a===this.name?new plt.compiler.localStackReference(a,this.boxed,c):this.parent.lookup(a,c+1)}}function Y(a,c,d){C.call(this);this.names=a;this.boxed=c;this.parent=d;this.lookup=function(a,c){var d=this.names.indexOf(a);return-1<d?new plt.compiler.globalStackReference(a,c,d):this.parent.lookup(a,c+1)}}var r=function(a){var c=function(){};c.prototype=a;return new c},h=function(){this.toString=function(){return this.val.toString()};
this.location=null};c.prototype=r(h.prototype);d.prototype=r(h.prototype);k.prototype=r(h.prototype);n.prototype=r(h.prototype);z.prototype=r(h.prototype);F.prototype=r(h.prototype);U.prototype=r(h.prototype);K.prototype=r(h.prototype);J.prototype=r(h.prototype);t.prototype=r(h.prototype);P.prototype=r(h.prototype);v.prototype=r(h.prototype);I.prototype=r(h.prototype);O.prototype=r(h.prototype);Vector.prototype.toString=Vector.prototype.toWrittenString=function(){var a=this.elts.filter(function(a){return void 0!==
a}),c=a[a.length-1];return"#("+this.elts.map(function(a){return void 0===a?c:a})+")"};M.prototype=r(h.prototype);R.prototype=r(h.prototype);N.prototype=r(h.prototype);Q.prototype=r(h.prototype);y.prototype=r(h.prototype);S.prototype=r(h.prototype);T.prototype=r(h.prototype);var L=types.makeLowLevelEqHash;plt.compiler.keywords="cond else let case let* letrec quote quasiquote unquote unquote-splicing local begin if or and when unless lambda \u03bb define define-struct define-values".split(" ");H.prototype=
r(C.prototype);X.prototype=r(C.prototype);A.prototype=r(C.prototype);Y.prototype=r(C.prototype);plt.compiler.defaultModuleResolver=function(a){for(var c=0;c<plt.compiler.knownModules.length;c++)if(plt.compiler.knownModules[c].name===a)return plt.compiler.knownModules[c];return!1};plt.compiler.moduleGuess=function(a){return plt.compiler.knownModules.reduce(function(c,d){var h=d.name;if(0===h.length)h=a.length;else if(0===a.length)h=h.length;else{for(var k=[],w=0;w<=a.length;w++)k[w]=[w];for(var l=
0;l<=h.length;l++)k[0][l]=l;for(w=1;w<=a.length;w++)for(l=1;l<=h.length;l++)a.charAt(w-1)==h.charAt(l-1)?k[w][l]=k[w-1][l-1]:k[w][l]=Math.min(k[w-1][l-1]+1,Math.min(k[w][l-1]+1,k[w-1][l]+1));h=k[a.length][h.length]}return h<c.distance?{name:d.name,distance:h}:c},{name:a,distance:5})};plt.compiler.defaultModulePathResolver=function(a,c){c=a.toString().split("/");var d=c[0];c.slice(1).join();return-1<plt.compiler.knownCollections.indexOf(d)&&plt.compiler.defaultModuleResolver(a.toString())||/^wescheme\/\w+$/.exec(a)};
plt.compiler.throwError=a;plt.compiler.Program=h;plt.compiler.comment=c;plt.compiler.couple=function(a,c){this.first=a;this.second=c;this.toString=function(){return"("+this.first.toString()+" "+this.second.toString()+")"}};plt.compiler.defFunc=d;plt.compiler.defVar=k;plt.compiler.defVars=n;plt.compiler.defStruct=z;plt.compiler.beginExpr=F;plt.compiler.lambdaExpr=U;plt.compiler.localExpr=K;plt.compiler.letrecExpr=function(a,c,d){this.bindings=a;this.body=c;this.stx=d;this.toString=function(){return"(letrec ("+
this.bindings.toString()+") ("+this.body.toString()+"))"}};plt.compiler.letExpr=function(a,c,d){this.bindings=a;this.body=c;this.stx=d;this.toString=function(){return"(let ("+this.bindings.toString()+") ("+this.body.toString()+"))"}};plt.compiler.letStarExpr=function(a,c,d){this.bindings=a;this.body=c;this.stx=d;this.toString=function(){return"(let* ("+this.bindings.toString()+") ("+this.body.toString()+"))"}};plt.compiler.condExpr=function(a,c){this.clauses=a;this.stx=c;this.toString=function(){return"(cond\n    "+
this.clauses.join("\n    ")+")"}};plt.compiler.caseExpr=J;plt.compiler.andExpr=function(a,c){this.exprs=a;this.stx=c;this.toString=function(){return"(and "+this.exprs.join(" ")+")"}};plt.compiler.orExpr=function(a,c){this.exprs=a;this.stx=c;this.toString=function(){return"(or "+this.exprs.toString()+")"}};plt.compiler.callExpr=t;plt.compiler.ifExpr=P;plt.compiler.whenUnlessExpr=v;plt.compiler.symbolExpr=I;plt.compiler.literal=O;plt.compiler.quotedExpr=M;plt.compiler.unquotedExpr=R;plt.compiler.quasiquotedExpr=
N;plt.compiler.unquoteSplice=Q;plt.compiler.requireExpr=y;plt.compiler.provideStatement=S;plt.compiler.unsupportedExpr=T;plt.compiler.pinfo=function(c,d,h,k,n,w,l,r,da,g,e,f,b,u){this.env=c||new H;this.modules=d||[];this.usedBindingsHash=h||L();this.freeVariables=k||[];this.gensymCounter=n||0;this.providedNames=w||L();this.definedNames=l||L();this.sharedExpressions=r||L();this.withLocationEmits=da||!0;this.allowRedefinition=g||!1;this.moduleResolver=e||plt.compiler.defaultModuleResolver;this.modulePathResolver=
f||plt.compiler.defaultModulePathResolver;this.currentModulePath=b||"";this.declaredPermissions=u||[];this.isRedefinition=function(a){return this.env.lookup(a)};this.usedBindings=this.usedBindingsHash.values;this.accumulateDeclaredPermission=function(a,b){this.declaredPermissions=[[a,b]].concat(this.declaredPermissions);return this};this.accumulateSharedExpression=function(a,b){b=makeLabeledTranslation(this.gensymCounter,b);this.sharedExpressions.put(b,a);return this};this.accumulateDefinedBinding=
function(b,f){if(-1<plt.compiler.keywords.indexOf(b.name))a(new types.Message([new types.ColoredPart(b.name,b.loc),": this is a reserved keyword and cannot be used as a variable or function name"]),b.loc);else if(!this.allowRedefinition&&this.isRedefinition(b.name))f=this.env.lookup(b.name),f.loc?a(new types.Message([new types.ColoredPart(b.name,b.loc),": this name has a ",new types.ColoredPart("previous definition",f.loc)," and cannot be re-defined"]),b.loc):a(new types.Message([new types.ColoredPart(b.name,
b.loc),": this name has a ","previous definition"," and cannot be re-defined"]),b.loc);else return this.env.extend(b),this.definedNames.put(b.name,b),this};this.accumulateDefinedBindings=function(a,b){var f=this;a.forEach(function(a){f.accumulateDefinedBinding(a,b)});return this};this.accumulateModuleBindings=function(a){var b=this;a.forEach(function(a){b.env.extend(a)});return this};this.accumulateModule=function(a){this.modules=[a].concat(this.modules);return this};this.accumulateBindingUse=function(a){var b=
this.usedBindingsHash.get(a.name);b&&b.moduleSource||this.usedBindingsHash.put(a.name,a);return this};this.accumulateFreeVariableUse=function(a){this.freeVariables=-1<this.freeVariables.indexOf(a)?this.freeVariables:[a].concat(this.freeVariables);return this};this.gensym=function(a){return[this,new I(a+this.gensymCounter++)]};this.permissions=function(){return this.usedBindings().reduce(function(a,b){return(b instanceof G||b instanceof W)&&0<b.permissions.length?a.concat(b.permissions):a},[]).filter(function(a,
b,f){return f.indexOf(a)===b})};this.getExposedBindings=function(){function b(b){function g(a){return e.definedNames.get(a)}e.definedNames.containsKey(b.symbl)||a(new types.Message(["provided-name-not-defined: ",b.symbl]));var c=f(c,e.definedNames.get(b.symbl));return b instanceof plt.compiler.provideBindingStructId?[g(c.constructor),g(c.predicate)].concat(c.accessors.map(g),c.mutators.map(g)):[c]}function f(b,f){if(b instanceof plt.compiler.provideBindingStructId&&!(f instanceof B))a(new types.Message(["provided-structure-not-structure: ",
f.symbl]));else return f}var e=this;bindings=bindings.reduce(function(a,f){return a.concat(b(f))},[]);return bindings.map(function(a){var b=e.declaredPermissions.filter(function(b){return b[0]===a.name});a.permissions=b.map(function(a){return a[1]});return a})};this.toString=function(){var a="pinfo-------------\n**env****: "+this.env.toString();a+="\n**modules**: "+this.modules.join(",");a+="\n**used bindings**: "+this.usedBindings();a+="\n**free variables**: "+this.freeVariables.join(",");a+="\n**gensym counter**: "+
this.gensymCounter;a+="\n**provided names**: "+this.providedNames.values();a+="\n**defined names**: "+this.definedNames.values();return a+="\n**permissions**: "+this.permissions()}};plt.compiler.getBasePinfo=function(a){var c="null empty true false eof pi e js-undefined js-null".split(" ").reduce(function(a,c){return a.extendConstant(c.toString(),'"moby/toplevel"',!1)},new H),d=new plt.compiler.pinfo;c=plt.compiler.topLevelModules.reduceRight(function(a,c){return a.extendEnv_moduleBinding(c)},c);
"moby"===a?d.env=c.extendEnv_moduleBinding(mobyModuleBinding):"base"===a&&(d.env=c);return d};plt.compiler.isExpression=function(a){return!(a instanceof k||a instanceof n||a instanceof z||a instanceof d||a instanceof S||a instanceof T||a instanceof y)};plt.compiler.isDefinition=function(a){return a instanceof k||a instanceof n||a instanceof z||a instanceof d};plt.compiler.env=C;plt.compiler.emptyEnv=H;plt.compiler.localEnv=A;plt.compiler.globalEnv=Y;plt.compiler.moduleBinding=function(a,c){this.name=
a;this.bindings=c};plt.compiler.functionBinding=G;plt.compiler.constantBinding=W;plt.compiler.structBinding=B;plt.compiler.unnamedEnv=X})();plt.compiler.lex={};plt.compiler.sexpToString={};window.plt=window.plt||{};plt.compiler=plt.compiler||{};
(function(){function a(a){return"("===a||")"===a||"["===a||"]"===a||"{"===a||"}"===a}function c(a,c){return"("===a&&")"===c||"["===a&&"]"===c||"{"===a&&"}"===c}function d(a){return"("===a?")":"["===a?"]":"{"===a?"}":")"===a?"(":"]"===a?"[":"}"===a?"{":y(new types.Message(["otherDelim: Unknown delimiter: ",a]))}function k(a,c){var l;if(c<a.length)for(l=a.charAt(c);/\s/.test(l)&&c<a.length;)"\n"===l?(r++,h=0):h++,l=a.charAt(++c);return c}function n(a){return a instanceof Array?"("+a.map(n).toString()+
")":a.toString()}function z(a,c){L=h;V=r;var l=c;c=k(a,c);var w=a.charAt(c);c>=a.length&&(D=c,y(new types.Message([E,":",V.toString(),":",(L-1).toString(),": read: (found end-of-file)"]),new q(L-1,V,c-2,2),"Error-GenericReadError"));return T.test(w)?y(new types.Message(["read: expected an open '",d(w),"' to open ",new types.ColoredPart(" "+w+" ",new q(h,V,l,1))]),new q(h,V,l,1)):S.test(w)?F(a,c):'"'===w?U(a,c):"#"===w?K(a,c):";"===w?v(a,c):G.test(w)?I(a,c):O(a,c)}function F(a,l){function w(a,b,f){a=
z(a,b);b=a.location.end().startChar+1;if(a instanceof N&&"."==a.val){if(ca){var e=new types.Message(["A syntax list may have only 2 `.'s"]);y(e,f[Z].location)}ca=Z?f.length:!1;Z=Z||f.length}a instanceof M||(a.parent=f,f.push(a));return b}function n(a,b,f){if(0===b){var e=new types.Message(["A `.' cannot be the first element in a syntax list"]);y(e,a[b].location)}if(b===a.length-1||f===a.length-1)e=new types.Message(["A `.' cannot be the last element in a syntax list"]),y(e,a[f||b].location);if(f)if(2!==
f-b)e=new types.Message(["Two `.'s may only surround one syntax item"]),y(e,a[f].location);else return a.slice(b+1,b+2).concat(a.slice(0,b),a.slice(f+1));a[b+1]instanceof Array||(e=new types.Message(["A `.' must be followed by a syntax list, but found ",new types.ColoredPart("something else",a[b+1].location)]),y(e,a[b+1].location));if(a.length>b+2)e=new types.Message(["A `.' followed by a syntax list must be followed by a closing delimeter, but found ",new types.ColoredPart("something else",a[b+2].location)]),
y(e,a[b+1].location);else return a.slice(0,b).concat(a[b+1],a.slice(b+2))}function g(a){if(/expected a .+ to (close|open)/.exec(a)||/unexpected/.exec(a)||/syntax list/.exec(a)||/bad syntax/.exec(a)||/bad character constant/.exec(a))throw a;var b=JSON.parse(JSON.parse(a)["structured-error"]).location;x=new q(Number(b.column),Number(b.line),Number(b.offset)-1,Number(b.span));l=D;u=a;return l}var e=h,f=r,b=l,u=!1,x=new q(e,f,b,1),p=a.charAt(l++),Z=!1,ca=!1;h++;var ba=[];Y.push(p);for(l=k(a,l);l<a.length&&
!T.test(a.charAt(l));){"\n"===a.charAt(l)&&(r++,h=0);try{l=w(a,l,ba)}catch(fa){l=g(fa)}l=k(a,l)}if(l>=a.length){var t=new types.Message(["read: expected a closing '",d(p),"' to close ",new types.ColoredPart(" "+p.toString()+" ",new q(e,f,b,1))]);y(t,x)}c(p,a.charAt(l))||(t=new types.Message(["read: expected a closing '",d(p),"' to close ",new types.ColoredPart(" "+p.toString()+" ",new q(e,f,b,1))," but found a ",new types.ColoredPart(" "+a.charAt(l).toString()+" ",new q(h,r,l,1))]),y(t,new q(h,r,
l,1)));h++;l++;if(u)throw D=l,u;if(Z||ca)ba=n(ba,Z,ca);ba.location=new q(e,f,b,l-b);return ba}function U(a,c){var d=h,l=r,g=c,e=/^"[^"]*(\\"[^"]*)*[^\\]"|""/.test(a.slice(c)),f=/^"[^"]*(\\"[^"]*)*/.exec(a.slice(g))[0];c++;h++;for(var b,u="";c<a.length&&'"'!==a.charAt(c);){b=a.charAt(c++);"\n"===b?(r++,h=0):h++;if("\\"===b){h++;b=a.charAt(c++);if(c>=a.length)break;switch(!0){case /a/.test(b):b="\u0007";break;case /b/.test(b):b="\b";break;case /t/.test(b):b="\t";break;case /n/.test(b):b="\n";break;
case /v/.test(b):b="\v";break;case /f/.test(b):b="\f";break;case /r/.test(b):b="\r";break;case /e/.test(b):b="'";break;case /\n/.test(b):b="";break;case /["'\\]/.test(b):break;case /[xuU]/.test(b):var x="x"===b?B:"u"===b?C:X;x.test(a.slice(c))||(D=g+f.length+1,y(new types.Message([E,":",l.toString(),":",d.toString(),": read: no hex digit following \\"+b+" in string"]),new q(d,l,g,c-g+1),"Error-GenericReadError"));x=x.exec(a.slice(c))[1];b=String.fromCharCode(parseInt(x,16));c+=x.length;h+=x.length;
break;case A.test(a.slice(c-1)):x=A.exec(a.slice(c-1))[1];b=String.fromCharCode(parseInt(x,8));c+=x.length-1;h+=x.length-1;break;default:D=g+f.length+1,y(new types.Message([E,":",l.toString(),":",d.toString(),": read: unknown escape sequence \\"+b+" in string"]),new q(d,l,g,c-g),"Error-GenericReadError")}}u+=b}e||(D=g+f.length,y(new types.Message([E,":",l.toString(),":",d.toString(),": read: expected a closing '\"'"]),new q(d,l,g,1),"Error-GenericReadError"));a=new R(new types.string(u));c++;h++;
a.location=new q(d,l,g,c-g);return a}function K(a,c){function d(a,b){a=new types.Message([E,":",r.toString(),":",(h-1).toString(),a]);y(a,new q(l,g,e,b.length+1),"Error-GenericReadError")}var l=h,g=r,e=c;c++;h++;if(c<a.length){var f=a.charAt(c).toLowerCase(),b=/^(((fl|fx|s|hash|hasheq)[[({])|((rx|px)#{0,1}"))/g.exec(a.slice(c));f=/^(!(?!\/)|reader|lang[\s]{0,1})/.exec(a.slice(c));var u=/^(c|C)(i|I|s|S)/.exec(a.slice(c)),x=/^([0-9]*)[[({]/g.exec(a.slice(c));if(b&&0<b[0].length){a=z(a,c+b[0].length-
1);c=b[0].length;var p=b[0].replace(/[\(\[\{"|#"]/g,"");switch(p){case "fl":p="flvectors";break;case "fx":p="fxvectors";break;case "s":p="structs";break;case "hash":case "hasheq":p="hashtables";break;case "px":case "rx":p="regular expressions";break;default:throw"IMPOSSIBLE: unsupportedMatch captured something it shouldn't: "+p;}x=new types.Message([E,":",r.toString(),":","0",": read-syntax: literal "+p+" not allowed"]);p=new Q(a,x,c);p.location=new q(l,g,e,b[0].length+a.location.span);return p}if(f&&
0<f[0].length)d(": read: #"+f[0].trim()+" not enabled in the current context",f[0]);else{if(u&&0<u[0].length)return aa="cs"===u[0].toLowerCase(),h+=2,z(a,c+2);if(x&&0<x[0].length)return p=x[1]?parseInt(x[1]):"",b=p.toString().length,c+=b,h+=b,b=F(a,c),p=""===p?b.length:parseInt(x[1]),b.length>p&&(a=new types.Message(["read: vector length "+p+" is too small, ",b.length+" value"+(1<b.length?"s":"")," provided"]),y(a,new q(l,g,e,x[0].length))),c+=b.location.span,p=new R(new Vector(p,b)),p.location=new q(l,
g,e,c-e),p;b=/^(hasheq|hash|fl|fx|\d+|true|false|[tfeibdox]|\<\<|[\\\"\%\:\&\|\;\!\`\,\']|)/i.exec(a.slice(c))[0];x=a.charAt(c+b.length);f=b.charAt(0).toLowerCase();switch(f){case "\\":p=J(a,c-1);c+=p.location.span-1;break;case '"':d(": byte strings are not supported in WeScheme",'#"');case "%":p=O(a,c);p.val="#"+p.val;c+=p.location.span;break;case ":":p=O(a,c-1);x=new types.Message([E,":",r.toString(),":","0",": read-syntax: Keyword internment is not supported in WeScheme"]);p=new Q(p.val,x,p.location.span);
c+=p.val.length-1;break;case "&":h++;a=z(a,c+1);b=new N("box");p=[b,a];c+=a.location.span+1;b.location=new q(l,g,e,c-e);break;case "|":c--;p=t(a,c);c+=p.location.span+1;break;case ";":p=P(a,c+1);c+=p.location.span+1;break;case "!":p=v(a,c-1);c+=p.location.span;break;case "`":case ",":case "'":p=I(a,c);p.location.startChar--;p.location.span++;D=c+p.location.span;a=new types.Message([E,":",g.toString(),":",(h-1).toString()," read: WeScheme does not support the '#"+f+"' notation for ",","===f?"unsyntax":
"'"===f?"syntax":"quasisyntax"]);y(a,p.location);break;case "<<":p=U(a,c-1);c+=p.location.span;break;case "e":case "i":case "b":case "o":case "d":case "x":h--;p=O(a,c-1);c+=p.location.span-1;break;case "true":case "false":case "t":case "f":if(!W.exec(x)){p=new R("t"===f||"true"===b);c+=b.length;h+=b.length;break}default:D=c,a=new types.Message([E,":",r.toString(),":",(h-1).toString(),": read: bad syntax `#",b+x,"'"]),y(a,new q(l,g,e,(b+x).length+1),"Error-GenericReadError")}}}else D=c,y(new types.Message([E,
":",r.toString(),":",(h-1).toString(),": read: bad syntax `#'"]),new q(l,g,e,c-e),"Error-GenericReadError");p.location=new q(l,g,e,c-e);return p}function J(c,d){var l=h,k=r,g=d;d+=2;h++;for(var e="",f=!0,b;d<c.length&&"#\\"!==c.slice(d,d+2)&&(f||!/\s/.test(c.charAt(d))&&!a(c.charAt(d)));)f=!1,h++,e+=c.charAt(d++);c=/(backspace|tab|newline|space|vtab)[^a-zA-Z]*/i;f=c.exec(e);c.test(e)?(e="backspace"===e?"\b":"tab"===e?"\t":"newline"===e?"\n":"space"===e?" ":"vtab"===e?"\v":"Impossible: unknown special char was matched by special char!",
d=g+2+f[1].length):/^[0-9].*/.test(e)&&A.test(e)&&A.exec(e)[0]===e&&256>parseInt(A.exec(e)[0],8)&&31<parseInt(A.exec(e)[0],8)?(f=/[0-7]+/.exec(e)[0],e=String.fromCharCode(parseInt(f,8)),d=g+2+f.length):/[uU]/.test(e)&&(b="u"===e.charAt(0)?C:H)&&b.test(e.slice(1))?(f=b.exec(e.slice(1))[0],h+=f.length-e.length+1,e=String.fromCharCode(parseInt(f,16)),d=g+3+f.length):1===e.length||/[^\u00C0-\u1FFF\u2C00-\uD7FF\w]$/.test(e.charAt(1))?(e=e.charAt(0),d=g+3):y(new types.Message([E,":",k.toString(),":",(l-
1).toString(),": read: bad character constant: #\\",e]),new q(l-1,k,g,d-g),"Error-GenericReadError");e=new R(new types["char"](e));e.location=new q(l,k,g,d-g);return e}function t(a,c){var d=h,l=r,g=c;c+=2;h+=2;for(var e="";c+1<a.length&&("|"!==a.charAt(c)||"#"!==a.charAt(c+1));)"\n"===a.charAt(c)&&(r++,h=0),e+=a.charAt(c),c++,h++;c+1>=a.length&&y(new types.Message(["read: Unexpected EOF when reading a multiline comment"]),new q(d,l,g,c-g));c++;h++;a=new M(e);a.location=new q(d,l,g,c-g);return a}function P(a,
c){for(var d=h++,l=r,g=c,e;(c=k(a,c))&&c+1<a.length&&(e=z(a,c))&&e instanceof M;)c=e.location.endChar;c+1>=a.length&&(D=c,y(new types.Message([E,":",l.toString(),":",(d-1).toString(),": read: expected a commented-out element for `#;' (found end-of-file)"]),new q(d-1,l,c-2,2),"Error-GenericReadError"));a=new M("("+e.toString()+")");c=e.location.endChar;a.location=new q(d,l,g,c-g);return a}function v(a,c){var d=h,l=r,g=c;c++;h++;for(var e="";c<a.length&&"\n"!==a.charAt(c);)e+=a.charAt(c),h++,c++;c>
a.length&&(D=c,y(new types.Message(["read: Unexpected EOF when reading a line comment"]),new q(d,l,g,c-g)));a=new M(e);a.location=new q(d,l,g,c+1-g);r++;h=0;return a}function I(a,c){function d(a){D=a+1;y(new types.Message([E,":",g.toString(),":",l.toString(),": read: expected an element for"+("'"==f?" quoting ":"`"==f?" quasiquoting ":","==f?" unquoting ":",@"==f?" unquoting ":""),f," (found end-of-file)"]),new q(l,g,e,f.length),"Error-GenericReadError")}var l=h,g=r,e=c,f=a.charAt(c),b="'"==f?new N("quote"):
"`"==f?new N("quasiquote"):"";c+1>=a.length&&d(c);c++;h++;","==f&&("@"==a.charAt(c)?(c++,h++,f+="@",b=new N("unquote-splicing")):b=new N("unquote"));for(b.location=new q(h-1,g,e,c-e);!u||u instanceof M;){c=k(a,c);try{var u=z(a,c)}catch(x){/read: \(found end-of-file\)/.test(x)&&d(c);if(u=/expected a .* to open ","(.)"/.exec(x))D=c+1,y(new types.Message([E,":",r.toString(),":",h.toString(),": read: unexpected `"+u[1]+"'"]),new q(h,r,c,1),"Error-GenericReadError");throw x;}c=u.location.end().startChar+
1}c=[b,u];u=u.location.end().startChar+1-e;c.location=new q(l,g,e,u);return c}function O(a,c){var d=h,k=r,g=c,e=/(\|(.|\n)*\||\\(.|\n)|[^\(\)\{\}\[\]\,\'\`\s\"\;])+/mg.exec(a.slice(c))[0],f=/\.*\\+$/.exec(e);f&&0<f[0].length%2&&(D=c=a.length,y(new types.Message([E,":",r.toString(),":",d.toString(),": read: EOF following `\\' in symbol"]),new q(d,k,g,c-g),"Error-GenericReadError"));c+=e.length;h+=e.length;f="";for(var b=0;b<e.length;b++)"\\"==e.charAt(b)&&b++,f+=e.charAt(b);f=f.split("|");if(0===f.length%
2){D=a.length;var u=e.slice(0,e.length-(f[f.length-1].length+1)),x=g+u.length;h=d;for(b=0;b<u.length;b++)"\n"===a.charAt(c)?(r++,h=0):h++;y(new types.Message([E,":",r.toString(),":",h.toString(),": read: unbalanced `|'"]),new q(h,r,x,a.length-x),"Error-GenericReadError")}a=f.reduce(function(a,b,c){return a+(c%2||aa?b:b.toLowerCase())},"");"\n"===a&&(r++,h=0);b=/^$|[\(\)\{\}\[\]\,\'\`\s\"\\]/g;a=/^.*\\[\d]*.*|\|[\d]*\|/.test(e)||b.test(a)?"|"+a+"|":a;e=new N(a);if(1===f.length&&!/^[a-zA-Z\-\?]+$/.test(a))try{var p=
jsnums.fromString(a,!0);if(p||0===p)p instanceof Object&&(p.stx=a,p.location=new q(d,k,g,c-g)),e=new R(p)}catch(Z){D=c,p=new types.Message([E,":",k.toString(),":",d.toString(),": read: "+Z.message]),y(p,new q(d,k,g,c-g),"Error-GenericReadError")}e.stx=a;e.location=new q(d,k,g,c-g);return e}var M=plt.compiler.comment,R=plt.compiler.literal,N=plt.compiler.symbolExpr,Q=plt.compiler.unsupportedExpr,y=plt.compiler.throwError,S=/[(\u005B\u007B]/,T=/[)\u005D\u007D]/,W=/^[^(\u005B\u007B)\u005D\u007D\s]+/,
G=/['`,]/,B=/^([0-9a-f]{1,2})/i,C=/^([0-9a-f]{1,4})/i,H=/^([0-9a-f]{1,6})/i,X=/^([0-9a-f]{1,8})/i,A=/^([0-7]{1,3})/i,Y,r,h,L,V,E,aa,D,q=function(a,c,d,k,g){this.startCol=a;this.startRow=c;this.startChar=d;this.span=k;this.source=g||E;this.endCol=h;this.endRow=r;this.endChar=d+k;this.start=function(){return new q("","",this.startChar,1)};this.end=function(){return new q("","",this.startChar+this.span-1,1)};this.toString=function(){return"Loc("+this.startCol+", "+this.startRow+", "+(this.startChar+
1)+","+this.span+")"};this.toVector=function(){return new types.vector(['"'+this.source+'"',this.startChar+1,this.startRow,this.startCol,this.span])};this.toString=function(){return{line:this.startRow.toString(),id:this.source,span:this.span.toString(),offset:(this.startChar+1).toString(),column:this.startCol.toString()}}};Array.prototype.toString=function(){return this.join(" ")};plt.compiler.lex=function(a,c,d){var l=(new Date).getTime();try{var g=0;L=h=0;V=r=1;aa=!0;E=c||"<definitions>";c=[];Y=
[];for(g=k(a,0);g<a.length;){var e=z(a,g);e instanceof M||c.push(e);g=k(a,e.location.startChar+e.location.span)}c.location=new q(L,V,0,g,E);var f=c}catch(b){throw console.log("LEXING ERROR"),b;}a=(new Date).getTime();d&&(console.log("Lexed in "+Math.floor(a-l)+"ms"),console.log(f),console.log(n(f)));return f};plt.compiler.sexpToString=n})();plt.compiler.parse={};window.plt=window.plt||{};plt.compiler=plt.compiler||{};
(function(){function a(a){return a instanceof h}function c(a){return a instanceof Array&&1<=a.length}function d(a,b){a=a instanceof h?a.val:a;b=b instanceof h?b.val:b;return a===b}function k(a){return a.map(function(a){return t(a)?P(a):t(a)||H(a)||A(a)?H(a)?X(a):A(a)?Y(a):m(new types.Message(["Not a Definition, Expression, Library Require, or Provide"]),a.location):v(a)})}function n(a){return 0===a.length?[]:c(a)?k(a):m(new types.Message(["The sexp is not a list of definitions or expressions: "+a]),
a.location)}function z(b){return c(b)&&a(b[0])&&d("define-struct",b[0])}function F(b){return c(b)&&a(b[0])&&d("define",b[0])}function U(b){return c(b)&&a(b[0])&&d("define-val",b[0])}function K(b){return c(b)&&a(b[0])&&d("define-fun",b[0])}function J(b){return c(b)&&a(b[0])&&d("define-values",b[0])}function t(a){return z(a)||F(a)||J(a)||U(a)||K(a)}function P(a){function b(a){2>a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected the structure name after define-struct, but nothing's there"]),
a.location);a[1]instanceof h||m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected the structure name after define-struct, but found ",new types.ColoredPart("something else",a[1].location)]),a.location);3>a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected at least one field name (in parentheses) after the ",new types.ColoredPart("structure name",a[1].location),", but nothing's there"]),a.location);a[2]instanceof Array||m(new types.Message([new types.ColoredPart(a[0].val,
a[0].location),": expected at least one field name (in parentheses) after the ",new types.ColoredPart("structure name",a[1].location),", but found ",new types.ColoredPart("something else",a[2].location)]),a.location);a[2].forEach(function(b){b instanceof h||m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a field name, but found ",new types.ColoredPart("something else",b.location)]),a.location)});if(3<a.length){var b=a.slice(3).map(function(a){return a.location}),c=1===
a[2].length?"field name":"field names",f=b.length+" extra "+(1===b.length?"part":"parts");m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected nothing after the ",new types.ColoredPart(c,a[2].location),", but found ",new types.MultiPart(f,b,!1)]),a.location)}return new fa(B(a[1]),a[2].map(B),a)}function c(a){2>a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expects a list of variables and a body, but found neither"]),a.location);3>a.length&&
m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expects a list of variables and a body, but found only ",new types.ColoredPart("one part",a[1].location)]),a.location);a[1]instanceof Array||m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expects a list of variables and a body, but found ",new types.ColoredPart("something else",a[1].location)]),a.location);if(3<a.length){var b=a.slice(3).map(function(a){return a.location}),c=b.length+" extra "+(1===b.length?
"part":"parts");b=new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expects a list of variables and a body, but found ",new types.MultiPart(c,b,!1)]);m(b,a.location)}return new ha(a[1].map(B),v(a[2]),a)}function f(a){if(3!==a.length){var b=a.slice(1).map(function(a){return a.location}),c=4>a.length?" fewer than two":new types.MultiPart("more than two parts",b,!1);m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected exactly two parts for the definition: a name (or a function name and its variables) and an expression, but found",
c]),a.location)}3<a.length&&(b=a.slice(1).map(function(a){return a.location}),c=b.length+" parts",m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected exactly two parts, but found",new types.MultiPart(c,b,!1)]),a.location));if(a[1]instanceof Array)return 0===a[1].length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected at least a function name within ",new types.ColoredPart("the parentheses",a[1].location)]),a.location),a[1][0]instanceof h||
m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a function name after the open parenthesis but found ",new types.ColoredPart("something else",a[1][0].location)]),a.location),a[1].forEach(function(b){b instanceof h||m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a variable name but found ",new types.ColoredPart("something else",b.location)]),a.location)}),3>a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected an expression for the function body, but nothing's there"]),
a.location),b=a[1].slice(1).map(B),b.location=a[1].location,new ca(B(a[1][0]),b,v(a[2]),a);if(a[1]instanceof h)return 3>a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected an expression after the variable ",new types.ColoredPart(a[1].val,a[1].location)," but nothing's there"]),a.location),new ba(B(a[1]),v(a[2]),a);m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a name (or a function name and its variables) "," and an expression, but found",
new types.ColoredPart("something else",a[1].location)]),a.location)}function e(a){if(3!==a.length){var b=a.slice(1).map(function(a){return a.location});b=4>a.length?" fewer than two":new types.MultiPart("more than two parts",b,!1);m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected exactly two parts for the value: a name and an expression, but found",b]),a.location)}if(a[1]instanceof h)return 3>a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),
": expected an expression after the name ",new types.ColoredPart(a[1].val,a[1].location)," but nothing's there"]),a.location),new ba(B(a[1]),v(a[2]),a);m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a name but found ",new types.ColoredPart("something else",a[1].location)]),a.location)}function g(a){if(3!==a.length){var b=a.slice(1).map(function(a){return a.location});b=4>a.length?" fewer than two":new types.MultiPart("more than two parts",b,!1);m(new types.Message([new types.ColoredPart(a[0].val,
a[0].location),": expected exactly two parts for the function: a header (function name and variables, in parentheses) and a body (any expression), but found",b]),a.location)}if(a[1]instanceof Array)return 0===a[1].length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected at least a function name within ",new types.ColoredPart("the parentheses",a[1].location)]),a.location),a[1][0]instanceof h||m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a function name after the open parenthesis but found ",
new types.ColoredPart("something else",a[1][0].location)]),a.location),a[1].forEach(function(b){b instanceof h||m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a variable name, but found ",new types.ColoredPart("something else",b.location)]),a.location)}),3>a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected an expression for the function body after ",new types.ColoredPart("the header",a[1].location,!1),", but nothing's there"]),
a.location),b=a[1].slice(1).map(B),b.location=a[1].location,new ca(B(a[1][0]),b,v(a[2]),a);m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a header (function name and variables, in parentheses) and a body for the function"]),a.location)}var d=z(a)?b(a):F(a)?f(a):J(a)?c(a):U(a)?e(a):K(a)?g(a):m(new types.Message([": expected to find a definition, but found: "+a]),a.location);d.location=a.location;return d}function v(a){return c(a)?I(a):G(a)}function I(b){function g(a){d(a[0],
"unquote")&&m(new types.Message(["misuse of a comma or 'unquote, not under a quasiquoting backquote"]),a.location,"Error-GenericSyntacticError");d(a[0],"unquote-splicing")&&m(new types.Message(["misuse of a ,@ or unquote-splicing, not under a quasiquoting backquote"]),a.location,"Error-GenericSyntacticError");d(a[0],"else")&&m(new types.Message([new types.ColoredPart(a[0].val,a.location),": not allowed ",new types.ColoredPart("here",a.location),", because this is not a question in a clause"]),a.location);
return c(a)?new p(v(a[0]),a.slice(1).map(v),a[0]):m(new types.Message(["function call sexp"]),a.location)}function u(a){1===a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected at least one variable (in parentheses) after lambda, but nothing's there"]),a.location);a[1]instanceof Array||m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected at least one variable (in parentheses) after lambda, but found ",new types.ColoredPart("something else",
a[1].location)]),a.location);a[1].forEach(function(b){b instanceof h||(b=new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a list of variables after lambda, but found ",new types.ColoredPart("something else",b.location)]),m(b,a.location))});2===a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected an expression for the function body, but nothing's there"]),a.location);if(3<a.length){var b=a.slice(3).map(function(a){return a.location}),
c=b.length+" extra "+(1===b.length?"part":"parts");b=new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected only one expression for the function body, but found ",new types.MultiPart(c,b,!1)]);m(b,a.location)}b=a[1].map(B);b.location=a[1].location;return new e(b,v(a[2]),a[0])}function x(a){1===a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected at least one definition (in square brackets) after local, but nothing's there"]),a.location);a[1]instanceof
Array||m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a collection of definitions, but given ",new types.ColoredPart("something else",a[1].location)]),a[1].location);a[1].forEach(function(b){t(b)||m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a definition, but given ",new types.ColoredPart("something else",b.location)]),b.location)});2===a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a single body, but found none"]),
a.location);if(3<a.length){var b=a.slice(3).map(function(a){return a.location}),c=b.length+" extra "+(1===b.length?"part":"parts");m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a single body, but found ",new types.MultiPart(c,b,!1)]),a.location)}return new w(a[1].map(P),v(a[2]),a[0])}function la(a){3>a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected an expression after the bindings, but nothing's there"]),a.location);a[1]instanceof
Array||m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a key/value pair, but given ",new types.ColoredPart("something else",a[1].location)]),a.location);a[1].forEach(function(b){C(b)||m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a key/value pair, but given ",new types.ColoredPart("something else",b.location)]),b.location)});2===a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected an expression after the bindings, but nothing's there"]),
a.location);if(3<a.length){var b=a.slice(3).map(function(a){return a.location}),c=b.length+" extra "+(1===b.length?"part":"parts");m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a single body, but found ",new types.MultiPart(c,b,!1)]),a.location)}return new q(a[1].map(N),v(a[2]),a[0])}function k(a){1===a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected at least one binding (in parentheses) after let, but nothing's there"]),a.location);
a[1]instanceof Array||m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected sequence of key value pairs, but given ",new types.ColoredPart("something else",a[1].location)]),a[1].location);a[1].forEach(function(b){C(b)||m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a key/value pair, but given ",new types.ColoredPart("something else",b.location)]),b.location)});if(3<a.length){var b=a.slice(3).map(function(a){return a.location}),c=b.length+" extra "+
(1===b.length?"part":"parts");m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a single body, but found ",new types.MultiPart(c,b,!1)]),a.location)}2===a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a single body, but found none"]),a.location);return new aa(a[1].map(N),v(a[2]),a)}function ca(a){1===a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected an expression after the bindings, but nothing's there"]),
a.location);if(!(a[1]instanceof Array)){var b=new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected sequence of key/value pairs, but given ",new types.ColoredPart("something else",a[1].location)]);m(b,a.location)}a[1].forEach(function(b){C(b)||m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a key/value pair, but given ",new types.ColoredPart("something else",b.location)]),b.location)});2===a.length&&m(new types.Message([new types.ColoredPart(a[0].val,
a[0].location),": expected a single body, but found none"]),a.location);if(3<a.length){b=a.slice(3).map(function(a){return a.location});var c=b.length+" extra "+(1===b.length?"part":"parts");m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a single body, but found ",new types.MultiPart(c,b,!1)]),a.location)}b=a[1].map(N);b.location=a[1].location;return new D(b,v(a[2]),a[0])}function n(a){4>a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a test, a consequence, and an alternative, but all three were not found"]),
a.location);if(4<a.length){var b=a.slice(1).map(function(a){return a.location});m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected only a test, a consequence, and an alternative, ","but found ",new types.MultiPart("more than three of these",b,!1)]),a.location)}return new V(v(a[1]),v(a[2]),v(a[3]),a[0])}function ba(a){function b(a){return c(a)?a.map(b):a instanceof Array&&0===a.length?a:G(a)}2>a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),
": expected a single argument, but did not find one."]),a.location);if(2<a.length){var e=a.slice(1).map(function(a){return a.location});m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a single argument, but found ",new types.MultiPart("more than one.",e,!1)]),a.location)}return new f(b(a[1]))}return function(){var c=b[0];a(c)?d("\u03bb",c)?c=u(b):d("lambda",c)?c=u(b):d("local",c)?c=x(b):d("letrec",c)?c=la(b):d("let",c)?c=k(b):d("let*",c)?c=ca(b):d("cond",c)?c=M(b):d("case",
c)?c=R(b):d("if",c)?c=n(b):d("begin",c)?(2>b.length&&(c=new types.Message([new types.ColoredPart(b[0].val,b[0].location),": Inside a begin, expected to find a body, but nothing was found."]),m(c,b.location)),c=new E(b.slice(1).map(v),b[0])):d("and",c)?(3>b.length&&m(new types.Message([new types.ColoredPart(b[0].val,b[0].location),": expected at least 2 arguments, but given ",1===b.length?"0":new types.ColoredPart((b.length-1).toString(),b[1].location)]),b.location),c=new l(b.slice(1).map(v),b[0])):
d("or",c)?(3>b.length&&m(new types.Message([new types.ColoredPart(b[0].val,b[0].location),": expected at least 2 arguments, but given ",1===b.length?"0":new types.ColoredPart((b.length-1).toString(),b[1].location)]),b.location),c=new ea(b.slice(1).map(v),b[0])):c=d("when",c)?O(b):d("unless",c)?O(b):d("quote",c)?ba(b):d("quasiquote",c)?T(b):d("unquote",c)?Q(b):d("unquote-splicing",c)?y(b):g(b):c=g(b);c.location=b.location;return c}()}function O(a){3>a.length&&m(new types.Message([new types.ColoredPart(a[0].val,
a[0].location),": expected at a test and at least one result after "+a[0]+", but nothing's there"]),a.location);var b=a.slice(2),c=new Z(v(a[1]),n(b),a[0]);b.location=b[0].location;c.location=a.location;return c}function M(b){1===b.length&&m(new types.Message([new types.ColoredPart(b[0].val,b[0].location),": expected at least one clause after cond, but nothing's there"]),b.location);var c=[b[0].location,b.location.start(),b.location.end()];b.slice(1).forEach(function(a){var f=[a.location.start(),
a.location.end()];a instanceof Array||m(new types.Message([new types.MultiPart(b[0].val,c,!0),": expected a clause with a question and an answer, but found ",new types.ColoredPart("something else",a.location)]),a.location);0===a.length&&m(new types.Message([new types.MultiPart(b[0].val,c,!0),": expected a clause with a question and an answer, but found an ",new types.MultiPart("empty part",f,!0)]),a.location);1===a.length&&m(new types.Message([new types.MultiPart(b[0].val,c,!0),": expected a clause with a question and an answer, but found a ",
new types.MultiPart("clause",f,!0)," with only ",new types.MultiPart("one part",[a[0].location],!1)]),a.location);if(2<a.length){var e=a.map(function(a){return a.location}),g=e.length+" parts";m(new types.Message([new types.MultiPart(b[0].val,c,!0),": expected a clause with a question and an answer, but found ",new types.MultiPart("a clause",f,!0)," with ",new types.MultiPart(g,e,!1)]),a.location)}});var f=b.slice(1).length,e=b.slice(1).map(function(a){var b=v(a[0]),c=v(a[1]);c=new L(b,c);-1<plt.compiler.keywords.indexOf(b.val)&&
"else"!==b.val&&m(new types.Message([new types.ColoredPart(b.val,b.location),": expected an open parenthesis before ",b.val,", but found none"]),b.location);b.isClause=!0;c.location=a.location;return c});b.slice(1).forEach(function(e,g){a(e[0])&&d(e[0],"else")&&g<f-1&&m(new types.Message([new types.MultiPart("cond",c,!0),": ","found an ",new types.ColoredPart("else clause",e.location)," that isn't the last clause in its cond expression; there is ",new types.ColoredPart("another clause",b[g+2].location),
" after it"]),e.location)});return new da(e,b[0])}function R(b){function c(b){return a(b[0])&&"else"===b[0].val}if(1===b.length){var e=new types.Message([new types.ColoredPart(b[0].val,b[0].location),": expected at least one clause after case, but nothing's there"]);m(e,b.location)}var u=[b[0].location,b.location.start(),b.location.end()];2===b.length&&(e=new types.Message([new types.MultiPart(b[0].val,u,!0),": expected a clause with at least one choice (in parentheses) and an answer after the expression, but nothing's there"]),
m(e,b.location));e=b.slice(2);e.forEach(function(a){var c=[a.location.start(),a.location.end()];if(!(a instanceof Array)){var f=new types.Message([new types.MultiPart(b[0].val,u,!0),": expected a clause with at least one choice (in parentheses), but found ",new types.ColoredPart("something else",a.location)]);m(f,b.location)}0===a.length&&(f=new types.Message([new types.MultiPart(b[0].val,u,!0),": expected at least one choice (in parentheses) and an answer, but found an ",new types.ColoredPart("empty part",
a.location)]),m(f,b.location));a[0]instanceof Array||a[0]instanceof h&&d(a[0],"else")||(f=new types.Message([new types.MultiPart(b[0].val,u,!0),": expected 'else', or at least one choice in parentheses, but found ",new types.ColoredPart("something else",a.location)]),m(f,b.location));1===a.length&&(f=new types.Message([new types.MultiPart(b[0].val,u,!0),": expected a clause with a question and an answer, but found a ",new types.MultiPart("clause",c,!0)," with only ",new types.ColoredPart("one part",
a[0].location)]),m(f,b.location));2<a.length&&(a=a.map(function(a){return a.location}),f=a.length+" parts",f=new types.Message([new types.MultiPart(b[0].val,u,!0),": expected only one expression for the answer in the case clause, but found a ",new types.MultiPart("clause",c,!0)," with ",new types.MultiPart(f,a,!1)]),m(f,b.location))});var x=e.length,p=e.map(function(a){var b=c(a)?a[0]:new f(a[0]),e=v(a[1]);e=new L(b,e);b.isClause=!0;e.location=a.location;return e});e.forEach(function(a,f){c(a)&&f<
x-1&&(a=new types.Message([new types.MultiPart("case",u,!0),": found an ",new types.ColoredPart("else clause",a.location),"that isn't the last clause in its case expression; there is ",new types.ColoredPart("another clause",b[f+2].location)," after it"]),m(a,b.location))});return new g(v(b[1]),p,b[0])}function N(a){if(C(a)){var b=new L(B(a[0]),v(a[1]));b.location=a.location;b.stx=a;return b}m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a sequence of key/value pairs, but given ",
new types.ColoredPart("something else",a[0].location)]),a.location)}function Q(a,c){if("undefined"===typeof c)m(new types.Message(["misuse of a comma or 'unquote, not under a quasiquoting backquote"]),a.location,"Error-GenericSyntacticError");else if(2!==a.length)m(new types.Message(["Inside an unquote, expected to find a single argument, but found "+(a.length-1)]),a.location);else{if(1===c)return c=new b(v(a[1])),c.location=a[1].location,c;if(1<c)return c=new b(S(a[1],c-1)),c.location=a[1].location,
c;m(new types.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),a.location)}}function y(a,b){if("undefined"===typeof b)m(new types.Message(["misuse of a ,@ or unquote-splicing, not under a quasiquoting backquote"]),a.location,"Error-GenericSyntacticError");else if(2!==a.length)m(new types.Message(["Inside an unquote-splicing, expected to find a single argument, but found "+(a.length-1)]),a.location);else{if(1===b)return b=new x(v(a[1])),b.location=a[1].location,
b;if(1<b)return b=new x(S(a[1],b-1)),b.location=a[1].location,b;m(new types.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),a.location)}}function S(a,b){if(c(a)&&"unquote"===a[0].val)return Q(a,b);if(c(a)&&"unquote-splicing"===a[0].val)return y(a,b);if(c(a)&&"quasiquote"===a[0].val)return T(a,b);if(c(a)){var e=a.map(function(a){return S(a,b)});e.location=a.location;return e}return 0===b?v(a):function(){var b=new f(a);b.location=a.location;return b}()}function T(a,
b){b="undefined"===typeof b?0:b;2>a.length&&m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a single argument, but did not find one "]),a.location);if(2<a.length){var f=a.slice(1).map(function(a){return a.location});m(new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a single argument, but found ",new types.MultiPart("more than one.",f,!1)]),a.location)}c(a[1])&&d(a[1][0],"unquote-splicing")&&m(new types.Message(["misuse of ,@ or `unquote-splicing' within a quasiquoting backquote"]),
a.location);b=S(a[1],b+1);b.location=a[1].location;b=new u(b);b.location=a.location;return b}function W(a){function b(){var b=new r(0);b.location=a.location;return b}var c=a.val,f=k(c.elts.filter(function(a){return void 0!==a})),e=0===f.length?b():f[f.length-1];f=c.elts.map(function(a){return void 0===a?e:v(a)});c=new h("vector");f=new p(c,f);c.location=f.location=a.location;return f}function G(b){var c=b instanceof ka?b:types.isVector(b.val)?W(b):a(b)?b:b instanceof r?b:d("quote",b)?new f(b):d("empty",
b)?new p(new h("list"),[]):new p(null,[]);c.location=b.location;return c}function B(b){return a(b)?b:m(new types.Message(["ID"]),b.location)}function C(a){return c(a)&&2===a.length}function H(b){return c(b)&&a(b[0])&&d(b[0],"require")}function X(a){if(2>a.length){var b=new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a module name after `require', but found nothing"]);m(b,a.location)}a[1]instanceof Array&&d(a[1][0],"lib")?(3>a[1].length&&(b=a[1].slice(1).length,b+=1===
b?" part":" parts",b=new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected at least two strings after ",new types.ColoredPart("lib",a[1][0].location)," but found only ",b]),m(b,a.location)),a[1].slice(1).forEach(function(b){types.isString(b.val)||(b=new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a string for a library collection, but found ",new types.ColoredPart("something else",str.location)]),m(b,a.location))})):a[1]instanceof Array&&d(a[1][0],
"planet")?(b=new types.Message([new types.ColoredPart(a[0].val,a[0].location),": Importing PLaneT pacakges is not supported at this time"]),m(b,a.location)):a[1]instanceof h||types.isString(a[1].val)||(b=new types.Message([new types.ColoredPart(a[0].val,a[0].location),": expected a module name as a string or a `(lib ...)' form, but found ",new types.ColoredPart("something else",a[1].location)]),m(b,a.location));b=new ia(a[1],a[0]);b.location=a.location;return b}function A(b){return c(b)&&a(b[0])&&
d(b[0],"provide")}function Y(a){var b=a.slice(1).map(function(b){if(b instanceof h||b instanceof Array&&2==b.length&&b[0]instanceof h&&d(b[0],"struct-out")&&b[1]instanceof h)return b;b=new types.Message([new types.ColoredPart(a[0].val,a[0].location),": I don't recognize the syntax of this ",new types.ColoredPart("clause",b.location)]);m(b,a.location)});b=new ja(b,a[0]);b.location=a.location;return b}var r=plt.compiler.literal,h=plt.compiler.symbolExpr,L=plt.compiler.couple,V=plt.compiler.ifExpr,E=
plt.compiler.beginExpr,aa=plt.compiler.letExpr,D=plt.compiler.letStarExpr,q=plt.compiler.letrecExpr,w=plt.compiler.localExpr,l=plt.compiler.andExpr,ea=plt.compiler.orExpr,da=plt.compiler.condExpr,g=plt.compiler.caseExpr,e=plt.compiler.lambdaExpr,f=plt.compiler.quotedExpr,b=plt.compiler.unquotedExpr,u=plt.compiler.quasiquotedExpr,x=plt.compiler.unquoteSplice,p=plt.compiler.callExpr,Z=plt.compiler.whenUnlessExpr,ca=plt.compiler.defFunc,ba=plt.compiler.defVar,ha=plt.compiler.defVars,fa=plt.compiler.defStruct,
ia=plt.compiler.requireExpr,ja=plt.compiler.provideStatement,ka=plt.compiler.unsupportedExpr,m=plt.compiler.throwError;plt.compiler.parse=function(a,b){var c=(new Date).getTime();try{var f=n(a);f.location=a.location}catch(ma){throw console.log("PARSING ERROR"),ma;}a=(new Date).getTime();b&&(console.log("Parsed in "+Math.floor(a-c)+"ms"),console.log(f));return f}})();plt.compiler.topLevelModules={};plt.compiler.knownModules={};plt.compiler.knownCollections={};window.plt=window.plt||{};
plt.compiler=plt.compiler||{};
(function(){function a(a){return function(c){c[3]=c[3]||[];c[4]=c[4]||!1;c[5]=c[5]||!1;return new d(c[0],a,c[1],c[2],c[3],c[4],c[5])}}var c=plt.compiler.moduleBinding,d=plt.compiler.functionBinding,k=plt.compiler.constantBinding,n=new c("moby/runtime/kernel/misc",[["verify-boolean-branch-value",2],["throw-cond-exhausted-error",1],["'check-operator-is-function",3],["print-values",0]].map(a('"moby/runtime/kernel/misc"'))),z=new c("moby/foreign",[["get-js-object",2,!1,["android.permission.FOREIGN-FUNCTION-INTERFACE"]]].map(a('"moby/foreign"'))),F=
new c("world-effects",[["make-effect:none",0,!1],["make-effect:beep",0,!1,["android.permission.VIBRATE"]],["make-effect:play-dtmf-tone",2,!1],["make-effect:send-sms",2,!1,["android.permission.SEND-SMS"]],["make-effect:play-sound",1,!1,["android.permission.INTERNET"]],["make-effect:stop-sound",1,!1],["make-effect:pause-sound",1,!1],["make-effect:set-sound-volume",1,!1],["make-effect:set-beep-volume",1,!1],["make-effect:raise-sound-volume",0,!1],["make-effect:lower-sound-volume",1,!1],["make-effect:set-wake-lock",
1,!1,["android.permission.WAKE-LOCK"]],["make-effect:release-wake-lock",1,!1,["android.permission.WAKE-LOCK"]],["make-effect:pick-playlist",1,!1],["make-effect:pick-random",2,!1]].map(a('"moby/world-effects"'))),U=new c("world-config",[["on-tick",1,!0],["initial-effect",1,!1],["on-key",1,!1],["on-key!",2,!1],["on-mouse",1,!1],["on-tap",1,!1],["on-tilt",1,!1],["on-redraw",1,!1],["to-draw",1,!1],["on-draw",2,!1],["stop-when",1,!1]].map(a('"moby/world-handlers"'))),K=[["START",14,!1],["test-frame",1,
!1],["sine",1,!1],["cosine",1,!1],["tangent",1,!1]],J=new c("bootstrap/bootstrap-teachpack",K.map(a('"bootstrap/bootstrap-teachpack"'))),t=new c("bootstrap2011/bootstrap-teachpack",K.map(a('"bootstrap2011/bootstrap-teachpack"'))),P=new c("bootstrap2012/bootstrap-teachpack",K.map(a('"bootstrap2012/bootstrap-teachpack"'))),v=new c("bootstrap2012/bootstrap-tilt-teachpack",K.map(a('"bootstrap2012/bootstrap-tilt-teachpack"'))),I=new c("bootstrap2014/bootstrap-teachpack",K.map(a('"bootstrap2014/bootstrap-teachpack"'))),
O=new c("bootstrap2014/bootstrap-tilt-teachpack",K.map(a('"bootstrap2014/bootstrap-tilt-teachpack"'))),M=new c("bootstrap2015/bootstrap-teachpack",K.map(a('"bootstrap2015/bootstrap-teachpack"')));K=new c("bootstrap2015/bootstrap-tilt-teachpack",K.map(a('"bootstrap2015/bootstrap-tilt-teachpack"')));var R=new c("bootstrap/cage-teachpack",[["start",1,!1]].map(a('"bootstrap/cage-teachpack"'))),N=new c("bootstrap2011/cage-teachpack",[["start",1,!1]].map(a('"bootstrap2011/cage-teachpack"'))),Q=new c("bootstrap2012/cage-teachpack",
[["start",1,!1]].map(a('"bootstrap2012/cage-teachpack"'))),y=new c("bootstrap2014/cage-teachpack",[["start",1,!1]].map(a('"bootstrap2014/cage-teachpack"')));cageTeachpack2015=new c("bootstrap2015/cage-teachpack",[["start",1,!1]].map(a('"bootstrap2015/cage-teachpack"')));var S=new c("bootstrap2020/boolean-teachpack",[["start",1,!1]].map(a('"bootstrap2020/boolean-teachpack"'))),T=new c("bootstrap/function-teachpack",[["start",1,!1]].map(a('"bootstrap/function-teachpack"'))),W=new c("bootstrap2011/function-teachpack",
[["start",1,!1]].map(a('"bootstrap2011/function-teachpack"'))),G=new c("bootstrap2012/function-teachpack",[["start",1,!1]].map(a('"bootstrap2012/function-teachpack"'))),B=new c("bootstrap2014/function-teachpack",[["start",1,!1]].map(a('"bootstrap2014/function-teachpack"'))),C=new c("bootstrap2015/function-teachpack",[["start",1,!1]].map(a('"bootstrap2015/function-teachpack"'))),H=new c("location",[["get-latitude",0,!1,["android.permission.LOCATION"]],["get-longitude",0,!1,["android.permission.LOCATION"]],
["get-altitude",0,!1,["android.permission.LOCATION"]],["get-bearing",0,!1,["android.permission.LOCATION"]],["get-speed",0,!1,["android.permission.LOCATION"]],["location-distance",0,!1,["android.permission.LOCATION"]]].map(a('"moby/geolocation"'))),X=new c("tilt",[["get-x-acceleration",0,!1,["android.permission.TILT"]],["get-y-acceleration",0,!1,["android.permission.TILT"]],["get-z-acceleration",0,!1,["android.permission.TILT"]],["get-azimuth",0,!1,["android.permission.TILT"]],["get-pitch",0,!1,["android.permission.TILT"]],
["get-roll",0,!1,["android.permission.TILT"]]].map(a('"moby/tilt"'))),A=new c("telephony",[["get-signal-strength",0,!1,["android.permission.TELEPHONY"]]].map(a('"moby/net"'))),Y=new c("net",[["get-url",1,!1,["android.permission.INTERNET"]]].map(a('"moby/net"'))),r=new c("parser",[["xml->s-sexp",1,!1]].map(a('"moby/parser"'))),h=new c("jsworld",[["js-big-bang",1,!1],["big-bang",1,!1],["js-div",0,!1],["js-p",0,!1],["js-button",2,!1],["js-button!",2,!1],["js-node",1,!1],["js-text",1,!1],["js-select",
2,!1],["js-img",1,!1,["android.permission.INTERNET"]]].map(a('"moby/jsworld"')));F=new c("world",U.bindings.concat(F.bindings,"key=? play-sound animate big-bang make-color color? color-red color-green color-blue color-alpha empty-scene empty-image scene+line put-image translate place-image place-image/align circle star polygon radial-star star-polygon nw:rectangle rectangle regular-polygon rhombus square triangle triangle/sas triangle/sss triangle/ass triangle/ssa triangle/aas triangle/asa triangle/saa right-triangle isosceles-triangle ellipse line add-line add-polygon overlay overlay/xy overlay/align underlay underlay/xy underlay/align beside beside/align above above/align rotate scale scale/xy dilate crop frame flip-horizontal flip-vertical reflect-x reflect-y text text/font video/url bitmap/url image-url image? image=? image-width image-height mouse-event? mouse=? image->color-list color-list->image color-list->bitmap image-baseline mode? image-color? name->color x-place? y-place? angle? side-count? step-count?".split(" ").map(function(a){var c=
-1<["video/url","bitmap/url","image-url"].indexOf(a)?["android.permission.INTERNET"]:[];return new k(a,'"moby/world"',c,!1)})));c=new c("moby/topLevel",[["<",2,!0],["<=",2,!0],["=",2,!0],[">",2,!0],[">=",2,!0],["<>",2,!0],["=~",3],["number->string",1],["even?",1],["odd?",1],["positive?",1],["negative?",1],["number?",1],["rational?",1],["quotient",2],["remainder",2],["numerator",1],["denominator",1],["integer?",1],["real?",1],["abs",1],["acos",1],["add1",1],["angle",1],["asin",1],["atan",1,!0],["ceiling",
1],["complex?",1],["conjugate",1],["cos",1],["cosh",1],["denominator",1],["even?",1],["exact->inexact",1],["exact?",1],["exp",1],["expt",2],["floor",1],["gcd",1,!0],["imag-part",1],["inexact->exact",1],["inexact?",1],["integer->char",1],["integer-sqrt",1],["integer?",1],["lcm",1,!0],["log",1],["magnitude",1],["make-polar",2],["make-rectangular",2],["max",1,!0],["min",1,!0],["modulo",2],["negative?",1],["number?",1],["numerator",1],["odd?",1],["positive?",1],["random",1],["rational?",1],["real-part",
1],["real?",1],["round",1],["sgn",1],["sin",1],["sinh",1],["sqr",1],["sqrt",1],["nth-root",2],["sub1",1],["tan",1],["zero?",1],["+",0,!0],["-",1,!0],["*",0,!0],["/",1,!0],["not",1],["false?",1],["boolean?",1],["boolean=?",2],["symbol->string",1],["symbol=?",2],["symbol?",1],["append",0,!0],["assq",2],["assv",2],["assoc",2],["caaar",1],["caadr",1],["caar",1],["cadar",1],["cadddr",1],["caddr",1],["cadr",1],["car",1],["cddar",1],["cdddr",1],["cddr",1],["cdr",1],["cdaar",1],["cdadr",1],["cdar",1],["cons?",
1],["list?",1],["cons",2],["empty?",1],["length",1],["list",0,!0],["list*",1,!0],["range",3],["list-ref",2],["remove",2],["remove-all",2],["member",2],["member?",2],["memq",2],["memv",2],["null?",1],["pair?",1],["rest",1],["reverse",1],["first",1],["second",1],["third",1],["fourth",1],["fifth",1],["sixth",1],["seventh",1],["eighth",1],["make-list",2],["box",1],["unbox",1],["set-box!",2],["box?",1],["make-posn",2],["posn-x",1],["posn-y",1],["posn?",1],["char->integer",1],["char-alphabetic?",1],["char-ci<=?",
2,!0],["char-ci<?",2,!0],["char-ci=?",2,!0],["char-ci>=?",2,!0],["char-ci>?",2,!0],["char-downcase",1],["char-lower-case?",1],["char-numeric?",1],["char-upcase",1],["char-upper-case?",1],["char-whitespace?",1],["char<=?",2,!0],["char<?",2,!0],["char=?",2,!0],["char>=?",2,!0],["char>?",2,!0],["char?",1],["format",1,!0],["list->string",1],["make-string",2],["replicate",2],["string",0,!0],["string->list",1],["string->number",1],["string->symbol",1],["string-alphabetic?",1],["string-append",0,!0],["string-contains?",
2],["string-ci<=?",2,!0],["string-ci<?",2,!0],["string-ci=?",2,!0],["string-ci<>?",2,!0],["string-ci>=?",2,!0],["string-ci>?",2,!0],["string-copy",1],["string-length",1],["string-lower-case?",1],["string-numeric?",1],["string-ref",2],["string-upper-case?",1],["string-whitespace?",1],["string<=?",2,!0],["string<?",2,!0],["string=?",2,!0],["string<>?",2,!0],["string>=?",2,!0],["string>?",2,!0],["string?",1],["substring",3],["string-ith",2],["int->string",1],["string->int",1],["explode",1],["implode",
1],["eof-object?",1],["=~",3],["eq?",2],["equal?",2],["equal~?",3],["eqv?",2],["error",2],["identity",1],["struct?",1],["current-seconds",0],["andmap",1,!0],["apply",2,!0],["argmax",2],["argmin",2],["build-list",2],["build-string",2],["compose",0,!0],["filter",2],["foldl",2,!0],["foldr",2,!0],["map",1,!0],["for-each",1,!0],["memf",2],["ormap",1,!0],["procedure?",1],["quicksort",2],["sort",2],["void",0,!0],["xml->s-exp",1],["build-vector",2],["make-vector",1,!0],["vector",0,!0],["vector-length",1],
["vector-ref",2],["vector-set!",3],["vector->list",1],["list->vector",1],["vector?",1],["printf",1,!0],["display",1],["write",1],["newline",0],["call/cc",1],["procedure-arity",1],["check-expect",2],["EXAMPLE",2],["check-within",3],["check-error",2],["make-hasheq",0],["make-hash",0],["hash-set!",3],["hash-ref",3],["hash-remove!",2],["hash-map",2],["hash-for-each",2],["hash?",1],["raise",1],["undefined?",1],["values",0,!0],["make-struct-type",4,!0],["make-struct-field-accessor",2,!0],["make-struct-field-mutator",
2,!0],["current-continuation-marks",0,!1],["continuation-mark-set->list",2,!1],["scheme->prim-js",1,!1],["prim-js->scheme",1,!1],["procedure->cps-js-fun",1,!1],["procedure->void-js-fun",1,!1],["js-===",2,!1],["js-get-named-object",1,!1],["js-get-field",2,!0],["js-set-field!",3,!1],["js-typeof",1,!1],["js-instanceof",2,!1],["js-call",2,!0],["js-new",1,!0],["js-make-hash",0,!0],["make-world-config",2,!0],["make-bb-info",2,!1],["bb-info?",1,!1],["bb-info-change-world",1,!1],["bb-info-toplevel-node",
1,!1],["make-effect-type",4,!0],["effect?",1,!1],["world-with-effects",2,!1],["make-render-effect-type",4,!0],["render-effect-type?",1],["render-effect?",1],["make-render-effect-type",4,!0],["values",0,!0],["sleep",0,!0],["current-inexact-milliseconds",0,!1],["make-exn",2,!1],["exn-message",1,!1],["exn-continuation-marks",1,!1]].map(a('"moby/toplevel"')));plt.compiler.topLevelModules=[c,n,,h,F];plt.compiler.knownCollections="bootstrap bootstrap2011 bootstrap2012 bootstrap2014 bootstrap2015 bootstrap2020".split(" ");
plt.compiler.knownModules=[n,h,z,F,J,t,P,I,M,v,O,K,R,N,Q,y,cageTeachpack2015,S,T,W,G,B,C,H,X,A,Y,r,c]})();plt.compiler.desugar={};plt.compiler.analyze={};window.plt=window.plt||{};plt.compiler=plt.compiler||{};
(function(){function a(a,c,f){var b={};a.forEach(function(a){a instanceof t?b[a.val]?q(new types.Message([new types.ColoredPart(c.toString(),c.location),": found ",new types.ColoredPart("a variable",a.location)," that is already used ",new types.ColoredPart("here",b[a.val].location)]),a.location):b[a.val]=a:q("expected identifier "+a.val,a.location)})}function c(a,c){c=plt.compiler.defaultModuleResolver(c);var f=(new plt.compiler.emptyEnv).extendEnv_moduleBinding(c);[a.func].concat(a.args).forEach(function(a){a.context=
f});return a}function d(a,e,f){a=new J(new types.string(a.toString()));var b=new t("verify-boolean-branch-value");a=new B(a);e=new B(new J(e.toVector()));var g=new B(new J(f.location.toVector())),d=new A(b,[a,e,f,g]);d.location=b.location=f.location;a.location=e.location=g.location=f.location;c(d,"moby/runtime/kernel/misc");return d}function k(a,e,f){e=[[],e||new plt.compiler.pinfo];e=a.reduce(function(a,e){var b=e.desugar(a[1]);if(plt.compiler.isExpression(e)&&f){e=new t("print-values");var g=new A(e,
[b[0]]);e.location=g.location=b[0].location;b[0]=g;c(g,"moby/runtime/kernel/misc")}b[0].length?a[0]=a[0].concat(b[0]):a[0].push(b[0]);return[a[0],b[1]]},e);e[0].location=a.location;return e}function n(a,c,f){var b="undefined"!=typeof a.location?a.location:a instanceof Array&&"undefined"!=typeof a[0].location?a[0].location:q(types.Message(["ASSERTION FAILURE: couldn't find a usable location"]),new Location(0,0,0,0));a=a.map(function(a){if(0===f&&a instanceof X)a=a.desugar(c,f);else{var e=a instanceof
Array?n(a,f,f)[0]:a.desugar(c,f)[0];a=new t("list");e=new A(a,[e]);a.parent=e;e.location=a.location=b;a=[e,c]}return a[0]});var e=new t("append");e.location=b;a=new A(e,a);a.location=b;return[a,c]}function z(a,c,f,b,d){return new ea(a,c,f,b,[],!1,d)}function F(a){this.symbl=a}function U(a,c){var f=c.env,b=f.bindings.keys(),e=types.makeLowLevelEqHash();b.forEach(function(a){e.put(a,f.bindings.get(a))});b=new plt.compiler.env(e);b=a.args.reduce(function(a,b){return a.extend(new l(b.val,!1,[],b.location))},
b);c.env=b;c=a.body.analyzeUses(c,b);c.env=f;return c}function K(a,c){c=function(a,b){return a.reduce(function(a,b){return b.collectDefinitions(a)},b)}(a,c);c=function(a,b){return a.reduce(function(a,b){return b.collectProvides(a)},b)}(a,c);return function(a,b){return a.reduce(function(a,b){return b.analyzeUses(a,a.env)},b)}(a,c)}var J=plt.compiler.literal,t=plt.compiler.symbolExpr,P=plt.compiler.Program,v=plt.compiler.couple,I=plt.compiler.ifExpr,O=plt.compiler.beginExpr,M=plt.compiler.letExpr,R=
plt.compiler.letStarExpr,N=plt.compiler.letrecExpr,Q=plt.compiler.localExpr,y=plt.compiler.andExpr,S=plt.compiler.orExpr,T=plt.compiler.condExpr,W=plt.compiler.caseExpr,G=plt.compiler.lambdaExpr,B=plt.compiler.quotedExpr,C=plt.compiler.unquotedExpr,H=plt.compiler.quasiquotedExpr,X=plt.compiler.unquoteSplice,A=plt.compiler.callExpr,Y=plt.compiler.whenUnlessExpr,r=plt.compiler.defFunc,h=plt.compiler.defVar,L=plt.compiler.defVars,V=plt.compiler.defStruct,E=plt.compiler.requireExpr,aa=plt.compiler.provideStatement,
D=plt.compiler.unsupportedExpr,q=plt.compiler.throwError,w=plt.compiler.structBinding,l=plt.compiler.constantBinding,ea=plt.compiler.functionBinding,da=plt.compiler.moduleBinding;P.prototype.desugar=function(a){return[this,a]};r.prototype.desugar=function(c){a([this.name].concat(this.args),this.stx[0],this.location);this.args.forEach(function(a){a instanceof t||q(new types.Message([new types.ColoredPart(this.stx.val,this.stx.location),": expected a variable but found ",new types.ColoredPart("something else",
a.location)]),sexp.location)});c=this.body.desugar(c);var e=new r(this.name,this.args,c[0],this.stx);e.location=this.location;return[e,c[1]]};h.prototype.desugar=function(a){if(this.expr instanceof G){var c=new r(this.name,this.expr.args,this.expr.body,this.stx);c.location=this.location;return c.desugar(a)}a=this.expr.desugar(a);c=new h(this.name,a[0],this.stx);c.location=this.location;return[c,a[1]]};L.prototype.desugar=function(a){a=this.expr.desugar(a);var c=new L(this.names,a[0],this.stx);c.location=
this.location;return[c,a[1]]};V.prototype.desugar=function(a){var c=this,f=["make-"+this.name.val,this.name.val+"?",this.name.val+"-ref",this.name.val+"-set!"].map(function(a){return new t(a)}),b=new t("make-struct-type"),g=[new B(new t(this.name.val)),new J(!1),new J(this.fields.length),new J(0)],d=new A(b,g);[d,b].concat(f,g).forEach(function(a){a.location=c.location});f=new L([this.name].concat(f),d,this.stx);var p=[f];f.location=this.location;this.fields.forEach(function(a,b){var f=new t("make-struct-field-accessor");
b=[new t(c.name.val+"-ref"),new J(b),new B(new t(a.val))];var e=new A(f,b),g=new t(c.name.val+"-"+a.val),d=new h(g,e);[d,f,e,g].concat(b).forEach(function(b){b.location=a.location});p.push(d)});return[p,a]};O.prototype.desugar=function(a){a=k(this.exprs,a);var c=new O(a[0],this.stx);c.location=this.location;return[c,a[1]]};G.prototype.desugar=function(c){this.stx&&a(this.args,this.stx,this.location);c=this.body.desugar(c);var e=new G(this.args,c[0],this.stx);e.location=this.location;return[e,c[1]]};
Q.prototype.desugar=function(a){var c=k(this.defs,a);a=this.body.desugar(c[1]);c=new Q(c[0],a[0],this.stx);c.location=this.location;return[c,a[1]]};A.prototype.desugar=function(a){this.func||q(new types.Message([new types.ColoredPart("( )",this.location),": expected a function, but nothing's there"]),this.location);a=k([this.func].concat(this.args),a);var c=new A(a[0][0],a[0].slice(1),this.stx);c.location=this.location;return[c,a[1]]};I.prototype.desugar=function(a){a=k([this.predicate,this.consequence,
this.alternative],a);var c=d(this.stx,this.stx.location,a[0][0]);c=new I(c,a[0][1],a[0][2],this.stx);c.location=this.location;return[c,a[1]]};Y.prototype.desugar=function(a){var c=new O(this.exprs,this.stx),f=new t("void"),b=new A(f,[],this.stx),d="when"===this.stx.val?c:b,g="when"===this.stx.val?b:c;c.location=this.exprs.location;f.location=b.location=this.location;a=k([this.predicate,d,g],a);c=new I(a[0][0],a[0][1],a[0][2],this.stx);c.location=this.location;return[c,a[1]]};N.prototype.desugar=function(a){a=
(new Q(this.bindings.map(function(a){var c=new h(a.first,a.second,a.stx);c.location=a.location;return c}),this.body,this.stx)).desugar(a);a[0].location=this.location;return a};M.prototype.desugar=function(a){var c=this.bindings.map(function(a){return a.first}),f=this.bindings.map(function(a){return a.second});c=new G(c,this.body,this.stx);f=new A(c,f);c.location=f.location=this.location;return f.desugar(a)};R.prototype.desugar=function(a){function c(a,b){a=new M([b],a,b.stx);a.location=b.location;
return a}return 0===this.bindings.length?this.body.desugar(a):this.bindings.reduceRight(c,this.body).desugar(a)};T.prototype.desugar=function(a){var e=new t("throw-cond-exhausted-error"),f=new B(new J(this.location.toVector())),b=c(new A(e,[f]),"moby/runtime/kernel/misc");(new t("if")).location=this.stx.location;b.location=e.location=f.location=this.location;for(e=this.clauses.length-1;-1<e;e--)this.clauses[e].first instanceof t&&"else"===this.clauses[e].first.val&&(this.clauses[e].first.val="true"),
b=new I(this.clauses[e].first,this.clauses[e].second,b,this.stx),b.location=this.location;return b.desugar(a)};W.prototype.desugar=function(a){var c=this,f=new t("if");f.location=c.location;a=a.gensym("val");var b=a[1],d=a[0].gensym("x");a=d[0];var g=d[1],p=new t("void"),h=[b,g,p];d=this.clauses;var k=d[this.clauses.length-1];k.first instanceof t&&"else"===k.first.val?(p=k.second,d.pop()):(p=new A(p,[],c.stx),p.location=c.location);k=new t("equal?");var l=new A(k,[g,b],f),n=new G([g],l,f);h=h.concat([k,
l,n]);b=new v(b,this.expr);d=d.reduceRight(function(a,b){var e=new t("ormap"),d=new A(e,[n,b.first],c.stx);a=new I(d,b.second,a,f);h=h.concat([e,d,b.first,a]);return a},p);d=new M([b],d,f);h=h.concat([b,d]);h.forEach(function(a){a.location=c.location});return d.desugar(a)};y.prototype.desugar=function(a){function c(a){var e=d(f.stx,f.stx.location,a[0]),g=2<a.length?c(a.slice(1)):d(f.stx,f.stx.location,a[1]);a=new J(!1);e=new I(e,g,a,b);[a,b,e].forEach(function(a){return a.location=f.location});return e}
var f=this,b=new t("if");a=k(this.exprs,a);var g=a[0];a=a[1];g=c(g);g.location=f.location;return[g,a]};S.prototype.desugar=function(a){function c(a,e){var g=a[0];e=e.gensym("tmp");var u=e[1],h=new t("if");u.notOriginalSource=!0;g.stx&&"if"!==g.stx.val&&(h.location=g.location,g.stx=h);e=e[0];g=new v(u,d(f.stx,f.stx.location,g));2==a.length?a=d(b,f.stx.location,a[1]):(e=c(a.slice(1),e),a=e[0],e=e[1]);a=new I(u,u,a,new t("if"));h=new M([g],a,b);[b,u,g,a,a.stx,h].forEach(function(a){return a.location=
f.location});return h.desugar(e)}var f=this,b=new t("or");a=k(this.exprs,a);var g=a[0];a=a[1];return c(g,a)};B.prototype.desugar=function(a){"undefined"===typeof this.location&&q(new types.Message(["ASSERTION ERROR: Every quotedExpr should have a location"]),loc);return function(a,c){return function(b){if(b instanceof A||b instanceof B||b instanceof D)return b.desugar(a);if(b instanceof t||b instanceof J||b instanceof Array)return b=new B(b),b.location=c,[b,a];q(new types.Message(["ASSERTION ERROR: Found an unexpected item in a quotedExpr"]),
c)}}(a,this.location)(this.val)};C.prototype.desugar=function(a,c){if("undefined"===typeof c)q(new types.Message(["misuse of a ', not under a quasiquoting backquote"]),this.location);else{if(1===c)return this.val.desugar(a);if(1<c){var f=this.val instanceof Array?n(this.val,a,c-1)[0]:this.val.desugar(a,c-1)[0];c=new B(new t("unquote"));var b=new t("list");f=[c,f];var e=new A(b,f);c.location=this.location;c.parent=f;b.location=this.location;b.parent=e;e.location=this.location;return[e,a]}q(new types.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),
this.location)}};X.prototype.desugar=function(a,c){if("undefined"===typeof c)q(new types.Message(["misuse of a ,@, not under a quasiquoting backquote"]),this.location);else{if(1===c)return this.val.desugar(a);if(1<c){var f=this.val instanceof Array?n(this.val,a,c-1)[0]:this.val.desugar(a,c-1)[0];c=new B(new t("unquote-splicing"));var b=new t("list");f=[c,f];var e=new A(b,f);c.location=this.location;c.parent=f;b.location=this.location;b.parent=e;e.location=this.location;return[e,a]}q(new types.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),
this.location)}};H.prototype.desugar=function(a,c){c="undefined"===typeof c?0:c;if(0<=c)var f=this.val instanceof Array?n(this.val,a,c+1)[0]:this.val.desugar(a,c+1)[0];else q(new types.Message(["ASSERTION FAILURE: depth should have been undefined, or a natural number"]),this.location);if(0==c)return[f,a];c=new B(new t("quasiquote"));var b=[c,f],e=new t("list"),d=new A(e,b);c.parent=b;c.location=this.location;f.parent=b;e.parent=d;e.location=this.location;d.location=this.location;return[d,a]};t.prototype.desugar=
function(a){if(!this.isClause&&"else"===this.val){var c=this.parent&&this.parent[0]===this?this.parent.location:this.location;q(new types.Message([new types.ColoredPart(this.val,c),": not allowed ",new types.ColoredPart("here",c),", because this is not a question in a clause"]),c)}this.parent&&this.parent[0]!==this&&"define"===this.val&&(c=new types.Message([new types.ColoredPart(this.val,this.location),": not allowed inside an expression"]),q(c,this.location));!this.parent&&-1<plt.compiler.keywords.indexOf(this.val)&&
"else"!==this.val&&q(new types.Message([new types.ColoredPart(this.val,this.location),": expected an open parenthesis before ",this.val,", but found none"]),this.location);"."===this.val&&(c=new types.Message([this.location.source,":",this.location.startRow.toString(),":",this.location.startCol.toString(),": read: '.' is not supported as a symbol in WeScheme"]),q(c,this.location,"Error-GenericReadError"));return[this,a]};D.prototype.desugar=function(a){this.location.span=this.errorSpan;q(this.errorMsg,
this.location,"Error-GenericReadError")};P.prototype.collectDefinitions=function(a){return a};r.prototype.collectDefinitions=function(a){this.args.forEach(function(a){-1<plt.compiler.keywords.indexOf(a.val)&&q(new types.Message([new types.ColoredPart(a.val,a.location),": this is a reserved keyword and cannot be used as a variable or function name"]),a.location)});var c=z(this.name.val,!1,this.args.length,!1,this.name.location);return a.accumulateDefinedBinding(c,this.location)};h.prototype.collectDefinitions=
function(a){var c=this.expr instanceof G?z(this.name.val,!1,this.expr.args.length,!1,this.name.location):new l(this.name.val,!1,[],this.name.location);return a.accumulateDefinedBinding(c,this.location)};L.prototype.collectDefinitions=function(a){var c=this,f=function(a){return c.stx[1].val+"-"+a.val},b=function(a){return"set-"+c.stx[1].val+"-"+a.val+"!"};if("define-struct"===c.stx[0].val){var d=c.stx[1].val,g=c.stx[2],h="make-"+d,k=d+"?";f=g.map(f);var n=g.map(b);b=c.stx[1].location;f=new w(d,!1,
g,h,k,f,n,null,c.stx[1].location);g=z(h,!1,g.length,!1,b);k=z(k,!1,1,!1,b);h=z(d+"-set!",!1,1,!1,b);d=z(d+"-ref",!1,1,!1,b);return a.accumulateDefinedBindings([f,d,g,k,h],c.location)}return this.names.reduce(function(a,b){b=new l(b.val,!1,[],b.location);return a.accumulateDefinedBinding(b,c.location)},a)};E.prototype.collectDefinitions=function(a){function c(a){return(a=a.match(/^wescheme\/(\w+)$/))?a[1]:!1}function f(a){a=plt.compiler.moduleGuess(g.spec.toString());a=new types.Message(["Found require of the module ",
new types.ColoredPart(g.spec.toString(),g.spec.location),", but this module is unknown.",a.name===g.spec.toString()?"":" Did you mean '"+a.name+"'?"]);q(a,g.spec.location,"Error-UnknownModule")}function b(b){var c=window.COLLECTIONS[b].provides.map(function(a){a=new l(a,new t(b),!1);a.imported=!0;return a}),f=new da(b,c);h=a.accumulateModule(f).accumulateModuleBindings(c)}var d=this.spec instanceof J?this.spec.val.toString():this.spec.toString(),g=this,h;a.modulePathResolver(d,a.currentModulePath)||
c(d)||f(d);var k=window.location.protocol+"//"+window.location.host+(c(d)?"/loadProject?publicId="+c(d):"/js/mzscheme-vm/collects/"+d+".js");console.log(k);window.COLLECTIONS&&window.COLLECTIONS[d]?b(d):jQuery.ajax({url:k,success:function(a){try{if(c(d)){var e=(0,eval)("("+a+")");void 0===window.COLLECTIONS&&(window.COLLECTIONS=[]);var h=plt.compiler.lex(e.source.src,d),u=plt.compiler.parse(h),p=plt.compiler.desugar(u)[0],k=plt.compiler.analyze(p),x=plt.compiler.compile(p,k);window.COLLECTIONS[d]=
{name:d,bytecode:(0,eval)("("+x.bytecode+")"),provides:x.provides}}else eval(a);a?b(d):f(d)}catch(m){if("moby-failure"===m.type)throw m;a=new types.Message(["A network error occured when trying to load ",new types.ColoredPart(g.spec.toString(),g.spec.location),". Please check your connection and try again."]);q(a,g.spec.location,"Error-NetworkError")}},error:function(a){f(d)},async:!1});return h};P.prototype.collectProvides=function(a){return a};aa.prototype.collectProvides=function(a){function c(c){a.providedNames.put(c,
new F(c))}return this.clauses.reduce(function(a,b){if(b instanceof t){if(a.definedNames.containsKey(b.val))return c(b.val),a;a=new types.Message(["The name '",new types.ColoredPart(b.toString(),b.location),"', is not defined in the program, and cannot be provided."]);q(a,b.location)}else if(b instanceof Array){if(a.definedNames.containsKey(b[1].val)&&a.definedNames.get(b[1].val)instanceof w)return b=a.definedNames.get(b[1].val),[b.name,b.constructor,b.predicate].concat(b.accessors,b.mutators).forEach(c),
a;q(new types.Message(["The struct '",new types.ColoredPart(b[1].toString(),b[1].location),"', is not defined in the program, and cannot be provided"]),b.location)}else throw"Impossible: all invalid provide clauses should have been filtered out!";},a)};P.prototype.analyzeUses=function(a,c){return a};h.prototype.analyzeUses=function(a){a.env.extend(this.expr instanceof G?z(this.name.val,!1,this.expr.args.length,!1,this.location):new l(this.name.val,!1,[],this.name.location));return this.expr.analyzeUses(a,
a.env)};L.prototype.analyzeUses=function(a){this.names.forEach(function(c){a.env.extend(new l(c.val,!1,[],c.location))});return this.expr.analyzeUses(a,a.env)};r.prototype.analyzeUses=function(a){a.env=a.env.extend(z(this.name.val,!1,this.args.length,!1,this.name.location));return U(this,a)};G.prototype.analyzeUses=function(a,c){return U(this,a)};O.prototype.analyzeUses=function(a,c){return this.exprs.reduce(function(a,b){return b.analyzeUses(a,c)},a)};Q.prototype.analyzeUses=function(a,c){a=this.defs.reduce(function(a,
b){return b.analyzeUses(a,c)},a);return this.body.analyzeUses(a,a.env)};A.prototype.analyzeUses=function(a,c){return[this.func].concat(this.args).reduce(function(f,b){return b instanceof Array?b.reduce(function(a,b){return b.analyzeUses(a,a.env)},a):b.analyzeUses(f,c)},a)};I.prototype.analyzeUses=function(a,c){return[this.predicate,this.consequence,this.alternative].reduce(function(a,b){return b.analyzeUses(a,c)},a)};t.prototype.analyzeUses=function(a,c){(-1<plt.compiler.keywords.indexOf(this.val)&&
(!this.parent||this.parent[0]!==this)||this.parent instanceof v)&&q(new types.Message([new types.ColoredPart(this.val,this.location),": expected an open parenthesis before ",this.val,", but found none"]),this.location);return(c=c.lookup_context(this.val))?(this.bindingLoc=c.loc,a.accumulateBindingUse(c,a)):a.accumulateFreeVariableUse(this.val,a)};plt.compiler.desugar=function(a,c,f){var b=(new Date).getTime();try{var d=k(a,c,!0),e=d[0]}catch(p){throw console.log("DESUGARING ERROR"),p;}a=(new Date).getTime();
f&&(console.log("Desugared in "+Math.floor(a-b)+"ms"),console.log(e),console.log(e.toString()));return d};plt.compiler.analyze=function(a,c){var f=(new Date).getTime();try{var b=K(a,plt.compiler.getBasePinfo("base"))}catch(u){throw console.log("ANALYSIS ERROR"),u;}a=(new Date).getTime();c&&console.log("Analyzed in "+Math.floor(a-f)+"ms");return b};plt.compiler.provideBindingId=F;plt.compiler.provideBindingStructId=function(a){this.symbl=a}})();plt.compiler.compile={};
plt.compiler.localStackReference={};plt.compiler.globalStackReference={};plt.compiler.unboundStackReference={};window.plt=window.plt||{};plt.compiler=plt.compiler||{};
(function(){function a(){}function c(a,b,c){this.name=a;this.isBoxed=b;this.depth=c}function d(a,b,c){this.name=a;this.pos=c;this.depth=b}function k(a){this.name=a}function n(a){return types.isString(a)&&void 0!==a.chars?'"'+a.toString()+'"':a.toBytecode?a.toBytecode():a}function z(a){a=a.toString().replace(/\|/g,"");for(var b="",c="{}[],'` \\\"".split(""),f=0;f<a.length;f++)b+=(-1<c.indexOf(a.charAt(f))?"\\":"")+a.charAt(f);return b=b.replace(/\n/g,"\\n")}function F(a){e.call(this);this.name=a;this.toBytecode=
function(){return'{"$":"global-bucket","value":"'+z(this.name)+'"}'}}function U(a,b,c,d){e.call(this);this.$="module-variable";this.modidx=a;this.sym=b;this.pos=c;this.phase=d;this.toBytecode=function(){return'{"$":"module-variable","sym":'+this.sym.toBytecode()+',"modidx":'+this.modidx.toBytecode()+',"pos":'+this.pos+',"phase":'+this.phase+"}"}}function K(a,b,c){e.call(this);this.numLifts=a;this.topLevels=b;this.stxs=c;this.toBytecode=function(){return'{"$":"prefix","num-lifts":'+this.numLifts+',"toplevels":['+
this.topLevels.map(function(a){return n(a)}).join(",")+'],"stxs":['+this.stxs.map(n)+"]}"}}function J(a,b,c){e.call(this);this.maxLetDepth=a;this.prefix=b;this.code=c;this.toBytecode=function(){return'{"$":"compilation-top","max-let-depth":'+this.maxLetDepth+',"prefix":'+this.prefix.toBytecode()+',"compiled-indirects":[],"code":'+this.code.toBytecode()+"}"}}function t(a,b,c,d,g){e.call(this);this.depth=a;this.pos=b;this.constant=c;this.ready=d;this.loc=g;this.toBytecode=function(){return'{"$":"toplevel","depth":'+
this.depth.toString()+',"pos":'+this.pos.toString()+',"const?":'+this.constant+',"ready?":'+this.ready+',"loc":'+(this.loc&&this.loc.toVector().toBytecode())+"}"}}function P(a){e.call(this);this.forms=a;this.toBytecode=function(){return'{"$":"seq","forms":['+this.forms.map(n).join(",")+"]}"}}function v(a,b){e.call(this);this.ids=a;this.rhs=b;this.toBytecode=function(){return'{"$":"def-values","ids":['+this.ids.map(n).join(",")+'],"body":'+this.rhs.toBytecode()+"}"}}function I(a,b,c,d,g,h,k,l,q,r){e.call(this);
this.name=a;this.flags=c;this.numParams=d;this.paramTypes=g;this.rest=h;this.body=r;this.closureMap=k;this.maxLetDepth=q;this.closureTypes=l;this.operatorAndRandLocs=b;this.toBytecode=function(){return'{"$":"lam","name":'+this.name.toBytecode()+',"locs":['+this.operatorAndRandLocs.map(n).join(",")+'],"flags":['+this.flags.map(n).join(",")+'],"num-params":'+this.numParams+',"param-types":['+this.paramTypes.map(n).join(",")+'],"rest?":'+this.rest+',"closure-map":['+this.closureMap.map(n).join(",")+
'],"closure-types":['+this.closureTypes.map(n).join(",")+'],"max-let-depth":'+this.maxLetDepth+',"body":'+this.body.toBytecode()+"}"}}function O(a,b,c){e.call(this);this.count=a;this.boxes=b;this.body=c;this.toBytecode=function(){return'{"$":"let-void","count":'+n(this.count)+',"boxes?":'+n(this.boxes)+',"body":'+this.body.toBytecode()+"}"}}function M(a,b,c,d,g){e.call(this);this.count=a;this.pos=b;this.boxes=c;this.rhs=d;this.body=g;this.toBytecode=function(){return'{"$":"install-value","count":'+
n(this.count)+',"pos":'+n(this.pos)+',"boxes?":'+n(this.boxes)+',"rhs":'+this.rhs.toBytecode()+',"body":'+this.body.toBytecode()+"}"}}function R(a,b,c,d,g){e.call(this);this.unbox=a||!1;this.pos=b;this.clear=c;this.flonum=g;this.otherClears=d;this.toBytecode=function(){return'{"$":"localref","unbox?":'+this.unbox+',"pos":'+this.pos+',"clear":'+this.clear+',"other-clears?":'+this.otherClears+',"flonum?":'+this.flonum+"}"}}function N(a,b){e.call(this);this.rator=a;this.rands=b;this.toBytecode=function(){return'{"$":"application","rator":'+
this.rator.toBytecode()+',"rands":['+this.rands.map(n).join(",")+"]}"}}function Q(a,b,c){e.call(this);this.testExpr=a;this.thenExpr=b;this.elseExpr=c;this.toBytecode=function(){return'{"$":"branch","test":'+this.testExpr.toBytecode()+',"then":'+this.thenExpr.toBytecode()+',"else":'+this.elseExpr.toBytecode()+"}"}}function y(a,b,c){e.call(this);this.$="with-cont-mark";this.key=a;this.val=b;this.body=c;this.toBytecode=function(){return'{"$":"with-cont-mark","key":'+(new C(new H(this.key))).toBytecode()+
',"val":'+(new C(this.val)).toBytecode()+',"body":'+this.body.toBytecode()+"}"}}function S(a,b){e.call(this);this.$="req";this.reqs=a;this.dummy=b;this.toBytecode=function(){return'{"$":"req","reqs":'+(this.reqs instanceof C?'"'+this.reqs.val+'"':this.reqs.toBytecode())+',"dummy":'+this.dummy.toBytecode()+"}"}}function T(a,b){this.path=a;this.base=b;e.call(this);this.toBytecode=function(){return'{"$":"module-path","path":'+n(this.path)+',"base":'+n(this.base)+"}"}}function W(a,b,c){function f(a){return 1>=
a.length?a:c(a[0],a[1])?f(a.slice(1)):[a[0]].concat(f(a.slice(1)))}return f(a.sort(function(a,c){return b(a,c)?-1:b(c,a)}))}function G(a,b){var c=a[0],f=a[1];a=a[2];f=b.compile(a,f);b=f[0];f=f[1];return[[b].concat(c),f,a]}function B(a,b){var c=function(a){var b=a.modules.reduce(function(a,b){return a.concat(b.bindings)},[]),c=a.usedBindingsHash.values().filter(function(a){return a.moduleSource&&-1===b.indexOf(a)});c=b.concat(c);a=a.freeVariables.concat(a.definedNames.keys());var f=W(a,function(a,
b){return a<b},function(a,b){return a==b});a=[!1].concat(f.map(function(a){return new F(a)}),c.map(function(a){var b=a.imported?!1:new T(!1,!1);b=new T(a.moduleSource,b);return new U(b,new H(a.name),-1,0)}));c=[!1].concat(f,c.map(function(a){return a.name}));return[new K(0,a,[]),new plt.compiler.globalEnv(c,!1,new plt.compiler.emptyEnv)]}(b),f=c[0];c=c[1];var d=a.filter(plt.compiler.isDefinition),e=a.filter(function(a){return a instanceof ea}),g=a.filter(plt.compiler.isExpression);b=e.reduceRight(G,
[[],b,c]);a=b[0];b=b[1];b=d.reduceRight(G,[[],b,c]);d=b[0];b=b[1];b=g.reduceRight(G,[[],b,c]);c=b[0];b=b[1];c=new P([].concat(a,d,c));return{bytecode:"/* runtime-version: local-compiler-summer2014 */\n"+(new J(0,f,c)).toBytecode(),permissions:b.permissions(),provides:b.providedNames.keys()}}var C=plt.compiler.literal,H=plt.compiler.symbolExpr,X=plt.compiler.Program,A=plt.compiler.ifExpr,Y=plt.compiler.beginExpr,r=plt.compiler.localExpr,h=plt.compiler.andExpr,L=plt.compiler.orExpr,V=plt.compiler.lambdaExpr,
E=plt.compiler.quotedExpr,aa=plt.compiler.callExpr,D=plt.compiler.defFunc,q=plt.compiler.defVar,w=plt.compiler.defVars,l=plt.compiler.defStruct,ea=plt.compiler.requireExpr,da=plt.compiler.provideStatement,g=function(a){var b=function(){};b.prototype=a;return new b};C.prototype.toBytecode=function(){return'{"$":"constant","value":'+(this.val.toBytecode?this.val.toBytecode():!0===this.val?"true":!1===this.val?"false":this.toString())+"}"};H.prototype.toBytecode=function(){return'types.symbol("'+z(this.val)+
'")'};Vector.prototype.toBytecode=function(){return"types.vector(["+this.elts.join(",")+"])"};Array.prototype.toBytecode=function(a){return"types."+(0===this.length?"EMPTY":"list(["+this.map(n).join(",")+"])")};jsnums.Rational.prototype.toBytecode=function(){return"types.rational("+n(this.n)+", "+n(this.d)+")"};jsnums.BigInteger.prototype.toBytecode=function(){return'types.bignum("'+this.toString()+'")'};jsnums.FloatPoint.prototype.toBytecode=function(){var a=this.toString();"+nan.0"===a&&(a="NaN");
"+inf.0"===a&&(a="Infinity");"-inf.0"===a&&(a="-Infinity");return'types["float"]('+a+")"};jsnums.Complex.prototype.toBytecode=function(){return"types.complex("+n(this.r)+", "+n(this.i)+")"};Char.prototype.toBytecode=function(){return"types['char'](String.fromCharCode("+this.val.charCodeAt(0)+"))"};c.prototype=g(a.prototype);d.prototype=g(a.prototype);k.prototype=g(a.prototype);var e=function(){this.toBytecode=function(){console.log(this);throw"IMPOSSIBLE - generic bytecode toBytecode method was called";
}};F.prototype=g(e.prototype);U.prototype=g(e.prototype);(function(){e.call(this)}).prototype=g(e.prototype);(function(a,b,c){e.call(this);this.datum=a;this.wraps=b;this.certs=c}).prototype=g(e.prototype);(function(a){this.encoded=a;e.call(this)}).prototype=g(e.prototype);K.prototype=g(e.prototype);(function(){e.call(this)}).prototype=g(e.prototype);(function(a){e.call(this)}).prototype=g(e.prototype);(function(a){e.call(this);this.v=a;this.toBytecode=function(){return'{"$":"indirect","v":'+this.v.toBytecode()+
"}"}}).prototype=g(e.prototype);J.prototype=g(e.prototype);(function(a,b,c,d,g,h,k){e.call(this);this.name=a;this.src=b;this.srcName=c;this.nomSrc=d;this.srcPhase=g;this.insp=k;this.isProtected=h}).prototype=g(e.prototype);t.prototype=g(e.prototype);P.prototype=g(e.prototype);v.prototype=g(e.prototype);(function(a,b,c,d){e.call(this);this.$="def-values";this.ids=a;this.rhs=b;this.prefix=c;this.maxLetDepth=d;this.toBytecode=function(){return'{"$":"def-values","ids":['+this.ids.toBytecode().join(",")+
'],"rhs":'+this.rhs.toBytecode()+',"prefix":'+this.prefix.toBytecode()+',"max-let-depth":'+this.maxLetDepth.toBytecode()+"}"}}).prototype=g(e.prototype);(function(a,b,c,d){e.call(this);this.ids=a;this.rhs=b;this.prefix=c;this.maxLetDepth=d}).prototype=g(e.prototype);(function(a,b,c,d,g,h,k,l,n,q,r,t){e.call(this);this.name=a;this.selfModidx=b;this.prefix=c;this.provides=d;this.requires=g;this.body=h;this.syntaxBody=k;this.unexported=l;this.maxLetDepth=n;this.dummy=q;this.langInfo=r;this.internalContext=
t;this.toBytecode=function(){return'{"$":"mod","name":'+this.name.toBytecode()+',"self-modidx":'+this.selfModidx.toBytecode()+',"prefix":'+this.prefix.toBytecode()+',"provides":'+this.provides.toBytecode()+',"requires":'+(this.requires&&this.requires.toVector().toBytecode())+',"body":'+this.body.toBytecode()+',"stx-body":'+this.syntaxBody.toBytecode()+',"max-let-depth":'+this.maxLetDepth.toBytecode()+"}"}}).prototype=g(e.prototype);I.prototype=g(e.prototype);(function(a,b){e.call(this);this.code=
a;this.genId=b;this.toBytecode=function(){return'{"$":"closure","code":'+this.code.toBytecode()+',"gen-id":'+this.genId.toBytecode()+"}"}}).prototype=g(e.prototype);(function(a,b){e.call(this);this.name=a;this.clauses=b;this.toBytecode=function(){return'{"$":"case-lam","name":'+this.name.toBytecode()+',"clauses":'+this.clauses.toBytecode()+"}"}}).prototype=g(e.prototype);(function(a,b,c){e.call(this);this.rhs=a;this.body=b;this.flonum=c;this.toBytecode=function(){return'{"$": "let-one","rhs":'+this.rhs.toBytecode()+
',"body":'+this.body.toBytecode()+',"flonum":'+this.flonum.toBytecode()+"}"}}).prototype=g(e.prototype);O.prototype=g(e.prototype);(function(a,b){e.call(this);this.procs=a;this.body=b;this.toBytecode=function(){return'{"$":"let-rec","procs":'+this.procs.toBytecode()+',"body":'+this.body.toBytecode()+"}"}}).prototype=g(e.prototype);M.prototype=g(e.prototype);(function(a,b){e.call(this);this.pos=a;this.body=b;this.toBytecode=function(){return'{"$":"boxenv","pos":'+this.pos.toBytecode()+',"body":'+this.body.toBytecode()+
"}"}}).prototype=g(e.prototype);R.prototype=g(e.prototype);(function(a,b,c){e.call(this);this.depth=a;this.pos=b;this.midpt=c}).prototype=g(e.prototype);N.prototype=g(e.prototype);Q.prototype=g(e.prototype);y.prototype=g(e.prototype);(function(a){e.call(this);this.seq=a;this.toBytecode=function(){return'{"$":"beg0","seq":'+this.seq.toBytecode()+"}"}}).prototype=g(e.prototype);(function(a){e.call(this);this.forms=a;this.toBytecode=function(){return'{"$":"splice","forms":'+this.forms.toBytecode()+"}"}}).prototype=
g(e.prototype);(function(a){e.call(this);this.topLevel=a;this.toBytecode=function(){return'{"$":"varref","top-level":'+this.topLevel.toBytecode()+"}"}}).prototype=g(e.prototype);(function(a,b,c){e.call(this);this.id=a;this.rhs=b;this.undefOk=c;this.toBytecode=function(){return'{"$":"assign","id":'+this.id.toBytecode()+',"rhs":'+this.rhs.toBytecode()+',"undef-ok":'+this.undefOk.toBytecode()+"}"}}).prototype=g(e.prototype);(function(a,b){e.call(this);this.proc=a;this.args=b;this.toBytecode=function(){return'{"$":"apply-values","proc":'+
this.proc.toBytecode()+',"args":'+this.args.toBytecode()+"}"}}).prototype=g(e.prototype);(function(a){e.call(this);this.id=a;this.toBytecode=function(){return'{"$":"primval","id":'+this.id.toBytecode()+"}"}}).prototype=g(e.prototype);S.prototype=g(e.prototype);(function(a,b,c){this.bool1=a;this.bool2=b;this.alist=c;e.call(this)}).prototype=g(e.prototype);(function(a,b,c){this.amt=a;this.src=b;this.dest=c;e.call(this)}).prototype=g(e.prototype);(function(a){this.val=a;e.call(this)}).prototype=g(e.prototype);
(function(a){this.sym=a;e.call(this)}).prototype=g(e.prototype);(function(a,b,c,d,g){this.path=a;this.phase=b;this.srcPhase=c;this.prefix=g;this.exceptions=d;e.call(this)}).prototype=g(e.prototype);(function(){e.call(this)}).prototype=g(e.prototype);(function(a){this.value=a;e.call(this)}).prototype=g(e.prototype);(function(a,b,c,d,g){this.path=a;this.phase=b;this.exportName=d;this.nominalExportName=g;e.call(this)}).prototype=g(e.prototype);(function(a,b,c,d){this.path=a;this.exportName=b;this.nominalPath=
c;this.nominalExportName=d;e.call(this)}).prototype=g(e.prototype);(function(a,b){this.path=a;this.nominalPath=b;e.call(this)}).prototype=g(e.prototype);(function(a,b){this.path=a;this.exportName=b;e.call(this)}).prototype=g(e.prototype);(function(a){this.path=a;e.call(this)}).prototype=g(e.prototype);(function(a,b,c,d,g,h,k){this.phase=a;this.kind=b;this.unmarshals=d;this.renames=g;this.markRenames=h;this.plusKern=k;e.call(this)}).prototype=g(e.prototype);T.prototype=g(e.prototype);X.prototype.freeVariables=
function(a,b){return a};A.prototype.freeVariables=function(a,b){return this.alternative.freeVariables(this.consequence.freeVariables(this.predicate.freeVariables(a,b),b),b)};Y.prototype.freeVariables=function(a,b){return this.exprs.reduceRight(function(a,c){return c.freeVariables(a,b)},a)};H.prototype.freeVariables=function(a,b){return b.lookup(this.val,0)instanceof k&&-1==a.indexOf(this)?a.concat([this]):a};r.prototype.freeVariables=function(a,b){var c=this.defs.reduce(function(a,b){return(b instanceof
w?b.names:[b.name]).concat(a)},[]).reduce(function(a,b){return new plt.compiler.localEnv(b.val,!0,a)},b);a=this.body.freeVariables(a,c);return this.defs.reduce(function(a,b){if(b instanceof D){var d=b.args.reduce(function(a,b){return new plt.compiler.localEnv(b.val,!1,a)},c);return b.body.freeVariables(a,d)}return b instanceof l?a:b.expr.freeVariables(a,c)},a)};h.prototype.freeVariables=function(a,b){return this.exprs.reduceRight(function(a,c){return c.freeVariables(a,b)},a)};L.prototype.freeVariables=
function(a,b){return this.exprs.reduceRight(function(a,c){return c.freeVariables(a,b)},a)};V.prototype.freeVariables=function(a,b){b=this.args.slice(0).reverse().reduce(function(a,b){return new plt.compiler.localEnv(b.val,!1,a)},b);return this.body.freeVariables(a,b)};E.prototype.freeVariables=function(a,b){return a};aa.prototype.freeVariables=function(a,b){return this.func.freeVariables(a,b).concat(this.args).reduceRight(function(a,c){return c.freeVariables(a,b)},a)};X.prototype.compile=function(a,
b){return[this,b]};D.prototype.compile=function(a,b){b=this.name.compile(a,b);var c=b[0];b=b[1];b=(new V(this.args,this.body)).compile(a,b,!1,this.name);a=b[0];b=b[1];return[new v([c],a),b]};q.prototype.compile=function(a,b){b=this.name.compile(a,b);var c=b[0];b=b[1];b=this.expr.compile(a,b);a=b[0];b=b[1];return[new v([c],a),b]};w.prototype.compile=function(a,b){b=this.names.reduceRight(G,[[],b,a]);var c=b[0];b=b[1];b=this.expr.compile(a,b);a=b[0];b=b[1];return[new v(c,a),b]};Y.prototype.compile=
function(a,b){a=this.exprs.reduceRight(G,[[],b,a]);b=a[1];return[new P(a[0]),b]};V.prototype.compile=function(a,b,e,g){function f(a,b){return a.map(function(a){return-1<b.indexOf(a)?a:!1})}function h(a,b){return new plt.compiler.localEnv(b,!1,a)}void 0===e&&(e=!0);var l=this.args.map(function(a){return a.val}).reduce(h,new plt.compiler.emptyEnv);freeVarsInBody=this.body.freeVariables([],l);l=function(a,b,e){var g=b.map(function(a){return e.lookup(a.val,0)}),l=function(a,b){return 0===b.length?!1:
a(b[0])?b[0]:l(a,b.slice(1))},p=function(a){return a.depth};if(b=l(function(a){return a instanceof k},g))throw"Can't produce closure; I don't know where "+b.name+" is bound.";var m=W(g.filter(function(a){return a instanceof c}),function(a,b){return a.depth<b.depth},function(a,b){return a.depth===b.depth});b=m.map(p);var n=g.filter(function(a){return a instanceof d});g=W(n.map(p),function(a,b){return a<b},function(a,b){return a===b});a=a.reverse().map(function(a){return a.val}).reduce(h,e);a=m.reverse().reduce(function(a,
b){return b.isBoxed?new plt.compiler.localEnv(b.name,!0,a):h(a,b.name)},a);a=g.reverse().reduce(function(a,b){var c=n.filter(function(a){return a.depth===b}).map(function(a){return a.name});c=f(e.peek(b).names,c);return new plt.compiler.globalEnv(c,!1,a)},a);return[g.concat(b),a]}(this.args.slice(0),freeVarsInBody,a);a=l[0];l=this.body.compile(l[1],b);b=l[0];l=l[1];return[new I(e?[]:new H(g),[e?this.stx:g].concat(this.args).map(function(a){return a.location.toVector()}),[],this.args.length,this.args.map(function(){return new H("val")}),
!1,a,a.map(function(){return new H("val/ref")}),0,b),l]};r.prototype.compile=function(a,b){function c(a,b,e,g){if(0===a.length)return d.body.compile(f,b);var h=a[0].compile(e,b),k=h[0].rhs;b=h[1];h=a[0]instanceof w?a[0].names.length:1;a=c(a.slice(1),b,e,g+h);newBody=a[0];b=a[1];return[new M(h,g,!0,k,newBody),b]}if(0===this.defs.length)return this.body.compile(a,b);var d=this,e=this.defs.reduce(function(a,b){return a.concat(b instanceof w?b.names:b.name)},[]),f=e.reverse().reduce(function(a,b){return new plt.compiler.localEnv(b.val,
!0,a)},a);b=c(this.defs,b,f,0);a=b[0];b=b[1];return[new O(e.length,!0,a),b]};aa.prototype.compile=function(a,b){var c=this.args.reduce(function(a,b){return new plt.compiler.unnamedEnv(a)},a),d=this.func.compile(c,b);a=d[0];c=this.args.reduceRight(G,[[],b,c])[0];b=d[1];a=new N(a,c);d=[this.func.location].concat(this.args.map(function(a){return a.location})).concat(this.location).map(function(a){return a.toVector()});return[new y(new H("moby-application-position-key"),d,new y(new H("moby-stack-record-continuation-mark-key"),
this.location.toVector(),a)),b]};A.prototype.compile=function(a,b){var c=this.predicate.compile(a,b)[0],d=this.consequence.compile(a,b)[0];a=this.alternative.compile(a,b);b=a[1];return[new Q(c,d,a[0]),b]};H.prototype.compile=function(a,b){a=a.lookup(this.val,0);if(a instanceof c)a=new R(a.isBoxed,a.depth,!1,!1,!1);else if(a instanceof d)a=new t(a.depth,a.pos,!1,!1,this.location);else{if(a instanceof k)throw"Couldn't find '"+this.val+"' in the environment";throw"IMPOSSIBLE: env.lookup failed for '"+
this.val+"'! A reference should be added to the environment!";}return[a,b]};E.prototype.compile=function(a,b){function c(a){return a instanceof C?c(a.val):a instanceof Array?a.map(c):a}result=new C(c(this.val));return[result,b]};da.prototype.compile=function(a,b){};ea.prototype.compile=function(a,b){return[new S(this.spec,new t(0,0,!1,!1,!1)),b]};plt.compiler.localStackReference=c;plt.compiler.globalStackReference=d;plt.compiler.unboundStackReference=k;plt.compiler.compile=function(a,b,c){var d=(new Date).getTime();
try{var e=B(a,b)}catch(Z){throw console.log("COMPILATION ERROR"),Z;}a=(new Date).getTime();c&&(console.log("Compiled in "+Math.floor(a-d)+"ms"),console.log(JSON.stringify(e)));return e}})();
