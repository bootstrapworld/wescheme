var sys={print:function(W){W=W.toString().replace(RegExp("\n","g"),"<br />");document.write(W)},error:function(W){"undefined"!==typeof console&&console.log?W.stack?console.log(W.stack):console.log("Error: "+str):(W=W.toString().replace(RegExp("\n","g"),"<br />"),document.write("<br />Error: "+W+"<br />"))},inspect:function(W){return W+""}},DEBUG_ON=!1,setDebug=function(W){DEBUG_ON=W},debug=function(W){DEBUG_ON&&sys.print(W)},debugF=function(W){DEBUG_ON&&sys.print(W())},hasOwnProperty={}.hasOwnProperty,
deepEqual=function(W,fa){if(W===fa)return!0;var ja;if(W instanceof Array){if(fa instanceof Array){for(ja=0;ja<W.length;ja++)if(!deepEqual(W[ja],fa[ja]))return!1;return!0}return!1}if("string"===typeof W||"number"===typeof W)return W===fa;for(ja in W)if(hasOwnProperty.call(W,ja)&&"_eqHashCode"!==ja&&"_isList"!==ja&&(!hasOwnProperty.call(fa,ja)||!deepEqual(W[ja],fa[ja])))return!1;for(ja in fa)if(hasOwnProperty.call(fa,ja)&&"_eqHashCode"!==ja&&"_isList"!==ja&&(!hasOwnProperty.call(W,ja)||!deepEqual(W[ja],
fa[ja])))return!1;return!0},assert={equal:function(W,fa){if(W!==fa)throw Error("AssertError: "+W+" equal "+fa);},deepEqual:function(W,fa){if(!deepEqual(W,fa))throw Error("AssertError: "+W+" deepEqual "+fa);},ok:function(W){if(!W)throw Error("AssertError: not ok: "+W);},throwsExn:function(W){try{W.apply(null,[])}catch(fa){return}throw Error("AssertError: Throw expected, none received.");}};this.JSON||(this.JSON={});
(function(){function W(u){return 10>u?"0"+u:u}function fa(u){m.lastIndex=0;return m.test(u)?'"'+u.replace(m,function(G){var F=na[G];return"string"===typeof F?F:"\\u"+("0000"+G.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+u+'"'}function ja(u,G){var F=C,E=G[u];E&&"object"===typeof E&&"function"===typeof E.toJSON&&(E=E.toJSON(u));"function"===typeof v&&(E=v.call(G,u,E));switch(typeof E){case "string":return fa(E);case "number":return isFinite(E)?String(E):"null";case "boolean":case "null":return String(E);
case "object":if(!E)return"null";C+=da;var O=[];if("[object Array]"===Object.prototype.toString.apply(E)){var P=E.length;for(u=0;u<P;u+=1)O[u]=ja(u,E)||"null";G=0===O.length?"[]":C?"[\n"+C+O.join(",\n"+C)+"\n"+F+"]":"["+O.join(",")+"]";C=F;return G}if(v&&"object"===typeof v)for(P=v.length,u=0;u<P;u+=1){var X=v[u];"string"===typeof X&&(G=ja(X,E))&&O.push(fa(X)+(C?": ":":")+G)}else for(X in E)Object.hasOwnProperty.call(E,X)&&(G=ja(X,E))&&O.push(fa(X)+(C?": ":":")+G);G=0===O.length?"{}":C?"{\n"+C+O.join(",\n"+
C)+"\n"+F+"}":"{"+O.join(",")+"}";C=F;return G}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(u){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+W(this.getUTCMonth()+1)+"-"+W(this.getUTCDate())+"T"+W(this.getUTCHours())+":"+W(this.getUTCMinutes())+":"+W(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(u){return this.valueOf()});var q=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
m=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,C,da,na={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},v;"function"!==typeof JSON.stringify&&(JSON.stringify=function(u,G,F){var E;da=C="";if("number"===typeof F)for(E=0;E<F;E+=1)da+=" ";else"string"===typeof F&&(da=F);if((v=G)&&"function"!==typeof G&&("object"!==typeof G||"number"!==typeof G.length))throw Error("JSON.stringify");return ja("",
{"":u})});"function"!==typeof JSON.parse&&(JSON.parse=function(u,G){function F(E,O){var P,X=E[O];if(X&&"object"===typeof X)for(P in X)if(Object.hasOwnProperty.call(X,P)){var ia=F(X,P);void 0!==ia?X[P]=ia:delete X[P]}return G.call(E,O,X)}u=String(u);q.lastIndex=0;q.test(u)&&(u=u.replace(q,function(E){return"\\u"+("0000"+E.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(u.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return u=eval("("+u+")"),"function"===typeof G?F({"":u},""):u;throw new SyntaxError("JSON.parse");})})();var helpers={};
(function(){var W=function(v){throw types.schemeError(v);},fa=function(v,u,G,F){v=state.captureCurrentContinuationMarks(v).ref("moby-application-position-key");var E=v[v.length-1],O=function(ia){var Ba=[],ma,wa=[];for(ma=0;ma<F.length;ma++)state.isState(F[ma])||void 0!==F[ma].name&&""===F[ma].name||wa.push(F[ma]);window.wtf=F[2];for(ma=0;ma<wa.length;ma++)ia.isEmpty()||(ma!=G-1&&Ba.push(new types.ColoredPart(types.toWrittenString(wa[ma])+" ",ia.first())),ia=ia.rest());0<Ba.length&&(ia=Ba[Ba.length-
1].text,ia=ia.substring(0,ia.length-1),Ba[Ba.length-1]=new types.ColoredPart(ia,Ba[Ba.length-1].location));return Ba};v=function(ia){var Ba=E,ma;for(ma=0;ma<ia;ma++)Ba=Ba.rest();return Ba.first()};var P=u.typeName+"",X=P.substring(0,1);F&&(O=O(E.rest()),0<O.length&&W(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart(u.functionName,E.first()),": expects ","a"===X||"e"===X||"i"===X||"o"===X||"u"===X?"an ":"a ",P," as ",u.ordinalPosition," argument, but given: ",new types.ColoredPart(types.toWrittenString(u.actualValue),
v(G)),"; other arguments were: ",new types.GradientPart(O)]),[])));W(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart(u.functionName,E.first()),": expects ","a"===X||"e"===X||"i"===X||"o"===X||"u"===X?"an ":"a ",P," as ",u.ordinalPosition," argument, but given: ",new types.ColoredPart(types.toWrittenString(u.actualValue),v(G))]),[]))},ja=function(v,u,G,F){if(v instanceof state.State){var E=state.captureCurrentContinuationMarks(v).ref("moby-application-position-key");
void 0!==E[E.length-1]&&fa(v,u,G,F)}if(F&&1<F.length){v=["~a: expects type ~a as ~a arguments, but given: ~s; other arguments were:"];for(E=0;E<F.length;E++)E!=G-1&&v.push(types.toWrittenString(F[E]));G=v.join(" ");W(types.incompleteExn(types.exnFailContract,helpers.format(G,[u.functionName,u.typeName,u.ordinalPosition,u.actualValue]),[]))}else W(types.incompleteExn(types.exnFailContract,helpers.format("~a: expects argument of type ~a, but given: ~s",[u.functionName,u.typeName,u.actualValue]),[]))},
q=function(v,u,G,F,E,O,P){G(u)||ja(v,{functionName:F,typeName:E,ordinalPosition:helpers.ordinalize(O),actualValue:u},O,P)},m=function(v){var u;v=u=v;if(u===types.EMPTY)return!0;for(;;){if(!types.isPair(u))return!1;if(types.isPair(v)){if(!0===v._isList)return!0;v=v.rest()}u=u.rest();if(types.isPair(u)){if(u._isList)return v._isList=!0;u=u.rest();if(types.isPair(u)&&u._isList)return v._isList=!0}if(u===types.EMPTY)return v._isList=!0;if(v===u)return!1}},C=function(v,u){if(!m(v))return!1;for(;types.isPair(v);){if(!u(v.first()))return!1;
v=v.rest()}return v===types.EMPTY},da=function(v){var u=v;if(u===types.EMPTY)return[];if(types.isPair(u)){for(v=[];!u.isEmpty();)v.push(da(u.first())),u=u.rest();return v}return v},na=function(v){if(!m(v))return[v];for(var u=[];!v.isEmpty();)u=u.concat(na(v.first())),v=v.rest();return u};helpers.format=function(v,u,G){var F=function(){G=G||"#<function>";var P=v.match(RegExp("~[sSaA]","g"));P=[G+": format string requires "+(null==P?0:P.length)+" arguments, but given "+u.length+"; arguments were:",
types.toWrittenString(v)];for(var X=0;X<u.length;X++)P.push(types.toWrittenString(u[X]));W(types.incompleteExn(types.exnFailContract,P.join(" "),[]))},E=RegExp("~[sSaAn%~]","g"),O=u.slice(0);E=v.replace(E,function(P){if("~~"==P)return"~";if("~n"==P||"~%"==P)return"\n";if("~s"==P||"~S"==P)return 0==O.length&&F(),types.toWrittenString(O.shift());if("~a"==P||"~A"==P)return 0==O.length&&F(),types.toDisplayedString(O.shift());throw types.internalError("format: string.replace matched invalid regexp",!1);
});0<O.length&&F();return E};helpers.forEachK=function(v,u,G,F){var E=function(O){if(O>=v.length)F&&F();else try{u(v[O],function(){E(O+1)})}catch(P){G(P)}};E(0)};helpers.reportError=function(v){var u="undefined"!=typeof console&&"undefined"!=typeof console.log?function(G){console.log(G)}:function(G){alert(G)};"string"==typeof v?u(v):types.isSchemeError(v)?types.isExn(v.val)?u(""+types.exnMessage(v.val)):u(v.val):v.message?u(v.message):u(v.toString())};helpers.raise=W;helpers.procArityContains=function(v){return function(u){var G=
function(E){return E instanceof types.ContinuationClosureValue?!0:E.numParams==v||E.isRest&&E.numParams<=v},F=[];if(u instanceof types.ContinuationClosureValue||u instanceof types.ClosureValue||u instanceof types.PrimProc)return G(u);u instanceof types.CasePrimitive?F=u.cases:u instanceof types.CaseLambdaValue&&(F=u.closures);for(u=0;u<F.length;u++)if(G(F[u]))return!0;return!1}};helpers.throwCheckError=ja;helpers.isList=m;helpers.isListOf=C;helpers.check=q;helpers.checkVarArity=function(v,u,G,F,E,
O,P){if(0<P.length&&P[P.length-1]instanceof Array){var X=[],ia;for(ia=0;ia<P.length-1;ia++)X.push(P[ia]);P=X.concat(P[P.length-1]);q(v,u,G,F,E,O,P)}else q(v,u,G,F,E,O,P)};helpers.checkListOf=function(v,u,G,F,E,O,P){C(u,G)||helpers.throwCheckError(v,{functionName:F,typeName:"list of "+E,ordinalPosition:helpers.ordinalize(O),actualValue:u},O,P)};helpers.map=function(v,u){for(var G=Array(u.length),F=0;F<u.length;F++)G[F]=v(u[F]);return G};helpers.schemeListToArray=function(v){for(var u=[];!v.isEmpty();)u.push(v.first()),
v=v.rest();return u};helpers.deepListToArray=da;helpers.flattenSchemeListToArray=na;helpers.assocListToHash=function(v){for(var u={};!v.isEmpty();){var G=v.first().first(),F=v.first().rest().first();u[G]=F;v=v.rest()}return u};helpers.ordinalize=function(v){if(11==v%100)return v+"th";var u=v;switch(v%10){case 1:u+="st";break;case 2:u+="nd";break;case 3:u+="rd";break;default:u+="th"}return u};helpers.wrapJsObject=function(v){return void 0===v?types.jsObject("undefined",v):null===v?types.jsObject("null",
v):"function"==typeof v?types.jsObject("function",v):v instanceof Array?types.jsObject("array",v):"string"==typeof v?types.jsObject("'"+v.toString()+"'",v):types.jsObject(v.toString(),v)};helpers.getKeyCodeName=function(v){v=v.charCode||v.keyCode;switch(v){case 8:v="\b";break;case 16:v="shift";break;case 17:v="control";break;case 19:v="pause";break;case 27:v="escape";break;case 33:v="prior";break;case 34:v="next";break;case 35:v="end";break;case 36:v="home";break;case 37:v="left";break;case 38:v=
"up";break;case 39:v="right";break;case 40:v="down";break;case 42:v="print";break;case 45:v="insert";break;case 46:v=String.fromCharCode(127);break;case 144:v="numlock";break;case 145:v="scroll";break;default:v=112<=v&&123>=v?"f"+(v-111):""}return v};helpers.maybeCallAfterAttach=function(v){for(v=[v];0!==v.length;){var u=v.pop();u.afterAttach&&u.afterAttach(u);if(u.hasChildNodes&&u.hasChildNodes()){u=u.childNodes;for(var G=0;G<u.length;G++)v.push(u[G])}}};helpers.makeLocationDom=function(v){var u=
document.createElement("span"),G=document.createElement("span"),F=document.createElement("span"),E=document.createElement("span"),O=document.createElement("span"),P=document.createElement("span");u.className="location-reference";G.className="location-id";F.className="location-offset";E.className="location-line";O.className="location-column";P.className="location-span";G.appendChild(document.createTextNode(v.id+""));F.appendChild(document.createTextNode(v.offset+""));E.appendChild(document.createTextNode(v.line+
""));O.appendChild(document.createTextNode(v.column+""));P.appendChild(document.createTextNode(v.span+""));u.appendChild(G);u.appendChild(F);u.appendChild(E);u.appendChild(O);u.appendChild(P);return u};helpers.isLocationDom=function(v){return v&&(v.nodeType===Node.TEXT_NODE||v.nodeType===Node.ELEMENT_NODE)&&"location-reference"===v.className}})();this.JSON||(this.JSON={});
(function(){function W(u){return 10>u?"0"+u:u}function fa(u){m.lastIndex=0;return m.test(u)?'"'+u.replace(m,function(G){var F=na[G];return"string"===typeof F?F:"\\u"+("0000"+G.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+u+'"'}function ja(u,G){var F=C,E=G[u];E&&"object"===typeof E&&"function"===typeof E.toJSON&&(E=E.toJSON(u));"function"===typeof v&&(E=v.call(G,u,E));switch(typeof E){case "string":return fa(E);case "number":return isFinite(E)?String(E):"null";case "boolean":case "null":return String(E);
case "object":if(!E)return"null";C+=da;var O=[];if("[object Array]"===Object.prototype.toString.apply(E)){var P=E.length;for(u=0;u<P;u+=1)O[u]=ja(u,E)||"null";G=0===O.length?"[]":C?"[\n"+C+O.join(",\n"+C)+"\n"+F+"]":"["+O.join(",")+"]";C=F;return G}if(v&&"object"===typeof v)for(P=v.length,u=0;u<P;u+=1){var X=v[u];"string"===typeof X&&(G=ja(X,E))&&O.push(fa(X)+(C?": ":":")+G)}else for(X in E)Object.hasOwnProperty.call(E,X)&&(G=ja(X,E))&&O.push(fa(X)+(C?": ":":")+G);G=0===O.length?"{}":C?"{\n"+C+O.join(",\n"+
C)+"\n"+F+"}":"{"+O.join(",")+"}";C=F;return G}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(u){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+W(this.getUTCMonth()+1)+"-"+W(this.getUTCDate())+"T"+W(this.getUTCHours())+":"+W(this.getUTCMinutes())+":"+W(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(u){return this.valueOf()});var q=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
m=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,C,da,na={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},v;"function"!==typeof JSON.stringify&&(JSON.stringify=function(u,G,F){var E;da=C="";if("number"===typeof F)for(E=0;E<F;E+=1)da+=" ";else"string"===typeof F&&(da=F);if((v=G)&&"function"!==typeof G&&("object"!==typeof G||"number"!==typeof G.length))throw Error("JSON.stringify");return ja("",
{"":u})});"function"!==typeof JSON.parse&&(JSON.parse=function(u,G){function F(E,O){var P,X=E[O];if(X&&"object"===typeof X)for(P in X)if(Object.hasOwnProperty.call(X,P)){var ia=F(X,P);void 0!==ia?X[P]=ia:delete X[P]}return G.call(E,O,X)}u=String(u);q.lastIndex=0;q.test(u)&&(u=u.replace(q,function(E){return"\\u"+("0000"+E.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(u.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return u=eval("("+u+")"),"function"===typeof G?F({"":u},""):u;throw new SyntaxError("JSON.parse");})})();helpers={};
(function(){var W=function(v){throw types.schemeError(v);},fa=function(v,u,G,F){v=state.captureCurrentContinuationMarks(v).ref("moby-application-position-key");var E=v[v.length-1],O=function(ia){var Ba=[],ma,wa=[];for(ma=0;ma<F.length;ma++)state.isState(F[ma])||void 0!==F[ma].name&&""===F[ma].name||wa.push(F[ma]);window.wtf=F[2];for(ma=0;ma<wa.length;ma++)ia.isEmpty()||(ma!=G-1&&Ba.push(new types.ColoredPart(types.toWrittenString(wa[ma])+" ",ia.first())),ia=ia.rest());0<Ba.length&&(ia=Ba[Ba.length-
1].text,ia=ia.substring(0,ia.length-1),Ba[Ba.length-1]=new types.ColoredPart(ia,Ba[Ba.length-1].location));return Ba};v=function(ia){var Ba=E,ma;for(ma=0;ma<ia;ma++)Ba=Ba.rest();return Ba.first()};var P=u.typeName+"",X=P.substring(0,1);F&&(O=O(E.rest()),0<O.length&&W(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart(u.functionName,E.first()),": expects ","a"===X||"e"===X||"i"===X||"o"===X||"u"===X?"an ":"a ",P," as ",u.ordinalPosition," argument, but given: ",new types.ColoredPart(types.toWrittenString(u.actualValue),
v(G)),"; other arguments were: ",new types.GradientPart(O)]),[])));W(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart(u.functionName,E.first()),": expects ","a"===X||"e"===X||"i"===X||"o"===X||"u"===X?"an ":"a ",P," as ",u.ordinalPosition," argument, but given: ",new types.ColoredPart(types.toWrittenString(u.actualValue),v(G))]),[]))},ja=function(v,u,G,F){if(v instanceof state.State){var E=state.captureCurrentContinuationMarks(v).ref("moby-application-position-key");
void 0!==E[E.length-1]&&fa(v,u,G,F)}if(F&&1<F.length){v=["~a: expects type ~a as ~a arguments, but given: ~s; other arguments were:"];for(E=0;E<F.length;E++)E!=G-1&&v.push(types.toWrittenString(F[E]));G=v.join(" ");W(types.incompleteExn(types.exnFailContract,helpers.format(G,[u.functionName,u.typeName,u.ordinalPosition,u.actualValue]),[]))}else W(types.incompleteExn(types.exnFailContract,helpers.format("~a: expects argument of type ~a, but given: ~s",[u.functionName,u.typeName,u.actualValue]),[]))},
q=function(v,u,G,F,E,O,P){G(u)||ja(v,{functionName:F,typeName:E,ordinalPosition:helpers.ordinalize(O),actualValue:u},O,P)},m=function(v){var u;v=u=v;if(u===types.EMPTY)return!0;for(;;){if(!types.isPair(u))return!1;if(types.isPair(v)){if(!0===v._isList)return!0;v=v.rest()}u=u.rest();if(types.isPair(u)){if(u._isList)return v._isList=!0;u=u.rest();if(types.isPair(u)&&u._isList)return v._isList=!0}if(u===types.EMPTY)return v._isList=!0;if(v===u)return!1}},C=function(v,u){if(!m(v))return!1;for(;types.isPair(v);){if(!u(v.first()))return!1;
v=v.rest()}return v===types.EMPTY},da=function(v){var u=v;if(u===types.EMPTY)return[];if(types.isPair(u)){for(v=[];!u.isEmpty();)v.push(da(u.first())),u=u.rest();return v}return v},na=function(v){if(!m(v))return[v];for(var u=[];!v.isEmpty();)u=u.concat(na(v.first())),v=v.rest();return u};helpers.format=function(v,u,G){var F=function(){G=G||"#<function>";var P=v.match(RegExp("~[sSaA]","g"));P=[G+": format string requires "+(null==P?0:P.length)+" arguments, but given "+u.length+"; arguments were:",
types.toWrittenString(v)];for(var X=0;X<u.length;X++)P.push(types.toWrittenString(u[X]));W(types.incompleteExn(types.exnFailContract,P.join(" "),[]))},E=RegExp("~[sSaAn%~]","g"),O=u.slice(0);E=v.replace(E,function(P){if("~~"==P)return"~";if("~n"==P||"~%"==P)return"\n";if("~s"==P||"~S"==P)return 0==O.length&&F(),types.toWrittenString(O.shift());if("~a"==P||"~A"==P)return 0==O.length&&F(),types.toDisplayedString(O.shift());throw types.internalError("format: string.replace matched invalid regexp",!1);
});0<O.length&&F();return E};helpers.forEachK=function(v,u,G,F){var E=function(O){if(O>=v.length)F&&F();else try{u(v[O],function(){E(O+1)})}catch(P){G(P)}};E(0)};helpers.reportError=function(v){var u="undefined"!=typeof console&&"undefined"!=typeof console.log?function(G){console.log(G)}:function(G){alert(G)};"string"==typeof v?u(v):types.isSchemeError(v)?types.isExn(v.val)?u(""+types.exnMessage(v.val)):u(v.val):v.message?u(v.message):u(v.toString())};helpers.raise=W;helpers.procArityContains=function(v){return function(u){var G=
function(E){return E instanceof types.ContinuationClosureValue?!0:E.numParams==v||E.isRest&&E.numParams<=v},F=[];if(u instanceof types.ContinuationClosureValue||u instanceof types.ClosureValue||u instanceof types.PrimProc)return G(u);u instanceof types.CasePrimitive?F=u.cases:u instanceof types.CaseLambdaValue&&(F=u.closures);for(u=0;u<F.length;u++)if(G(F[u]))return!0;return!1}};helpers.throwCheckError=ja;helpers.isList=m;helpers.isListOf=C;helpers.check=q;helpers.checkVarArity=function(v,u,G,F,E,
O,P){if(0<P.length&&P[P.length-1]instanceof Array){var X=[],ia;for(ia=0;ia<P.length-1;ia++)X.push(P[ia]);P=X.concat(P[P.length-1]);q(v,u,G,F,E,O,P)}else q(v,u,G,F,E,O,P)};helpers.checkListOf=function(v,u,G,F,E,O,P){C(u,G)||helpers.throwCheckError(v,{functionName:F,typeName:"list of "+E,ordinalPosition:helpers.ordinalize(O),actualValue:u},O,P)};helpers.map=function(v,u){for(var G=Array(u.length),F=0;F<u.length;F++)G[F]=v(u[F]);return G};helpers.schemeListToArray=function(v){for(var u=[];!v.isEmpty();)u.push(v.first()),
v=v.rest();return u};helpers.deepListToArray=da;helpers.flattenSchemeListToArray=na;helpers.assocListToHash=function(v){for(var u={};!v.isEmpty();){var G=v.first().first(),F=v.first().rest().first();u[G]=F;v=v.rest()}return u};helpers.ordinalize=function(v){if(11==v%100)return v+"th";var u=v;switch(v%10){case 1:u+="st";break;case 2:u+="nd";break;case 3:u+="rd";break;default:u+="th"}return u};helpers.wrapJsObject=function(v){return void 0===v?types.jsObject("undefined",v):null===v?types.jsObject("null",
v):"function"==typeof v?types.jsObject("function",v):v instanceof Array?types.jsObject("array",v):"string"==typeof v?types.jsObject("'"+v.toString()+"'",v):types.jsObject(v.toString(),v)};helpers.getKeyCodeName=function(v){v=v.charCode||v.keyCode;switch(v){case 8:v="\b";break;case 16:v="shift";break;case 17:v="control";break;case 19:v="pause";break;case 27:v="escape";break;case 33:v="prior";break;case 34:v="next";break;case 35:v="end";break;case 36:v="home";break;case 37:v="left";break;case 38:v=
"up";break;case 39:v="right";break;case 40:v="down";break;case 42:v="print";break;case 45:v="insert";break;case 46:v=String.fromCharCode(127);break;case 144:v="numlock";break;case 145:v="scroll";break;default:v=112<=v&&123>=v?"f"+(v-111):""}return v};helpers.maybeCallAfterAttach=function(v){for(v=[v];0!==v.length;){var u=v.pop();u.afterAttach&&u.afterAttach(u);if(u.hasChildNodes&&u.hasChildNodes()){u=u.childNodes;for(var G=0;G<u.length;G++)v.push(u[G])}}};helpers.makeLocationDom=function(v){var u=
document.createElement("span"),G=document.createElement("span"),F=document.createElement("span"),E=document.createElement("span"),O=document.createElement("span"),P=document.createElement("span");u.className="location-reference";G.className="location-id";F.className="location-offset";E.className="location-line";O.className="location-column";P.className="location-span";G.appendChild(document.createTextNode(v.id+""));F.appendChild(document.createTextNode(v.offset+""));E.appendChild(document.createTextNode(v.line+
""));O.appendChild(document.createTextNode(v.column+""));P.appendChild(document.createTextNode(v.span+""));u.appendChild(G);u.appendChild(F);u.appendChild(E);u.appendChild(O);u.appendChild(P);return u};helpers.isLocationDom=function(v){return v&&(v.nodeType===Node.TEXT_NODE||v.nodeType===Node.ELEMENT_NODE)&&"location-reference"===v.className}})();var jsworld={};
(function(){function W(){}function fa(A){A=ta.indexOf(A);-1!=A&&ta.splice(A,1)}function ja(){Pa=new W;ta=[];for(var A=0;A<Ua.length;A++)Ua[A]();Ua=[];R=!1}function q(A,H){if(R)setTimeout(function(){q(A,H)},100);else{var N=Pa;R=!0;var Z=function(K){Pa=K;Pa instanceof B?(K=Pa.getEffects(),helpers.forEachK(K,function(T,qa){T.invokeEffect(q,qa)},function(T){throw T;},function(){Pa=Pa.getWorld();y()})):y()},la=function(K,T){K(Pa,N,T)},k=function(K){Pa=N;throw K;},y=function(){helpers.forEachK(ta,la,k,
function(){R=!1;H()})};try{A(Pa,Z)}catch(K){throw Pa=N,"undefined"!==typeof console&&console.log&&K.stack&&console.log(K.stack),K;}}}function m(A,H){for(var N=Array(A.length),Z=0;Z<A.length;Z++)N[Z]=H(A[Z]);return N}function C(A,H){for(var N=[],Z=0;Z<A.length;Z++)N=N.concat(H(A[Z]));return N}function da(A,H){for(var N=0;N<A.length;N++)if(A[N]==H)return!0;return!1}function na(A){var H=[A];for(A=A.firstChild;null!=A;A=A.nextSibling)H.push(na(A));return H}function v(A){var H=[A.node];if(1==A.node.jsworldOpaque)return H;
for(var N=0;N<A.children.length;N++)H=H.concat(v(A.children[N]));return H}function u(A,H){return A&&H&&A===H}function G(A){var H=[];if(1==A.node.jsworldOpaque)return[];for(var N=0;N<A.children.length;N++)H.push({relation:"parent",parent:A.node,child:A.children[N].node});for(N=0;N<A.children.length-1;N++)H.push({relation:"neighbor",left:A.children[N].node,right:A.children[N+1].node});for(N=0;N<A.children.length;N++)H=H.concat(G(A.children[N]));return H}function F(A,H,N){function Z(qa,Ga){Ga=qa.compareDocumentPosition(Ga);
return Ga&qa.DOCUMENT_POSITION_CONTAINED_BY?1:Ga&qa.DOCUMENT_POSITION_CONTAINS||Ga&qa.DOCUMENT_POSITION_FOLLOWING?-1:Ga&qa.DOCUMENT_POSITION_PRECEDING?1:0}for(var la=0;la<N.length;la++)if("parent"==N[la].relation){var k=N[la].parent,y=N[la].child;u(y.parentNode,k)||k.appendChild(y)}for(k=!0;k;)for(k=!1,la=0;la<N.length;la++)if("neighbor"==N[la].relation){y=N[la].left;var K=N[la].right;u(y.nextSibling,K)||(y.parentNode.insertBefore(y,K),k=!0)}try{var T=H.concat(A).sort(Z)}catch(qa){T=null}N=A;for(A=
A.parentNode;N!=A;){for(;null!=N.firstChild&&!N.jsworldOpaque;)N=N.firstChild;for(;N!=A;){y=N.nextSibling;k=N.parentNode;K=!1;if(null!=T)for(;0<T.length&&0<=Z(N,T[0]);){if(la=T.shift(),u(la,N)){K=!0;break}}else for(la=0;la<H.length;la++)if(u(H[la],N)){K=!0;break}if(!K){if(!N.isJsworldOpaque)for(;null!=N.firstChild;)N.parentNode.appendChild(N.firstChild);y=N.nextSibling;N.parentNode.removeChild(N)}if(null==y)N=k;else{N=y;break}}}X(H)}function E(A){return A.replace(/\-(.)/g,function(H,N){return N.toUpperCase()})}
function O(A,H){for(var N=0;N<H.length;N++)A.style[E(H[N].attrib)]=H[N].values.join(" ")}function P(A,H){for(var N=0;N<A.length;N++);for(N=0;N<H.length;N++)if("id"in H[N])for(var Z=0;Z<A.length;Z++){var la=A[Z];var k=H[N];la=k.id.match(/^\./)?"class"in la&&da(la["class"].split(/\s+/),k.id.substring(1)):"id"in la&&la.id==k.id;la&&O(A[Z],H[N].attribs)}else O(H[N].node,H[N].attribs)}function X(A){for(var H=0;H<A.length;H++)if(A[H].onWorldChange)A[H].onWorldChange(Pa)}function ia(A,H,N,Z,la,k){H instanceof
W?Z(A,function(y){var K=Xa(y),T=v(K);la(A,function(qa){P(T,C(qa,Ra));F(N,T,G(K));k()})}):Ba(function(y){function K(T,qa){return U?qa(U):la(T,qa)}(function(T,qa){return L?qa(L):Z(T,qa)})(H,function(T){Z(A,function(qa){K(H,function(Ga){la(A,function(Ea){var Va=Xa(qa),Ka=v(Va);T!==qa?(L=qa,P(Ka,C(Ea,Ra)),F(N,Ka,G(Va))):Ga!==Ea&&(U=Ea,P(Ka,C(Ea,Ra)));y()})})})})},k)}function Ba(A,H){if(void 0!=sa){var N=new ma;A(function(){N.restore();H()})}else A(H)}function ma(){this.focused=sa;this.selectionStart=
sa.selectionStart;this.selectionEnd=sa.selectionEnd}function wa(A,H,N,Z,la){this.top=A;this.world=H;this.handlers=Z;this.handlerCreators=N;this.attribs=la}function ka(A,H,N,Z,la){ja();var k=m(N,function(T){return T()});0<l.length&&l[l.length-1].pause();var y=new wa(A,H,N,k,Z);l.push(y);ta.push(function(T,qa,Ga){y.world=T;Ga()});var K=new oa(function(T,qa){qa(!1)},function(T,qa){qa(T)});for(N=0;N<k.length;N++)if(k[N]instanceof oa)K=k[N];else k[N].onRegister(A);ta.push(function(T,qa,Ga){K.test(T,function(Ea){Ea?
(Ea=K.last_picture_handler(),Ea.onRegister(A),Ea._listener(T,qa,function(Va){Ga()}),Q.shutdown(),la(T)):Ga()})});za(A,Z);q(function(T,qa){qa(H)},pa)}function oa(A,H,N){this.test=A;this.receiver=H;this.last_picture_handler=N}function ca(A,H,N){A.addEventListener?A.addEventListener(H,N,!1):A.attachEvent("on"+H,N,!1)}function ua(A,H,N){var Z=function(la){q(function(k,y){N(k,la,y)},pa)};ca(A,H,Z);Ua.push(function(){ha(A,H,Z)})}function Qa(A,H,N){var Z=function(la){setTimeout(function(){q(function(k,y){N(k,
la,y)},pa)},0)};ca(A,H,Z);Ua.push(function(){ha(A,H,Z)})}function Sa(A){ca(A,"focus",function(H){sa=A});ca(A,"blur",function(H){sa=void 0});return A}function Xa(A){return isPage(A)?Xa(na(A.toDomNode())):void 0==A.length?{node:A,children:[]}:{node:A[0],children:m(A.slice(1),Xa)}}function Oa(A){return{attrib:A[0],values:A.slice(1)}}function Ra(A){var H=m(A.slice(1),Oa);return"string"==typeof A[0]?[{id:A[0],attribs:H}]:"length"in A[0]?m(A[0],function(N){return{id:N,attribs:H}}):[{node:A[0],attribs:H}]}
function bb(A,H){if(!isPage(A))if(!A instanceof Array&&ra(A,H),0==A.length&&ra(A,H),A[0].nodeType==Node.TEXT_NODE){if(1<A.length)throw new Na(helpers.format("Text node ~s can not have children",[A]),A);}else if(A[0].nodeType==Node.ELEMENT_NODE)for(H=1;H<A.length;H++)bb(A[H],A);else throw new Na(helpers.format("expected a Text or an Element, received ~s within ~s",[A,H]),A[0]);}function Na(A,H){this.msg=A;this.elt=H}function za(A,H){if(H)for(a in H)Object.hasOwnProperty.call(H,a)&&("function"==typeof H[a]?
ua(A,a,H[a]):A[a]=H[a]);return A}function Da(A){return Sa(za(document.createElement("div"),A))}function Fa(A,H){H=document.createElement("div");H.appendChild(document.createTextNode(A));H.style["white-space"]="pre";H.jsworldOpaque=!0;return H}jsworld.Jsworld={};var Q=jsworld.Jsworld,sa=!1,pa=function(){},Pa=new W,R=!1,ta=[],Ua=[],l=[];Q.shutdown=function(){for(;0<l.length;){var A=l.pop();A&&A.pause()}ja()};Q.change_world=q;Number.prototype.NaN0=function(){return isNaN(this)?0:this};Q.getPosition=
function(A){for(var H=0,N=0;A.offsetParent;)H+=A.offsetLeft+(A.currentStyle?parseInt(A.currentStyle.borderLeftWidth).NaN0():0),N+=A.offsetTop+(A.currentStyle?parseInt(A.currentStyle.borderTopWidth).NaN0():0),A=A.offsetParent;H+=A.offsetLeft+(A.currentStyle?parseInt(A.currentStyle.borderLeftWidth).NaN0():0);N+=A.offsetTop+(A.currentStyle?parseInt(A.currentStyle.borderTopWidth).NaN0():0);return{x:H,y:N}};var D=0;Q.gensym=function(){return D++};Q.map=m;Q.mapi=function(A,H){for(var N=Array(A.length),
Z=0;Z<A.length;Z++)N[Z]=H(A[Z],Z);return N};Q.fold=function(A,H,N){for(var Z=0;Z<A.length;Z++)H=N(A[Z],H);return H};Q.augment=function(A,H){var N={},Z;for(Z in A)N[Z]=A[Z];for(Z in H)N[Z]=H[Z];return N};Q.assoc_cons=function(A,H,N){var Z={},la;for(la in A)Z[la]=A[la];Z[H]=N;return Z};Q.cons=function(A,H){return[A].concat(H)};Q.append=function(A,H){return A.concat(H)};Q.array_join=function(A,H){for(var N=[],Z=0;Z<A.length;Z++)N.push([A[Z],H[Z]]);return N};Q.removeq=function(A,H){for(var N=0;N<A.length;N++)if(A[N]===
H)return A.slice(0,N).concat(A.slice(N+1));return A};Q.removef=function(A,H){for(H=0;H<A.length;H++)if(f(A[H]))return A.slice(0,H).concat(A.slice(H+1));return A};Q.filter=function(A,H){for(var N=[],Z=0;Z<A.length;Z++)H(A[Z])&&N.push(A[Z]);return N};Q.without=function(A,H){var N={},Z;for(Z in A)Z!=H&&(N[Z]=A[Z]);return N};Q.memberq=function(A,H){for(var N=0;N<A.length;N++)if(A[N]===H)return!0;return!1};Q.member=da;Q.head=function(A){return A[0]};Q.tail=function(A){return A.slice(1,A.length)};Q.node_to_tree=
na;var L,U;ma.prototype.restore=function(){if(this.focused.parentNode)this.focused.selectionStart=this.selectionStart,this.focused.selectionEnd=this.selectionEnd,this.focused.focus();else if(this.focused.id){var A=document.getElementById(this.focused.id);A&&(A.selectionStart=this.selectionStart,A.selectionEnd=this.selectionEnd,A.focus())}};wa.prototype.restart=function(){ka(this.top,this.world,this.handlerCreators,this.attribs)};wa.prototype.pause=function(){for(var A=0;A<this.handlers.length;A++)if(!(this.handlers[A]instanceof
oa))this.handlers[A].onUnregister(top)};Q.big_bang=ka;Q.on_tick=function(A,H){return function(){var N,Z=function(){N=setTimeout(la,A)},la=function(){q(H,Z)};return{onRegister:function(k){Z()},onUnregister:function(k){N&&clearTimeout(N)}}}};Q.on_key=function(A){return function(){var H=!1,N=function(){H=!1},Z,la=function(y,K){A(y,Z,K)},k=function(y){if(27!=y.keyCode){Z=y;if("keydown"!==Z.type||""!==helpers.getKeyCodeName(Z)||Z.altKey)"keydown"===Z.type&&""!==helpers.getKeyCodeName(Z)&&xa(Z);else return!1;
Aa(Z);H!==Z.type&&(H=Z.type,q(la,N))}};return{onRegister:function(y){ca(y,"keypress",k);ca(y,"keydown",k)},onUnregister:function(y){ha(y,"keypress",k);ha(y,"keydown",k)}}}};Q.on_mouse=function(A){return function(){var H,N,Z=!1,la=function(){Z=!1},k=function(K,T){A(K,H,T)},y=function(K){H=K;N&&N.focus();xa(H);Aa(H);Z||(Z=!0,q(k,la))};return{onRegister:function(K){N=K;ca(N,"mousedown",y);ca(N,"mouseup",y);ca(N,"mousemove",y)},onUnregister:function(K){ha(K,"mousedown",y);ha(K,"mouseup",y);ha(K,"mousemove",
y)}}}};Q.on_tap=function(A){return function(){var H,N,Z=!1,la=function(){Z=!1},k=function(K,T){A(K,H,T)},y=function(K){H=K;N&&N.focus();xa(H);Aa(H);Z||(Z=!0,q(k,la))};return{onRegister:function(K){N=K;ca(N,"touchstart",y)},onUnregister:function(K){ha(K,"touchstart",y)}}}};Q.on_tilt=function(A){return function(){var H=0,N=0,Z,la=function(T,qa){A(T,H,N,qa)},k=function(){q(la,y)},y=function(){Z=setTimeout(k,250)};if(window.DeviceOrientationEvent){var K=function(T){xa(T);Aa(T);null===T.gamma||null===
T.beta?Z&&(clearTimeout(Z),Z=void 0):0===window.orientation?(H=T.gamma,N=T.beta):90===window.orientation?(H=T.beta,N=-T.gamma):-90===window.orientation?(H=-T.beta,N=T.gamma):180===window.orientation?(H=-T.gamma,N=-T.beta):(H=T.gamma,N=T.beta)};return{onRegister:function(T){ca(window,"deviceorientation",K);y()},onUnregister:function(T){Z&&clearTimeout(Z);ha(window,"deviceorientation",K)}}}return{onRegister:function(T){},onUnregister:function(T){}}}};Q.on_draw=function(A,H){var N,Z=function(k){bb(k,
k);N(k)},la=function(k,y){N=y;A(k,Z)};return function(){var k={_top:null,_listener:function(y,K,T){ia(y,K,k._top,la,H,T)},onRegister:function(y){k._top=y;ta.push(k._listener)},onUnregister:function(y){fa(k._listener)}};return k}};Q.stop_when=function(A,H,N){return function(){void 0==H&&(H=function(Z,la){la(Z)});return new oa(A,H,N)}};Q.on_world_change=function(A){var H=function(N,Z,la){A(N,la)};return function(){return{onRegister:function(N){ta.push(H)},onUnregister:function(N){fa(H)}}}};var ha=function(A,
H,N){A.addEventListener?A.removeEventListener(H,N,!1):A.detachEvent("on"+H,N,!1)},ra=function(A,H){throw new Na(helpers.format("Expected a non-empty array, received ~s within ~s",[A,H]),A);};Na.prototype.toString=function(){return"on-draw: "+this.msg};Q.p=function(A){return Sa(za(document.createElement("p"),A))};Q.div=Da;Q.button=function(A,H){var N=document.createElement("button");N.onclick=function(Z){return!1};ua(N,"click",A);return Sa(za(N,H))};var xa=function(A){A.preventDefault?A.preventDefault():
A.returnValue=!1},Aa=function(A){A.stopPropagation?A.stopPropagation():A.cancelBubble=!0},Ta=function(A){ca(A,"click",function(H){Aa(H)});return A};Q.input=function(A,H,N){A=A.toLowerCase();var Z={text:Ha,password:Ha,checkbox:Za};if(Z[A])return Z[A](A,H,N);throw Error("js-input: does not currently support type "+A);};var Ha=function(A,H,N){var Z=document.createElement("input");Z.type=A;Qa(Z,"keypress",function(y,K,T){H(y,Z.value,T)});var la=Z.value,k=setInterval(function(){Z.parentNode?la!=Z.value&&
(la=Z.value,q(function(y,K){H(y,Z.value,K)},pa)):clearInterval(k)},1E3);return Ta(Sa(za(Z,N)))},Za=function(A,H,N){var Z=document.createElement("input");Z.type=A;Qa(Z,"change",function(la,k,y){H(la,Z.checked,y)});ca(Z,"click",function(la){Aa(la)});return za(Z,N)};Q.text=Fa;Q.select=function(A,H,N){for(var Z=document.createElement("select"),la=0;la<H.length;la++){var k=Z,y=k.add,K=H[la],T=document.createElement("option");T.text=K;T.value=K;y.call(k,T,null)}Z.jsworldOpaque=!0;ua(Z,"change",N);return Sa(za(Z,
A))};Q.textarea=function(A){return Sa(za(document.createElement("textarea"),A))};Q.h1=function(A){return Sa(za(document.createElement("h1"),A))};Q.canvas=function(A){return Sa(za(document.createElement("canvas"),A))};Q.img=function(A,H){var N=document.createElement("img");N.src=A;return Sa(za(N,H))};Q.raw_node=function(A,H){return Sa(za(A,H))};var B=function(A,H){A instanceof B?(this.w=A.w,this.e=A.e.concat(H)):(this.w=A,this.e=H)};B.prototype.getWorld=function(){return this.w};B.prototype.getEffects=
function(){return this.e};Q.with_effect=function(A,H){return new B(A,[H])};Q.with_multiple_effects=function(A,H){return new B(A,H)};Q.has_effects=function(A){return A instanceof B};Q.alert_effect=function(A){return new J(A)};var J=function(A){this.msg=A};J.prototype.invokeEffect=function(A){alert(this.msg);A()};Q.music_effect=function(A){return new V(A)};var V=function(A){this.musicUrl=A};V.prototype.invokeEffect=function(A){(new Audio(url)).play();A()};var Y=function(A,H){"undefined"===typeof A&&
(A=[]);this.elts=A;this.attribs=H};Y.prototype.add=function(A,H,N){return new Y(this.elts.concat([{elt:A,positionTop:N,positionLeft:H}]),this.attribs)};Y.prototype.toDomNode=function(){for(var A=Da(),H=0;H<this.elts.length;H++){var N=this.elts[H].elt;N.style||(N.style="");N.style.position="absolute";N.style.left=this.elts[H].positionLeft+"px";N.style.top=this.elts[H].positionTop+"px";A.appendChild(N)}za(A,this.attribs);return A};isPage=function(A){return A instanceof Y};Q.isPage=isPage;Q.emptyPage=
function(A){return new Y([],A)};Q.placeOnPage=function(A,H,N,Z){"string"===typeof A&&(A=Fa(A));return Z.add(A,H,N)};Q.getCurrentWorld=function(){return Pa}})();var __PLTNUMBERS_TOP__;"undefined"!==typeof exports?__PLTNUMBERS_TOP__=exports:(this.jsnums||(this.jsnums={}),__PLTNUMBERS_TOP__=this.jsnums);
(function(){function W(d,h){return new RegExp("^(?:([+-]?(?:["+(d+"]+|[")+(d+"]*\\.["+d+"]+|[")+(d+"]+\\.["+d+"]*))[")+h+"]([+-]?["+d+"]+))$")}function fa(d){return 2===d?"01":8===d?"0-7":10===d?"0-9":16===d?"0-9a-fA-F":ta("digitsForRadix: invalid radix",this,d)}function ja(d){return 2===d||8===d||10===d?"defsl":16===d?"sl":ta("expMarkForRadix: invalid radix",this,d)}function q(d){this.defaultp=function(){return 0==d};this.exactp=function(){return 1==d};this.inexactp=function(){return 2==d}}function m(d,
h,z,I){var S=d.match,ea=fa(h);if(S=S.call(d,new RegExp("^([+-]?["+ea+"]+)/(["+ea+"]+)$")))return Ia.makeInstance(m(S[1],h,z),m(S[2],h,z));if("+nan.0"===d||"-nan.0"===d)return aa.nan;if("+inf.0"===d)return aa.inf;if("-inf.0"===d)return aa.neginf;if("-0.0"===d)return wb;S=d.match;ea=fa(h);if(S=S.call(d,new RegExp("^(?:([+-]?)((["+(ea+"]*)\\.(["+ea+"]+)|([")+(ea+"]+)\\.(["+ea+"]*)))$"))))return d=S[1],ea=void 0!==S[3]?S[3]:S[5],I=void 0!==S[4]?S[4]:S[6],d="-"==d?-1:1,S=""===ea?0:z.intAsExactp()?m(ea,
h,q.on,!0):parseInt(ea,h),ea=""===I?0:z.intAsExactp()?m(I,h,q.on,!0):parseInt(I,h),h=z.intAsExactp()?y(h,I.length):Math.pow(h,I.length),h=""===I?0:z.intAsExactp()?Y(ea,h):ea/h,z.floatAsInexactp()?(z=J(d,Ha(S,h)),z="number"===typeof z?aa.makeInstance(z):z.toInexact()):z=J(d,Ha(S,h)),z;if(S=d.match(W(fa(h),ja(h))))return d=m(S[1],h,z),z=m(S[2],h,z),J(d,y(h,z));if(d.match(new RegExp("^[+-]?["+fa(h)+"]+$")))return h=parseInt(d,h),mb(h)?eb(d):z.intAsExactp()?h:aa.makeInstance(h);if(I)0===d.length&&ta("no digits"),
ta("bad number: "+d,this);else return!1}function C(d,h,z){null!=d&&("number"==typeof d?this.fromNumber(d,h,z):null==h&&"string"!=typeof d?this.fromString(d,256):this.fromString(d,h))}function da(){return new C(null)}function na(d,h,z,I,S,ea){for(;0<=--ea;){var va=h*this[d++]+z[I]+S;S=Math.floor(va/67108864);z[I++]=va&67108863}return S}function v(d,h,z,I,S,ea){var va=h&32767;for(h>>=15;0<=--ea;){var Ma=this[d]&32767,ib=this[d++]>>15,gb=h*Ma+ib*va;Ma=va*Ma+((gb&32767)<<15)+z[I]+(S&1073741823);S=(Ma>>>
30)+(gb>>>15)+h*ib+(S>>>30);z[I++]=Ma&1073741823}return S}function u(d,h,z,I,S,ea){var va=h&16383;for(h>>=14;0<=--ea;){var Ma=this[d]&16383,ib=this[d++]>>14,gb=h*Ma+ib*va;Ma=va*Ma+((gb&16383)<<14)+z[I]+S;S=(Ma>>28)+(gb>>14)+h*ib;z[I++]=Ma&268435455}return S}function G(d,h){d=Lb[d.charCodeAt(h)];return null==d?-1:d}function F(d){var h=da();h.fromInt(d);return h}function E(d){var h=this.s-d.s;if(0!=h)return h;var z=this.t;h=0>this.s?d.t-z:z-d.t;if(0!=h)return h;for(;0<=--z;)if(0!=(h=this[z]-d[z]))return h;
return 0}function O(d){var h=1,z;0!=(z=d>>>16)&&(d=z,h+=16);0!=(z=d>>8)&&(d=z,h+=8);0!=(z=d>>4)&&(d=z,h+=4);0!=(z=d>>2)&&(d=z,h+=2);0!=d>>1&&(h+=1);return h}function P(d){var h=da();this.abs().divRemTo(d,null,h);0>this.s&&0<h.compareTo(C.ZERO)&&d.subTo(h,h);return h}function X(d){this.m=d}function ia(d){this.m=d;this.mp=d.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<d.DB-15)-1;this.mt2=2*d.t}function Ba(d){return 0==this.compareTo(d)}function ma(d,h){return d&h}function wa(d,
h){return d|h}function ka(d,h){return d^h}function oa(d,h){return d&~h}function ca(d){var h=da();this.addTo(d,h);return h}function ua(d){var h=da();this.subTo(d,h);return h}function Qa(d){var h=da();this.multiplyTo(d,h);return h}function Sa(d){var h=da();this.divRemTo(d,h,null);return h}function Xa(d){var h=da();this.divRemTo(d,null,h);return h}function Oa(d){var h=da(),z=da();this.divRemTo(d,h,z);return[h,z]}function Ra(){}function bb(d){return d}function Na(d){return this.bnpExp(d,new Ra)}function za(d){this.r2=
da();this.q3=da();C.ONE.dlShiftTo(2*d.t,this.r2);this.mu=this.r2.divide(d);this.m=d}function Da(d){var h=0>this.s?this.negate():this.clone();d=0>d.s?d.negate():d.clone();if(0>h.compareTo(d)){var z=h;h=d;d=z}z=h.getLowestSetBit();var I=d.getLowestSetBit();if(0>I)return h;z<I&&(I=z);0<I&&(h.rShiftTo(I,h),d.rShiftTo(I,d));for(;0<h.signum();)0<(z=h.getLowestSetBit())&&h.rShiftTo(z,h),0<(z=d.getLowestSetBit())&&d.rShiftTo(z,d),0<=h.compareTo(d)?(h.subTo(d,h),h.rShiftTo(1,h)):(d.subTo(h,d),d.rShiftTo(1,
d));0<I&&d.lShiftTo(I,d);return d}function Fa(d){return function(){var h=this.toInexact();return h[d].apply(h,arguments)}}var Q=__PLTNUMBERS_TOP__,sa=function(d,h,z){z=z||{};return function(I,S){if(z.isXSpecialCase&&z.isXSpecialCase(I))return z.onXSpecialCase(I,S);if(z.isYSpecialCase&&z.isYSpecialCase(S))return z.onYSpecialCase(I,S);if("number"===typeof I&&"number"===typeof S)return d(I,S);"number"===typeof I&&(I=R(I,S));"number"===typeof S&&(S=R(S,I));I.level<S.level&&(I=I.liftTo(S));S.level<I.level&&
(S=S.liftTo(I));return h(I,S)}},pa=function(d){var h=d.match(W(fa(10),ja(10)));return h?(d=h[1].match(/^([^.]*)(.*)$/),h=Number(h[2]),0===d[2].length?d[1]+Pa(h):h>=d[2].length-1?d[1]+d[2].substring(1)+Pa(h-(d[2].length-1)):d[1]+d[2].substring(1,1+h)):d},Pa=function(d){var h=[];h.length=d;for(var z=0;z<d;z++)h[z]="0";return h.join("")},R=function(d,h){switch(h.level){case 0:return eb(d);case 1:return new Ia(d,1);case 2:return new aa(d);case 3:return new ya(d,0);default:ta("IMPOSSIBLE: cannot lift fixnum integer to "+
h.toString(),d,h)}},ta=function(d,h,z){Q.onThrowRuntimeError(d,h,z)},Ua=function(d){return"number"===typeof d||d instanceof Ia||d instanceof aa||d instanceof ya||d instanceof C},l=function(d){return"number"===typeof d||Ua(d)&&d.isRational()},D=function(d){return"number"===typeof d||Ua(d)&&d.isReal()},L=function(d){return"number"===typeof d||Ua(d)&&d.isExact()},U=function(d){return"number"===typeof d?!1:Ua(d)&&d.isInexact()},ha=function(d){return"number"===typeof d||Ua(d)&&d.isInteger()},ra=function(d){return"number"===
typeof d||Ua(d)&&d.isInteger()&&d.isExact()},xa=function(d){return"number"===typeof d?d:d.toFixnum()},Aa=function(d){return"number"===typeof d?d:d.toExact()},Ta=function(d){return"number"===typeof d?aa.makeInstance(d):d.toInexact()},Ha=function(d,h){return"number"===typeof d&&"number"===typeof h&&mb(d+h)?eb(d).add(eb(h)):d instanceof aa&&h instanceof aa?d.add(h):Za(d,h)},Za=sa(function(d,h){var z=d+h;return mb(z)?eb(d).add(eb(h)):z},function(d,h){return d.add(h)},{isXSpecialCase:function(d){return ra(d)&&
c(d)},onXSpecialCase:function(d,h){return h},isYSpecialCase:function(d){return ra(d)&&c(d)},onYSpecialCase:function(d,h){return d}}),B=sa(function(d,h){var z=d-h;return mb(z)?eb(d).subtract(eb(h)):z},function(d,h){return d.subtract(h)},{isXSpecialCase:function(d){return ra(d)&&c(d)},onXSpecialCase:function(d,h){return fb(h)},isYSpecialCase:function(d){return ra(d)&&c(d)},onYSpecialCase:function(d,h){return d}}),J=function(d,h){if("number"===typeof d&&"number"===typeof h){var z=d*h;return mb(z)?eb(d).multiply(eb(h)):
z}return d instanceof aa&&h instanceof aa?d.multiply(h):V(d,h)},V=sa(function(d,h){var z=d*h;return mb(z)?eb(d).multiply(eb(h)):z},function(d,h){return d.multiply(h)},{isXSpecialCase:function(d){return ra(d)&&(c(d)||b(d)||e(d))},onXSpecialCase:function(d,h){if(c(d))return 0;if(b(d))return h;if(e(d))return fb(h)},isYSpecialCase:function(d){return ra(d)&&(c(d)||b(d)||e(d))},onYSpecialCase:function(d,h){if(c(h))return 0;if(b(h))return d;if(e(h))return fb(d)}}),Y=sa(function(d,h){c(h)&&ta("/: division by zero",
d,h);var z=d/h;return mb(z)?eb(d).divide(eb(h)):Math.floor(z)!==z?Ia.makeInstance(d,h):z},function(d,h){return d.divide(h)},{isXSpecialCase:function(d){return H(d,0)},onXSpecialCase:function(d,h){H(h,0)&&ta("/: division by zero",d,h);return 0},isYSpecialCase:function(d){return H(d,0)},onYSpecialCase:function(d,h){ta("/: division by zero",d,h)}}),A=sa(function(d,h){return d===h},function(d,h){return d.equals(h)}),H=function(d,h){if(d===h)return!0;if("number"===typeof d&&"number"===typeof h||d===wb||
h===wb)return d===h;if(d instanceof ya||h instanceof ya)return H(ob(d),ob(h))&&H(rb(d),rb(h));var z=L(d),I=L(h);return(z&&I||!z&&!I)&&A(d,h)},N=sa(function(d,h){return d>=h},function(d,h){D(d)&&D(h)||ta(">=: couldn't be applied to complex number",d,h);return d.greaterThanOrEqual(h)}),Z=sa(function(d,h){return d<=h},function(d,h){D(d)&&D(h)||ta("<=: couldn't be applied to complex number",d,h);return d.lessThanOrEqual(h)}),la=sa(function(d,h){return d>h},function(d,h){D(d)&&D(h)||ta(">: couldn't be applied to complex number",
d,h);return d.greaterThan(h)}),k=sa(function(d,h){return d<h},function(d,h){D(d)&&D(h)||ta("<: couldn't be applied to complex number",d,h);return d.lessThan(h)}),y=function(){var d=sa(function(h,z){var I=Math.pow(h,z);return mb(I)?eb(h).expt(eb(z)):I},function(h,z){return A(z,0)?Ha(z,1):h.expt(z)});return function(h,z){return A(z,0)?Ha(z,1):D(z)&&k(z,0)?d(Y(1,h),fb(z)):d(h,z)}}(),K=function(d){return H(d,0)?1:"number"===typeof d?aa.makeInstance(Math.exp(d)):d.exp()},T=function(d,h){ha(d)||ta("modulo: the first argument "+
d+" is not an integer.",d,h);ha(h)||ta("modulo: the second argument "+h+" is not an integer.",d,h);if("number"===typeof d)return d%=h,0>h?0>=d?d:d+h:0>d?d+h:d;d=Eb(Ka(d),Ka(h));return k(h,0)?Z(d,0)?d:Ha(d,h):k(d,0)?Ha(d,h):d},qa=function(d){return"number"===typeof d?d:d.numerator()},Ga=function(d){return"number"===typeof d?1:d.denominator()},Ea=function(d){return"number"===typeof d?0<=d?(d=Math.sqrt(d),Math.floor(d)===d?d:aa.makeInstance(d)):ya.makeInstance(0,Ea(-d)):d.sqrt()},Va=function(d){return"number"===
typeof d?Math.abs(d):d.abs()},Ka=function(d){return"number"===typeof d?d:d.floor()},db=function(d){return"number"===typeof d?d:d.ceiling()},Ja=function(d){return"number"===typeof d?d:d.conjugate()},t=function(d){return H(d,1)?0:"number"===typeof d?aa.makeInstance(Math.log(d)):d.log()},Ya=function(d){return"number"===typeof d?0<d?0:aa.pi:d.angle()},ab=function(d){return H(d,0)?0:"number"===typeof d?aa.makeInstance(Math.tan(d)):d.tan()},cb=function(d){return H(d,0)?0:"number"===typeof d?aa.makeInstance(Math.atan(d)):
d.atan()},jb=function(d){return H(d,0)?1:"number"===typeof d?aa.makeInstance(Math.cos(d)):d.cos()},sb=function(d){return H(d,0)?0:"number"===typeof d?aa.makeInstance(Math.sin(d)):d.sin()},Bb=function(d){return H(d,1)?0:"number"===typeof d?aa.makeInstance(Math.acos(d)):d.acos()},Mb=function(d){return H(d,0)?0:"number"===typeof d?aa.makeInstance(Math.asin(d)):d.asin()},rb=function(d){return"number"===typeof d?0:d.imaginaryPart()},ob=function(d){return"number"===typeof d?d:d.realPart()},Fb=function(d){return"number"===
typeof d?d:d.round()},pb=function(d){return J(d,d)},Cb=function(d){ha(d)||ta("integer-sqrt: the argument "+d.toString()+" is not an integer.",d);return"number"===typeof d?0>d?ya.makeInstance(0,Math.floor(Math.sqrt(-d))):Math.floor(Math.sqrt(d)):d.integerSqrt()},xb=function(d,h){ha(d)||ta("quotient: the first argument "+d.toString()+" is not an integer.",d);ha(h)||ta("quotient: the second argument "+h.toString()+" is not an integer.",h);return M(d,h)},vb=function(d,h){ha(d)||ta("remainder: the first argument "+
d.toString()+" is not an integer.",d);ha(h)||ta("remainder: the second argument "+h.toString()+" is not an integer.",h);return ba(d,h)},Gb=function(d){return"number"===typeof d?isFinite(d):d.isFinite()},mb=function(d){return-9E15>d||9E15<d},fb=function(d){return"number"===typeof d?-d:d.negate()},Hb=function(d,h){for(var z=1;;){if(c(h))return z;A(T(h,2),0)?(d=J(d,d),h=Y(h,2)):(z=J(z,d),h=B(h,1))}},kb=function(d,h,z){z=z||{};return function(I,S){I instanceof Ia?I=qa(I):I instanceof ya&&(I=ob(I));S instanceof
Ia?S=qa(S):S instanceof ya&&(S=ob(S));if("number"===typeof I&&"number"===typeof S){var ea=d(I,S);if(!mb(ea)||z.ignoreOverflow)return ea}if(I instanceof aa||S instanceof aa)return z.doNotCoerseToFloating?d(xa(I),xa(S)):aa.makeInstance(d(xa(I),xa(S)));"number"===typeof I&&(I=eb(I));"number"===typeof S&&(S=eb(S));return h(I,S)}},Db=function(d,h,z){z=z||{};return function(I){I instanceof Ia?I=qa(I):I instanceof ya&&(I=ob(I));if("number"===typeof I){var S=d(I);if(!mb(S)||z.ignoreOverflow)return S}if(I instanceof
aa)return d(xa(I));"number"===typeof I&&(I=eb(I));return h(I)}},Eb=kb(function(d,h){return d%h},function(d,h){return P.call(d,h)}),zb=kb(function(d,h){for(var z;0!==h;)z=d,d=h,h=z%h;return d},function(d,h){return Da.call(d,h)}),c=Db(function(d){return 0===d},function(d){return Ba.call(d,C.ZERO)}),b=Db(function(d){return 1===d},function(d){return Ba.call(d,C.ONE)}),e=Db(function(d){return-1===d},function(d){return Ba.call(d,C.NEGATIVE_ONE)}),g=kb(function(d,h){return d+h},function(d,h){return ca.call(d,
h)}),p=kb(function(d,h){return d-h},function(d,h){return ua.call(d,h)}),w=kb(function(d,h){return d*h},function(d,h){return Qa.call(d,h)}),M=kb(function(d,h){return(d-d%h)/h},function(d,h){return Sa.call(d,h)}),ba=kb(function(d,h){return d%h},function(d,h){return Xa.call(d,h)}),Ca=kb(function(d,h){return d/h},function(d,h){return xa(d)/xa(h)},{ignoreOverflow:!0,doNotCoerseToFloating:!0}),La=kb(function(d,h){return d===h},function(d,h){return Ba.call(d,h)},{doNotCoerseToFloating:!0}),Wa=kb(function(d,
h){return d>h},function(d,h){return 0<E.call(d,h)},{doNotCoerseToFloating:!0}),$a=kb(function(d,h){return d<h},function(d,h){return 0>E.call(d,h)},{doNotCoerseToFloating:!0}),lb=kb(function(d,h){return d>=h},function(d,h){return 0<=E.call(d,h)},{doNotCoerseToFloating:!0}),Ob=kb(function(d,h){return d<=h},function(d,h){return 0>=E.call(d,h)},{doNotCoerseToFloating:!0}),Ia=function(d,h){this.n=d;this.d=h};Ia.prototype.toString=function(){return b(this.d)?this.n.toString()+"":this.n.toString()+"/"+this.d.toString()};
Ia.prototype.level=1;Ia.prototype.liftTo=function(d){return 2===d.level?new aa(Ca(this.n,this.d)):3===d.level?new ya(this,0):ta("invalid level of Number",this,d)};Ia.prototype.isFinite=function(){return!0};Ia.prototype.equals=function(d){return d instanceof Ia&&La(this.n,d.n)&&La(this.d,d.d)};Ia.prototype.isInteger=function(){return b(this.d)};Ia.prototype.isRational=function(){return!0};Ia.prototype.isReal=function(){return!0};Ia.prototype.add=function(d){return Ia.makeInstance(g(w(this.n,d.d),w(this.d,
d.n)),w(this.d,d.d))};Ia.prototype.subtract=function(d){return Ia.makeInstance(p(w(this.n,d.d),w(this.d,d.n)),w(this.d,d.d))};Ia.prototype.negate=function(){return Ia.makeInstance(-this.n,this.d)};Ia.prototype.multiply=function(d){return Ia.makeInstance(w(this.n,d.n),w(this.d,d.d))};Ia.prototype.divide=function(d){(c(this.d)||c(d.n))&&ta("/: division by zero",this,d);return Ia.makeInstance(w(this.n,d.d),w(this.d,d.n))};Ia.prototype.toExact=function(){return this};Ia.prototype.toInexact=function(){return aa.makeInstance(this.toFixnum())};
Ia.prototype.isExact=function(){return!0};Ia.prototype.isInexact=function(){return!1};Ia.prototype.toFixnum=function(){return Ca(this.n,this.d)};Ia.prototype.numerator=function(){return this.n};Ia.prototype.denominator=function(){return this.d};Ia.prototype.greaterThan=function(d){return Wa(w(this.n,d.d),w(this.d,d.n))};Ia.prototype.greaterThanOrEqual=function(d){return lb(w(this.n,d.d),w(this.d,d.n))};Ia.prototype.lessThan=function(d){return $a(w(this.n,d.d),w(this.d,d.n))};Ia.prototype.lessThanOrEqual=
function(d){return Ob(w(this.n,d.d),w(this.d,d.n))};Ia.prototype.integerSqrt=function(){var d=Ea(this);return l(d)?Aa(Ka(d)):D(d)?Aa(Ka(d)):ya.makeInstance(Aa(Ka(ob(d))),Aa(Ka(rb(d))))};Ia.prototype.sqrt=function(){if(lb(this.n,0)){var d=Ea(this.n),h=Ea(this.d);return A(Ka(d),d)&&A(Ka(h),h)?Ia.makeInstance(d,h):aa.makeInstance(Ca(d,h))}d=Ea(fb(this.n));h=Ea(this.d);return A(Ka(d),d)&&A(Ka(h),h)?ya.makeInstance(0,Ia.makeInstance(d,h)):ya.makeInstance(0,aa.makeInstance(Ca(d,h)))};Ia.prototype.abs=function(){return Ia.makeInstance(Va(this.n),
this.d)};Ia.prototype.floor=function(){var d=M(this.n,this.d);return $a(this.n,0)?B(d,1):d};Ia.prototype.ceiling=function(){var d=M(this.n,this.d);return $a(this.n,0)?d:Ha(d,1)};Ia.prototype.conjugate=function(){return this};Ia.prototype.magnitude=Ia.prototype.abs;Ia.prototype.log=function(){return aa.makeInstance(Math.log(this.n/this.d))};Ia.prototype.angle=function(){return c(this.n)?0:Wa(this.n,0)?0:aa.pi};Ia.prototype.tan=function(){return aa.makeInstance(Math.tan(Ca(this.n,this.d)))};Ia.prototype.atan=
function(){return aa.makeInstance(Math.atan(Ca(this.n,this.d)))};Ia.prototype.cos=function(){return aa.makeInstance(Math.cos(Ca(this.n,this.d)))};Ia.prototype.sin=function(){return aa.makeInstance(Math.sin(Ca(this.n,this.d)))};Ia.prototype.expt=function(d){return ra(d)&&N(d,0)?Hb(this,d):aa.makeInstance(Math.pow(Ca(this.n,this.d),Ca(d.n,d.d)))};Ia.prototype.exp=function(){return aa.makeInstance(Math.exp(Ca(this.n,this.d)))};Ia.prototype.acos=function(){return aa.makeInstance(Math.acos(Ca(this.n,this.d)))};
Ia.prototype.asin=function(){return aa.makeInstance(Math.asin(Ca(this.n,this.d)))};Ia.prototype.imaginaryPart=function(){return 0};Ia.prototype.realPart=function(){return this};Ia.prototype.round=function(){var d=A(this.d,2),h=$a(this.n,0),z=this.n;h&&(z=fb(z));var I=M(z,this.d);d?I=Ha(I,1):(d=ba(z,this.d),la(J(d,2),this.d)&&(I=Ha(I,1)));h&&(I=fb(I));return I};Ia.makeInstance=function(d,h){void 0===d&&ta("n undefined",d,h);void 0===h&&(h=1);c(h)&&ta("division by zero: "+d+"/"+h);$a(h,0)&&(d=fb(d),
h=fb(h));var z=zb(Va(d),Va(h));d=M(d,z);h=M(h,z);return b(h)||c(d)?d:new Ia(d,h)};var aa=function(d){this.n=d},Ib=new aa(Number.NaN),Vb=new aa(Number.POSITIVE_INFINITY),Qb=new aa(Number.NEGATIVE_INFINITY),Rb=new aa(Number.POSITIVE_INFINITY),Sb=new aa(Number.NEGATIVE_INFINITY),wb=new aa(-0),Tb=new aa(0);aa.pi=new aa(Math.PI);aa.e=new aa(Math.E);aa.nan=Ib;aa.inf=Vb;aa.neginf=Qb;aa.makeInstance=function(d){return isNaN(d)?aa.nan:d===Number.POSITIVE_INFINITY?aa.inf:d===Number.NEGATIVE_INFINITY?aa.neginf:
0===d?-Infinity===1/d?wb:Tb:new aa(d)};aa.prototype.isExact=function(){return!1};aa.prototype.isInexact=function(){return!0};aa.prototype.isFinite=function(){return isFinite(this.n)||this===Rb||this===Sb};aa.prototype.toExact=function(){isFinite(this.n)&&!isNaN(this.n)||ta("toExact: no exact representation for "+this,this);var d=this.n.toString().match(/^(.*)\.(.*)$/);return d?(parseInt(d[1]),parseInt(d[2]),d=Math.pow(10,d[2].length),Ia.makeInstance(Math.round(this.n*d),d)):this.n};aa.prototype.toInexact=
function(){return this};aa.prototype.isInexact=function(){return!0};aa.prototype.level=2;aa.prototype.liftTo=function(d){return 3===d.level?new ya(this,0):ta("invalid level of Number",this,d)};aa.prototype.toString=function(){if(isNaN(this.n))return"+nan.0";if(this.n===Number.POSITIVE_INFINITY)return"+inf.0";if(this.n===Number.NEGATIVE_INFINITY)return"-inf.0";if(this===wb)return"-0.0";var d=this.n.toString();return d.match("\\.")?d:d+".0"};aa.prototype.equals=function(d,h){return d instanceof aa&&
this.n===d.n};aa.prototype.isRational=function(){return this.isFinite()};aa.prototype.isInteger=function(){return this.isFinite()&&this.n===Math.floor(this.n)};aa.prototype.isReal=function(){return!0};var Jb=function(d){return k(d,0)?-1:la(d,0)?1:d===wb?-1:0};aa.prototype.add=function(d){return this.isFinite()&&d.isFinite()?aa.makeInstance(this.n+d.n):isNaN(this.n)||isNaN(d.n)?Ib:this.isFinite()&&!d.isFinite()?d:!this.isFinite()&&d.isFinite()?this:1===Jb(this)*Jb(d)?this:Ib};aa.prototype.subtract=
function(d){return this.isFinite()&&d.isFinite()?aa.makeInstance(this.n-d.n):isNaN(this.n)||isNaN(d.n)?Ib:this.isFinite()||d.isFinite()?this.isFinite()?J(d,-1):this:Jb(this)===Jb(d)?Ib:this};aa.prototype.negate=function(){return aa.makeInstance(-this.n)};aa.prototype.multiply=function(d){return aa.makeInstance(this.n*d.n)};aa.prototype.divide=function(d){return aa.makeInstance(this.n/d.n)};aa.prototype.toFixnum=function(){return this.n};aa.prototype.numerator=function(){var d=this.n.toString().match(/^(.*)\.(.*)$/);
if(d){var h=parseInt(d[2]);d=Math.pow(10,d[2].length);h=zb(d,h);return aa.makeInstance(Math.round(d/h*this.n))}return this};aa.prototype.denominator=function(){var d=this.n.toString().match(/^(.*)\.(.*)$/);if(d){var h=parseInt(d[2]);d=Math.pow(10,d[2].length);h=zb(d,h);return aa.makeInstance(Math.round(d/h))}return aa.makeInstance(1)};aa.prototype.floor=function(){return aa.makeInstance(Math.floor(this.n))};aa.prototype.ceiling=function(){return aa.makeInstance(Math.ceil(this.n))};aa.prototype.greaterThan=
function(d){return this.n>d.n};aa.prototype.greaterThanOrEqual=function(d){return this.n>=d.n};aa.prototype.lessThan=function(d){return this.n<d.n};aa.prototype.lessThanOrEqual=function(d){return this.n<=d.n};aa.prototype.integerSqrt=function(){if(this===wb)return this;if(ha(this))return 0<=this.n?aa.makeInstance(Math.floor(Math.sqrt(this.n))):ya.makeInstance(Tb,aa.makeInstance(Math.floor(Math.sqrt(-this.n))));ta("integerSqrt: can only be applied to an integer",this)};aa.prototype.sqrt=function(){return 0>
this.n?ya.makeInstance(0,aa.makeInstance(Math.sqrt(-this.n))):aa.makeInstance(Math.sqrt(this.n))};aa.prototype.abs=function(){return aa.makeInstance(Math.abs(this.n))};aa.prototype.log=function(){return 0>this.n?(new ya(this,0)).log():aa.makeInstance(Math.log(this.n))};aa.prototype.angle=function(){return 0===this.n?0:0<this.n?0:aa.pi};aa.prototype.tan=function(){return aa.makeInstance(Math.tan(this.n))};aa.prototype.atan=function(){return aa.makeInstance(Math.atan(this.n))};aa.prototype.cos=function(){return aa.makeInstance(Math.cos(this.n))};
aa.prototype.sin=function(){return aa.makeInstance(Math.sin(this.n))};aa.prototype.expt=function(d){return 1===this.n?(d.isFinite()||isNaN(d.n),this):aa.makeInstance(Math.pow(this.n,d.n))};aa.prototype.exp=function(){return aa.makeInstance(Math.exp(this.n))};aa.prototype.acos=function(){return aa.makeInstance(Math.acos(this.n))};aa.prototype.asin=function(){return aa.makeInstance(Math.asin(this.n))};aa.prototype.imaginaryPart=function(){return 0};aa.prototype.realPart=function(){return this};aa.prototype.round=
function(){return isFinite(this.n)?this===wb?this:.5===Math.abs(Math.floor(this.n)-this.n)?0===Math.floor(this.n)%2?aa.makeInstance(Math.floor(this.n)):aa.makeInstance(Math.ceil(this.n)):aa.makeInstance(Math.round(this.n)):this};aa.prototype.conjugate=function(){return this};aa.prototype.magnitude=aa.prototype.abs;var ya=function(d,h){this.r=d;this.i=h};ya.makeInstance=function(d,h){void 0===h&&(h=0);if(L(h)&&ha(h)&&c(h))return d;if(U(d)||U(h))d=Ta(d),h=Ta(h);return new ya(d,h)};ya.prototype.toString=
function(){var d=this.r.toString(),h=this.i.toString();return"-"===h[0]||"+"===h[0]?d+h+"i":d+"+"+h+"i"};ya.prototype.isFinite=function(){return Gb(this.r)&&Gb(this.i)};ya.prototype.isRational=function(){return l(this.r)&&H(this.i,0)};ya.prototype.isInteger=function(){return ha(this.r)&&H(this.i,0)};ya.prototype.toExact=function(){return ya.makeInstance(Aa(this.r),Aa(this.i))};ya.prototype.toInexact=function(){return ya.makeInstance(Ta(this.r),Ta(this.i))};ya.prototype.isExact=function(){return L(this.r)&&
L(this.i)};ya.prototype.isInexact=function(){return U(this.r)||U(this.i)};ya.prototype.level=3;ya.prototype.liftTo=function(d){ta("Don't know how to lift Complex number",this,d)};ya.prototype.equals=function(d){return d instanceof ya&&A(this.r,d.r)&&A(this.i,d.i)};ya.prototype.greaterThan=function(d){this.isReal()&&d.isReal()||ta(">: expects argument of type real number",this,d);return la(this.r,d.r)};ya.prototype.greaterThanOrEqual=function(d){this.isReal()&&d.isReal()||ta(">=: expects argument of type real number",
this,d);return N(this.r,d.r)};ya.prototype.lessThan=function(d){this.isReal()&&d.isReal()||ta("<: expects argument of type real number",this,d);return k(this.r,d.r)};ya.prototype.lessThanOrEqual=function(d){this.isReal()&&d.isReal()||ta("<=: expects argument of type real number",this,d);return Z(this.r,d.r)};ya.prototype.abs=function(){A(this.i,0).valueOf()||ta("abs: expects argument of type real number",this);return Va(this.r)};ya.prototype.toFixnum=function(){A(this.i,0).valueOf()||ta("toFixnum: expects argument of type real number",
this);return xa(this.r)};ya.prototype.numerator=function(){this.isReal()||ta("numerator: can only be applied to real number",this);return qa(this.n)};ya.prototype.denominator=function(){this.isReal()||ta("floor: can only be applied to real number",this);return Ga(this.n)};ya.prototype.add=function(d){return ya.makeInstance(Ha(this.r,d.r),Ha(this.i,d.i))};ya.prototype.subtract=function(d){return ya.makeInstance(B(this.r,d.r),B(this.i,d.i))};ya.prototype.negate=function(){return ya.makeInstance(fb(this.r),
fb(this.i))};ya.prototype.multiply=function(d){if(d.isReal())return ya.makeInstance(J(this.r,d.r),J(this.i,d.r));var h=B(J(this.r,d.r),J(this.i,d.i));d=Ha(J(this.r,d.i),J(this.i,d.r));return ya.makeInstance(h,d)};ya.prototype.divide=function(d){if(d.isReal())return ya.makeInstance(Y(this.r,d.r),Y(this.i,d.r));if(this.isInexact()||d.isInexact()){var h=this.r;var z=this.i;var I=d.r;var S=d.i;if(Z(Va(S),Va(I))){var ea=Y(S,I);d=Y(Ha(h,J(z,ea)),Ha(I,J(S,ea)));h=Y(B(z,J(h,ea)),Ha(I,J(S,ea)))}else ea=Y(I,
S),d=Y(Ha(J(h,ea),z),Ha(J(I,ea),S)),h=Y(B(J(z,ea),h),Ha(J(I,ea),S));return ya.makeInstance(d,h)}z=Ja(d);h=J(this,z);z=ob(J(d,z));return ya.makeInstance(Y(ob(h),z),Y(rb(h),z))};ya.prototype.conjugate=function(){return ya.makeInstance(this.r,B(0,this.i))};ya.prototype.magnitude=function(){var d=Ha(J(this.r,this.r),J(this.i,this.i));return Ea(d)};ya.prototype.isReal=function(){return H(this.i,0)};ya.prototype.integerSqrt=function(){if(ha(this))return Cb(this.r);ta("integerSqrt: can only be applied to an integer",
this)};ya.prototype.sqrt=function(){if(this.isReal())return Ea(this.r);var d=Ha(this.magnitude(),this.r),h=Ea(Y(d,2));d=Y(this.i,Ea(J(d,2)));return ya.makeInstance(h,d)};ya.prototype.log=function(){var d=this.magnitude(),h=this.angle();return Ha(t(d),J(h,tb))};ya.prototype.angle=function(){if(this.isReal())return Ya(this.r);if(A(0,this.r)){var d=Y(aa.pi,2);return la(this.i,0)?d:fb(d)}d=cb(Y(Va(this.i),Va(this.r)));return la(this.r,0)?la(this.i,0)?d:fb(d):la(this.i,0)?B(aa.pi,d):B(d,aa.pi)};var tb=
ya.makeInstance(0,1),Ub=ya.makeInstance(0,-1);ya.prototype.tan=function(){return Y(this.sin(),this.cos())};ya.prototype.atan=function(){return A(this,tb)||A(this,Ub)?Qb:J(tb,J(aa.makeInstance(.5),t(Y(Ha(tb,this),Ha(tb,B(0,this))))))};ya.prototype.cos=function(){if(this.isReal())return jb(this.r);var d=J(this,tb),h=fb(d);return Y(Ha(K(d),K(h)),2)};ya.prototype.sin=function(){if(this.isReal())return sb(this.r);var d=J(this,tb),h=fb(d),z=ya.makeInstance(0,2);d=B(K(d),K(h));return Y(d,z)};ya.prototype.expt=
function(d){if(ra(d)&&N(d,0))return Hb(this,d);d=J(d,this.log());return K(d)};ya.prototype.exp=function(){var d=K(this.r),h=jb(this.i),z=sb(this.i);return J(d,Ha(h,J(z,tb)))};ya.prototype.acos=function(){if(this.isReal())return Bb(this.r);var d=Y(aa.pi,2),h=J(this,tb),z=Ea(B(1,pb(this)));h=J(t(Ha(h,z)),tb);return Ha(d,h)};ya.prototype.asin=function(){if(this.isReal())return Mb(this.r);var d=B(1,pb(this));d=Ea(d);return J(2,cb(Y(this,Ha(1,d))))};ya.prototype.ceiling=function(){this.isReal()||ta("ceiling: can only be applied to real number",
this);return db(this.r)};ya.prototype.floor=function(){this.isReal()||ta("floor: can only be applied to real number",this);return Ka(this.r)};ya.prototype.imaginaryPart=function(){return this.i};ya.prototype.realPart=function(){return this.r};ya.prototype.round=function(){this.isReal()||ta("round: can only be applied to real number",this);return Fb(this.r)};var Wb=RegExp("^(#[ei]#[bodx]|#[bodx]#[ei]|#[bodxei])(.*)$");q.def=new q(0);q.on=new q(1);q.off=new q(2);q.prototype.intAsExactp=function(){return this.defaultp()||
this.exactp()};q.prototype.floatAsInexactp=function(){return this.defaultp()||this.inexactp()};if("undefined"!==typeof navigator&&"Microsoft Internet Explorer"==navigator.appName){C.prototype.am=v;var Ab=30}else"undefined"!==typeof navigator&&"Netscape"!=navigator.appName?(C.prototype.am=na,Ab=26):(C.prototype.am=u,Ab=28);C.prototype.DB=Ab;C.prototype.DM=(1<<Ab)-1;C.prototype.DV=1<<Ab;C.prototype.FV=Math.pow(2,52);C.prototype.F1=52-Ab;C.prototype.F2=2*Ab-52;var Lb=[],qb;var Kb=48;for(qb=0;9>=qb;++qb)Lb[Kb++]=
qb;Kb=97;for(qb=10;36>qb;++qb)Lb[Kb++]=qb;Kb=65;for(qb=10;36>qb;++qb)Lb[Kb++]=qb;X.prototype.convert=function(d){return 0>d.s||0<=d.compareTo(this.m)?d.mod(this.m):d};X.prototype.revert=function(d){return d};X.prototype.reduce=function(d){d.divRemTo(this.m,null,d)};X.prototype.mulTo=function(d,h,z){d.multiplyTo(h,z);this.reduce(z)};X.prototype.sqrTo=function(d,h){d.squareTo(h);this.reduce(h)};ia.prototype.convert=function(d){var h=da();d.abs().dlShiftTo(this.m.t,h);h.divRemTo(this.m,null,h);0>d.s&&
0<h.compareTo(C.ZERO)&&this.m.subTo(h,h);return h};ia.prototype.revert=function(d){var h=da();d.copyTo(h);this.reduce(h);return h};ia.prototype.reduce=function(d){for(;d.t<=this.mt2;)d[d.t++]=0;for(var h=0;h<this.m.t;++h){var z=d[h]&32767,I=z*this.mpl+((z*this.mph+(d[h]>>15)*this.mpl&this.um)<<15)&d.DM;z=h+this.m.t;for(d[z]+=this.m.am(0,I,d,h,0,this.m.t);d[z]>=d.DV;)d[z]-=d.DV,d[++z]++}d.clamp();d.drShiftTo(this.m.t,d);0<=d.compareTo(this.m)&&d.subTo(this.m,d)};ia.prototype.mulTo=function(d,h,z){d.multiplyTo(h,
z);this.reduce(z)};ia.prototype.sqrTo=function(d,h){d.squareTo(h);this.reduce(h)};C.prototype.copyTo=function(d){for(var h=this.t-1;0<=h;--h)d[h]=this[h];d.t=this.t;d.s=this.s};C.prototype.fromInt=function(d){this.t=1;this.s=0>d?-1:0;0<d?this[0]=d:-1>d?this[0]=d+DV:this.t=0};C.prototype.fromString=function(d,h){if(16==h)h=4;else if(8==h)h=3;else if(256==h)h=8;else if(2==h)h=1;else if(32==h)h=5;else if(4==h)h=2;else{this.fromRadix(d,h);return}this.s=this.t=0;for(var z=d.length,I=!1,S=0;0<=--z;){var ea=
8==h?d[z]&255:G(d,z);0>ea?"-"==d.charAt(z)&&(I=!0):(I=!1,0==S?this[this.t++]=ea:S+h>this.DB?(this[this.t-1]|=(ea&(1<<this.DB-S)-1)<<S,this[this.t++]=ea>>this.DB-S):this[this.t-1]|=ea<<S,S+=h,S>=this.DB&&(S-=this.DB))}8==h&&0!=(d[0]&128)&&(this.s=-1,0<S&&(this[this.t-1]|=(1<<this.DB-S)-1<<S));this.clamp();I&&C.ZERO.subTo(this,this)};C.prototype.clamp=function(){for(var d=this.s&this.DM;0<this.t&&this[this.t-1]==d;)--this.t};C.prototype.dlShiftTo=function(d,h){var z;for(z=this.t-1;0<=z;--z)h[z+d]=this[z];
for(z=d-1;0<=z;--z)h[z]=0;h.t=this.t+d;h.s=this.s};C.prototype.drShiftTo=function(d,h){for(var z=d;z<this.t;++z)h[z-d]=this[z];h.t=Math.max(this.t-d,0);h.s=this.s};C.prototype.lShiftTo=function(d,h){var z=d%this.DB,I=this.DB-z,S=(1<<I)-1;d=Math.floor(d/this.DB);var ea=this.s<<z&this.DM,va;for(va=this.t-1;0<=va;--va)h[va+d+1]=this[va]>>I|ea,ea=(this[va]&S)<<z;for(va=d-1;0<=va;--va)h[va]=0;h[d]=ea;h.t=this.t+d+1;h.s=this.s;h.clamp()};C.prototype.rShiftTo=function(d,h){h.s=this.s;var z=Math.floor(d/
this.DB);if(z>=this.t)h.t=0;else{d%=this.DB;var I=this.DB-d,S=(1<<d)-1;h[0]=this[z]>>d;for(var ea=z+1;ea<this.t;++ea)h[ea-z-1]|=(this[ea]&S)<<I,h[ea-z]=this[ea]>>d;0<d&&(h[this.t-z-1]|=(this.s&S)<<I);h.t=this.t-z;h.clamp()}};C.prototype.subTo=function(d,h){for(var z=0,I=0,S=Math.min(d.t,this.t);z<S;)I+=this[z]-d[z],h[z++]=I&this.DM,I>>=this.DB;if(d.t<this.t){for(I-=d.s;z<this.t;)I+=this[z],h[z++]=I&this.DM,I>>=this.DB;I+=this.s}else{for(I+=this.s;z<d.t;)I-=d[z],h[z++]=I&this.DM,I>>=this.DB;I-=d.s}h.s=
0>I?-1:0;-1>I?h[z++]=this.DV+I:0<I&&(h[z++]=I);h.t=z;h.clamp()};C.prototype.multiplyTo=function(d,h){var z=this.abs(),I=d.abs(),S=z.t;for(h.t=S+I.t;0<=--S;)h[S]=0;for(S=0;S<I.t;++S)h[S+z.t]=z.am(0,I[S],h,S,0,z.t);h.s=0;h.clamp();this.s!=d.s&&C.ZERO.subTo(h,h)};C.prototype.squareTo=function(d){for(var h=this.abs(),z=d.t=2*h.t;0<=--z;)d[z]=0;for(z=0;z<h.t-1;++z){var I=h.am(z,h[z],d,2*z,0,1);(d[z+h.t]+=h.am(z+1,2*h[z],d,2*z+1,I,h.t-z-1))>=h.DV&&(d[z+h.t]-=h.DV,d[z+h.t+1]=1)}0<d.t&&(d[d.t-1]+=h.am(z,
h[z],d,2*z,0,1));d.s=0;d.clamp()};C.prototype.divRemTo=function(d,h,z){var I=d.abs();if(!(0>=I.t)){var S=this.abs();if(S.t<I.t)null!=h&&h.fromInt(0),null!=z&&this.copyTo(z);else{null==z&&(z=da());var ea=da(),va=this.s;d=d.s;var Ma=this.DB-O(I[I.t-1]);0<Ma?(I.lShiftTo(Ma,ea),S.lShiftTo(Ma,z)):(I.copyTo(ea),S.copyTo(z));I=ea.t;S=ea[I-1];if(0!=S){var ib=S*(1<<this.F1)+(1<I?ea[I-2]>>this.F2:0),gb=this.FV/ib;ib=(1<<this.F1)/ib;var Nb=1<<this.F2,hb=z.t,ub=hb-I,yb=null==h?da():h;ea.dlShiftTo(ub,yb);0<=z.compareTo(yb)&&
(z[z.t++]=1,z.subTo(yb,z));C.ONE.dlShiftTo(I,yb);for(yb.subTo(ea,ea);ea.t<I;)ea[ea.t++]=0;for(;0<=--ub;){var Pb=z[--hb]==S?this.DM:Math.floor(z[hb]*gb+(z[hb-1]+Nb)*ib);if((z[hb]+=ea.am(0,Pb,z,ub,0,I))<Pb)for(ea.dlShiftTo(ub,yb),z.subTo(yb,z);z[hb]<--Pb;)z.subTo(yb,z)}null!=h&&(z.drShiftTo(I,h),va!=d&&C.ZERO.subTo(h,h));z.t=I;z.clamp();0<Ma&&z.rShiftTo(Ma,z);0>va&&C.ZERO.subTo(z,z)}}}};C.prototype.invDigit=function(){if(1>this.t)return 0;var d=this[0];if(0==(d&1))return 0;var h=d&3;h=h*(2-(d&15)*h)&
15;h=h*(2-(d&255)*h)&255;h=h*(2-((d&65535)*h&65535))&65535;h=h*(2-d*h%this.DV)%this.DV;return 0<h?this.DV-h:-h};C.prototype.isEven=function(){return 0==(0<this.t?this[0]&1:this.s)};C.prototype.bnpExp=function(d,h){if(4294967295<d||1>d)return C.ONE;var z=da(),I=da(),S=h.convert(this),ea=O(d)-1;for(S.copyTo(z);0<=--ea;)if(h.sqrTo(z,I),0<(d&1<<ea))h.mulTo(I,S,z);else{var va=z;z=I;I=va}return h.revert(z)};C.prototype.toString=function(d){if(0>this.s)return"-"+this.negate().toString(d);if(16==d)d=4;else if(8==
d)d=3;else if(2==d)d=1;else if(32==d)d=5;else if(4==d)d=2;else return this.toRadix(d);var h=(1<<d)-1,z,I=!1,S=[],ea=this.t,va=this.DB-ea*this.DB%d;if(0<ea--)for(va<this.DB&&0<(z=this[ea]>>va)&&(I=!0,S.push("0123456789abcdefghijklmnopqrstuvwxyz".charAt(z)));0<=ea;)va<d?(z=(this[ea]&(1<<va)-1)<<d-va,z|=this[--ea]>>(va+=this.DB-d)):(z=this[ea]>>(va-=d)&h,0>=va&&(va+=this.DB,--ea)),0<z&&(I=!0),I&&S.push("0123456789abcdefghijklmnopqrstuvwxyz".charAt(z));return I?S.join(""):"0"};C.prototype.negate=function(){var d=
da();C.ZERO.subTo(this,d);return d};C.prototype.abs=function(){return 0>this.s?this.negate():this};C.prototype.compareTo=E;C.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+O(this[this.t-1]^this.s&this.DM)};C.prototype.mod=P;C.prototype.modPowInt=function(d,h){h=256>d||h.isEven()?new X(h):new ia(h);return this.exp(d,h)};C.ZERO=F(0);C.ONE=F(1);Ra.prototype.convert=bb;Ra.prototype.revert=bb;Ra.prototype.mulTo=function(d,h,z){d.multiplyTo(h,z)};Ra.prototype.sqrTo=function(d,h){d.squareTo(h)};
za.prototype.convert=function(d){if(0>d.s||d.t>2*this.m.t)return d.mod(this.m);if(0>d.compareTo(this.m))return d;var h=da();d.copyTo(h);this.reduce(h);return h};za.prototype.revert=function(d){return d};za.prototype.reduce=function(d){d.drShiftTo(this.m.t-1,this.r2);d.t>this.m.t+1&&(d.t=this.m.t+1,d.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>d.compareTo(this.r2);)d.dAddOffset(1,this.m.t+1);for(d.subTo(this.r2,d);0<=d.compareTo(this.m);)d.subTo(this.m,
d)};za.prototype.mulTo=function(d,h,z){d.multiplyTo(h,z);this.reduce(z)};za.prototype.sqrTo=function(d,h){d.squareTo(h);this.reduce(h)};var nb=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],
Xb=67108864/nb[nb.length-1];C.prototype.chunkSize=function(d){return Math.floor(Math.LN2*this.DB/Math.log(d))};C.prototype.toRadix=function(d){null==d&&(d=10);if(0==this.signum()||2>d||36<d)return"0";var h=this.chunkSize(d);h=Math.pow(d,h);var z=F(h),I=da(),S=da(),ea="";for(this.divRemTo(z,I,S);0<I.signum();)ea=(h+S.intValue()).toString(d).substr(1)+ea,I.divRemTo(z,I,S);return S.intValue().toString(d)+ea};C.prototype.fromRadix=function(d,h){this.fromInt(0);null==h&&(h=10);for(var z=this.chunkSize(h),
I=Math.pow(h,z),S=!1,ea=0,va=0,Ma=0;Ma<d.length;++Ma){var ib=G(d,Ma);0>ib?"-"==d.charAt(Ma)&&0==this.signum()&&(S=!0):(va=h*va+ib,++ea>=z&&(this.dMultiply(I),this.dAddOffset(va,0),va=ea=0))}0<ea&&(this.dMultiply(Math.pow(h,ea)),this.dAddOffset(va,0));S&&C.ZERO.subTo(this,this)};C.prototype.fromNumber=function(d,h,z){if("number"==typeof h)if(2>d)this.fromInt(1);else for(this.fromNumber(d,z),this.testBit(d-1)||this.bitwiseTo(C.ONE.shiftLeft(d-1),wa,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(h);)this.dAddOffset(2,
0),this.bitLength()>d&&this.subTo(C.ONE.shiftLeft(d-1),this);else{z=[];var I=d&7;z.length=(d>>3)+1;h.nextBytes(z);z[0]=0<I?z[0]&(1<<I)-1:0;this.fromString(z,256)}};C.prototype.bitwiseTo=function(d,h,z){var I,S=Math.min(d.t,this.t);for(I=0;I<S;++I)z[I]=h(this[I],d[I]);if(d.t<this.t){var ea=d.s&this.DM;for(I=S;I<this.t;++I)z[I]=h(this[I],ea);z.t=this.t}else{ea=this.s&this.DM;for(I=S;I<d.t;++I)z[I]=h(ea,d[I]);z.t=d.t}z.s=h(this.s,d.s);z.clamp()};C.prototype.changeBit=function(d,h){d=C.ONE.shiftLeft(d);
this.bitwiseTo(d,h,d);return d};C.prototype.addTo=function(d,h){for(var z=0,I=0,S=Math.min(d.t,this.t);z<S;)I+=this[z]+d[z],h[z++]=I&this.DM,I>>=this.DB;if(d.t<this.t){for(I+=d.s;z<this.t;)I+=this[z],h[z++]=I&this.DM,I>>=this.DB;I+=this.s}else{for(I+=this.s;z<d.t;)I+=d[z],h[z++]=I&this.DM,I>>=this.DB;I+=d.s}h.s=0>I?-1:0;0<I?h[z++]=I:-1>I&&(h[z++]=this.DV+I);h.t=z;h.clamp()};C.prototype.dMultiply=function(d){this[this.t]=this.am(0,d-1,this,0,0,this.t);++this.t;this.clamp()};C.prototype.dAddOffset=
function(d,h){if(0!=d){for(;this.t<=h;)this[this.t++]=0;for(this[h]+=d;this[h]>=this.DV;)this[h]-=this.DV,++h>=this.t&&(this[this.t++]=0),++this[h]}};C.prototype.multiplyLowerTo=function(d,h,z){var I=Math.min(this.t+d.t,h);z.s=0;for(z.t=I;0<I;)z[--I]=0;var S;for(S=z.t-this.t;I<S;++I)z[I+this.t]=this.am(0,d[I],z,I,0,this.t);for(S=Math.min(d.t,h);I<S;++I)this.am(0,d[I],z,I,0,h-I);z.clamp()};C.prototype.multiplyUpperTo=function(d,h,z){--h;var I=z.t=this.t+d.t-h;for(z.s=0;0<=--I;)z[I]=0;for(I=Math.max(h-
this.t,0);I<d.t;++I)z[this.t+I-h]=this.am(h-I,d[I],z,0,0,this.t+I-h);z.clamp();z.drShiftTo(1,z)};C.prototype.modInt=function(d){if(0>=d)return 0;var h=this.DV%d,z=0>this.s?d-1:0;if(0<this.t)if(0==h)z=this[0]%d;else for(var I=this.t-1;0<=I;--I)z=(h*z+this[I])%d;return z};C.prototype.millerRabin=function(d){var h=this.subtract(C.ONE),z=h.getLowestSetBit();if(0>=z)return!1;var I=h.shiftRight(z);d=d+1>>1;d>nb.length&&(d=nb.length);for(var S=da(),ea=0;ea<d;++ea){S.fromInt(nb[ea]);var va=S.modPow(I,this);
if(0!=va.compareTo(C.ONE)&&0!=va.compareTo(h)){for(var Ma=1;Ma++<z&&0!=va.compareTo(h);)if(va=va.modPowInt(2,this),0==va.compareTo(C.ONE))return!1;if(0!=va.compareTo(h))return!1}}return!0};C.prototype.clone=function(){var d=da();this.copyTo(d);return d};C.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]};C.prototype.byteValue=function(){return 0==
this.t?this.s:this[0]<<24>>24};C.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16};C.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1};C.prototype.toByteArray=function(){var d=this.t,h=[];h[0]=this.s;var z=this.DB-d*this.DB%8,I,S=0;if(0<d--)for(z<this.DB&&(I=this[d]>>z)!=(this.s&this.DM)>>z&&(h[S++]=I|this.s<<this.DB-z);0<=d;)if(8>z?(I=(this[d]&(1<<z)-1)<<8-z,I|=this[--d]>>(z+=this.DB-8)):(I=this[d]>>(z-=8)&255,0>=z&&(z+=this.DB,--d)),0!=(I&
128)&&(I|=-256),0==S&&(this.s&128)!=(I&128)&&++S,0<S||I!=this.s)h[S++]=I;return h};C.prototype.equals=Ba;C.prototype.min=function(d){return 0>this.compareTo(d)?this:d};C.prototype.max=function(d){return 0<this.compareTo(d)?this:d};C.prototype.and=function(d){var h=da();this.bitwiseTo(d,ma,h);return h};C.prototype.or=function(d){var h=da();this.bitwiseTo(d,wa,h);return h};C.prototype.xor=function(d){var h=da();this.bitwiseTo(d,ka,h);return h};C.prototype.andNot=function(d){var h=da();this.bitwiseTo(d,
oa,h);return h};C.prototype.not=function(){for(var d=da(),h=0;h<this.t;++h)d[h]=this.DM&~this[h];d.t=this.t;d.s=~this.s;return d};C.prototype.shiftLeft=function(d){var h=da();0>d?this.rShiftTo(-d,h):this.lShiftTo(d,h);return h};C.prototype.shiftRight=function(d){var h=da();0>d?this.lShiftTo(-d,h):this.rShiftTo(d,h);return h};C.prototype.getLowestSetBit=function(){for(var d=0;d<this.t;++d)if(0!=this[d]){var h=d*this.DB;d=this[d];if(0==d)d=-1;else{var z=0;0==(d&65535)&&(d>>=16,z+=16);0==(d&255)&&(d>>=
8,z+=8);0==(d&15)&&(d>>=4,z+=4);0==(d&3)&&(d>>=2,z+=2);0==(d&1)&&++z;d=z}return h+d}return 0>this.s?this.t*this.DB:-1};C.prototype.bitCount=function(){for(var d=0,h=this.s&this.DM,z=0;z<this.t;++z){for(var I=this[z]^h,S=0;0!=I;)I&=I-1,++S;d+=S}return d};C.prototype.testBit=function(d){var h=Math.floor(d/this.DB);return h>=this.t?0!=this.s:0!=(this[h]&1<<d%this.DB)};C.prototype.setBit=function(d){return this.changeBit(d,wa)};C.prototype.clearBit=function(d){return this.changeBit(d,oa)};C.prototype.flipBit=
function(d){return this.changeBit(d,ka)};C.prototype.add=ca;C.prototype.subtract=ua;C.prototype.multiply=Qa;C.prototype.divide=Sa;C.prototype.remainder=Xa;C.prototype.divideAndRemainder=Oa;C.prototype.modPow=function(d,h){var z=d.bitLength(),I=F(1);if(0>=z)return I;var S=18>z?1:48>z?3:144>z?4:768>z?5:6;h=8>z?new X(h):h.isEven()?new za(h):new ia(h);var ea=[],va=3,Ma=S-1,ib=(1<<S)-1;ea[1]=h.convert(this);if(1<S)for(z=da(),h.sqrTo(ea[1],z);va<=ib;)ea[va]=da(),h.mulTo(z,ea[va-2],ea[va]),va+=2;var gb=
d.t-1,Nb=!0,hb=da();for(z=O(d[gb])-1;0<=gb;){if(z>=Ma)var ub=d[gb]>>z-Ma&ib;else ub=(d[gb]&(1<<z+1)-1)<<Ma-z,0<gb&&(ub|=d[gb-1]>>this.DB+z-Ma);for(va=S;0==(ub&1);)ub>>=1,--va;0>(z-=va)&&(z+=this.DB,--gb);if(Nb)ea[ub].copyTo(I),Nb=!1;else{for(;1<va;)h.sqrTo(I,hb),h.sqrTo(hb,I),va-=2;0<va?h.sqrTo(I,hb):(va=I,I=hb,hb=va);h.mulTo(hb,ea[ub],I)}for(;0<=gb&&0==(d[gb]&1<<z);)h.sqrTo(I,hb),va=I,I=hb,hb=va,0>--z&&(z=this.DB-1,--gb)}return h.revert(I)};C.prototype.modInverse=function(d){var h=d.isEven();if(this.isEven()&&
h||0==d.signum())return C.ZERO;for(var z=d.clone(),I=this.clone(),S=F(1),ea=F(0),va=F(0),Ma=F(1);0!=z.signum();){for(;z.isEven();)z.rShiftTo(1,z),h?(S.isEven()&&ea.isEven()||(S.addTo(this,S),ea.subTo(d,ea)),S.rShiftTo(1,S)):ea.isEven()||ea.subTo(d,ea),ea.rShiftTo(1,ea);for(;I.isEven();)I.rShiftTo(1,I),h?(va.isEven()&&Ma.isEven()||(va.addTo(this,va),Ma.subTo(d,Ma)),va.rShiftTo(1,va)):Ma.isEven()||Ma.subTo(d,Ma),Ma.rShiftTo(1,Ma);0<=z.compareTo(I)?(z.subTo(I,z),h&&S.subTo(va,S),ea.subTo(Ma,ea)):(I.subTo(z,
I),h&&va.subTo(S,va),Ma.subTo(ea,Ma))}if(0!=I.compareTo(C.ONE))return C.ZERO;if(0<=Ma.compareTo(d))return Ma.subtract(d);if(0>Ma.signum())Ma.addTo(d,Ma);else return Ma;return 0>Ma.signum()?Ma.add(d):Ma};C.prototype.pow=Na;C.prototype.expt=Na;C.prototype.gcd=Da;C.prototype.isProbablePrime=function(d){var h,z=this.abs();if(1==z.t&&z[0]<=nb[nb.length-1]){for(h=0;h<nb.length;++h)if(z[0]==nb[h])return!0;return!1}if(z.isEven())return!1;for(h=1;h<nb.length;){for(var I=nb[h],S=h+1;S<nb.length&&I<Xb;)I*=nb[S++];
for(I=z.modInt(I);h<S;)if(0==I%nb[h++])return!1}return z.millerRabin(d)};C.NEGATIVE_ONE=C.ONE.negate();var eb=function(d){"number"===typeof d&&(d+="");d=pa(d);return new C(d,10)};C.prototype.level=0;C.prototype.liftTo=function(d){return 1===d.level?new Ia(this,1):2===d.level?(d=this.toFixnum(),d===Number.POSITIVE_INFINITY?Rb:d===Number.NEGATIVE_INFINITY?Sb:new aa(d)):3===d.level?new ya(this,0):ta("invalid level for BigInteger lift",this,d)};C.prototype.isFinite=function(){return!0};C.prototype.isInteger=
function(){return!0};C.prototype.isRational=function(){return!0};C.prototype.isReal=function(){return!0};C.prototype.isExact=function(){return!0};C.prototype.isInexact=function(){return!1};C.prototype.toExact=function(){return this};C.prototype.toInexact=function(){return aa.makeInstance(this.toFixnum())};C.prototype.toFixnum=function(){var d=0,h=this.toString(),z;if("-"===h[0]){for(z=1;z<h.length;z++)d=10*d+Number(h[z]);return-d}for(z=0;z<h.length;z++)d=10*d+Number(h[z]);return d};C.prototype.greaterThan=
function(d){return 0<this.compareTo(d)};C.prototype.greaterThanOrEqual=function(d){return 0<=this.compareTo(d)};C.prototype.lessThan=function(d){return 0>this.compareTo(d)};C.prototype.lessThanOrEqual=function(d){return 0>=this.compareTo(d)};C.prototype.divide=function(d){var h=Oa.call(this,d);return 0===h[1].compareTo(C.ZERO)?h[0]:Ha(h[0],Ia.makeInstance(h[1],d))};C.prototype.numerator=function(){return this};C.prototype.denominator=function(){return 1};(function(){var d=function(h,z){for(;!Z(pb(z),
h)||!k(h,pb(Ha(z,1)));)z=Ka(Y(Ha(z,Ka(Y(h,z))),2));return z};C.prototype.integerSqrt=function(){if(0<=Jb(this))return d(this,this);var h=this.negate();return ya.makeInstance(0,d(h,h))}})();(function(){C.prototype.sqrt=function(){var d=this.integerSqrt();if(H(pb(d),this))return d;var h=xa(this);return isFinite(h)?0<=h?aa.makeInstance(Math.sqrt(h)):ya.makeInstance(0,aa.makeInstance(Math.sqrt(-h))):d}})();C.prototype.floor=function(){return this};C.prototype.ceiling=function(){return this};C.prototype.conjugate=
Fa("conjugate");C.prototype.magnitude=Fa("magnitude");C.prototype.log=Fa("log");C.prototype.angle=Fa("angle");C.prototype.atan=Fa("atan");C.prototype.acos=Fa("acos");C.prototype.asin=Fa("asin");C.prototype.tan=Fa("tan");C.prototype.cos=Fa("cos");C.prototype.sin=Fa("sin");C.prototype.exp=Fa("exp");C.prototype.imaginaryPart=function(){return 0};C.prototype.realPart=function(){return this};C.prototype.round=function(){return this};var Yb=function(){return function(d,h,z){var I=512;z&&"undefined"!==typeof z.limit&&
(I=z.limit);ha(d)||ta("toRepeatingDecimal: n "+d.toString()+" is not an integer.");ha(h)||ta("toRepeatingDecimal: d "+h.toString()+" is not an integer.");A(h,0)&&ta("toRepeatingDecimal: d equals 0");k(h,0)&&ta("toRepeatingDecimal: d < 0");z=k(d,0)?"-":"";d=Va(d);z+=xb(d,h);a:{d=vb(d,h);var S=I;I=[];var ea={};for(ea[d]=!0;;){if(0>=S--){h=[I.join(""),"..."];break a}var va=xb(J(d,10),h);d=vb(J(d,10),h);I.push(va.toString());if(ea[d])break;else ea[d]=!0}ea=d;for(S=[];va=xb(J(d,10),h),d=vb(J(d,10),h),
S.push(va.toString()),!A(d,ea););h=I.join("");for(d=S.join("");h.length>=d.length&&h.substring(h.length-d.length)===d;)h=h.substring(0,h.length-d.length);h=[h,d]}return[z].concat(h)}}();Q.fromFixnum=function(d){if(isNaN(d)||!isFinite(d))return aa.makeInstance(d);var h=Math.floor(d);return h===d?mb(h)?eb(pa(d+"")):h:aa.makeInstance(d)};Q.fromString=function(d,h){var z=10;h="undefined"===typeof h?q.def:!0===h?q.on:!1===h?q.off:ta("exactness must be true or false",this,r);var I=d.toLowerCase().match(Wb);
if(I){var S=I[1].toLowerCase(),ea=S.match(RegExp("(#[ei])"));S=S.match(RegExp("(#[bodx])"));ea&&(ea=ea[1].charAt(1),h="e"===ea?q.on:"i"===ea?q.off:ta("invalid exactness flag",this,r));S&&(ea=S[1].charAt(1),z="b"===ea?2:"o"===ea?8:"d"===ea?10:"x"===ea?16:ta("invalid radix flag",this,r))}d=I?I[2]:d;I=I?!0:!1;S=fa(z);var va="["+ja(z)+"]",Ma="["+S+"]+";ea=Ma+"/"+Ma;S="(?:(?:"+(Ma+"|["+(S+"]*\\.["+S+"]+|[")+(S+"]+\\.["+S+"]*)|"))+ea+")(?:"+va+"[+-]?"+Ma+")?";va="(?:[+-]?"+S+"|[+-](?:inf.0|nan.0|inf.f|nan.f))";
S=new RegExp("^("+va+")?([+-](?:"+(S+"|(?:inf.0|nan.0|inf.f|nan.f))?)i$"));va=new RegExp("^("+va+")@("+va+")$");ea=d.match(new RegExp("^([+-]?"+ea+")([+-]"+ea+"?)i$"));S=d.match(S);va=d.match(va);d=(ea=ea?ea:S?S:va?va:!1)?ya.makeInstance(m(ea[1]||"0",z,h),m("+"===ea[2]?"1":"-"===ea[2]?"-1":ea[2],z,h)):m(d,z,h,I);return d};Q.makeBignum=eb;Q.makeRational=Ia.makeInstance;Q.makeFloat=aa.makeInstance;Q.makeComplex=ya.makeInstance;Q.makeComplexPolar=function(d,h){return H(h,0)?d:ya.makeInstance(J(d,jb(h)),
J(d,sb(h)))};Q.pi=aa.pi;Q.e=aa.e;Q.nan=aa.nan;Q.negative_inf=aa.neginf;Q.inf=aa.inf;Q.negative_one=-1;Q.zero=0;Q.one=1;Q.i=tb;Q.negative_i=Ub;Q.negative_zero=wb;Q.onThrowRuntimeError=function(d,h,z){throw Error(d);};Q.isSchemeNumber=Ua;Q.isRational=l;Q.isReal=D;Q.isExact=L;Q.isInexact=U;Q.isInteger=ha;Q.toFixnum=xa;Q.toExact=Aa;Q.toInexact=Ta;Q.add=Ha;Q.subtract=B;Q.multiply=J;Q.divide=Y;Q.equals=A;Q.eqv=H;Q.approxEquals=function(d,h,z){return k(Va(B(d,h)),z)};Q.greaterThanOrEqual=N;Q.lessThanOrEqual=
Z;Q.greaterThan=la;Q.lessThan=k;Q.expt=y;Q.exp=K;Q.modulo=T;Q.numerator=qa;Q.denominator=Ga;Q.integerSqrt=Cb;Q.sqrt=Ea;Q.abs=Va;Q.quotient=xb;Q.remainder=vb;Q.floor=Ka;Q.ceiling=db;Q.conjugate=Ja;Q.magnitude=function(d){return"number"===typeof d?Math.abs(d):d.magnitude()};Q.log=t;Q.angle=Ya;Q.tan=ab;Q.atan=cb;Q.cos=jb;Q.sin=sb;Q.tan=ab;Q.acos=Bb;Q.asin=Mb;Q.cosh=function(d){return H(d,0)?aa.makeInstance(1):Y(Ha(K(d),K(fb(d))),2)};Q.sinh=function(d){return Y(B(K(d),K(fb(d))),2)};Q.imaginaryPart=rb;
Q.realPart=ob;Q.round=Fb;Q.sqr=pb;Q.gcd=function(d,h){ha(d)||ta("gcd: the argument "+d.toString()+" is not an integer.",d);d=Va(d);for(var z,I,S=0;S<h.length;S++)for(I=Va(h[S]),ha(I)||ta("gcd: the argument "+I.toString()+" is not an integer.",I);!c(I);)z=d,d=I,I=Eb(z,I);return d};Q.lcm=function(d,h){ha(d)||ta("lcm: the argument "+d.toString()+" is not an integer.",d);d=Va(d);if(c(d))return 0;for(var z=0;z<h.length;z++){ha(h[z])||ta("lcm: the argument "+h[z].toString()+" is not an integer.",h[z]);
var I=zb(d,h[z]);if(c(I))return 0;d=Y(J(d,h[z]),I)}return d};Q.toRepeatingDecimal=Yb;Q.BigInteger=C;Q.Rational=Ia;Q.FloatPoint=aa;Q.Complex=ya;Q.MIN_FIXNUM=-9E15;Q.MAX_FIXNUM=9E15})();
var _Hashtable=function(){function W(P){return"function"===typeof P}function fa(P){return"string"===typeof P?P:W(P.hashCode)?(P=P.hashCode(),"string"!==typeof P?fa(P):P):W(P.toString)?P.toString():String(P)}function ja(P,X){return P.equals(X)}function q(P,X){return W(X.equals)?X.equals(P):P===X}function m(P,X){return P===X}function C(P,X,ia,Ba,ma){for(var wa,ka=0,oa=P.length;ka<oa;ka++)if(wa=P[ka],ma(X,ia(wa)))return Ba?[ka,wa]:!0;return!1}function da(P,X){if(W(P.splice))P.splice(X,1);else if(X===
P.length-1)P.length=X;else{var ia=P.slice(X+1);P.length=X;for(var Ba=0,ma=ia.length;Ba<ma;Ba++)P[X+Ba]=ia[Ba]}}function na(P,X){if(null===P)throw Error("null is not a valid "+X);if("undefined"===typeof P)throw Error(X+" must not be undefined");}function v(P,X,ia){this.entries=[];this.addEntry(P,X);null!==ia&&(this.getEqualityFunction=function(){return ia})}function u(P){return P[0]}function G(P){return P[1]}function F(){}function E(P){return P[0]}function O(P,X){return(P=P[X])&&P instanceof F?P[1]:
null}v.prototype={getEqualityFunction:function(P){return W(P.equals)?ja:q},searchForEntry:function(P){return C(this.entries,P,u,!0,this.getEqualityFunction(P))},getEntryForKey:function(P){return this.searchForEntry(P)[1]},getEntryIndexForKey:function(P){return this.searchForEntry(P)[0]},removeEntryForKey:function(P){return(P=this.searchForEntry(P))?(da(this.entries,P[0]),!0):!1},addEntry:function(P,X){this.entries[this.entries.length]=[P,X]},size:function(){return this.entries.length},keys:function(P){for(var X=
P.length,ia=0,Ba=this.entries.length;ia<Ba;ia++)P[X+ia]=this.entries[ia][0]},values:function(P){for(var X=P.length,ia=0,Ba=this.entries.length;ia<Ba;ia++)P[X+ia]=this.entries[ia][1]},containsKey:function(P){return C(this.entries,P,u,!1,this.getEqualityFunction(P))},containsValue:function(P){return C(this.entries,P,G,!1,m)}};F.prototype=[];return function(P,X){var ia=[],Ba={};P=W(P)?P:fa;X=W(X)?X:null;this.put=function(ma,wa){na(ma,"key");na(wa,"value");var ka=P(ma),oa=O(Ba,ka);oa?(ka=oa.getEntryForKey(ma))?
ka[1]=wa:oa.addEntry(ma,wa):(oa=new F,oa[0]=ka,oa[1]=new v(ma,wa,X),ia[ia.length]=oa,Ba[ka]=oa)};this.get=function(ma){na(ma,"key");var wa=P(ma);if(wa=O(Ba,wa))if(ma=wa.getEntryForKey(ma))return ma[1];return null};this.containsKey=function(ma){na(ma,"key");var wa=P(ma);return(wa=O(Ba,wa))?wa.containsKey(ma):!1};this.containsValue=function(ma){na(ma,"value");for(var wa=0,ka=ia.length;wa<ka;wa++)if(ia[wa][1].containsValue(ma))return!0;return!1};this.clear=function(){ia.length=0;Ba={}};this.isEmpty=
function(){return 0===ia.length};this.keys=function(){for(var ma=[],wa=0,ka=ia.length;wa<ka;wa++)ia[wa][1].keys(ma);return ma};this.values=function(){for(var ma=[],wa=0,ka=ia.length;wa<ka;wa++)ia[wa][1].values(ma);return ma};this.remove=function(ma){na(ma,"key");var wa=P(ma),ka=O(Ba,wa);ka&&ka.removeEntryForKey(ma)&&0===ka.size()&&(ma=ka.getEqualityFunction(ma),ma=C(ia,wa,E,!0,ma),da(ia,ma[0]),delete Ba[wa])};this.size=function(){for(var ma=0,wa=0,ka=ia.length;wa<ka;wa++)ma+=ia[wa][1].size();return ma}}}(),
types={};
(function(){function W(k,y,K){var T=document.createElement("span");T.className=y;T.ariaText=K;T.setAttribute("aria-label",K);T.appendChild(document.createTextNode(k));return T}function fa(){var k=document.createElement("span");k.appendChild(document.createTextNode("("));k.className="lParen";return k}function ja(){var k=document.createElement("span");k.appendChild(document.createTextNode(")"));k.className="rParen";return k}function q(k){return k.replace(/\\u[\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef]/g,function(y){return String.fromCharCode(parseInt(y.replace(/\\u/g,
""),16))})}var m={}.hasOwnProperty,C=0;makeEqHashCode=function(){C++;return C};getEqHashCode=function(k){k&&!k._eqHashCode&&(k._eqHashCode=makeEqHashCode());return k&&k._eqHashCode?k._eqHashCode:"string"==typeof k?k:0};var da=function(){this.parentMap=G()};da.prototype.find=function(k){var y=this.parentMap.containsKey(k)?this.parentMap.get(k):k;if(y===k)return y;y=this.find(y);this.parentMap.put(k,y);return y};da.prototype.merge=function(k,y){this.parentMap.put(this.find(k),this.find(y))};var na=
function(){var k=!1,y=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,K=function(){};K.extend=function(T){var qa=this.prototype;k=!0;var Ga=new this;k=!1;for(var Ea in T)Ga[Ea]="function"==typeof T[Ea]&&"function"==typeof qa[Ea]&&y.test(T[Ea])?function(Va,Ka){return function(){var db=this._super;this._super=qa[Va];var Ja=Ka.apply(this,arguments);this._super=db;return Ja}}(Ea,T[Ea]):T[Ea];Ea=function(){!k&&this.init&&this.init.apply(this,arguments)};Ea.prototype=Ga;Ea.constructor=Ea;Ea.extend=arguments.callee;
return Ea};return K}();StructType=function(k,y,K,T,qa,Ga,Ea,Va,Ka){this.name=k;this.type=y;this.numberOfArgs=K;this.numberOfFields=T;this.firstField=qa;this.constructor=Ga;this.predicate=Ea;this.accessor=Va;this.mutator=Ka};StructType.prototype.toString=function(){return"#<struct-type:"+this.name+">"};StructType.prototype.isEqual=function(k,y){return this===k};var v=function(k,y,K,T,qa,Ga){y||={type:u,numberOfArgs:0,numberOfFields:0,firstField:0};var Ea=y.numberOfArgs,Va=y.type.extend({init:function(Ka,
db){Ga||=function(t){if(3==arguments.length)t(arguments[1]);else{var Ya=[],ab;for(ab=1;ab<arguments.length-1;ab++)Ya.push(arguments[ab]);t(new bb(Ya))}};var Ja=this;db.unshift(function(t){t=t instanceof bb?t.elts:[t];var Ya=t.slice(0,Ea);Ja._super(Ka,Ya);for(Ya=0;Ya<K;Ya++)Ja._fields.push(t[Ya+Ea]);for(Ya=0;Ya<T;Ya++)Ja._fields.push(qa)});db.push(P.makeInstance(Ka));Ga.apply(null,db)}});Va.prototype.type=Va;return new StructType(k,Va,K+Ea,K+T,y.firstField+y.numberOfFields,function(){for(var Ka=[],
db=0;db<arguments.length;db++)Ka.push(arguments[db]);return new Va(k,Ka)},function(Ka){return Ka instanceof Va},function(Ka,db){return Ka._fields[db+this.firstField]},function(Ka,db,Ja){Ka._fields[db+this.firstField]=Ja})},u=na.extend({init:function(k,y){this._constructorName=k;this._fields=[]},toWrittenString:function(k){var y=[],K;y.push("(");y.push(this._constructorName);for(K=0;K<this._fields.length;K++)y.push(" "),y.push(ca(this._fields[K],k));y.push(")");return y.join("")},toDisplayedString:this.toWrittenString,
toDomNode:function(k){var y=document.createElement("span"),K=document.createElement("span");K.appendChild(document.createTextNode(this._constructorName));ariaText=this._constructorName+":";y.appendChild(fa());y.appendChild(K);for(K=0;K<this._fields.length;K++){var T=ua(this._fields[K],k);ariaText+=" "+T.ariaText;y.appendChild(T)}y.appendChild(ja());y.ariaText=ariaText;y.setAttribute("aria-label",ariaText);return y},isEqual:function(k,y){if(void 0==k.type||this.type!==k.type||!(k instanceof this.type))return!1;
for(var K=0;K<this._fields.length;K++)if(!Ra(this._fields[K],k._fields[K],y))return!1;return!0}});u.prototype.type=u;var G=function(){return new _Hashtable(function(k){return getEqHashCode(k)},function(k,y){return k===y})},F=function(k){this.hash=G();this.mutable=!0};F.prototype.toWrittenString=function(k){for(var y=this.hash.keys(),K=[],T=0;T<y.length;T++){var qa=types.toWrittenString(y[T],k),Ga=types.toWrittenString(this.hash.get(y[T]),k);K.push("("+qa+" . "+Ga+")")}return"#hasheq("+K.join(" ")+
")"};F.prototype.toDisplayedString=F.prototype.toWrittenString;F.prototype.isEqual=function(k,y){if(!(k instanceof F)||this.hash.keys().length!=k.hash.keys().length)return!1;for(var K=this.hash.keys(),T=0;T<K.length;T++)if(!k.hash.containsKey(K[T])||!Ra(this.hash.get(K[T]),k.hash.get(K[T]),y))return!1;return!0};var E=function(k){this.hash=new _Hashtable(function(y){return ca(y)},function(y,K){return Ra(y,K,new da)});this.mutable=!0};E.prototype.toWrittenString=function(k){for(var y=this.hash.keys(),
K=[],T=0;T<y.length;T++){var qa=types.toWrittenString(y[T],k),Ga=types.toWrittenString(this.hash.get(y[T]),k);K.push("("+qa+" . "+Ga+")")}return"#hash("+K.join(" ")+")"};E.prototype.toDisplayedString=E.prototype.toWrittenString;E.prototype.toDomNode=function(k){var y=document.createElement("span");document.createElement("span");var K=this.hash.keys(),T="hashtable with "+K.length+" item"+(1==K.length?"":"s")+": ";y.appendChild(document.createTextNode(this.toDisplayedString()));for(var qa=0;qa<K.length;qa++){var Ga=
ua(K[qa],k),Ea=ua(this.hash.get(K[qa]),k);T+=" "+Ga.ariaText+" maps to "+Ea.ariaText}y.ariaText=T;y.setAttribute("aria-label",T);return y};E.prototype.isEqual=function(k,y){if(!(k instanceof E)||this.hash.keys().length!=k.hash.keys().length)return!1;for(var K=this.hash.keys(),T=0;T<K.length;T++)if(!k.hash.containsKey(K[T])||!Ra(this.hash.get(K[T]),k.hash.get(K[T]),y))return!1;return!0};var O=function(k,y){this.val=k;this.mutable=y};O.prototype.unbox=function(){return this.val};O.prototype.set=function(k){this.mutable&&
(this.val=k)};O.prototype.toString=function(){return"#&"+this.val.toString()};O.prototype.toWrittenString=function(k){return"#&"+ca(this.val,k)};O.prototype.toDisplayedString=this.toWrittenString;O.prototype.toDomNode=function(k){var y=document.createElement("span"),K=document.createElement("span");K.appendChild(document.createTextNode("#&"));var T="a box containing: "+ua(this.val).ariaText;y.className="wescheme-box";y.ariaText=T;y.setAttribute("aria-label",T);y.appendChild(K);y.appendChild(ua(this.val,
k));return y};Logic={TRUE:!0,FALSE:!1};Boolean.prototype.toString=function(){return this.valueOf()?"true":"false"};Boolean.prototype.toWrittenString=Boolean.prototype.toString;Boolean.prototype.toDisplayedString=Boolean.prototype.toString;Boolean.prototype.toDomNode=function(){return W(this.toString(),"wescheme-boolean",this.toString()+", a Boolean")};Boolean.prototype.isEqual=function(k,y){return this==k};Char=function(k){this.val=k};Char.makeInstance=function(k){return new Char(k)};Char.prototype.toString=
function(){var k=this.val.charCodeAt(0);switch(k){case 0:k="#\\nul";break;case 8:k="#\\backspace";break;case 9:k="#\\tab";break;case 10:k="#\\newline";break;case 11:k="#\\vtab";break;case 12:k="#\\page";break;case 13:k="#\\return";break;case 20:k="#\\space";break;case 127:k="#\\rubout";break;default:if(32<=k&&126>=k)k="#\\"+this.val;else{for(k=k.toString(16).toUpperCase();4>k.length;)k="0"+k;k="#\\u"+k}}return k};Char.prototype.toWrittenString=Char.prototype.toString;Char.prototype.toDisplayedString=
function(k){return this.val};Char.prototype.toDomNode=function(){return W(this.toString(),"wescheme-character",this.toString().substring(2)+", a Character")};Char.prototype.getValue=function(){return this.val};Char.prototype.isEqual=function(k,y){return k instanceof Char&&this.val==k.val};var P=function(k){this.val=k},X={};P.makeInstance=function(k){m.call(X,k)||(X[k]=new P(k));return X[k]};P.prototype.isEqual=function(k,y){return k instanceof P&&this.val==k.val};P.prototype.toString=function(){return this.val};
P.prototype.toWrittenString=function(k){return this.val};P.prototype.toDisplayedString=this.toWrittenString;P.prototype.toDomNode=function(k){k=W(this.toString(),"wescheme-symbol","'"+this.val+", a Symbol");k.style.fontFamily="monospace";k.style.whiteSpace="pre";return k};Empty=function(){};Empty.EMPTY=new Empty;Empty.prototype.isEqual=function(k,y){return k instanceof Empty};Empty.prototype.reverse=function(){return this};Empty.prototype.first=function(){throw Error("first can't be applied on empty.");
};Empty.prototype.rest=function(){throw Error("rest can't be applied on empty.");};Empty.prototype.isEmpty=function(){return!0};Empty.prototype.toWrittenString=function(k){return"empty"};Empty.prototype.toDisplayedString=this.toWrittenString;Empty.prototype.toString=function(k){return"()"};Empty.prototype.toDomNode=function(k){document.createElement("span");k=W("empty","wescheme-symbol","empty");k.style.fontFamily="monospace";k.style.whiteSpace="pre";return k};Empty.prototype.append=function(k){return k};
Cons=function(k,y){this.f=k;this.r=y};Cons.prototype.reverse=function(){for(var k=this,y=Empty.EMPTY;!k.isEmpty();)y=Cons.makeInstance(k.first(),y),k=k.rest();return y};Cons.makeInstance=function(k,y){return new Cons(k,y)};Cons.prototype.isEqual=function(k,y){return k instanceof Cons?Ra(this.first(),k.first(),y)&&Ra(this.rest(),k.rest(),y):Logic.FALSE};Cons.prototype.first=function(){return this.f};Cons.prototype.rest=function(){return this.r};Cons.prototype.isEmpty=function(){return!1};Cons.prototype.append=
function(k){if(k===Empty.EMPTY)return this;for(var y=this.reverse();!y.isEmpty();)k=Cons.makeInstance(y.first(),k),y=y.rest();return k};Cons.prototype.toWrittenString=function(k){for(var y=["list"],K=this;K instanceof Cons;)y.push(ca(K.first(),k)),K=K.rest();if(K!==Empty.EMPTY){y=this;K=ca;for(var T=[],qa=[];y instanceof Cons;)T.push("(cons "),T.push(K(y.first(),k)),T.push(" "),qa.push(")"),y=y.rest();T.push(K(y,k));return T.join("")+qa.join("")}return"("+y.join(" ")+")"};Cons.prototype.toString=
Cons.prototype.toWrittenString;Cons.prototype.toDisplayedString=this.toWrittenString;Cons.prototype.toDomNode=function(k){var y=document.createElement("span"),K=document.createElement("span");y.className="wescheme-cons";K.appendChild(document.createTextNode("list"));y.appendChild(fa());y.appendChild(K);K=this;for(var T=0,qa="";K instanceof Cons;){var Ga=ua(K.first(),k);y.appendChild(Ga);T++;qa+=", "+Ga.ariaText||Ga.textContent;K=K.rest()}if(K!==Empty.EMPTY){T=this;K=y=document.createElement("span");
qa=document.createElement("span");qa.appendChild(document.createTextNode("cons"));trailingRParens=ariaText="";for(K.className="wescheme-cons";T instanceof Cons;)K.appendChild(fa()),K.appendChild(qa.cloneNode(!0)),ariaText+=" (cons",trailingRParens+=")",Ga=ua(T.first(),k),ariaText+=" "+Ga.ariaText||Ga.textContent,K.appendChild(Ga),Ga=document.createElement("span"),K.appendChild(Ga),K.appendChild(ja()),K=Ga,T=T.rest();k=ua(T,k);ariaText+=" "+(k.ariaText||k.textContent)+")"+trailingRParens;K.appendChild(k);
y.ariaText=ariaText;y.setAttribute("aria-label",ariaText);return y}y.appendChild(ja());k="list of "+T+" element"+(1==T?"":"s")+": "+qa;y.setAttribute("aria-label",k);y.ariaText=k;return y};Vector=function(k,y){this.elts=Array(k);if(y)for(var K=0;K<k;K++)this.elts[K]=y[K];else for(K=0;K<k;K++)this.elts[K]=void 0;this.mutable=!0};Vector.makeInstance=function(k,y){return new Vector(k,y)};Vector.prototype.length=function(){return this.elts.length};Vector.prototype.ref=function(k){return this.elts[k]};
Vector.prototype.set=function(k,y){this.elts[k]=y};Vector.prototype.isEqual=function(k,y){if(null!=k&&void 0!=k&&k instanceof Vector){if(k.length()!=this.length())return!1;for(var K=0;K<this.length();K++)if(!Ra(this.elts[K],k.elts[K],y))return!1;return!0}return!1};Vector.prototype.toList=function(){for(var k=Empty.EMPTY,y=this.length()-1;0<=y;y--)k=Cons.makeInstance(this.elts[y],k);return k};Vector.prototype.toWrittenString=function(k){for(var y=[],K=0;K<this.length();K++)y.push(ca(this.ref(K),k));
return"#("+y.join(" ")+")"};Vector.prototype.toDisplayedString=this.toWrittenString;Vector.prototype.toDomNode=function(k){var y=document.createElement("span"),K=document.createElement("span"),T=document.createElement("span");K.appendChild(document.createTextNode("#("));K.className="lParen";T.appendChild(document.createTextNode(")"));T.className="rParen";y.className="wescheme-vector";y.appendChild(K);K="a vector of size "+this.length()+": ";for(var qa=0;qa<this.length();qa++){var Ga=ua(this.ref(qa),
k);K+=" "+Ga.ariaText;y.appendChild(Ga)}y.appendChild(T);y.setAttribute("aria-label",K);y.ariaText=K;return y};var ia=function(k){this.chars=k;this.length=k.length;this.mutable=!0};ia.makeInstance=function(k){return new ia(k)};ia.fromString=function(k){return ia.makeInstance(k.split(""))};ia.prototype.toString=function(){return this.chars.join("")};ia.prototype.toWrittenString=function(k){return'"'+Ba(this.toString())+'"'};ia.prototype.toDisplayedString=ia.prototype.toString;ia.prototype.copy=function(){return ia.makeInstance(this.chars.slice(0))};
ia.prototype.substring=function(k,y){if(null==y||void 0==y)y=this.length;return ia.makeInstance(this.chars.slice(k,y))};ia.prototype.charAt=function(k){return this.chars[k]};ia.prototype.charCodeAt=function(k){return this.chars[k].charCodeAt(0)};ia.prototype.replace=function(k,y){return ia.fromString(this.toString().replace(k,y))};ia.prototype.isEqual=function(k,y){return k instanceof ia||"string"==typeof k?this.toString()===k.toString():!1};ia.prototype.set=function(k,y){this.chars[k]=y};ia.prototype.toUpperCase=
function(){return ia.fromString(this.chars.join("").toUpperCase())};ia.prototype.toLowerCase=function(){return ia.fromString(this.chars.join("").toLowerCase())};ia.prototype.match=function(k){return this.toString().match(k)};var Ba=function(k){for(var y=[],K=0;K<k.length;K++){var T=k.charCodeAt(K);switch(T){case 7:y.push("\\a");break;case 8:y.push("\\b");break;case 9:y.push("\\t");break;case 10:y.push("\\n");break;case 11:y.push("\\v");break;case 12:y.push("\\f");break;case 13:y.push("\\r");break;
case 34:y.push('\\"');break;case 92:y.push("\\\\");break;default:if(32<=T&&126>=T)y.push(k.charAt(K));else{for(T=T.toString(16).toUpperCase();4>T.length;)T="0"+T;y.push("\\u"+T)}}}return y.join("")},ma=function(k,y){this.name=k;this.obj=y};ma.prototype.toString=function(){return"#<js-object:"+typeof this.obj+":"+this.name+">"};ma.prototype.isEqual=function(k,y){return this.obj===k.obj};var wa=function(k,y,K){this.startup=k;this.shutdown=y;this.startupArgs=K;this.shutdownArg=void 0};wa.prototype.toString=
function(){return"#<world-config>"};wa.prototype.isEqual=function(k,y){if(!Ra(this.startup,k.startup,y)||!Ra(this.shutdown,k.shutdown,y)||this.startupArgs.length!=k.startupArgs.length||!Ra(this.shutdownArg,k.shutdownArg,y))return!1;for(var K=0;K<args.length;K++)if(!Ra(this.startupArgs[K],k.startupArgs[K],y))return!1;return!0};var ka=v("effect",!1,0,0,!1,!1);ka.type.prototype.invokeEffect=function(k){helpers.raise(types.incompleteExn(types.exnFail,"effect type created without using make-effect-type",
[]))};var oa=v("render-effect",!1,0,0,!1,!1);oa.type.prototype.callImplementation=function(k,y){helpers.raise(types.incompleteExn(types.exnFail,"render effect created without using make-render-effect-type",[]))};var ca=function(k,y){y||=G();if("object"==typeof k){if(y.containsKey(k))return"...";y.put(k,!0)}if(void 0==k||null==k)return"#<undefined>";if("string"==typeof k)return'"'+Ba(k.toString())+'"';if("object"!=typeof k&&"function"!=typeof k)return k.toString();var K="undefined"!==typeof k.toWrittenString?
k.toWrittenString(y):"undefined"!==typeof k.toDisplayedString?k.toDisplayedString(y):k.toString();y.remove(k);return K},ua=function(k,y){y||=G();if("undefined"!==typeof k.toDomNode)return k.toDomNode(y);if(Xa(k)){a:{y=k.toString();if(jsnums.isExact(k))if(jsnums.isInteger(k)){var K="wescheme-number Integer";y+=""}else if(jsnums.isRational(k)){k=node=Sa(k);break a}else k instanceof jsnums.Complex?(K="wescheme-number Complex",y+=", Complex Number"):y+=", Number";else k instanceof jsnums.Complex?(K=" wescheme-numberComplex",
y+=", a Complex Number"):y+=", a Number";k=W(k.toString(),K,y)}return k}if("object"==typeof k){if(y.containsKey(k))return k=document.createElement("span"),k.style["font-family"]="monospace",k.appendChild(document.createTextNode("...")),k;y.put(k,!0)}if(void 0==k||null==k)return k=document.createElement("span"),k.style["font-family"]="monospace",k.appendChild(document.createTextNode("#<undefined>")),k;if("string"==typeof k)return Qa(ca(k));if("object"!=typeof k&&"function"!=typeof k)return Qa(k.toString());
K=k.nodeType?k:"undefined"!==typeof k.toWrittenString?Qa(k.toWrittenString(y)):"undefined"!==typeof k.toDisplayedString?Qa(k.toDisplayedString(y)):Qa(k.toString());y.remove(k);return K},Qa=function(k){var y=k.split("\n"),K=y.map(q),T,qa=document.createElement("span"),Ga=document.createElement("span"),Ea=document.createElement("span");Ea.style.paddingLeft=Ga.style.paddingLeft="0px";0<y.length&&(Ga.appendChild(document.createTextNode(K[0])),Ea.appendChild(document.createTextNode(y[0])));for(T=1;T<y.length;T++){var Va=
document.createElement("br");Va.style.clear="left";Ga.appendChild(Va);Ga.appendChild(document.createTextNode(K[T]));Ea.appendChild(document.createTextNode(y[T]))}qa.className="wescheme-string";y=K.join(" ")+", a String";qa.ariaText=y;qa.setAttribute("aria-label",y);qa.style.fontFamily="monospace";qa.style.whiteSpace="pre-wrap";qa.appendChild(Ea);if(k!==q(k)){qa.appendChild(Ga);var Ka=!0;Ea.style.display="none";qa.onclick=function(db){Ka=!Ka;Ea.style.display=Ka?"none":"inline";Ga.style.display=Ka?
"inline":"none"};qa.style.cursor="pointer"}return qa},Sa=function(k){var y=document.createElement("span"),K=jsnums.toRepeatingDecimal(jsnums.numerator(k),jsnums.denominator(k),{limit:25}),T=document.createElement("span");T.appendChild(document.createTextNode(K[0]+"."+K[1]));y.appendChild(T);y.ariaText=K[0]+" point "+K[1];"..."===K[2]?(T.appendChild(document.createTextNode(K[2])),y.ariaText+=" , (truncated)"):"0"!==K[2]&&(T=document.createElement("span"),T.style.textDecoration="overline",T.appendChild(document.createTextNode(K[2])),
y.appendChild(T),y.ariaText+=K[1]?" with repeating "+K[2]:K[2]+" repeating");y.setAttribute("aria-hidden",!0);var qa=document.createElement("span");K=document.createElement("sup");K.appendChild(document.createTextNode(String(jsnums.numerator(k))));T=document.createElement("sub");T.appendChild(document.createTextNode(String(jsnums.denominator(k))));var Ga=document.createElement("span");Ga.appendChild(document.createTextNode("/"));qa.appendChild(K);qa.appendChild(Ga);qa.appendChild(T);qa.ariaText=String(jsnums.numerator(k))+
" over "+String(jsnums.denominator(k));var Ea=document.createElement("span");Ea.appendChild(y);Ea.appendChild(qa);qa.style.display="none";qa.setAttribute("aria-hidden",!0);var Va=!0;Ea.onclick=function(Ka){Va=!Va;y.style.display=Va?"inline":"none";qa.style.display=Va?"none":"inline";Ea.setAttribute("aria-label",(Va?y:qa).ariaText)};Ea.ariaText=y.ariaText;Ea.style.cursor="pointer";Ea.className="wescheme-number Rational";return Ea},Xa=jsnums.isSchemeNumber,Oa=function(k){return"string"===typeof k||
k instanceof ia},Ra=function(k,y,K){if(k===y)return!0;if(Xa(k)&&Xa(y))return jsnums.equals(k,y);if(Oa(k)&&Oa(y))return k.toString()===y.toString();if(void 0==k||null==k)return void 0==y||null==y;if("object"==typeof k&&"object"==typeof y&&k.isEqual&&y.isEqual){if(K.find(k)===K.find(y))return!0;K.merge(k,y);return k.isEqual(y,K)}return!1},bb=function(k){this.elts=k};bb.prototype.toDomNode=function(k){var y=document.createElement("span");y.style.whiteSpace="pre";if(0<this.elts.length){y.appendChild(ua(this.elts[0],
k));for(var K=1;K<this.elts.length;K++){var T=ua(this.elts[K],k);y.appendChild(document.createTextNode("\n"));y.appendChild(T)}}return y};var Na=function(){};Na.prototype.toString=function(){return"#<undefined>"};Na=new Na;var za=function(){};za.prototype.toString=function(){return"#<void>"};var Da=new za;za=function(){};za.prototype.toString=function(){return"#<eof>"};za=new za;var Fa=function(k,y,K,T,qa,Ga,Ea){this.name=k;this.locs=y;this.numParams=K;this.paramTypes=T;this.isRest=qa;this.closureVals=
Ga;this.body=Ea};Fa.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<function:~a>",[this.name]):"#<function>"};Fa.prototype.toDomNode=function(){return W(this.toString(),"wescheme-primproc",this.name===Empty.EMPTY?"anonymous function":this.name+", a function")};var Q=function(k,y){this.name=k;this.closures=y};Q.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<case-lambda-procedure:~a>",[this.name]):"#<case-lambda-procedure>"};var sa=function(k,
y){this.name=!1;this.vstack=k.slice(0);this.cstack=y.slice(0)};sa.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<function:~a>",[this.name]):"#<function>"};sa.prototype.toDomNode=function(){return W(this.toWrittenString(),"wescheme-primproc",this.name===Empty.EMPTY?"anonymous function":this.name+", a function")};var pa=function(){this.slots=[];this.definedMask=[]};pa.prototype.addSlot=function(k){void 0===k?(this.slots.push(types.UNDEFINED),this.definedMask.push(!1)):
(this.slots.push(k),k instanceof Pa?k.value===types.UNDEFINED?this.definedMask.push(!1):this.definedMask.push(!0):this.definedMask.push(!0))};pa.prototype.ref=function(k,y){if(this.slots[k]instanceof Pa){if(this.definedMask[k])return this.slots[k].value;helpers.raise(types.incompleteExn(types.exnFailContractVariable,new ha([new ra(this.slots[k].name,y),": this variable is not defined"]),[this.slots[k].name]))}else{if(this.definedMask[k])return this.slots[k];helpers.raise(types.incompleteExn(types.exnFailContractVariable,
"variable has not been defined",[!1]))}};pa.prototype.set=function(k,y){this.slots[k]instanceof Pa?this.slots[k].value=y:this.slots[k]=y;this.definedMask[k]=!0};pa.prototype.length=function(){return this.slots.length};var Pa=function(k,y){this.name=k;this.value=y},R=function(k,y){this.prefix=k;this.pos=y};R.prototype.ref=function(){return this.prefix.ref(this.pos)};R.prototype.set=function(k){this.prefix.set(this.pos,k)};var ta=function(k){this.dict=k||{}};ta.prototype.invoke=function(k){};ta.prototype.update=
function(k,y){this.dict[k.val]=y;return this};var Ua=function(k){this.dict=k};Ua.prototype.toDomNode=function(k){k=document.createElement("span");k.appendChild(document.createTextNode("#<continuation-mark-set>"));return k};Ua.prototype.toWrittenString=function(k){return"#<continuation-mark-set>"};Ua.prototype.toDisplayedString=this.toWrittenString;Ua.prototype.ref=function(k){return this.dict.containsKey(k)?this.dict.get(k):[]};var l=function(){},D=new l,L=function(k,y,K,T,qa){this.name=k;this.numParams=
y;this.isRest=K;this.assignsToValueRegister=T;this.impl=qa};L.prototype.toString=function(){return"#<function:"+this.name+">"};L.prototype.toWrittenString=L.prototype.toString;L.prototype.toDisplayedString=L.prototype.toString;L.prototype.toDomNode=function(k){return W(this.toString(),"wescheme-primproc",this.name+", a function")};var U=function(k,y){this.name=k;this.cases=y};U.prototype.toString=function(k){return"#<function:"+this.name+">"};U.prototype.toWrittenString=U.prototype.toString;U.prototype.toDisplayedString=
U.prototype.toString;U.prototype.toDomNode=function(k){return W(this.toString(),"wescheme-caseprimitive",this.name+", a function")};var ha=function(k){this.args=k};ha.prototype.toString=function(){var k=[],y;for(y=0;y<this.args.length;y++)k.push(""+this.args[y]);return k.join("")};var ra=function(k,y){this.text=k;this.location=y};ra.prototype.toString=function(){return this.text+""};var xa=function(k){this.coloredParts=k};xa.prototype.toString=function(){var k,y=[];for(k=0;k<this.coloredParts.length;k++)y.push(this.coloredParts[k].text+
"");return y.join("")};var Aa=function(k,y,K){this.text=k;this.locations=y;this.solid=K};Aa.prototype.toString=function(){return this.text};var Ta=function(k){return Vector.makeInstance(k.length,k)},Ha=Ta(["<no-location>",0,0,0,0]),Za=v("posn",!1,2,0,!1,!1),B=v("color",!1,4,0,!1,!1),J=v("arity-at-least",!1,1,0,!1,function(k,y,K){helpers.check(void 0,y,function(T){return jsnums.isExact(T)&&jsnums.isInteger(T)&&jsnums.greaterThanOrEqual(T,0)},K,"exact non-negative integer",1);k(y)});types.symbol=P.makeInstance;
types.rational=jsnums.makeRational;types["float"]=jsnums.makeFloat;types.complex=jsnums.makeComplex;types.bignum=jsnums.makeBignum;types.list=function(k){var y=Empty.EMPTY,K;for(K=k.length-1;0<=K;K--)y=Cons.makeInstance(k[K],y);return y};types.vector=Ta;types["char"]=Char.makeInstance;types.string=function(k){if(k instanceof ia)return k;if(k instanceof Array)return ia.makeInstance(k);if("string"===typeof k)return ia.fromString(k);throw types.internalError("makeString expects and array of 1-character strings or a string; given "+
k.toString(),!1);};types.box=function(k){return new O(k,!0)};types.boxImmutable=function(k){return new O(k,!1)};types.pair=function(k,y){return Cons.makeInstance(k,y)};types.hash=function(k){for(var y=new E;!k.isEmpty();)y.hash.put(k.first().first(),k.first().rest()),k=k.rest();return y};types.hashEq=function(k){for(var y=new F;!k.isEmpty();)y.hash.put(k.first().first(),k.first().rest()),k=k.rest();return y};types.jsObject=function(k,y){return new ma(k,y)};types.toWrittenString=ca;types.toDisplayedString=
function(k,y){y||=G();if("object"==typeof k){if(y.containsKey(k))return"...";y.put(k,!0)}if(void 0==k||null==k)return"#<undefined>";if("string"==typeof k)return k;if("object"!=typeof k&&"function"!=typeof k)return k.toString();var K="undefined"!==typeof k.toDisplayedString?k.toDisplayedString(y):"undefined"!==typeof k.toWrittenString?k.toWrittenString(y):k.toString();y.remove(k);return K};types.toDomNode=ua;types.posn=Za.constructor;types.posnX=function(k){return Za.accessor(k,0)};types.posnY=function(k){return Za.accessor(k,
1)};types.color=function(k,y,K,T){void 0===T&&(T=255);return B.constructor(k,y,K,T)};types.colorRed=function(k){return B.accessor(k,0)};types.colorGreen=function(k){return B.accessor(k,1)};types.colorBlue=function(k){return B.accessor(k,2)};types.colorAlpha=function(k){return B.accessor(k,3)};types.arityAtLeast=J.constructor;types.arityValue=function(k){return J.accessor(k,0)};types.FALSE=Logic.FALSE;types.TRUE=Logic.TRUE;types.EMPTY=Empty.EMPTY;types.isEqual=Ra;types.isNumber=Xa;types.isSymbol=function(k){return k instanceof
P};types.isChar=function(k){return k instanceof Char};types.isString=Oa;types.isPair=function(k){return k instanceof Cons};types.isVector=function(k){return k instanceof Vector};types.isBox=function(k){return k instanceof O};types.isHash=function(k){return k instanceof F||k instanceof E};types.isStruct=function(k){return k instanceof u};types.isPosn=Za.predicate;types.isArityAtLeast=J.predicate;types.isColor=B.predicate;types.isFunction=function(k){return k instanceof L||k instanceof U||k instanceof
Fa||k instanceof Q||k instanceof sa};types.getProcedureType=function(k){return k instanceof L?"PrimProc":k instanceof U?"CasePrimitive":k instanceof Fa?"ClosureValue":k instanceof Q?"CaseLambdaValue":k instanceof sa?"ContinuationClosureValue":!1};types.isJsObject=function(k){return k instanceof ma};types.UnionFind=da;types.cons=Cons.makeInstance;types.UNDEFINED=Na;types.VOID=Da;types.EOF=za;types.ValuesWrapper=bb;types.ClosureValue=Fa;types.ContinuationPrompt=l;types.defaultContinuationPrompt=D;types.ContinuationClosureValue=
sa;types.CaseLambdaValue=Q;types.PrimProc=L;types.CasePrimitive=U;types.contMarkRecordControl=function(k){return new ta(k)};types.isContMarkRecordControl=function(k){return k instanceof ta};types.continuationMarkSet=function(k){return new Ua(k)};types.isContinuationMarkSet=function(k){return k instanceof Ua};types.PrefixValue=pa;types.GlobalBucket=Pa;types.ModuleVariableRecord=function(k,y){this.resolvedModuleName=k;this.variableName=y};types.VariableReference=R;types.Box=O;types.ThreadCell=function(k,
y){this.v=k;this.isPreserved=y||!1};types.Class=na;types.makeStructureType=v;types.isStructType=function(k){return k instanceof StructType};types.makeLowLevelEqHash=G;var V=function(k,y){this.val=k;this.contMarks=y?y:!1};types.internalError=function(k,y){return new V(k,y)};types.isInternalError=function(k){return k instanceof V};var Y=function(k){this.val=k};types.schemeError=function(k){return new Y(k)};types.isSchemeError=function(k){return k instanceof Y};var A=function(k,y,K){this.constructor=
k;this.msg=y;this.otherArgs=K};types.incompleteExn=function(k,y,K){return new A(k,y,K)};types.isIncompleteExn=function(k){return k instanceof A};var H=v("exn",!1,2,0,!1,function(k,y,K,T){helpers.check(void 0,K,types.isContinuationMarkSet,T,"continuation mark set",2);k(new bb([y,K]))});types.exn=H.constructor;types.isExn=H.predicate;types.exnMessage=function(k){return H.accessor(k,0)};types.exnContMarks=function(k){return H.accessor(k,1)};types.exnSetContMarks=function(k,y){H.mutator(k,1,y)};var N=
v("exn:break",H,1,0,!1,function(k,y,K,T,qa){k(new bb([y,K,T]))});types.exnBreak=N.constructor;types.isExnBreak=N.predicate;types.exnBreakContinuation=function(k){return N.accessor(k,0)};na=v("exn:fail",H,0,0,!1,!1);types.exnFail=na.constructor;types.isExnFail=na.predicate;Na=v("exn:fail:contract",na,0,0,!1,!1);types.exnFailContract=Na.constructor;types.isExnFailContract=Na.predicate;na=v("exn:fail:contract:arity",Na,0,0,!1,!1);types.exnFailContractArity=Na.constructor;types.isExnFailContractArity=
Na.predicate;var Z=v("exn:fail:contract:variable",Na,1,0,!1,!1);types.exnFailContractVariable=Na.constructor;types.isExnFailContractVariable=Na.predicate;types.exnFailContractVariableId=function(k){return Z.accessor(k,0)};Na=v("exn:fail:contract:division-by-zero",Na,0,0,!1,!1);types.exnFailContractDivisionByZero=Na.constructor;types.isExnFailContractDivisionByZero=Na.predicate;var la=v("exn:fail:contract:arity:position",na,1,0,!1,!1);types.exnFailContractArityWithPosition=la.constructor;types.isExnFailContractArityWithPosition=
la.predicate;types.exnFailContractArityWithPositionLocations=function(k){return la.accessor(k,0)};types.worldConfig=function(k,y,K){return new wa(k,y,K)};types.isWorldConfig=function(k){return k instanceof wa};types.makeEffectType=function(k,y,K,T,qa,Ga){y||=ka;k=v(k,y,K,0,!1,qa);var Ea=k.firstField+k.numberOfFields;k.type.prototype.invokeEffect=function(Va,Ka){var db=new L("update-world",1,!1,!0,function(t,Ya){helpers.check(t,Ya,helpers.procArityContains(1),"update-world","procedure (arity 1)",1);
Va(function(ab,cb){interpret.call(t,Ya,[ab],cb,function(jb){throw jb;})},function(){t.v=Da})}),Ja=this._fields.slice(0,Ea);Ja.unshift(db);Ga(T,Ja,Ka)};return k};types.isEffectType=function(k){return k instanceof StructType&&k.type.prototype.invokeEffect?!0:!1};types.isEffect=ka.predicate;types.makeRenderEffectType=function(k,y,K,T,qa){y||=oa;k=v(k,y,K,0,!1,qa);var Ga=k.firstField+k.numberOfFields;k.type.prototype.callImplementation=function(Ea,Va){var Ka=this._fields.slice(0,Ga);Ea(T,Ka,Va)};return k};
types.isRenderEffectType=function(k){return k instanceof StructType&&k.type.prototype.callImplementation?!0:!1};types.isRenderEffect=oa.predicate;types.NoLocation=Ha;types.isNoLocation=function(k){return k===Ha};types.ColoredPart=ra;types.Message=ha;types.isColoredPart=function(k){return k instanceof ra};types.isMessage=function(k){return k instanceof ha};types.GradientPart=xa;types.isGradientPart=function(k){return k instanceof xa};types.MultiPart=Aa;types.isMultiPart=function(k){return k instanceof
Aa}})();var state={};
(function(){var W=function(v){sys.print(types.toWrittenString(v)+"\n")},fa=function(){throw Error("There is a software configuration error by the system's maintainer: the toplevel node has not been initialized yet.");},ja=function(v,u,G){G(v+" not known")},q=function(){this.v=[];this.vstack=[];this.cstack=[];this.heap={};this.globals={};this.hooks={printHook:W,displayHook:W,toplevelNodeHook:fa,imageProxyHook:!1,dynamicModuleLoader:ja};this.invokedModules={};this.breakRequested=!1;this.breakRequestedListeners=
[]};q.prototype.clearForEval=function(v){this.v=[];this.vstack=[];this.cstack=[];v&&v.preserveBreak||(this.breakRequested=!1,this.breakRequestedListeners=[]);v&&v.clearGlobals&&(this.globals={})};q.prototype.save=function(){return{v:this.v,vstack:this.vstack.slice(0),cstack:this.cstack.slice(0),heap:this.heap,globals:C(this.globals),hooks:this.hooks,breakRequested:this.breakRequested,breakRequestedListeners:C(this.breakRequestedListeners),invokedModules:this.invokedModules}};var m={}.hasOwnProperty,
C=function(v){var u={},G;for(G in v)m.call(v,G)&&(u[G]=v[G]);return u};q.prototype.restore=function(v){this.v=v.v;this.vstack=v.vstack;this.cstack=v.cstack;this.heap=v.heap;this.globals=v.globals;this.hooks=v.hooks;this.breakRequestListeners=v.breakRequestListeners;this.invokedModules=v.invokedModules};q.prototype.requestBreak=function(){this.breakRequested=!0;for(var v=0;v<this.breakRequestedListeners.length;v++)try{this.breakRequestedListeners[v]()}catch(u){helpers.reportError(u)}};q.prototype.addBreakRequestedListener=
function(v){this.breakRequestedListeners.push(v)};q.prototype.removeBreakRequestedListener=function(v){for(var u=this.breakRequestedListeners.length-1;0<=u;u--)this.breakRequestedListeners[u]===v&&this.breakRequestedListeners.splice(u,1)};q.prototype.pushControl=function(v){this.cstack.push(v)};q.prototype.pushManyControls=function(v){for(var u=0;u<v.length;u++)this.cstack.push(v[v.length-1-u])};q.prototype.isStuck=function(){return 0===this.cstack.length};q.prototype.popControl=function(){if(0===
this.cstack.length)throw types.internalError("cstack empty",da(this));return this.cstack.pop()};q.prototype.pushValue=function(v){this.vstack.push(v)};q.prototype.popValue=function(){if(0===this.vstack.length)throw types.internalError("vstack empty",da(this));return this.vstack.pop()};q.prototype.pushn=function(v){for(var u=0;u<v;u++)this.vstack.push(types.UNDEFINED)};q.prototype.popn=function(v){for(var u=[],G=0;G<v;G++){if(0===this.vstack.length)throw types.internalError("vstack empty",da(this));
u.push(this.vstack.pop())}return u};q.prototype.peekn=function(v){if(0>this.vstack.length-1-(v||0))throw types.internalError("vstack not long enough",da(this));return this.vstack[this.vstack.length-1-(v||0)]};q.prototype.setn=function(v,u){this.vstack[this.vstack.length-1-(v||0)]=u};q.prototype.refPrefix=function(v,u,G){v=this.vstack[this.vstack.length-1-v].ref(u,G);if(v instanceof types.ModuleVariableRecord&&this.invokedModules[v.resolvedModuleName]){u=this.invokedModules[v.resolvedModuleName];if("undefined"!==
typeof u.providedValues[v.variableName])return u.providedValues[v.variableName];throw types.schemeError(types.exnFailContractVariable("reference to an identifier before its definition: "+v.variableName,!1,v.variableName));}return v};q.prototype.setPrefix=function(v,u,G){this.vstack[this.vstack.length-1-v].set(u,G)};q.prototype.setPrintHook=function(v){this.hooks.printHook=v};q.prototype.getPrintHook=function(){return this.hooks.printHook};q.prototype.setDisplayHook=function(v){this.hooks.displayHook=
v};q.prototype.setImageProxyHook=function(v){this.hooks.imageProxyHook=v};q.prototype.getImageProxyHook=function(){return this.hooks.imageProxyHook};q.prototype.getDisplayHook=function(){return this.hooks.displayHook};q.prototype.getToplevelNodeHook=function(){return this.hooks.toplevelNodeHook};q.prototype.setToplevelNodeHook=function(v){this.hooks.toplevelNodeHook=v};var da=function(v){for(var u=types.makeLowLevelEqHash(),G=0;G<v.cstack.length;G++)if(types.isContMarkRecordControl(v.cstack[G])){var F=
v.cstack[G].dict,E;for(E in F)u.put(E,[F[E]]),u.get(E).push(F[E])}return types.continuationMarkSet(u)},na=function(v,u){for(var G in v)if(m.call(v,G))if(m.call(u,G)){if(v[G]!==u[G])return!1}else return!1;for(G in u)if(m.call(u,G))if(m.call(v,G)){if(v[G]!==u[G])return!1}else return!1;return!0};state.State=q;state.isState=function(v){return v instanceof q};state.captureCurrentContinuationMarks=da;state.getStackTraceFromContinuationMarks=function(v){var u=[];v=v.ref("moby-stack-record-continuation-mark-key");
for(var G=v.length-1;0<=G;G--){var F=v[G],E=F.ref(0),O=F.ref(1),P=F.ref(2),X=F.ref(3);F=F.ref(4);E={id:E,offset:O,line:P,column:X,span:F};0!==u.length&&na(u[u.length-1],E)||u.push(E)}return u}})();"undefined"===typeof world&&(world={});
(function(W){var fa=function(v,u){var G=v[0],F=v[1],E=v[2],O=v[3];G=q(G,F,E,O,u[0],7,-680876936);O=q(O,G,F,E,u[1],12,-389564586);E=q(E,O,G,F,u[2],17,606105819);F=q(F,E,O,G,u[3],22,-1044525330);G=q(G,F,E,O,u[4],7,-176418897);O=q(O,G,F,E,u[5],12,1200080426);E=q(E,O,G,F,u[6],17,-1473231341);F=q(F,E,O,G,u[7],22,-45705983);G=q(G,F,E,O,u[8],7,1770035416);O=q(O,G,F,E,u[9],12,-1958414417);E=q(E,O,G,F,u[10],17,-42063);F=q(F,E,O,G,u[11],22,-1990404162);G=q(G,F,E,O,u[12],7,1804603682);O=q(O,G,F,E,u[13],12,-40341101);
E=q(E,O,G,F,u[14],17,-1502002290);F=q(F,E,O,G,u[15],22,1236535329);G=m(G,F,E,O,u[1],5,-165796510);O=m(O,G,F,E,u[6],9,-1069501632);E=m(E,O,G,F,u[11],14,643717713);F=m(F,E,O,G,u[0],20,-373897302);G=m(G,F,E,O,u[5],5,-701558691);O=m(O,G,F,E,u[10],9,38016083);E=m(E,O,G,F,u[15],14,-660478335);F=m(F,E,O,G,u[4],20,-405537848);G=m(G,F,E,O,u[9],5,568446438);O=m(O,G,F,E,u[14],9,-1019803690);E=m(E,O,G,F,u[3],14,-187363961);F=m(F,E,O,G,u[8],20,1163531501);G=m(G,F,E,O,u[13],5,-1444681467);O=m(O,G,F,E,u[2],9,-51403784);
E=m(E,O,G,F,u[7],14,1735328473);F=m(F,E,O,G,u[12],20,-1926607734);G=ja(F^E^O,G,F,u[5],4,-378558);O=ja(G^F^E,O,G,u[8],11,-2022574463);E=ja(O^G^F,E,O,u[11],16,1839030562);F=ja(E^O^G,F,E,u[14],23,-35309556);G=ja(F^E^O,G,F,u[1],4,-1530992060);O=ja(G^F^E,O,G,u[4],11,1272893353);E=ja(O^G^F,E,O,u[7],16,-155497632);F=ja(E^O^G,F,E,u[10],23,-1094730640);G=ja(F^E^O,G,F,u[13],4,681279174);O=ja(G^F^E,O,G,u[0],11,-358537222);E=ja(O^G^F,E,O,u[3],16,-722521979);F=ja(E^O^G,F,E,u[6],23,76029189);G=ja(F^E^O,G,F,u[9],
4,-640364487);O=ja(G^F^E,O,G,u[12],11,-421815835);E=ja(O^G^F,E,O,u[15],16,530742520);F=ja(E^O^G,F,E,u[2],23,-995338651);G=C(G,F,E,O,u[0],6,-198630844);O=C(O,G,F,E,u[7],10,1126891415);E=C(E,O,G,F,u[14],15,-1416354905);F=C(F,E,O,G,u[5],21,-57434055);G=C(G,F,E,O,u[12],6,1700485571);O=C(O,G,F,E,u[3],10,-1894986606);E=C(E,O,G,F,u[10],15,-1051523);F=C(F,E,O,G,u[1],21,-2054922799);G=C(G,F,E,O,u[8],6,1873313359);O=C(O,G,F,E,u[15],10,-30611744);E=C(E,O,G,F,u[6],15,-1560198380);F=C(F,E,O,G,u[13],21,1309151649);
G=C(G,F,E,O,u[4],6,-145523070);O=C(O,G,F,E,u[11],10,-1120210379);E=C(E,O,G,F,u[2],15,718787259);F=C(F,E,O,G,u[9],21,-343485551);v[0]=na(G,v[0]);v[1]=na(F,v[1]);v[2]=na(E,v[2]);v[3]=na(O,v[3])},ja=function(v,u,G,F,E,O){u=na(na(u,v),na(F,O));return na(u<<E|u>>>32-E,G)},q=function(v,u,G,F,E,O,P){return ja(u&G|~u&F,v,u,E,O,P)},m=function(v,u,G,F,E,O,P){return ja(u&F|G&~F,v,u,E,O,P)},C=function(v,u,G,F,E,O,P){return ja(G^(u|~F),v,u,E,O,P)},da="0123456789abcdef".split(""),na=function(v,u){return v+u&4294967295};
"5d41402abc4b2a76b9719d911017c592"!=(W.md5=function(v){var u=v,G=u.length;v=[1732584193,-271733879,-1732584194,271733878];var F;for(F=64;F<=u.length;F+=64){var E,O=u.substring(F-64,F),P=[];for(E=0;64>E;E+=4)P[E>>2]=O.charCodeAt(E)+(O.charCodeAt(E+1)<<8)+(O.charCodeAt(E+2)<<16)+(O.charCodeAt(E+3)<<24);fa(v,P)}u=u.substring(F-64);E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(F=0;F<u.length;F++)E[F>>2]|=u.charCodeAt(F)<<(F%4<<3);E[F>>2]|=128<<(F%4<<3);if(55<F)for(fa(v,E),F=0;16>F;F++)E[F]=0;E[14]=8*G;fa(v,
E);for(u=0;u<v.length;u++){G=u;F=v[u];E="";for(O=0;4>O;O++)E+=da[F>>8*O+4&15]+da[F>>8*O&15];v[G]=E}return v.join("")})("hello")&&(na=function(v,u){var G=(v&65535)+(u&65535);return(v>>16)+(u>>16)+(G>>16)<<16|G&65535})})(world);"undefined"===typeof world&&(world={});
(function(){world.config={};var W=function(){this.vals={changeWorld:!1,shutdownWorld:!1,initialEffect:!1,onRedraw:!1,onDraw:!1,onDrawCss:!1,tickDelay:!1,onTick:!1,onTickEffect:!1,onKey:!1,onKeyEffect:!1,onMouse:!1,onTilt:!1,onTiltEffect:!1,onTap:!1,onTapEffect:!1,onAcceleration:!1,onAccelerationEffect:!1,onShake:!1,onShakeEffect:!1,onSmsReceive:!1,onSmsReceiveEffect:!1,onLocationChange:!1,onLocationChangeEffect:!1,onAnnounce:!1,onAnnounceEffect:!1,stopWhen:!1,stopWhenEffect:!1,connectToGame:!1,onGameStart:!1,
onOpponentTurn:!1,onMyTurn:!1,afterMyTurn:!1,onGameFinish:!1}};W.prototype.lookup=function(fa){if(fa in this.vals)return this.vals[fa];throw Error("Can't find "+fa+" in the configuration");};W.prototype.updateAll=function(fa){var ja=new W,q=this.vals,m={},C;for(C in q)Object.hasOwnProperty.call(q,C)&&(m[C]=q[C]);for(C in fa)Object.hasOwnProperty.call(fa,C)&&(m[C]=fa[C]);ja.vals=m;return ja};world.config.WorldConfig=W;world.config.CONFIG=new W;world.config.Kernel=world.config.Kernel||{};world.config.Kernel.getNoneEffect=
function(){throw Error("getNoneEffect: We should not be calling effects!");}})();
(function(){world.stimuli={};var W=[],fa=function(){},ja=function(C,da,na){this.config=C;this.caller=da;this.restarter=na;W.push(this)};ja.prototype.doStimuli=function(C,da,na,v){var u=this;try{u.change(function(G,F){var E=[G].concat(na);da?u.caller(da,E,F):F(G)},v)}catch(G){this.onShutdown()}};ja.prototype.onTilt=function(C,da){var na=this.lookup("onTilt"),v=this.lookup("onTiltEffect");this.doStimuli(v,na,helpers.map(q,C),da)};ja.prototype.onAcceleration=function(C,da){var na=this.lookup("onAcceleration"),
v=this.lookup("onAccelerationEffect");this.doStimuli(v,na,helpers.map(q,C),da)};ja.prototype.onShake=function(C,da){C=this.lookup("onShake");var na=this.lookup("onShakeEffect");this.doStimuli(na,C,[],da)};ja.prototype.onSmsReceive=function(C,da){var na=this.lookup("onSmsReceive"),v=this.lookup("onSmsReceiveEffect");this.doStimuli(v,na,[C[0]+"",C[1]+""],da)};ja.prototype.onLocation=function(C,da){var na=this.lookup("onLocationChange"),v=this.lookup("onLocationChangeEffect");this.doStimuli(v,na,helpers.map(q,
C),da)};ja.prototype.onKey=function(C,da){C=helpers.getKeyCodeName(C[0]);var na=this.lookup("onKey"),v=this.lookup("onKeyEffect");this.doStimuli(v,na,[C],da)};ja.prototype.onAnnounce=function(C,da){for(var na=C[1],v=types.EMPTY,u=0;u<na.length;u++)v=types.cons(na[na.length-u-1],v);na=this.lookup("onAnnounce");u=this.lookup("onAnnounceEffect");this.doStimuli(na,u,[C[0],v],da)};ja.prototype.onShutdown=function(){var C=W.indexOf(this);-1!=C&&W.splice(C,1);(C=this.lookup("shutdownWorld"))&&C()};var q=
types["float"];ja.prototype.lookup=function(C){return this.config.lookup(C)};ja.prototype.change=function(C,da){this.lookup("changeWorld")?this.lookup("changeWorld")(C,da):da()};var m=function(C){return function(){for(var da=arguments,na=0;na<W.length;na++)W[na][C](da,fa)}};world.stimuli.StimuliHandler=ja;world.stimuli.onTilt=m("onTilt");world.stimuli.onAcceleration=m("onAcceleration");world.stimuli.onShake=m("onShake");world.stimuli.onSmsReceive=m("onSmsReceive");world.stimuli.onLocation=m("onLocation");
world.stimuli.onKey=m("onKey");world.stimuli.onAnnounce=m("onAnnounce");world.stimuli.massShutdown=function(){for(var C=0;C<W.length;C++){var da=W[C].lookup("shutdownWorld");da&&da()}W=[]}})();"undefined"===typeof world&&(world={});
(function(){function W(){setTimeout(W,ia);if(myEditor.getScreenreader()){var l=[];for(L in X)X.hasOwnProperty(L)&&!X[L].labeled&&l.push(X[L]);if(0!==l.length){var D=[];l.forEach(function(ha){D.push({image:{source:{imageUri:ha.originalURI}},features:[{type:"LABEL_DETECTION",maxResults:10}]})});var L=JSON.stringify({requests:D});try{var U=new XMLHttpRequest;U.onload=function(){var ha=JSON.parse(this.responseText);if(ha.responses)console.log("successful load from VisionAPI. set timeout to ",ia,"ms"),
ia=5E3;else throw ia*=2,console.log("no response from VisionAPI. set timeout to ",ia,"ms"),"No response from Google Vision API";ha.responses.forEach(function(ra,xa){ra.labelAnnotations.sort(function(Ta,Ha){return Ta.confidence<Ha.confidence?1:-1});var Aa=ra.labelAnnotations[0].description;X[l[xa].originalURI].labeled=!0;X[l[xa].originalURI].getAriaText=function(){" a picture of a "+Aa}});console.log("after load(), timeout is",ia)};U.onerror=function(){console.log("Google VisionAPI post() failure")};
U.open("POST","https://vision.googleapis.com/v1/images:annotate?key="+plt.config.API_KEY);U.setRequestHeader("content-type","application/json");U.send(L)}catch(ha){console.log("Setting up XHR for Google Vision API failed",ha),ia*=2}}}}function fa(l){l=l.replace(/^\s*/,"");return(l.match(/^[aeiouAEIOU]/)?" an ":" a ")+l}function ja(l,D){if(0===D)return" transparent ";var L=q(types.colorRed(l),types.colorGreen(l),types.colorBlue(l));l=world.Kernel.colorLabs.map(function(U){return{l:U.l,a:U.a,b:U.b,
name:U.name,d:Math.sqrt(Math.pow(L.l-U.l,2)+Math.pow(L.a-U.a,2)+Math.pow(L.b-U.b,2))}});l=l.sort(function(U,ha){return U.d<ha.d?-1:U.d>ha.d?1:0});l=l[0].name;return(""==D||isNaN(D)?D=" "+D:" translucent ")+" "+l.toLowerCase()}function q(l,D,L){l=function(U,ha,ra){function xa(Aa){Aa=parseFloat(Aa/255);return 100*(.04045<Aa?Math.pow((Aa+.055)/1.055,2.4):Aa/12.92)}U=xa(U);ha=xa(ha);ra=xa(ra);return[.4124*U+.3576*ha+.1805*ra,.2126*U+.7152*ha+.0722*ra,.0193*U+.1192*ha+.9505*ra]}(l,D,L);l=function(U,ha,
ra){function xa(Aa){return.008856<Aa?Math.pow(Aa,1/3):7.787*Aa+16/116}ha/=100;ra/=108.883;U=xa(U/95.047);ha=xa(ha);ra=xa(ra);return[116*ha-16,500*(U-ha),200*(ha-ra)]}(l[0],l[1],l[2]);return{l:l[0],a:l[1],b:l[2]}}world.Kernel={};var m=[],C=function(l){var D=function(){};D.prototype=l;return new D},da=[];world.Kernel.addAnnounceListener=function(l){da.push(l)};world.Kernel.removeAnnounceListener=function(l){l=da.indexOf(l);-1!==l&&da.splice(l,1)};world.Kernel.announce=function(l,D){var L;for(L=0;L<
da.length;L++)try{da[L](l,D)}catch(U){}};world.Kernel.updateWorld=function(l){world=l(world);for(l=0;l<m.length;l++)m[l](world)};world.Kernel.shutdownWorld=function(){};var na=function(l,D){if(l.length!==D.length)return!1;l=l.map(function(L){return"x:"+L.x+",y:"+L.y}).join(",");D=D.map(function(L){return"x:"+L.x+",y:"+L.y}).join(",");return(l+","+l).includes(D)},v=function(l){return{xs:l.map(function(D){return D.x}),ys:l.map(function(D){return D.y})}},u=function(l){l=v(l).xs;return Math.max.apply(Math,
l)-Math.min.apply(Math,l)},G=function(l){l=v(l).ys;return Math.max.apply(Math,l)-Math.min.apply(Math,l)},F=function(l){var D=v(l),L=-Math.min.apply(Math,D.xs),U=-Math.min.apply(Math,D.ys);return l.map(function(ha){return{x:ha.x+L,y:ha.y+U}})},E=function(){};world.Kernel.BaseImage=E;E.prototype.getHeight=function(){return Math.round(this.height)};E.prototype.getWidth=function(){return Math.round(this.width)};E.prototype.getBaseline=function(){return Math.round(this.height)};E.prototype.getVertices=
function(){return this.vertices?this.vertices:[{x:0,y:0},{x:this.width,y:0},{x:0,y:this.height},{x:this.width,y:this.height}]};E.prototype.render=function(l,D,L){if(!this.vertices)throw Error("BaseImage.render is not implemented for this type!");l.save();l.beginPath();var U="outline"!==this.style.toString().toLowerCase();if(l.isEqualityTest||U)var ha=this.vertices;else{var ra=u(this.vertices)/2,xa=G(this.vertices)/2;ha=this.vertices.map(function(Aa){return{x:Aa.x+(Aa.x<ra?.5:-.5),y:Aa.y+(Aa.y<xa?
.5:-.5)}})}l.moveTo(D+ha[0].x,L+ha[0].y);ha.forEach(function(Aa){l.lineTo(D+Aa.x,L+Aa.y)});l.closePath();U?(l.fillStyle=Ra(this.color,this.style),l.fill()):(l.strokeStyle=Ra(this.color),l.stroke());l.restore()};world.Kernel.makeCanvas=makeCanvas=function(l,D){var L=document.createElement("canvas");L.width=l;L.height=D;L.style.width=L.width+"px";L.style.height=L.height+"px";return L};E.prototype.toDomNode=function(l){var D=this;l=D.getWidth();var L=D.getHeight(),U=world.Kernel.makeCanvas(l,L),ha;U.afterAttach=
function(){ha=U.getContext("2d");D.render(ha,0,0)};U.ariaText=this.getAriaText(E.ariaNestingDepth);return U};E.ariaNestingDepth=6;E.prototype.toWrittenString=function(l){return"<image>"};E.prototype.toDisplayedString=this.toWrittenString;E.prototype.getAriaText=function(l){return"image"};E.prototype.isEqual=function(l,D){if(!(l instanceof E)||this.getWidth()!==l.getWidth()||this.getHeight()!==l.getHeight())return!1;if(this.vertices&&l.vertices&&this.style===l.style&&types.isEqual(this.color,l.color,
D)&&na(this.vertices,l.vertices))return console.log("Using fast path for image equality check"),!0;console.log("Using slow path for image equality check");D=this.toDomNode();var L=l.toDomNode();D.style.visibility=L.style.visibility="hidden";if(D.width!==L.width||D.height!==L.height)return!1;try{var U=D.getContext("2d"),ha=L.getContext("2d");U.isEqualityTest=!0;ha.isEqualityTest=!0;this.render(U,0,0);l.render(ha,0,0);var ra=document.createElement("canvas").getContext("2d"),xa=document.createElement("canvas").getContext("2d"),
Aa=Math.min(1E4,D.width),Ta=Math.min(1E4,D.height);for(l=0;l<D.height;l+=Ta)for(U=0;U<D.width;U+=Aa){Aa=Math.min(Aa,D.width-U);Ta=Math.min(Ta,D.height-l);ra.canvas.width=xa.canvas.width=Aa;ra.canvas.height=xa.canvas.height=Ta;console.log("processing chunk from ("+U+","+l+") to ("+(U+Aa)+","+(l+Ta)+")");ra.clearRect(0,0,Aa,Ta);ra.drawImage(D,U,l,Aa,Ta,0,0,Aa,Ta);xa.clearRect(0,0,Aa,Ta);xa.drawImage(L,U,l,Aa,Ta,0,0,Aa,Ta);var Ha=ra.canvas.toDataURL(),Za=xa.canvas.toDataURL(),B=world.md5(Ha),J=world.md5(Za);
if(B!==J)return!1}}catch(V){return console.log("Couldn't compare images:",V),!1}return!0};var O=function(l,D,L,U,ha){this.width=l;this.height=D;this.children=L;this.withBorder=U;this.color=ha};O.prototype=C(E.prototype);O.prototype.add=function(l,D,L){return new O(this.width,this.height,this.children.concat([[l,D-l.getWidth()/2,L-l.getHeight()/2]]),this.withBorder,this.color)};O.prototype.getAriaText=function(l){if(0>=l)return"scene image";var D=" a Scene that is "+this.width+" by "+this.height+". children are: ";
return D+=this.children.map(function(L,U){return"child "+(U+1)+": "+L[0].getAriaText(l-1)+", positioned at "+L[1]+","+L[2]+" "}).join(". ")};O.prototype.render=function(l,D,L){var U,ha,ra;l.save();l.fillStyle=this.color?Ra(this.color):"transparent";l.fillRect(D,L,this.width,this.height);l.restore();l.save();l.beginPath();l.rect(D,L,this.width,this.height);l.clip();this.children.forEach(function(xa){U=xa[0];ha=xa[1];ra=xa[2];U.render(l,ha+D,ra+L)});l.restore();this.withBorder&&(l.strokeStyle="black",
l.strokeRect(D,L,this.width,this.height))};O.prototype.isEqual=function(l,D){return l instanceof O&&this.width==l.width&&this.height==l.height&&this.children.length==l.children.length&&this.children.every(function(L,U){U=l.children[U];return L[1]==U[1]&&L[2]==U[2]&&types.isEqual(L[0],U[0],D)})||E.prototype.isEqual.call(this,l,D)};var P=function(l,D,L){function U(){ha.isLoaded=!0;ha.width=ha.img.width;ha.height=ha.img.height}var ha=this;this.src=l;this.isLoaded=!1;this.originalURI=decodeURIComponent(l).slice(16);
this.labeled=!1;this.animationHackImg=void 0;D&&D.complete?(ha.img=D,U()):(ha.img=new Image,ha.img.onload=U,ha.img.onerror=function(ra){ha.img.onerror="";ha.img.src="http://www.wescheme.org/images/broken.png"},ha.img.src=l);this.installHackToSupportAnimatedGifs(L)};P.prototype=C(E.prototype);P.prototype.getAriaText=function(l){return X&&X[this.originalURI]&&X[this.originalURI].labeled?X[this.originalURI].getAriaText():" an image file from "+this.originalURI};var X={},ia=5E3;window.myEditor&&setTimeout(W,
ia);P.makeInstance=function(l,D,L){var U=decodeURIComponent(l).slice(16);U in X?L(X[U]):X[U]=new P(l,D,L);return X[U]};P.prototype.render=function(l,D,L){l.drawImage(this.animationHackImg,D,L);setTimeout(function(){},5E3)};P.prototype.installHackToSupportAnimatedGifs=function(l){var D=this;this.animationHackImg=this.img.cloneNode(!0);document.body.appendChild(this.animationHackImg);this.animationHackImg.style.position="absolute";this.animationHackImg.style.top="-50000px";this.animationHackImg.complete?
l(D):this.animationHackImg.onload=function(){l(D)}};P.prototype.getWidth=function(){return Math.round(this.img.width)};P.prototype.getHeight=function(){return Math.round(this.img.height)};P.prototype.isEqual=function(l,D){return l instanceof P&&this.src===l.src||E.prototype.isEqual.call(this,l,D)};var Ba=function(l,D){var L=this;this.src=l;D?(this.video=D,this.width=L.video.videoWidth,this.height=L.video.videoHeight,this.video.volume=1,this.video.poster="http://www.wescheme.org/images/broken.png",
this.video.autoplay=!0,this.video.autobuffer=!0,this.video.loop=!0,this.video.play()):(this.video=document.createElement("video"),this.video.src=l,this.video.addEventListener("canplay",function(){this.width=L.video.videoWidth;this.height=L.video.videoHeight;this.video.poster="http://www.wescheme.org/images/broken.png";this.video.autoplay=!0;this.video.autobuffer=!0;this.video.loop=!0;this.video.play()}),this.video.addEventListener("error",function(U){L.video.onerror="";L.video.poster="http://www.wescheme.org/images/broken.png"}))};
Ba.prototype=C(E.prototype);Ba.prototype.getAriaText=function(l){return" a video file from "+decodeURIComponent(this.src).slice(16)};var ma={};Ba.makeInstance=function(l,D){l in Ba||(ma[l]=new Ba(l,D));return ma[l]};Ba.prototype.render=function(l,D,L){l.drawImage(this.video,D,L)};Ba.prototype.isEqual=function(l,D){return l instanceof Ba&&this.src===l.src||E.prototype.isEqual.call(this,l,D)};var wa=function(l,D,L){this.src=l;var U=this;L&&4===L.readyState?(U.audio=L,U.audio.autoplay=!0,U.audio.autobuffer=
!0,U.audio.currentTime=0,U.audio.loop=D,U.audio.play()):(U.audio=document.createElement("audio"),U.audio.src=l,U.audio.addEventListener("canplay",function(){U.audio.autoplay=!0;U.audio.autobuffer=!0;U.audio.currentTime=0;U.audio.loop=D;U.audio.play()}));return!0},ka={};wa.makeInstance=function(l,D,L){l in ka?(ka[l].audio.play(),afterInit(ka[l])):ka[l]=new wa(l,D,L,afterInit);return ka[l]};var oa=function(l){this.imageData=l;this.width=l.width;this.height=l.height};oa.prototype=C(E.prototype);oa.prototype.render=
function(l,D,L){l.putImageData(this.imageData,D,L)};var ca=function(l,D,L,U){var ha,ra;if("left"===L)var xa=ha=0;else"right"===L?(ha=Math.max(l.width,D.width)-l.width,xa=Math.max(l.width,D.width)-D.width):"beside"===L?(ha=0,xa=l.width):"middle"===L||"center"===L?(ha=Math.max(l.width,D.width)/2-l.width/2,xa=Math.max(l.width,D.width)/2-D.width/2):(ha=Math.max(L,0)-L,xa=Math.max(L,0));if("top"===U)var Aa=ra=0;else"bottom"===U?(ra=Math.max(l.height,D.height)-l.height,Aa=Math.max(l.height,D.height)-D.height):
"above"===U?(ra=0,Aa=l.height):"baseline"===U?(ra=Math.max(l.getBaseline(),D.getBaseline())-l.getBaseline(),Aa=Math.max(l.getBaseline(),D.getBaseline())-D.getBaseline()):"middle"===U||"center"===U?(ra=Math.max(l.height,D.height)/2-l.height/2,Aa=Math.max(l.height,D.height)/2-D.height/2):(ra=Math.max(U,0)-U,Aa=Math.max(U,0));var Ta=l.getVertices(),Ha=D.getVertices();Ta=Ta.map(function(B){return{x:B.x+ha,y:B.y+ra}});Ha=Ha.map(function(B){return{x:B.x+xa,y:B.y+Aa}});this._vertices=Ta.concat(Ha);this.x1=
ha;this.y1=ra;this.x2=xa;this.y2=Aa;this.img1=l;this.img2=D;var Za;-1<["middle","center"].indexOf(L)&&-1<["middle","center"].indexOf(U)?Za=" centered ":"left"===L?Za=" left-aligned ":"right"===L?Za=" right-aligned ":"beside"===L?Za=" beside ":isNaN(L)||(Za=" shifted left by "+L);"top"===U?Za+=" top-aligned ":"bottom"===U?Za+=" bottom-aligned ":"above"===U?Za+=" above ":isNaN(U)||(Za+=" , shifted up by "+U);this.width=u(this._vertices);this.height=G(this._vertices);this.positionText=Za};ca.prototype=
C(E.prototype);ca.prototype.getAriaText=function(l){return 0>=l?"overlay image":" an overlay: "+this.img1.getAriaText(l-1)+this.positionText+" above "+this.img2.getAriaText(l-1)};ca.prototype.getVertices=function(){return this._vertices};ca.prototype.render=function(l,D,L){l.save();this.img2.render(l,D+this.x2,L+this.y2);this.img1.render(l,D+this.x1,L+this.y1);l.restore()};ca.prototype.isEqual=function(l,D){return l instanceof ca&&this.width===l.width&&this.height===l.height&&this.x1===l.x1&&this.y1===
l.y1&&this.x2===l.x2&&this.y2===l.y2&&types.isEqual(this.img1,l.img1,D)&&types.isEqual(this.img2,l.img2,D)||E.prototype.isEqual.call(this,l,D)};var ua=function(l,D){D instanceof pa&&D.width==D.height&&(l=0);var L=Math.sin(l*Math.PI/180),U=Math.cos(l*Math.PI/180),ha=D.getVertices().map(function(xa){return{x:xa.x*U-xa.y*L,y:xa.x*L+xa.y*U}}),ra=v(ha);this._vertices=F(ha);this.img=D;this.width=u(ha);this.height=G(ha);this.angle=Math.round(l);this.translateX=-Math.min.apply(Math,ra.xs);this.translateY=
-Math.min.apply(Math,ra.ys)};ua.prototype=C(E.prototype);ua.prototype.getAriaText=function(l){return 0>=l?"rotated image":"Rotated image, "+-1*this.angle+" degrees: "+this.img.getAriaText(l-1)};ua.prototype.getVertices=function(){return this._vertices};ua.prototype.render=function(l,D,L){l.save();l.translate(D+this.translateX,L+this.translateY);l.rotate(this.angle*Math.PI/180);this.img.render(l,0,0);l.restore()};ua.prototype.isEqual=function(l,D){return l instanceof ua&&this.width===l.width&&this.height===
l.height&&this.angle===l.angle&&this.translateX===l.translateX&&this.translateY===l.translateY&&types.isEqual(this.img,l.img,D)||E.prototype.isEqual.call(this,l,D)};var Qa=function(l,D,L){this._vertices=L.getVertices().map(function(U){return{x:U.x*l,y:U.y*D}});this.img=L;this.width=L.width*l;this.height=L.height*D;this.xFactor=l;this.yFactor=D};Qa.prototype=C(E.prototype);Qa.prototype.getAriaText=function(l){return 0>=l?"scaled image":"Scaled Image, "+(this.xFactor===this.yFactor?"by "+this.xFactor:
"horizontally by "+this.xFactor+" and vertically by "+this.yFactor)+". "+this.img.getAriaText(l-1)};Qa.prototype.getVertices=function(){return this._vertices};Qa.prototype.render=function(l,D,L){l.save();l.scale(this.xFactor,this.yFactor);this.img.render(l,D/this.xFactor,L/this.yFactor);l.restore()};Qa.prototype.isEqual=function(l,D){return l instanceof Qa&&this.width===l.width&&this.height===l.height&&this.xFactor===l.xFactor&&this.yFactor===l.yFactor&&types.isEqual(this.img,l.img,D)||E.prototype.isEqual.call(this,
l,D)};var Sa=function(l,D,L,U,ha){this.x=l;this.y=D;this.width=L;this.height=U;this.img=ha};Sa.prototype=C(E.prototype);Sa.prototype.getAriaText=function(l){return 0>=l?"cropped image":"Cropped image, from "+this.x+", "+this.y+" to "+(this.x+this.width)+", "+(this.y+this.height)+": "+this.img.getAriaText(l-1)};Sa.prototype.render=function(l,D,L){l.save();l.beginPath();l.rect(D,L,this.width,this.height);l.clip();l.translate(-this.x,-this.y);this.img.render(l,D,L);l.restore()};Sa.prototype.isEqual=
function(l,D){return l instanceof Sa&&this.width===l.width&&this.height===l.height&&this.x===l.x&&this.y===l.y&&types.isEqual(this.img,l.img,D)||E.prototype.isEqual.call(this,l,D)};var Xa=function(l){this.img=l;this.width=l.width;this.height=l.height};Xa.prototype=C(E.prototype);Xa.prototype.getAriaText=function(l){return 0>=l?"framed image":" Framed image: "+this.img.getAriaText(l-1)};Xa.prototype.render=function(l,D,L){l.save();this.img.render(l,D,L);l.beginPath();l.strokeStyle="black";l.strokeRect(D,
L,this.width,this.height);l.closePath();l.restore()};Xa.prototype.isEqual=function(l,D){return l instanceof Xa&&types.isEqual(this.img,l.img,D)||E.prototype.isEqual.call(this,l,D)};var Oa=function(l,D){this.img=l;this.width=l.getWidth();this.height=l.getHeight();this.direction=D};Oa.prototype=C(E.prototype);Oa.prototype.getAriaText=function(l){return 0>=l?"flipped image":fa(this.direction)+"ly flipped image: "+this.img.getAriaText(l-1)};Oa.prototype.render=function(l,D,L){l.save();"horizontal"===
this.direction&&(l.scale(-1,1),l.translate(-(this.width+2*D),0));"vertical"===this.direction&&(l.scale(1,-1),l.translate(0,-(this.height+2*L)));this.img.render(l,D,L);l.restore()};Oa.prototype.isEqual=function(l,D){return l instanceof Oa&&this.width===l.width&&this.height===l.height&&this.direction===l.direction&&types.isEqual(this.img,l.img,D)||E.prototype.isEqual.call(this,l,D)};var Ra=function(l,D){D=isNaN(D)?1:D/255;var L=types.colorAlpha(l)/255;return"rgba("+types.colorRed(l)+", "+types.colorGreen(l)+
", "+types.colorBlue(l)+", "+D*L+")"},bb=function(l,D,L,U){this.width=l;this.height=D;this.style=L;this.color=U;this.vertices=[{x:0,y:D},{x:0,y:0},{x:l,y:0},{x:l,y:D}]};bb.prototype=C(E.prototype);bb.prototype.getAriaText=function(l){return fa(ja(this.color,this.style))+(this.width===this.height?" square of size "+this.width:" rectangle of width "+this.width+" and height "+this.height)};var Na=function(l,D,L,U){this.width=Math.sin(D/2*Math.PI/180)*l*2;this.height=Math.abs(Math.cos(D/2*Math.PI/180))*
l*2;this.style=L;this.color=U;this.side=l;this.angle=D;this.vertices=[{x:this.width/2,y:0},{x:this.width,y:this.height/2},{x:this.width/2,y:this.height},{x:0,y:this.height/2}]};Na.prototype=C(E.prototype);Na.prototype.getAriaText=function(l){return fa(ja(this.color,this.style))+" rhombus of size "+this.side+" and angle "+this.angle};var za=function(l,D,L){l=l.map(function(U){return{x:jsnums.toFixnum(types.posnX(U)),y:jsnums.toFixnum(types.posnY(U))}});console.log("vertices are",l);this.width=u(l);
this.height=G(l);this.style=D;this.color=L;this.vertices=F(l)};za.prototype=C(E.prototype);za.prototype.getAriaText=function(l){return fa(ja(this.color,this.style))+", "+this.vertices.length+"-pointed polygon "};var Da=function(l,D,L,U,ha,ra){this.outerRadius=Math.round(l/(2*Math.sin(Math.PI/D)));this.innerRadius=Math.round(l/(2*Math.tan(Math.PI/D)));for(var xa=3*Math.PI/2+Math.PI/D,Aa=0,Ta=[],Ha=0;Ha<D;Ha++)Aa+=2*L*Math.PI/D,Ta.push({x:Math.round(this.outerRadius*Math.cos(Aa-xa)),y:Math.round(this.outerRadius*
Math.sin(Aa-xa))});this.width=u(Ta);this.height=G(Ta);this.length=l;this.count=D;this.style=U;this.color=ha;this.vertices=F(Ta);this.ariaOverride=ra};Da.prototype=C(E.prototype);Da.prototype.getAriaText=function(l){return fa(ja(this.color,this.style))+(this.ariaOverride?" "+this.ariaOverride+" of size "+this.length:", "+this.count+" sided polygon with each side of length "+this.length)};var Fa=function(l,D,L,U,ha,ra,xa,Aa,Ta){l=JSON.stringify(l);this.str=l.substring(1,l.length-1);this.size=D;this.color=
L;this.face=U;this.family=ha;this.outline=Ta||!1;this.style="slant"===ra?"oblique":ra;this.weight="light"===xa?"lighter":xa;this.underline=Aa;this.font=this.style+" "+this.weight+" "+this.size+'px "'+this.face+'", '+this.family;l=document.createElement("div");D=document.createElement("span");L=document.createElement("img");D.style.font=this.font;L.width=42;L.height=1;L.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQIHWM4MbPgPwAGzwLR05RbqwAAAABJRU5ErkJggg==";l.style.cssText=
"position: absolute; top: 0px; left: 0px; zIndex=-1; white-space: pre;";D.appendChild(document.createTextNode(this.str));D.appendChild(L);l.appendChild(D);document.body.appendChild(l);L.style.display="none";D.style.display="inline";this.alphaBaseline=0;this.width=D.offsetWidth;this.height=D.offsetHeight;document.body.removeChild(l)};Fa.prototype=C(E.prototype);Fa.prototype.getAriaText=function(l){return" a string "+this.str+", colored "+ja(this.color,"solid")+" of size "+this.size};Fa.prototype.render=
function(l,D,L){l.save();l.textAlign="left";l.textBaseline="top";l.font=this.font;l.fillStyle=this.outline?"white":Ra(this.color);l.fillText(this.str,D,L);this.outline&&(l.strokeStyle=Ra(this.color),l.strokeText(this.str,D,L));this.underline&&(l.beginPath(),l.moveTo(D,L+this.size),l.lineTo(D+this.width,L+this.size),l.closePath(),l.strokeStyle=Ra(this.color),l.stroke());l.restore()};Fa.prototype.getBaseline=function(){return this.alphaBaseline};Fa.prototype.isEqual=function(l,D){return l instanceof
Fa&&this.str===l.str&&this.size===l.size&&this.face===l.face&&this.family===l.family&&this.style===l.style&&this.weight===l.weight&&this.underline===l.underline&&this.font===l.font&&types.isEqual(this.color,l.color,D)||E.prototype.isEqual.call(this,l,D)};var Q=function(l,D,L,U,ha){for(var ra=Math.max(L,D),xa=[],Aa=Math.PI/180,Ta=0;Ta<2*l+1;Ta++){var Ha=360/(2*l)*Ta*Aa-.5,Za=1===Ta%2?D:L;xa.push({x:ra+Math.sin(Ha)*Za,y:ra+Math.cos(Ha)*Za})}this.width=u(xa);this.height=G(xa);this.style=U;this.color=
ha;this.points=l;this.inner=L;this.outer=D;this.vertices=F(xa)};Q.prototype=C(E.prototype);Q.prototype.getAriaText=function(l){return fa(ja(this.color,this.style))+", "+this.points+"-pointed star with inner radius "+this.inner+" and outer radius "+this.outer};var sa=function(l,D,L,U,ha){this.sideC=l;this.sideB=L;this.angleA=D;var ra=L*Math.cos(D*Math.PI/180);D=L*Math.sin(D*Math.PI/180);L=0-Math.min(0,ra);var xa=[];0<D?(xa.push({x:L+0,y:0}),xa.push({x:L+l,y:0}),xa.push({x:L+ra,y:D})):(xa.push({x:L+
0,y:-D}),xa.push({x:L+l,y:-D}),xa.push({x:L+ra,y:0}));this.width=Math.max(l,ra)+L;this.height=Math.abs(D);this.style=U;this.color=ha;this.vertices=xa};sa.prototype=C(E.prototype);sa.prototype.getAriaText=function(l){l=fa(ja(this.color,this.style));return l=270===this.angleA?l+(" right triangle whose base is of length "+this.sideC+" and height of "+this.sideB):300===this.angleA&&this.sideC===this.sideB?l+(" equilateral triangle with sides of length "+this.sideC):l+(" triangle whose base is of length "+
this.sideC+", with an angle of "+this.angleA%180+" degrees between it and a side of length "+this.sideB)};var pa=function(l,D,L,U){this.width=l;this.height=D;this.style=L;this.color=U};pa.prototype=C(E.prototype);pa.prototype.getAriaText=function(l){return fa(ja(this.color,this.style))+(this.width===this.height?" circle of radius "+this.width/2:" ellipse of width "+this.width+" and height "+this.height)};pa.prototype.render=function(l,D,L){l.save();l.beginPath();var U="outline"!==this.style.toString().toLowerCase()?
0:.5,ha=this.width-2*U,ra=this.height-2*U;D+=U;L+=U;U=ha/2*.5522848;var xa=ra/2*.5522848,Aa=D+ha,Ta=L+ra;ha=D+ha/2;ra=L+ra/2;l.moveTo(D,ra);l.bezierCurveTo(D,ra-xa,ha-U,L,ha,L);l.bezierCurveTo(ha+U,L,Aa,ra-xa,Aa,ra);l.bezierCurveTo(Aa,ra+xa,ha+U,Ta,ha,Ta);l.bezierCurveTo(ha-U,Ta,D,ra+xa,D,ra);l.closePath();"outline"===this.style.toString().toLowerCase()?(l.strokeStyle=Ra(this.color),l.stroke()):(l.fillStyle=Ra(this.color,this.style),l.fill());l.restore()};pa.prototype.isEqual=function(l,D){return l instanceof
pa&&this.width===l.width&&this.height===l.height&&this.style===l.style&&types.isEqual(this.color,l.color,D)||E.prototype.isEqual.call(this,l,D)};var Pa=function(l,D,L){var U=0<=l?0<=D?[{x:0,y:0},{x:l,y:D}]:[{x:0,y:-D},{x:l,y:0}]:0<=D?[{x:-l,y:0},{x:0,y:D}]:[{x:-l,y:-D},{x:0,y:0}];this.x=l;this.y=D;this.width=Math.abs(l);this.height=Math.abs(D);this.style="outline";this.color=L;this.vertices=U};Pa.prototype=C(E.prototype);Pa.prototype.getAriaText=function(l){return fa(ja(this.color,""))+" line of width "+
this.x+" and height "+this.y};world.Kernel.applyEffect=function(l){if(l!==types.EMPTY){if(types.isPair(l))return world.Kernel.applyEffect(l.first).concat(world.Kernel.applyEffect(l.rest));if(l=l.run())return l}return[]};C=function(){this.colors={}};C.prototype.put=function(l,D){this.colors[l]=D};C.prototype.get=function(l){if(l.toString)return this.colors[l.toString().replace(/\s/g,"").toUpperCase()]};var R=new C;R.put("ORANGE",types.color(255,165,0,255));R.put("LIGHTORANGE",types.color(255,216,51,
255));R.put("MEDIUMORANGE",types.color(255,165,0,255));R.put("ORANGERED",types.color(255,69,0,255));R.put("TOMATO",types.color(255,99,71,255));R.put("RED",types.color(255,0,0,255));R.put("LIGHTRED",types.color(255,102,102,255));R.put("MEDIUMRED",types.color(255,0,0,255));R.put("DARKRED",types.color(139,0,0,255));R.put("FIREBRICK",types.color(178,34,34,255));R.put("CRIMSON",types.color(220,20,60,255));R.put("DEEPPINK",types.color(255,20,147,255));R.put("MAROON",types.color(176,48,96,255));R.put("INDIANRED",
types.color(205,92,92,255));R.put("MEDIUMVIOLETRED",types.color(199,21,133,255));R.put("VIOLETRED",types.color(208,32,144,255));R.put("LIGHTCORAL",types.color(240,128,128,255));R.put("HOTPINK",types.color(255,105,180,255));R.put("PALEVIOLETRED",types.color(219,112,147,255));R.put("LIGHTPINK",types.color(255,182,193,255));R.put("ROSYBROWN",types.color(188,143,143,255));R.put("PINK",types.color(255,192,203,255));R.put("MEDIUMPINK",types.color(255,192,203,255));R.put("DARKPINK",types.color(204,141,152,
255));R.put("ORCHID",types.color(218,112,214,255));R.put("LAVENDERBLUSH",types.color(255,240,245,255));R.put("SNOW",types.color(255,250,250,255));R.put("CHOCOLATE",types.color(210,105,30,255));R.put("SADDLEBROWN",types.color(139,69,19,255));R.put("BROWN",types.color(132,60,36,255));R.put("LIGHTBROWN",types.color(183,111,87,255));R.put("MEDIUMBROWN",types.color(132,60,36,255));R.put("DARKBROWN",types.color(81,9,0,255));R.put("DARKORANGE",types.color(255,140,0,255));R.put("CORAL",types.color(255,127,
80,255));R.put("SIENNA",types.color(160,82,45,255));R.put("ORANGE",types.color(255,165,0,255));R.put("SALMON",types.color(250,128,114,255));R.put("PERU",types.color(205,133,63,255));R.put("GOLDENROD",types.color(218,165,32,255));R.put("LIGHTGOLDENROD",types.color(255,216,83,255));R.put("DARKGOLDENROD",types.color(184,134,11,255));R.put("SANDYBROWN",types.color(244,164,96,255));R.put("LIGHTSALMON",types.color(255,160,122,255));R.put("DARKSALMON",types.color(233,150,122,255));R.put("GOLD",types.color(255,
215,0,255));R.put("YELLOW",types.color(255,255,0,255));R.put("LIGHTYELLOW",types.color(255,255,51,255));R.put("MEDIUMYELLOW",types.color(255,255,0,255));R.put("DARKYELLOW",types.color(204,204,0,255));R.put("OLIVE",types.color(128,128,0,255));R.put("BURLYWOOD",types.color(222,184,135,255));R.put("TAN",types.color(210,180,140,255));R.put("NAVAJOWHITE",types.color(255,222,173,255));R.put("PEACHPUFF",types.color(255,218,185,255));R.put("KHAKI",types.color(240,230,140,255));R.put("DARKKHAKI",types.color(189,
183,107,255));R.put("MOCCASIN",types.color(255,228,181,255));R.put("WHEAT",types.color(245,222,179,255));R.put("BISQUE",types.color(255,228,196,255));R.put("PALEGOLDENROD",types.color(238,232,170,255));R.put("BLANCHEDALMOND",types.color(255,235,205,255));R.put("MEDIUMGOLDENROD",types.color(234,234,173,255));R.put("PAPAYAWHIP",types.color(255,239,213,255));R.put("MISTYROSE",types.color(255,228,225,255));R.put("LEMONCHIFFON",types.color(255,250,205,255));R.put("ANTIQUEWHITE",types.color(250,235,215,
255));R.put("CORNSILK",types.color(255,248,220,255));R.put("LIGHTGOLDENRODYELLOW",types.color(250,250,210,255));R.put("OLDLACE",types.color(253,245,230,255));R.put("LINEN",types.color(250,240,230,255));R.put("LIGHTYELLOW",types.color(255,255,224,255));R.put("SEASHELL",types.color(255,245,238,255));R.put("BEIGE",types.color(245,245,220,255));R.put("FLORALWHITE",types.color(255,250,240,255));R.put("IVORY",types.color(255,255,240,255));R.put("GREEN",types.color(0,255,0,255));R.put("MEDIUMGREEN",types.color(0,
255,0,255));R.put("LAWNGREEN",types.color(124,252,0,255));R.put("CHARTREUSE",types.color(127,255,0,255));R.put("GREENYELLOW",types.color(173,255,47,255));R.put("YELLOWGREEN",types.color(154,205,50,255));R.put("OLIVEDRAB",types.color(107,142,35,255));R.put("MEDIUMFORESTGREEN",types.color(107,142,35,255));R.put("DARKOLIVEGREEN",types.color(85,107,47,255));R.put("DARKSEAGREEN",types.color(143,188,139,255));R.put("LIME",types.color(0,255,0,255));R.put("DARKGREEN",types.color(0,100,0,255));R.put("LIMEGREEN",
types.color(50,205,50,255));R.put("FORESTGREEN",types.color(34,139,34,255));R.put("SPRING GREEN",types.color(0,255,127,255));R.put("SPRINGGREEN",types.color(0,255,127,255));R.put("MEDIUMSPRINGGREEN",types.color(0,250,154,255));R.put("SEAGREEN",types.color(46,139,87,255));R.put("MEDIUMSEAGREEN",types.color(60,179,113,255));R.put("AQUAMARINE",types.color(112,216,144,255));R.put("LIGHTGREEN",types.color(144,238,144,255));R.put("PALEGREEN",types.color(152,251,152,255));R.put("MEDIUM AQUAMARINE",types.color(102,
205,170,255));R.put("MEDIUMAQUAMARINE",types.color(102,205,170,255));R.put("TURQUOISE",types.color(64,224,208,255));R.put("LIGHTTURQUOISE",types.color(155,255,255,255));R.put("MEDIUMTURQUOISE",types.color(72,209,204,255));R.put("LIGHTSEAGREEN",types.color(32,178,170,255));R.put("HONEYDEW",types.color(240,255,240,255));R.put("MINTCREAM",types.color(245,255,250,255));R.put("ROYALBLUE",types.color(65,105,225,255));R.put("DODGERBLUE",types.color(30,144,255,255));R.put("DEEPSKYBLUE",types.color(0,191,
255,255));R.put("CORNFLOWERBLUE",types.color(100,149,237,255));R.put("STEELBLUE",types.color(70,130,180,255));R.put("LIGHTSKYBLUE",types.color(135,206,250,255));R.put("DARKTURQUOISE",types.color(0,206,209,255));R.put("CYAN",types.color(0,255,255,255));R.put("LIGHTCYAN",types.color(224,255,255,255));R.put("MEDIUMCYAN",types.color(0,255,255,255));R.put("DARKCYAN",types.color(0,139,139,255));R.put("AQUA",types.color(0,255,255,255));R.put("TEAL",types.color(0,128,128,255));R.put("SKYBLUE",types.color(135,
206,235,255));R.put("CADETBLUE",types.color(95,158,160,255));R.put("DARKSLATEGRAY",types.color(47,79,79,255));R.put("LIGHTSLATEGRAY",types.color(119,136,153,255));R.put("SLATEGRAY",types.color(112,128,144,255));R.put("LIGHTSTEELBLUE",types.color(176,196,222,255));R.put("LIGHTBLUE",types.color(173,216,230,255));R.put("POWDERBLUE",types.color(176,224,230,255));R.put("PALETURQUOISE",types.color(175,238,238,255));R.put("ALICEBLUE",types.color(240,248,255,255));R.put("AZURE",types.color(240,255,255,255));
R.put("MEDIUMBLUE",types.color(0,0,205,255));R.put("DARKBLUE",types.color(0,0,139,255));R.put("MIDNIGHTBLUE",types.color(25,25,112,255));R.put("NAVY",types.color(36,36,140,255));R.put("BLUE",types.color(0,0,255,255));R.put("INDIGO",types.color(75,0,130,255));R.put("BLUEVIOLET",types.color(138,43,226,255));R.put("MEDIUMSLATEBLUE",types.color(123,104,238,255));R.put("SLATEBLUE",types.color(106,90,205,255));R.put("PURPLE",types.color(160,32,240,255));R.put("LIGHTPURPLE",types.color(211,83,255,255));
R.put("MEDIUMPURPLE",types.color(147,112,219,255));R.put("DARKPURPLE",types.color(109,0,189,255));R.put("DARKSLATEBLUE",types.color(72,61,139,255));R.put("DARKVIOLET",types.color(148,0,211,255));R.put("DARKORCHID",types.color(153,50,204,255));R.put("MEDIUMORCHID",types.color(186,85,211,255));R.put("MAGENTA",types.color(255,0,255,255));R.put("FUCHSIA",types.color(255,0,255,255));R.put("DARKMAGENTA",types.color(139,0,139,255));R.put("VIOLET",types.color(238,130,238,255));R.put("PLUM",types.color(221,
160,221,255));R.put("LAVENDER",types.color(230,230,250,255));R.put("THISTLE",types.color(216,191,216,255));R.put("GHOSTWHITE",types.color(248,248,255,255));R.put("WHITE",types.color(255,255,255,255));R.put("WHITESMOKE",types.color(245,245,245,255));R.put("GAINSBORO",types.color(220,220,220,255));R.put("LIGHTGRAY",types.color(211,211,211,255));R.put("LIGHTGREY",types.color(211,211,211,255));R.put("SILVER",types.color(192,192,192,255));R.put("GRAY",types.color(190,190,190,255));R.put("GREY",types.color(190,
190,190,255));R.put("MEDIUMGRAY",types.color(190,190,190,255));R.put("MEDIUMGREY",types.color(190,190,190,255));R.put("DARKGRAY",types.color(169,169,169,255));R.put("DARKGREY",types.color(169,169,169,255));R.put("DIMGRAY",types.color(105,105,105,255));R.put("DIMGREY",types.color(105,105,105,255));R.put("BLACK",types.color(0,0,0,255));R.put("TRANSPARENT",types.color(0,0,0,0));C=[];oa=R.colors;for(var ta in oa)if(oa.hasOwnProperty(ta)){var Ua=q(types.colorRed(oa[ta]),types.colorGreen(oa[ta]),types.colorBlue(oa[ta]));
C.push({name:ta,l:Ua.l,a:Ua.a,b:Ua.b})}world.Kernel.isImage=function(l){return null!==l&&void 0!==l&&l instanceof E};world.Kernel.isScene=function(l){return void 0!==l&&null!==l&&l instanceof O};world.Kernel.isColor=function(l){return types.isColor(l)||(types.isString(l)||types.isSymbol(l))&&"undefined"!==typeof R.get(l)};world.Kernel.nameToColor=function(l){return R.get(""+l)};world.Kernel.colorDb=R;world.Kernel.colorLabs=C;world.Kernel.sceneImage=function(l,D,L,U,ha){return new O(l,D,L,U,ha)};world.Kernel.circleImage=
function(l,D,L){return new pa(2*l,2*l,D,L)};world.Kernel.starImage=function(l,D,L,U,ha){return new Q(l,D,L,U,ha)};world.Kernel.rectangleImage=function(l,D,L,U){return new bb(l,D,L,U)};world.Kernel.rhombusImage=function(l,D,L,U){return new Na(l,D,L,U)};world.Kernel.polygonImage=function(l,D,L,U,ha,ra){return new Da(l,D,L,U,ha,ra)};world.Kernel.posnImage=function(l,D,L){return new za(l,D,L)};world.Kernel.squareImage=function(l,D,L){return new bb(l,l,D,L)};world.Kernel.triangleImage=function(l,D,L,U,
ha){return new sa(l,D,L,U,ha)};world.Kernel.ellipseImage=function(l,D,L,U){return new pa(l,D,L,U)};world.Kernel.lineImage=function(l,D,L){return new Pa(l,D,L)};world.Kernel.overlayImage=function(l,D,L,U){return new ca(l,D,L,U)};world.Kernel.rotateImage=function(l,D){return new ua(l,D)};world.Kernel.scaleImage=function(l,D,L){return new Qa(l,D,L)};world.Kernel.cropImage=function(l,D,L,U,ha){return new Sa(l,D,L,U,ha)};world.Kernel.frameImage=function(l){return new Xa(l)};world.Kernel.flipImage=function(l,
D){return new Oa(l,D)};world.Kernel.textImage=function(l,D,L,U,ha,ra,xa,Aa,Ta){return new Fa(l,D,L,U,ha,ra,xa,Aa,Ta)};world.Kernel.fileImage=function(l,D,L){return P.makeInstance(l,D,L)};world.Kernel.fileVideo=function(l,D){return Ba.makeInstance(l,D)};world.Kernel.fileAudio=function(l,D,L){return wa.makeInstance(l,D,L)};world.Kernel.isSceneImage=function(l){return l instanceof O};world.Kernel.isStarImage=function(l){return l instanceof Q};world.Kernel.isRectangleImage=function(l){return l instanceof
bb};world.Kernel.isPolygonImage=function(l){return l instanceof Da};world.Kernel.isRhombusImage=function(l){return l instanceof Na};world.Kernel.isTriangleImage=function(l){return l instanceof sa};world.Kernel.isEllipseImage=function(l){return l instanceof pa};world.Kernel.isLineImage=function(l){return l instanceof Pa};world.Kernel.isOverlayImage=function(l){return l instanceof ca};world.Kernel.isRotateImage=function(l){return l instanceof ua};world.Kernel.isScaleImage=function(l){return l instanceof
Qa};world.Kernel.isCropImage=function(l){return l instanceof Sa};world.Kernel.isFrameImage=function(l){return l instanceof Xa};world.Kernel.isFlipImage=function(l){return l instanceof Oa};world.Kernel.isTextImage=function(l){return l instanceof Fa};world.Kernel.isFileImage=function(l){return l instanceof P};world.Kernel.isFileVideo=function(l){return l instanceof Ba}})();
(function(){var W=jsworld.MobyJsworld={},fa=jsworld.Jsworld;(function(){for(var ka=0,oa=["ms","moz","webkit","o"],ca=0;ca<oa.length&&!window.requestAnimationFrame;++ca)window.requestAnimationFrame=window[oa[ca]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[oa[ca]+"CancelAnimationFrame"]||window[oa[ca]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(ua,Qa){var Sa=(new Date).getTime(),Xa=Math.max(0,16-(Sa-ka));Qa=window.setTimeout(function(){ua(Sa+
Xa)},Xa);ka=Sa+Xa;return Qa});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(ua){clearTimeout(ua)})})();document.getElementById("bigBangLog");var ja,q=function(ka){ja=function(oa,ca,ua){ka(oa,ca,ua,wa)}},m=function(){ja=function(){throw Error("caller not defined!");}};m();var C,da=function(ka){var oa=!1;C=function(ca){if(oa)throw Error("Cannot restart twice!");oa=!0;ka(ca)}};(function(){C=function(){throw Error("restarter not defined!");}})();var na,v=function(){na=function(){throw Error("terminator not defined!");
}};v();var u=[],G=function(ka){helpers.forEachK(u,function(oa,ca){ja(oa.startup,oa.startupArgs,function(ua){oa.shutdownArg=ua;ca()})},wa,ka)},F=function(ka){var oa=u;u=[];helpers.forEachK(oa,function(ca,ua){ja(ca.shutdown,[ca.shutdownArg],ua)},wa,ka)},E=function(ka){return types.jsObject("function",function(){for(var oa=[],ca=0;ca<arguments.length;ca++)oa.push(helpers.wrapJsObject(arguments[ca]));W.updateWorld(function(ua,Qa){ua=[ua].concat(oa);ja(ka,ua,Qa)},function(){})})},O=function(ka,oa){types.isJsObject(ka)?
oa(ka.obj):types.isRenderEffect(ka)?ka.callImplementation(ja,function(ca){O(ca,oa)}):types.isPair(ka)?O(ka.first(),function(ca){O(ka.rest(),function(ua){oa(types.cons(ca,ua))})}):oa(ka)},P=types.isPair,X=function(ka){return P(ka)||ka===types.EMPTY};W.printWorldHook=function(ka,oa){null==oa.lastChild?(ka=types.toDomNode(ka),oa.appendChild(ka)):(ka=types.toDomNode(ka),oa.replaceChild(ka,oa.lastChild));helpers.maybeCallAfterAttach(ka)};var ia=function(ka,oa,ca){var ua=function(Sa,Xa){throw types.schemeError(types.incompleteExn(types.exnFailContract,
helpers.format(Sa,Xa),[]));};if(!fa.isPage(ka))if(types.isPair(ka)){var Qa=ka.first();ca=ka.rest();"undefined"==typeof Qa.nodeType&&ua("on-draw: expected a dom-element, but received ~s instead, the first element within ~s",[Qa,oa]);Qa.nodeType!=Node.TEXT_NODE||ca.isEmpty()||ua("on-draw: the text node ~s must not have children.  It has ~s",[Qa,ca]);for(oa=2;!ca.isEmpty();)ia(ca.first(),ka,oa),ca=ca.rest(),oa++}else Qa="on-draw: expected a dom-s-expression, but received ~s instead",ka=[ka],void 0!=
ca&&(Qa+=", the ~a element within ~s",ka.push(helpers.ordinalize(ca)),ka.push(oa)),ua(Qa+".",ka)},Ba=function(ka,oa,ca){ka.addEventListener?ka.addEventListener(oa,ca,!1):ka.attachEvent("on"+oa,ca,!1);return function(){ma(ka,oa,ca)}},ma=function(ka,oa,ca){ka.addEventListener?ka.removeEventListener(oa,ca,!1):ka.detachEvent("on"+oa,ca,!1)};W.bigBang=function(ka,oa,ca,ua,Qa){q(ua);da(Qa);na=function(Fa){ma(oa,"click",Xa);F(function(){m();v();C(Fa)})};var Sa=types.EMPTY;oa.tabIndex=0;var Xa=function(Fa){Fa.preventDefault?
Fa.preventDefault():Fa.returnValue=!1;Fa.stopPropagation?Fa.stopPropagation():Fa.cancelBubble=!0;return!1};Ba(oa,"click",Xa);[].push(function(){ma(oa,"click",Xa)});var Oa=new world.config.WorldConfig;for(ua=0;ua<ca.length;ua++)X(ca[ua])?Sa=ca[ua]:"function"==typeof ca[ua]?Oa=ca[ua](Oa):types.isWorldConfig(ca[ua])&&(ca[ua].startupArgs=helpers.map(E,ca[ua].startupArgs),u.push(ca[ua]));Oa=Oa.updateAll({changeWorld:W.updateWorld,shutdownWorld:W.shutdownWorld});new world.stimuli.StimuliHandler(Oa,ja,C);
var Ra=[],bb=[];if(Oa.lookup("onDraw"))ca=function(Fa,Q){try{ja(Oa.lookup("onDraw"),[Fa],function(sa){O(sa,function(pa){ia(pa,pa,void 0);pa=[oa,helpers.deepListToArray(pa)];Q(pa)})})}catch(sa){wa(sa)}},ua=Oa.lookup("onDrawCss")?function(Fa,Q){try{ja(Oa.lookup("onDrawCss"),[Fa],function(sa){sa=helpers.deepListToArray(sa);Q(sa)})}catch(sa){wa(sa)}}:function(Fa,Q){Q([])},Ra.push(fa.on_draw(ca,ua));else if(Oa.lookup("onRedraw")){var Na=void 0,za=void 0;ca=function(Fa,Q){window.requestAnimationFrame(function(sa){bb=
[sa/1E3].concat(bb);bb=bb.slice(0,3);try{Fa=fa.getCurrentWorld(),ja(Oa.lookup("onRedraw"),[Fa],function(pa){if(world.Kernel.isImage(pa)){var Pa=pa.getWidth(),R=pa.getHeight();Na||(Na=world.Kernel.makeCanvas(Pa,R),Na.jsworldOpaque=!0,za=fa.node_to_tree(Na));setTimeout(function(){Na.width=Pa;Na.height=R;var ta=Na.getContext("2d");pa.render(ta,0,0);ta=document.createElement("span");ta.className="screenreader-only";ta.appendChild(document.createTextNode(pa.getAriaText(6)));oa.appendChild(ta)},0);Q([oa,
za])}else wa("to-draw handler: is expected to return a scene or image")})}catch(pa){wa(pa)}})};ua=function(Fa,Q){Q([[Na,["width",Na.width+"px"],["height",Na.height+"px"]]])};Ra.push(fa.on_draw(ca,ua))}else Ra.push(fa.on_world_change(function(Fa,Q){W.printWorldHook(Fa,oa);Q()}));Oa.lookup("tickDelay")&&(ca=jsnums.toFixnum(Oa.lookup("tickDelay")),Ra.push(fa.on_tick(ca,function(Fa,Q){ja(Oa.lookup("onTick"),[Fa],Q)})));Oa.lookup("stopWhen")&&Ra.push(fa.stop_when(function(Fa,Q){ja(Oa.lookup("stopWhen"),
[Fa],function(sa){Q(sa)})},void 0,function(Fa,Q){lastPictureCss=function(sa,pa){pa([[Na,["width",Na.width+"px"],["height",Na.height+"px"]]])};return fa.on_draw(function(sa){try{Oa.lookup("lastPicture")&&(Fa=fa.getCurrentWorld(),ja(Oa.lookup("lastPicture"),[Fa],function(pa){world.Kernel.isImage(pa)?setTimeout(function(){Na.width=pa.getWidth();Na.height=pa.getHeight();var Pa=Na.getContext("2d");pa.render(Pa,0,0)},0):wa("stop-when handler: is expected to return a scene or image")}))}catch(pa){wa(pa)}},
lastPictureCss)()}));Oa.lookup("onKey")&&(Ra.push(fa.on_key(function(Fa,Q,sa){Q="keydown"===Q.type?helpers.getKeyCodeName(Q):String.fromCharCode(Q.which).replace(/[^\x00-\xFE]+/g,"");ja(Oa.lookup("onKey"),[Fa,Q],sa)})),oa.focus());var Da=!1;Oa.lookup("onMouse")&&(Oa.lookup("onRedraw")||Oa.lookup("onDraw")||wa("a mouse handler cannot be used without a draw handler"),Ra.push(fa.on_mouse(function(Fa,Q,sa){"mousedown"===Q.type&&(Da=!0);if("mouseup"===Q.type||"mouseleave"===Q.type)Da=!1;var pa=Q.pageX,
Pa=Q.pageY,R="mousedown"===Q.type?"button-down":"mouseup"===Q.type?"button-up":"mouseenter"===Q.type?"enter":"mouseleave"===Q.type?"leave":"mousemove"===Q.type&&Da?"drag":"mousemove"===Q.type?"move":Q.type,ta=Q.target;do pa-=ta.offsetLeft,Pa-=ta.offsetTop,ta=ta.offsetParent;while(ta);pa=pa*Q.target.width/Q.target.offsetWidth;scaledY=Pa*Q.target.height/Q.target.offsetHeight;ja(Oa.lookup("onMouse"),[Fa,pa,scaledY,R],sa)})));Oa.lookup("onTap")&&Ra.push(fa.on_tap(function(Fa,Q,sa){var pa=Q.pageX,Pa=Q.pageY;
Q=Q.target;do pa-=Q.offsetLeft,Pa-=Q.offsetTop,Q=Q.offsetParent;while(Q);ja(Oa.lookup("onTap"),[Fa,pa,Pa],sa)}));Oa.lookup("onTilt")&&(Ra.push(fa.on_tilt(function(Fa,Q,sa,pa){ja(Oa.lookup("onTilt"),[Fa,jsnums.makeFloat(Q),jsnums.makeFloat(sa)],pa)})),oa.focus());G(function(){fa.big_bang(oa,ka,Ra,helpers.assocListToHash(Sa),na)});return{breaker:function(){wa(types.schemeError(types.incompleteExn(types.exnBreak,"user break",[])))}}};var wa=function(ka){console.log("handling error",ka);world.stimuli.massShutdown();
F(function(){types.isSchemeError(ka)?(console.log(1),na(ka)):types.isInternalError(ka)?(console.log(2),na(ka)):"string"==typeof ka?(console.log(3),na(types.schemeError(types.incompleteExn(types.exnFail,ka,[])))):ka instanceof Error?(console.log(4),na(types.schemeError(types.incompleteExn(types.exnFail,ka.message,[])))):(console.log(5),na(types.schemeError(ka)))})};W.updateWorld=function(ka,oa){fa.change_world(function(ca,ua){try{ka(ca,ua)}catch(Qa){wa(Qa)}},oa)};W.shutdownWorld=function(){fa.shutdown()};
W.p=fa.p;W.div=fa.div;W.buttonBang=function(ka,oa,ca){return fa.button(function(ua,Qa,Sa){try{ja(ka,[ua],function(Xa){Sa(Xa)})}catch(Xa){wa(Xa)}},ca)};W.input=function(ka,oa,ca){return fa.input(ka,function(ua,Qa,Sa){ja(oa,[ua,Qa],Sa)},ca)};W.get_dash_input_dash_value=function(ka){return types.isString(ka)?document.getElementById(ka).value||"":ka.value||""};W.img=fa.img;W.text=fa.text;W.select=function(ka,oa,ca){return fa.select(ca,ka,function(ua,Qa,Sa){ja(oa,[ua,Qa.target.value],Sa)})};W.emptyPage=
fa.emptyPage;W.placeOnPage=function(ka,oa,ca,ua){ka=types.toDomNode(O(ka));return fa.placeOnPage(ka,oa,ca,ua)}})();var primitive={};
(function(){function W(c,b,e,g){c=state.captureCurrentContinuationMarks(c).ref("moby-application-position-key");var p=c[c.length-1];c=p.first();p=p.rest().first();g!==e&&(b=new types.Message([new types.ColoredPart(b,c),": expected a "+e+"-argument function as input, but given",new types.ColoredPart("a function",p),"of "+g+" arguments"]),ca(types.incompleteExn(types.exnFailContract,b,[])))}var fa,ja,q={},m=types.PrimProc,C=types.CasePrimitive,da=function(c){return c},na=function(c,b){return b instanceof
types.ValuesWrapper?fa(c,b.elts,da):fa(c,[b],da)},v=function(c,b){t(c,b,B,"procedure-arity","function",1,[b]);c=function(p){return p instanceof types.ContinuationClosureValue?types.arityAtLeast(0):p.isRest?types.arityAtLeast(p.numParams):p.numParams};if(b instanceof m||b instanceof types.ClosureValue||b instanceof types.ContinuationClosureValue)return c(b);if(b instanceof C)b=b.cases;else if(b instanceof types.CaseLambdaValue)b=b.closures;else throw types.internalError("procedure-arity given wrong type that passed isFunction!",
!1);for(var e=[],g=0;g<b.length;g++)e.push(c(b[g]));e=u(e);return 1==e.length?e[0]:types.list(e)},u=function(c){c=c.splice(0);c.sort(function(e,g){return types.isArityAtLeast(e)&&types.isArityAtLeast(g)?types.arityValue(e)-types.arityValue(g):types.isArityAtLeast(e)?types.arityValue(e)-g-.5:types.isArityAtLeast(g)?e-types.arityValue(g)+.5:e-g});for(var b=0;b<c.length-1;b++)if(types.isArityAtLeast(c[b]))return c.splice(0,b+1);return c},G=helpers.procArityContains,F=function(c){for(var b=0;!c.isEmpty();c=
c.rest())b+=1;return b},E=function(c,b){if(0==b.length)return types.EMPTY;var e=b.slice(0,b.length-1),g=b[b.length-1];Ja(e,function(w,M){ab(c,w,"append",M+1,b)});for(var p=e.length-1;0<=p;p--)g=e[p].append(g);return g},O=function(c,b,e){if(e[0].isEmpty())return b;for(var g=[],p=[],w=0;w<e.length;w++)g.push(e[w].first()),p.push(e[w].rest());g.push(b);return fa(c,g,function(M){return O(c,M,p)})},P=function(c){return function(b,e,g){ab(b,e,c,1,arguments);t(b,g,G(2),c,"procedure (arity 2)",2,arguments);
var p=function(w,M){if(M.isEmpty())return types.EMPTY;var ba=new m("compYes",1,!1,!1,function(Wa,$a){return fa(g,[$a,M.first()],da)}),Ca=new m("compNo",1,!1,!1,function(Wa,$a){return fa(g,[$a,M.first()],function(lb){return!lb})}),La=new m("quicksort",1,!1,!1,p);return fa(q.filter,[ba,M.rest()],function(Wa){return fa(La,[Wa],function($a){return fa(q.filter,[Ca,M.rest()],function(lb){return fa(La,[lb],function(Ob){return E(w,[$a,types.list([M.first()]),Ob])})})})})};return p(b,e)}},X=function(c,b){for(var e=
c[0],g=1;g<c.length;g++){if(!b(e,c[g]))return!1;e=c[g]}return!0},ia=function(c){var b;for(b=0;b<c.length;b++)if(!("a"<=c.charAt(b)&&"z">=c.charAt(b)||"A"<=c.charAt(b)&&"Z">=c.charAt(b)))return!1;return!0},Ba=function(){var c=RegExp("^\\s*$");return function(b){return b.match(c)?!0:!1}}(),ma=types.Class.extend({init:function(c){this.name=c},configure:function(c){throw types.internalError("unimplemented",!1);},toWrittenString:function(c){return"("+this.name+" ...)"},toDisplayedString:this.toWrittenString,
toDomNode:function(c){c=document.createElement("div");c.appendChild(document.createTextNode(this.toWrittenString()));return c}}),wa=function(c,b,e){return function(g,p){W(g,c,e,p.numParams);return ka(c,b)(g,p,new m("",e,!1,!1,function(w){return types.EMPTY}))}},ka=function(c,b){return function(e,g,p){t(e,g,B,c,"function",1,arguments);t(e,p,B,c,"function",2,arguments);return new (ma.extend({init:function(){this._super(c)},configure:function(w){var M={};M[b]=g;M[b+"Effect"]=p;return w.updateAll(M)}}))}},
oa=helpers.assocListToHash,ca=helpers.raise,ua=function(c){var b=function(e){"undefined"!==typeof console&&console.log&&(console.log("There was an error in a procedure converted from scheme to javascript"),e.stack?console.log(e.stack):console.log(e));throw e;};return function(e,g,p){return interpret.call(c,e,g,p,b)}},Qa=function(c,b){var e=function(g,p,w){return interpret.call(c,g,p,w,function(M){throw M;})};return function(g){for(var p=[],w=1;w<arguments.length;w++)p.push(arguments[w]);e(b,p,g)}},
Sa=function(c,b,e,g,p,w){m.call(this,b,e,g,p,w);this.typeName=c};Sa.prototype=m.prototype;var Xa=function(){Sa.apply(this,arguments)};Xa.prototype=Sa.prototype;var Oa=function(){Sa.apply(this,arguments)};Oa.prototype=Sa.prototype;var Ra=function(){Sa.apply(this,arguments)};Ra.prototype=Sa.prototype;var bb=function(){Sa.apply(this,arguments)};bb.prototype=Sa.prototype;var Na=function(c){var b=c.name;return new types.ValuesWrapper([c,new Xa(b,"make-"+b,c.numberOfArgs,!1,!1,function(e){return c.constructor.apply(null,
[].slice.call(arguments,1))}),new Oa(b,b+"?",1,!1,!1,function(e,g){return c.predicate(g)}),new Ra(b,b+"-ref",2,!1,!1,function(e,g,p){t(e,g,c.predicate,b+"-ref","struct:"+b,1,arguments);t(e,p,sa,b+"-ref","non-negative exact integer",2,arguments);var w=c.numberOfFields;jsnums.greaterThanOrEqual(p,w)&&ca(types.incompleteExn(types.exnFailContract,b+"-ref: slot index for <struct:"+b+"> not in [0, "+(w-1)+"]: "+p,[]));return c.accessor(g,jsnums.toFixnum(p))}),new bb(b,b+"-set!",3,!1,!1,function(e,g,p,w){t(e,
g,c.predicate,b+"-set!","struct:"+b,1,arguments);t(e,p,sa,b+"-set!","non-negative exact integer",2,arguments);var M=c.numberOfFields;jsnums.greaterThanOrEqual(p,M)&&ca(types.incompleteExn(types.exnFailContract,b+"-set!: slot index for <struct"+b+"> not in [0, "+(M-1)+"]: "+p,[]));c.mutator(g,jsnums.toFixnum(p),w)})])},za=jsnums.isSchemeNumber,Da=jsnums.isReal,Fa=jsnums.isRational,Q=jsnums.isInteger,sa=function(c){return jsnums.isExact(c)&&Q(c)&&jsnums.greaterThanOrEqual(c,0)},pa=function(c){return Da(c)&&
jsnums.greaterThanOrEqual(c,0)},Pa=function(c){return Da(c)&&!(jsnums.equals(c,jsnums.inf)||jsnums.equals(c,jsnums.negative_inf))&&jsnums.lessThan(c,180)&&jsnums.greaterThan(c,0)},R=function(c){return Q(c)&&jsnums.greaterThanOrEqual(c,3)},ta=function(c){return Q(c)&&jsnums.greaterThanOrEqual(c,1)},Ua=types.isSymbol,l=types.isChar,D=types.isString,L=types.isPair,U=helpers.isList,ha=helpers.isListOf,ra=types.isVector,xa=types.isBox,Aa=types.isHash,Ta=types.isByteString,Ha=function(c){return sa(c)&&
jsnums.lessThanOrEqual(c,255)},Za=function(c){return!0===c||!1===c},B=types.isFunction,J=function(c,b){return types.isEqual(c,b,new types.UnionFind)},V=function(c,b){return za(c)&&za(b)?jsnums.eqv(c,b):l(c)&&l(b)?c.val===b.val:c===b},Y=world.Kernel.isImage,A=world.Kernel.isScene,H=world.Kernel.isColor,N=world.Kernel.nameToColor,Z=function(c){return(D(c)||Ua(c))&&("default"==c.toString().toLowerCase()||"decorative"==c.toString().toLowerCase()||"roman"==c.toString().toLowerCase()||"script"==c.toString().toLowerCase()||
"swiss"==c.toString().toLowerCase()||"modern"==c.toString().toLowerCase()||"symbol"==c.toString().toLowerCase()||"system"==c.toString().toLowerCase())||!c},la=function(c){return(D(c)||Ua(c))&&("normal"==c.toString().toLowerCase()||"italic"==c.toString().toLowerCase()||"slant"==c.toString().toLowerCase())||!c},k=function(c){return(D(c)||Ua(c))&&("normal"==c.toString().toLowerCase()||"bold"==c.toString().toLowerCase()||"light"==c.toString().toLowerCase())||!c},y=world.Kernel.colorDb,K=function(c){return(D(c)||
Ua(c))&&("solid"==c.toString().toLowerCase()||"outline"==c.toString().toLowerCase())||Da(c)&&jsnums.greaterThanOrEqual(c,0)&&jsnums.lessThanOrEqual(c,255)},T=function(c){return(D(c)||Ua(c))&&("left"==c.toString().toLowerCase()||"right"==c.toString().toLowerCase()||"center"==c.toString().toLowerCase()||"middle"==c.toString().toLowerCase())},qa=function(c){return(D(c)||Ua(c))&&("top"==c.toString().toLowerCase()||"bottom"==c.toString().toLowerCase()||"baseline"==c.toString().toLowerCase()||"center"==
c.toString().toLowerCase()||"middle"==c.toString().toLowerCase())},Ga=function(c){return L(c)&&L(c.rest())&&c.rest().rest()===types.EMPTY},Ea=function(c){return-1<"button-down button-up drag move enter leave".split(" ").indexOf(c)},Va=function(c){return types.isEffect(c)||ha(c,Va)},Ka=types.isJsObject,db=function(c){return Ka(c)&&"function"==typeof c.obj},Ja=function(c,b){for(var e=0;e<c.length;e++)b.call(null,c[e],e)},t=helpers.check,Ya=helpers.checkVarArity,ab=function(c,b,e,g,p){U(b)||helpers.throwCheckError(c,
{functionName:e,typeName:"list",ordinalPosition:helpers.ordinalize(g),actualValue:b},g,p)},cb=helpers.checkListOf,jb=function(c,b,e,g,p,w){(!U(b)||F(b)<e)&&helpers.throwCheckError(c,{functionName:g,typeName:"list with "+e+" or more elements",ordinalPosition:helpers.ordinalize(p),actualValue:b},p,w)},sb=function(c,b,e,g){if(0!==b.length){var p=F(b[0]);Ja(b,function(w,M){F(w)!=p&&(w=helpers.map(function(ba){return" ~s"},g).join(""),w=helpers.format(e+": all lists must have the same size; arguments were:"+
w,g),ca(types.incompleteExn(types.exnFailContract,w,[])))})}},Bb=function(c){window.plt&&window.plt.wescheme&&plt.wescheme.WeSchemeIntentBus?(c=c.substring(0,20)+"..."+c.substring(c.length-20),plt.wescheme.WeSchemeIntentBus.notify("load-file",c)):console.log("Loading from "+c)};q["verify-boolean-branch-value"]=new m("verify-boolean-branch-value",4,!1,!1,function(c,b,e,g,p){!0!==g&&!1!==g&&(state.captureCurrentContinuationMarks(c).ref("moby-application-position-key"),ca(types.incompleteExn(types.exnFailContract,
new types.Message([new types.ColoredPart(b,e),": expected a boolean value, but found: ",new types.ColoredPart(types.toWrittenString(g),p)]),[])));return g});q["throw-cond-exhausted-error"]=new m("throw-cond-exhausted-error",1,!1,!1,function(c,b){ca(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("cond",b),": all question results were false"]),[]))});q["print-values"]=new m("print-values",0,!0,!1,function(c,b){for(var e=!1,g=0;g<b.length;g++)b[g]!==types.VOID&&(c.getPrintHook()(b[g]),
e=!0);e&&c.getDisplayHook()("\n");return types.VOID});q["check-expect"]=new m("check-expect",2,!1,!1,function(c,b,e){(B(b)||B(e))&&ca(types.incompleteExn(types.exnFailContract,"check-expect cannot compare functions",[]));if(!J(b,e))for(b=helpers.format("check-expect: actual value ~s differs from ~s, the expected value.\n",[b,e]),c.getDisplayHook()(b),b=state.getStackTraceFromContinuationMarks(state.captureCurrentContinuationMarks(c)),e=0;e<b.length;e++)c.getPrintHook()(helpers.makeLocationDom(b[e]));
return types.VOID});q.EXAMPLE=new m("EXAMPLE",2,!1,!1,function(c,b,e){(B(b)||B(e))&&ca(types.incompleteExn(types.exnFailContract,"EXAMPLE cannot compare functions",[]));if(!J(b,e)){var g="EXAMPLE failed: ";g="<image>"===types.toWrittenString(b)&&"<image>"===types.toWrittenString(e)?g+"Expected the two <image>s to match.":g+helpers.format("Got ~s, but expected ~s.\n",[b,e]);c.getDisplayHook()(g);b=state.getStackTraceFromContinuationMarks(state.captureCurrentContinuationMarks(c));for(e=0;e<b.length;e++)c.getPrintHook()(helpers.makeLocationDom(b[e]))}return types.VOID});
q["check-within"]=new m("check-within",3,!1,!1,function(c,b,e,g){if(!pa(g)){var p=helpers.format("check-within requires a non-negative real number for range, but given ~s.",[g]);ca(types.incompleteExn(types.exnFailContract,p,[]))}(B(b)||B(e))&&ca(types.incompleteExn(types.exnFailContract,"check-within cannot compare functions",[]));if(!(J(b,e)||Da(b)&&Da(e)&&jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(b,e)),g)))for(p=helpers.format("check-within: actual value ~s is not within ~s of expected value ~s.",
[b,g,e]),c.getDisplayHook()(p),b=state.getStackTraceFromContinuationMarks(state.captureCurrentContinuationMarks(c)),e=0;e<b.length;e++)c.getPrintHook()(helpers.makeLocationDom(b[e]));return types.VOID});var Mb=new m("print",1,!1,!1,function(c,b){c.getPrintHook()(types.toWrittenString(b));return types.VOID});q.write=new C("write",[new m("write",1,!1,!1,function(c,b){c.getPrintHook()(b);return types.VOID}),new m("write",2,!1,!0,function(c,b,e){throw types.internalError("write to a port not implemented yet.",
state.captureCurrentContinuationMarks(c));})]);q.display=new C("display",[new m("display",1,!1,!1,function(c,b){c.getDisplayHook()(types.toDisplayedString(b));return types.VOID}),new m("display",2,!1,!0,function(c,b,e){throw types.internalError("display to a port not implemented yet.",state.captureCurrentContinuationMarks(c));})]);q.newline=new C("newline",[new m("newline",0,!1,!0,function(c){c.getDisplayHook()("\n");c.v=types.VOID}),new m("newline",1,!1,!1,function(c,b){throw types.internalError("newline to a port not implemented yet.",
state.captureCurrentContinuationMarks(c));})]);q["current-print"]=new m("current-print",0,!1,!1,function(c){return Mb});q["current-continuation-marks"]=new m("current-continuation-marks",0,!1,!1,function(c){return state.captureCurrentContinuationMarks(c)});q["continuation-mark-set->list"]=new m("continuation-mark-set->list",2,!1,!1,function(c,b,e){t(c,b,types.isContinuationMarkSet,"continuation-mark-set->list","continuation-mark-set",1,[b,e]);return types.list(b.ref(e))});q["for-each"]=new m("for-each",
2,!0,!1,function(c,b,e,g){var p=[b,e].concat(g);g.unshift(e);t(c,b,B,"for-each","function",1,p);Ja(g,function(M,ba){ab(c,M,"for-each",ba+2,p)});sb(c,g,"for-each",p);var w=function(M){if(M[0].isEmpty())return types.VOID;for(var ba=[],Ca=[],La=0;La<M.length;La++)ba.push(M[La].first()),Ca.push(M[La].rest());return fa(b,ba,function(Wa){return w(Ca)})};return w(g)});q["make-thread-cell"]=new C("make-thread-cell",[new m("make-thread-cell",1,!1,!1,function(c,b){return new types.ThreadCell(b,!1)}),new m("make-thread-cell",
2,!1,!1,function(c,b,e){return new types.ThreadCell(b,e)})]);q["make-continuation-prompt-tag"]=new C("make-continuation-prompt-tag",[new m("make-continuation-prompt-tag",0,!1,!1,function(c){return new types.ThreadCell}),new m("make-continuation-prompt-tag",1,!1,!1,function(c,b){return new types.ThreadCell(b)})]);var rb=function(c,b,e,g,p){for(var w=function(Ca){return new m(c,b+Ca,!1,g,function(La){assert.equal(arguments.length,b+Ca+1);for(var Wa=[arguments],$a=0;$a<arguments.length;$a++)Wa.push(arguments[$a]);
return p.apply(p,Wa.concat(e.slice($a-b-1)))})},M=[],ba=0;ba<=e.length;ba++)M.push(w(ba));return new C(c,M)};q["make-struct-type"]=rb("make-struct-type",4,[!1,types.EMPTY,types.symbol("prefab"),!1,types.EMPTY,!1],!1,function(c,b,e,g,p,w,M,ba,Ca,La,Wa,$a){t(b,e,Ua,"make-struct-type","symbol",1,c);t(b,g,function(lb){return!1===lb||types.isStructType(lb)},"make-struct-type","struct-type or #f",2,c);t(b,p,sa,"make-struct-type","exact non-negative integer",3,c);t(b,w,sa,"make-struct-type","exact non-negative integer",
4,c);cb(b,Wa,sa,"make-struct-type","exact non-negative integer",9,c);t(b,$a,function(lb){return!1===lb||B(lb)},"make-struct-type","procedure or #f",10,c);c=p+1+(g?g.numberOfArgs:0);$a&&!G(c)($a)&&ca(types.incompleteExn(types.exnFailContract,helpers.format("make-struct-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",[c,$a]),[]));b=$a?Qa(b,$a):!1;e=types.makeStructureType(e.toString(),g,jsnums.toFixnum(p),jsnums.toFixnum(w),M,b);return Na(e)});
q["make-struct-field-accessor"]=rb("make-struct-field-accessor",2,[!1],!1,function(c,b,e,g,p){t(b,e,function(M){return M instanceof Ra&&1<M.numParams},"make-struct-field-accessor","accessor procedure that requires a field index",1,c);t(b,g,sa,"make-struct-field-accessor","exact non-negative integer",2,c);t(b,p,function(M){return!1===M||Ua(M)},"make-struct-field-accessor","symbol or #f",3,c);var w=jsnums.toFixnum(g);return new Ra(e.typeName,e.typeName+"-"+(p?p.toString():"field"+w),1,!1,!1,function(M,
ba){return e.impl(M,ba,w)})});q["make-struct-field-mutator"]=rb("make-struct-field-mutator",2,[!1],!1,function(c,b,e,g,p){t(b,e,function(M){return M instanceof bb&&1<M.numParams},"make-struct-field-mutator","mutator procedure that requires a field index",1,c);t(b,g,sa,"make-struct-field-mutator","exact non-negative integer",2,c);t(b,p,function(M){return!1===M||Ua(M)},"make-struct-field-mutator","symbol or #f",3,c);var w=jsnums.toFixnum(g);return new bb(e.typeName,e.typeName+"-"+(p?p.toString():"field"+
w),2,!1,!1,function(M,ba){return e.impl(b,M,w,ba)})});q["struct-type?"]=new m("struct-type?",1,!1,!1,function(c,b){return types.isStructType(b)});q["struct-constructor-procedure?"]=new m("struct-constructor-procedure?",1,!1,!1,function(c,b){return b instanceof Xa});q["struct-predicate-procedure?"]=new m("struct-predicate-procedure?",1,!1,!1,function(c,b){return b instanceof Oa});q["struct-accessor-procedure?"]=new m("struct-accessor-procedure?",1,!1,!1,function(c,b){return b instanceof Ra});q["struct-mutator-procedure?"]=
new m("struct-mutator-procedure?",1,!1,!1,function(c,b){return b instanceof bb});q["procedure-arity"]=new m("procedure-arity",1,!1,!1,function(c,b){return v(c,b)});q.apply=new m("apply",2,!0,!1,function(c,b,e,g){var p=[b,e].concat(g);t(c,b,B,"apply","function",1,p);g.unshift(e);e=g.pop();ab(c,e,"apply",g.length+2,p);g=g.concat(helpers.schemeListToArray(e));return fa(b,g,da)});q.values=new m("values",0,!0,!1,function(c,b){return 1===b.length?b[0]:new types.ValuesWrapper(b)});q["call-with-values"]=
new m("call-with-values",2,!1,!1,function(c,b,e){t(c,b,G(0),"call-with-values","procedure (arity 0)",1,arguments);t(c,e,B,"call-with-values","function",2,arguments);return fa(b,[],function(g){return na(e,g)})});q.compose=new m("compose",0,!0,!1,function(c,b){Ja(b,function(p,w){t(c,p,B,"compose","function",w+1,b)});if(0==b.length)return q.values;var e=types.list(b).reverse(),g=function(p,w){return w.isEmpty()?p:fa(new m("",1,!1,!1,function(M,ba){return na(w.first(),ba)}),[p],function(M){return g(M,
w.rest())})};return new m("",0,!0,!1,function(p,w){return 1===w.length?g(w[0],e):g(new types.ValuesWrapper(w),e)})});q["current-inexact-milliseconds"]=new m("current-inexact-milliseconds",0,!1,!1,function(c){return jsnums.makeFloat((new Date).valueOf())});q["current-seconds"]=new m("current-seconds",0,!1,!1,function(c){return Math.floor((new Date).getTime()/1E3)});q.not=new m("not",1,!1,!1,function(c,b){return!1===b});q["void"]=new m("void",0,!0,!1,function(c,b){return types.VOID});q.random=new C("random",
[new m("random",0,!1,!1,function(c){return types["float"](Math.random())}),new m("random",1,!1,!1,function(c,b){t(c,b,sa,"random","non-negative exact integer",1,arguments);return Math.floor(Math.random()*jsnums.toFixnum(b))})]);q.sleep=new C("sleep",[new m("sleep",0,!1,!1,function(c){return types.VOID}),new m("sleep",1,!1,!1,function(c,b){t(c,b,pa,"sleep","non-negative real number",1);var e=jsnums.toFixnum(jsnums.multiply(b,1E3));return ja(function(g,p){setTimeout(function(){g(types.VOID)},e)})})]);
q.identity=new m("identity",1,!1,!1,function(c,b){return b});q.raise=new m("raise",1,!1,!1,function(c,b){return ca(b)});q.error=new m("error",1,!0,!0,function(c,b,e){var g=[b].concat(e);t(c,b,function(w){return Ua(w)||D(w)},"error","symbol or string",1,g);if(Ua(b)){0===e.length&&ca(types.incompleteExn(types.exnFail,"error: "+b.val,[]));var p=e.shift();t(c,p,D,"error","string",2,g);e.unshift(b);ca(types.incompleteExn(types.exnFail,helpers.format("~s: "+p.toString(),e),[]))}else{c=[b.toString()];for(b=
0;b<e.length;b++)c.push(types.toWrittenString(e[b]));ca(types.incompleteExn(types.exnFail,c.join(""),[]))}});q["make-exn"]=new m("make-exn",2,!1,!1,function(c,b,e){return types.exn(b,e)});q["exn-message"]=new m("exn-message",1,!1,!1,function(c,b){t(c,b,types.isExn,"exn-message","exn",1,[b]);return""+types.exnMessage(b)});q["exn-continuation-marks"]=new m("exn-continuation-marks",1,!1,!1,function(c,b){t(c,b,types.isExn,"exn-continuation-marks","exn",1,[b]);return types.exnContMarks(b)});q["make-exn:fail"]=
new m("make-exn:fail",2,!1,!1,function(c,b,e){return types.exnFail(b,e)});q["make-exn:fail:contract"]=new m("make-exn:fail:contract",2,!1,!1,function(c,b,e){return types.exnFailContract(b,e)});q["make-exn:fail:contract:division-by-zero"]=new m("make-exn:fail:contract:division-by-zero",2,!1,!1,function(c,b,e){return types.exnFailContractDivisionByZero(b,e)});q["*"]=new m("*",0,!0,!1,function(c,b){Ja(b,function(p,w){t(c,p,za,"*","number",w+1,b)});var e=types.rational(1),g;for(g=0;g<b.length;g++)e=jsnums.multiply(b[g],
e);return e});q["-"]=new m("-",1,!0,!1,function(c,b,e){var g=[b].concat(e);t(c,b,za,"-","number",1,g);Ja(e,function(w,M){t(c,w,za,"-","number",M+2,g)});if(0==e.length)return jsnums.subtract(0,b);for(var p=0;p<e.length;p++)b=jsnums.subtract(b,e[p]);return b});q["+"]=new m("+",0,!0,!1,function(c,b){Ja(b,function(p,w){t(c,p,za,"+","number",w+1,b)});if(0==b.length)return 0;for(var e=b[0],g=1;g<b.length;g++)e=jsnums.add(e,b[g]);return e});q["="]=new m("=",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);
Ja(g,function(p,w){t(c,p,za,"=","number",w+1,g)});return X(g,jsnums.equals)});q["<>"]=new m("<>",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,za,"<>","number",w+1,g)});return!X(g,jsnums.equals)});q["=~"]=new m("=~",3,!1,!1,function(c,b,e,g){t(c,b,Da,"=~","real",1,arguments);t(c,e,Da,"=~","real",2,arguments);t(c,g,pa,"=~","non-negative-real",3,arguments);return jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(b,e)),g)});q["/"]=new m("/",2,!0,!1,function(c,b,e,g){var p=
[b,e].concat(g);Ja(p,function(M,ba){t(c,M,za,"/","number",ba+1,p)});var w=function(M){var ba;try{var Ca=state.captureCurrentContinuationMarks(c).ref("moby-application-position-key");var La=Ca[Ca.length-1];var Wa=La.first();La=La.rest();for(ba=0;ba<M;ba++)La=La.rest();var $a=new types.Message([new types.ColoredPart("/",Wa),": cannot divide by ",new types.ColoredPart("zero",La.first())])}catch(lb){$a=new types.Message(["/: cannot divide by zero"])}ca(types.incompleteExn(types.exnFailContractDivisionByZero,
$a,[]))};jsnums.equals(e,0)&&w(1);b=jsnums.divide(b,e);for(e=0;e<g.length;e++)jsnums.equals(g[e],0)&&w(2+e),b=jsnums.divide(b,g[e]);return b});q.sub1=new m("sub1",1,!1,!1,function(c,b){t(c,b,za,"sub1","number",1,arguments);return jsnums.subtract(b,1)});q.add1=new m("add1",1,!1,!1,function(c,b){t(c,b,za,"add1","number",1,arguments);return jsnums.add(b,1)});q["<"]=new m("<",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,za,"<","number",w+1,g)});return X(g,jsnums.lessThan)});
q[">"]=new m(">",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,za,">","number",w+1,g)});return X(g,jsnums.greaterThan)});q["<="]=new m("<=",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,za,"<=","number",w+1,g)});return X(g,jsnums.lessThanOrEqual)});q[">="]=new m(">=",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,za,">=","number",w+1,g)});return X(g,jsnums.greaterThanOrEqual)});q.abs=new m("abs",1,!1,!1,function(c,
b){t(c,b,Da,"abs","real",1);return jsnums.abs(b)});q.quotient=new m("quotient",2,!1,!1,function(c,b,e){t(c,b,Q,"quotient","integer",1,arguments);t(c,e,Q,"quotient","integer",2,arguments);return jsnums.quotient(b,e)});q.remainder=new m("remainder",2,!1,!1,function(c,b,e){t(c,b,Q,"remainder","integer",1,arguments);t(c,e,Q,"remainder","integer",2,arguments);return jsnums.remainder(b,e)});q.modulo=new m("modulo",2,!1,!1,function(c,b,e){t(c,b,Q,"modulo","integer",1,arguments);t(c,e,Q,"modulo","integer",
2,arguments);return jsnums.modulo(b,e)});q.max=new m("max",1,!0,!1,function(c,b,e){e.unshift(b);Ja(e,function(p,w){t(c,p,Da,"max","real",w+1,e)});for(var g=1;g<e.length;g++)jsnums.greaterThan(e[g],b)&&(b=e[g]);return b});q.min=new m("min",1,!0,!1,function(c,b,e){e.unshift(b);Ja(e,function(p,w){t(c,p,Da,"min","real",w+1,e)});for(var g=1;g<e.length;g++)jsnums.lessThan(e[g],b)&&(b=e[g]);return b});q.gcd=new m("gcd",1,!0,!1,function(c,b,e){var g=[b].concat(e);t(c,b,Q,"gcd","integer",1,g);Ja(e,function(p,
w){t(c,p,Q,"gcd","integer",w+2,g)});return jsnums.gcd(b,e)});q.lcm=new m("lcm",1,!0,!1,function(c,b,e){var g=[b].concat(e);t(c,b,Q,"lcm","integer",1,g);Ja(e,function(p,w){t(c,p,Q,"lcm","integer",w+2,g)});return jsnums.lcm(b,e)});q.floor=new m("floor",1,!1,!1,function(c,b){t(c,b,Da,"floor","real",1);return jsnums.floor(b)});q.ceiling=new m("ceiling",1,!1,!1,function(c,b){t(c,b,Da,"ceiling","real",1);return jsnums.ceiling(b)});q.round=new m("round",1,!1,!1,function(c,b){t(c,b,Da,"round","real",1);return jsnums.round(b)});
q.numerator=new m("numerator",1,!1,!1,function(c,b){t(c,b,Fa,"numerator","rational number",1);return jsnums.numerator(b)});q.denominator=new m("denominator",1,!1,!1,function(c,b){t(c,b,Fa,"denominator","rational number",1);return jsnums.denominator(b)});q.expt=new m("expt",2,!1,!1,function(c,b,e){t(c,b,za,"expt","number",1,arguments);t(c,e,za,"expt","number",2,arguments);return jsnums.expt(b,e)});q.exp=new m("exp",1,!1,!1,function(c,b){t(c,b,za,"exp","number",1);return jsnums.exp(b)});q.log=new m("log",
1,!1,!1,function(c,b){t(c,b,za,"log","number",1);return jsnums.log(b)});q.sin=new m("sin",1,!1,!1,function(c,b){t(c,b,za,"sin","number",1);return jsnums.sin(b)});q.cos=new m("cos",1,!1,!1,function(c,b){t(c,b,za,"cos","number",1);return jsnums.cos(b)});q.tan=new m("tan",1,!1,!1,function(c,b){t(c,b,za,"tan","number",1);return jsnums.tan(b)});q.asin=new m("asin",1,!1,!1,function(c,b){t(c,b,za,"asin","number",1);return jsnums.asin(b)});q.acos=new m("acos",1,!1,!1,function(c,b){t(c,b,za,"acos","number",
1);return jsnums.acos(b)});q.atan=new m("atan",1,!1,!1,function(c,b){t(c,b,za,"atan","number",1);return jsnums.atan(b)});q.sinh=new m("sinh",1,!1,!1,function(c,b){t(c,b,za,"sinh","number",1);return jsnums.sinh(b)});q.cosh=new m("cosh",1,!1,!1,function(c,b){t(c,b,za,"cosh","number",1);return jsnums.cosh(b)});q.sqr=new m("sqr",1,!1,!1,function(c,b){t(c,b,za,"sqr","number",1);return jsnums.sqr(b)});q.sqrt=new m("sqrt",1,!1,!1,function(c,b){t(c,b,za,"sqrt","number",1);return jsnums.sqrt(b)});q["nth-root"]=
new m("nth-root",2,!1,!1,function(c,b,e){t(c,b,za,"nth-root","number",1,arguments);t(c,e,za,"nth-root","number",2,arguments);var g=jsnums.expt(b,jsnums.divide(1,e)),p=jsnums.round(g),w=jsnums.subtract(g,p);return jsnums.lessThan(w,1E-11)?jsnums.toExact(p):g});q["integer-sqrt"]=new m("integer-sqrt",1,!1,!1,function(c,b){t(c,b,Q,"integer-sqrt","integer",1);return jsnums.integerSqrt(b)});q["make-rectangular"]=new m("make-rectangular",2,!1,!1,function(c,b,e){t(c,b,Da,"make-rectangular","real",1,arguments);
t(c,e,Da,"make-rectangular","real",2,arguments);return types.complex(b,e)});q["make-polar"]=new m("make-polar",2,!1,!1,function(c,b,e){t(c,b,Da,"make-polar","real",1,arguments);t(c,e,Da,"make-polar","real",2,arguments);return jsnums.makeComplexPolar(b,e)});q["real-part"]=new m("real-part",1,!1,!1,function(c,b){t(c,b,za,"real-part","number",1);return jsnums.realPart(b)});q["imag-part"]=new m("imag-part",1,!1,!1,function(c,b){t(c,b,za,"imag-part","number",1);return jsnums.imaginaryPart(b)});q.angle=
new m("angle",1,!1,!1,function(c,b){t(c,b,za,"angle","number",1);return jsnums.angle(b)});q.magnitude=new m("magnitude",1,!1,!1,function(c,b){t(c,b,za,"magnitude","number",1);return jsnums.magnitude(b)});q.conjugate=new m("conjugate",1,!1,!1,function(c,b){t(c,b,za,"conjugate","number",1);return jsnums.conjugate(b)});q.sgn=new m("sgn",1,!1,!1,function(c,b){t(c,b,Da,"sgn","real number",1);return jsnums.greaterThan(b,0)?1:jsnums.lessThan(b,0)?-1:0});q["inexact->exact"]=new m("inexact->exact",1,!1,!1,
function(c,b){t(c,b,za,"inexact->exact","number",1);try{return jsnums.toExact(b)}catch(e){ca(types.exnFailContract("inexact->exact: no exact representation for "+types.toWrittenString(b),!1))}});q["exact->inexact"]=new m("exact->inexact",1,!1,!1,function(c,b){t(c,b,za,"exact->inexact","number",1);return jsnums.toInexact(b)});q["number->string"]=new m("number->string",1,!1,!1,function(c,b){t(c,b,za,"number->string","number",1);return types.string(b+"")});q["string->number"]=new m("string->number",
1,!1,!1,function(c,b){t(c,b,D,"string->number","string",1);return(c=jsnums.fromString(b))?jsnums.toExact(c):c});q["xml->s-exp"]=new m("xml->s-exp",1,!1,!1,function(c,b){t(c,b,D,"xml->s-exp","string",1);if(0==b.length)return types.string("");try{var e=new ActiveXObject("Microsoft.XMLDOM");e.async="false";e.loadXML(s)}catch(p){e=(new DOMParser).parseFromString(s,"text/xml")}var g=function(p){if(p.nodeType==Node.ELEMENT_NODE){for(var w=types.EMPTY,M=p.firstChild;null!=M;){var ba=g(M);w=D(ba)&&!w.isEmpty()&&
D(w.first())?types.cons(w.first()+ba,w.rest()):types.cons(ba,w);M=M.nextSibling}w=w.reverse();M=types;ba=M.cons;var Ca=p.attributes;for(var La=types.EMPTY,Wa=0;Wa<Ca.length;Wa++){var $a=types.cons(types.symbol(Ca.item(Wa).nodeName),types.cons(Ca.item(Wa).nodeValue,types.EMPTY));La=types.cons($a,La)}Ca=types.cons(types.symbol("@"),La).reverse();w=ba.call(M,Ca,w);return w=types.cons(types.symbol(p.nodeName),w)}return p.nodeType==Node.TEXT_NODE?p.textContent:p.nodeType==Node.CDATA_SECTION_NODE?p.data:
types.EMPTY};return g(e.firstChild)});q["procedure?"]=new m("procedure?",1,!1,!1,function(c,b){return B(b)});q["pair?"]=new m("pair?",1,!1,!1,function(c,b){return L(b)});q["cons?"]=new m("cons?",1,!1,!1,function(c,b){return L(b)});q["empty?"]=new m("empty?",1,!1,!1,function(c,b){return b===types.EMPTY});q["null?"]=new m("null?",1,!1,!1,function(c,b){return b===types.EMPTY});q["undefined?"]=new m("undefined?",1,!1,!1,function(c,b){return b===types.UNDEFINED});q["void?"]=new m("void?",1,!1,!1,function(c,
b){return b===types.VOID});q["symbol?"]=new m("symbol?",1,!1,!1,function(c,b){return Ua(b)});q["string?"]=new m("string?",1,!1,!1,function(c,b){return D(b)});q["char?"]=new m("char?",1,!1,!1,function(c,b){return l(b)});q["boolean?"]=new m("boolean?",1,!1,!1,function(c,b){return Za(b)});q["vector?"]=new m("vector?",1,!1,!1,function(c,b){return ra(b)});q["struct?"]=new m("struct?",1,!1,!1,function(c,b){return types.isStruct(b)});q["eof-object?"]=new m("eof-object?",1,!1,!1,function(c,b){return b===
types.EOF});q["color?"]=new m("color?",1,!1,!1,function(c,b){return types.isColor(b)});q["posn?"]=new m("posn?",1,!1,!1,function(c,b){return types.isPosn(b)});q["bytes?"]=new m("bytes?",1,!1,!1,function(c,b){return Ta(b)});q["byte?"]=new m("byte?",1,!1,!1,function(c,b){return Ha(b)});q["number?"]=new m("number?",1,!1,!1,function(c,b){return za(b)});q["complex?"]=new m("complex?",1,!1,!1,function(c,b){return void 0!==b.i?types.TRUE:types.FALSE});q["real?"]=new m("real?",1,!1,!1,function(c,b){return Da(b)});
q["rational?"]=new m("rational?",1,!1,!1,function(c,b){return Fa(b)});q["integer?"]=new m("integer?",1,!1,!1,function(c,b){return Q(b)});q["exact?"]=new m("exact?",1,!1,!1,function(c,b){t(c,b,za,"exact?","number",1);return jsnums.isExact(b)});q["inexact?"]=new m("inexact?",1,!1,!1,function(c,b){t(c,b,za,"inexact?","number",1);return jsnums.isInexact(b)});q["odd?"]=new m("odd?",1,!1,!1,function(c,b){t(c,b,Q,"odd?","integer",1);return jsnums.equals(jsnums.modulo(b,2),1)});q["even?"]=new m("even?",1,
!1,!1,function(c,b){t(c,b,Q,"even?","integer",1);return jsnums.equals(jsnums.modulo(b,2),0)});q["zero?"]=new m("zero?",1,!1,!1,function(c,b){t(c,b,za,"zero?","number",1);return jsnums.equals(0,b)});q["positive?"]=new m("positive?",1,!1,!1,function(c,b){t(c,b,Da,"positive?","real",1);return jsnums.greaterThan(b,0)});q["negative?"]=new m("negative?",1,!1,!1,function(c,b){t(c,b,Da,"negative?","real",1);return jsnums.lessThan(b,0)});q["box?"]=new m("box?",1,!1,!1,function(c,b){return xa(b)});q["hash?"]=
new m("hash?",1,!1,!1,function(c,b){return Aa(b)});q["eq?"]=new m("eq?",2,!1,!1,function(c,b,e){return b===e});q["eqv?"]=new m("eqv?",2,!1,!1,function(c,b,e){return V(b,e)});q["equal?"]=new m("equal?",2,!1,!1,function(c,b,e){return J(b,e)});q["equal~?"]=new m("equal~?",3,!1,!1,function(c,b,e,g){t(c,g,pa,"equal~?","non-negative number",3,arguments);return J(b,e)||Da(b)&&Da(e)&&jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(b,e)),g)});q["false?"]=new m("false?",1,!1,!1,function(c,b){return!1===b});
q["boolean=?"]=new m("boolean=?",2,!1,!1,function(c,b,e){t(c,b,Za,"boolean=?","boolean",1,arguments);t(c,e,Za,"boolean=?","boolean",2,arguments);return b===e});q["symbol=?"]=new m("symbol=?",2,!1,!1,function(c,b,e){t(c,b,Ua,"symbol=?","symbol",1,arguments);t(c,e,Ua,"symbol=?","symbol",2,arguments);return J(b,e)});q["js-object?"]=new m("js-object?",1,!1,!1,function(c,b){return Ka(b)});q.cons=new m("cons",2,!1,!1,function(c,b,e){return types.cons(b,e)});q.car=new m("car",1,!1,!1,function(c,b){t(c,b,
L,"car","pair",1);return b.first()});q.cdr=new m("cdr",1,!1,!1,function(c,b){t(c,b,L,"cdr","pair",1);return b.rest()});q.caar=new m("caar",1,!1,!1,function(c,b){t(c,b,function(e){return L(e)&&L(e.first())},"caar","caarable value",1);return b.first().first()});q.cadr=new m("cadr",1,!1,!1,function(c,b){t(c,b,function(e){return L(e)&&L(e.rest())},"cadr","cadrable value",1);return b.rest().first()});q.cdar=new m("cdar",1,!1,!1,function(c,b){t(c,b,function(e){return L(e)&&L(e.first())},"cdar","cdarable value",
1);return b.first().rest()});q.cddr=new m("cddr",1,!1,!1,function(c,b){t(c,b,function(e){return L(e)&&L(e.rest())},"cddr","cddrable value",1);return b.rest().rest()});q.caaar=new m("caaar",1,!1,!1,function(c,b){t(c,b,function(e){return L(e)&&L(e.first())&&L(e.first().first())},"caaar","caaarable value",1);return b.first().first().first()});q.caadr=new m("caadr",1,!1,!1,function(c,b){t(c,b,function(e){return L(e)&&L(e.rest())&&L(e.rest().first())},"caadr","caadrable value",1);return b.rest().first().first()});
q.cadar=new m("cadar",1,!1,!1,function(c,b){t(c,b,function(e){return L(e)&&L(e.first())&&L(e.first().rest())},"cadar","cadarable value",1);return b.first().rest().first()});q.cdaar=new m("cdaar",1,!1,!1,function(c,b){t(c,b,function(e){return L(e)&&L(e.first())&&L(e.first().first())},"cdaar","cdaarable value",1);return b.first().first().rest()});q.cdadr=new m("cdadr",1,!1,!1,function(c,b){t(c,b,function(e){return L(e)&&L(e.rest())&&L(e.rest().first())},"cdadr","cdadrable value",1);return b.rest().first().rest()});
q.cddar=new m("cddar",1,!1,!1,function(c,b){t(c,b,function(e){return L(e)&&L(e.first())&&L(e.first().rest())},"cddar","cddarable value",1);return b.first().rest().rest()});q.caddr=new m("caddr",1,!1,!1,function(c,b){t(c,b,function(e){return L(e)&&L(e.rest())&&L(e.rest().rest())},"caddr","caddrable value",1);return b.rest().rest().first()});q.cdddr=new m("cdddr",1,!1,!1,function(c,b){t(c,b,function(e){return L(e)&&L(e.rest())&&L(e.rest().rest())},"cdddr","cdddrable value",1);return b.rest().rest().rest()});
q.cadddr=new m("cadddr",1,!1,!1,function(c,b){t(c,b,function(e){return L(e)&&L(e.rest())&&L(e.rest().rest())&&L(e.rest().rest().rest())},"cadddr","cadddrable value",1);return b.rest().rest().rest().first()});q.rest=new m("rest",1,!1,!1,function(c,b){t(c,b,function(e){return U(e)&&e!==types.EMPTY},"rest","non-empty list",1);return b.rest()});q.first=new m("first",1,!1,!1,function(c,b){t(c,b,function(e){return U(e)&&e!==types.EMPTY},"first","non-empty list",1);return b.first()});q.second=new m("second",
1,!1,!1,function(c,b){jb(c,b,2,"second",1);return b.rest().first()});q.third=new m("third",1,!1,!1,function(c,b){jb(c,b,3,"third",1);return b.rest().rest().first()});q.fourth=new m("fourth",1,!1,!1,function(c,b){jb(c,b,4,"fourth",1);return b.rest().rest().rest().first()});q.fifth=new m("fifth",1,!1,!1,function(c,b){jb(c,b,5,"fifth",1);return b.rest().rest().rest().rest().first()});q.sixth=new m("sixth",1,!1,!1,function(c,b){jb(c,b,6,"sixth",1);return b.rest().rest().rest().rest().rest().first()});
q.seventh=new m("seventh",1,!1,!1,function(c,b){jb(c,b,7,"seventh",1);return b.rest().rest().rest().rest().rest().rest().first()});q.eighth=new m("eighth",1,!1,!1,function(c,b){jb(c,b,8,"eighth",1);return b.rest().rest().rest().rest().rest().rest().rest().first()});q.length=new m("length",1,!1,!1,function(c,b){ab(c,b,"length",1,arguments);return jsnums.makeRational(F(b))});q["list?"]=new m("list?",1,!1,!1,function(c,b){return U(b)});q.list=new m("list",0,!0,!1,function(c,b){return types.list(b)});
q["make-list"]=new m("make-list",2,!1,!1,function(c,b,e){t(c,b,sa,"make-list","non-negative exact integer",1,arguments);for(var g=[],p=0;p<b;p++)g.push(e);return types.list(g)});q.range=new m("range",3,!1,!1,function(c,b,e,g){t(c,b,za,"range","number",1,arguments);t(c,e,za,"range","number",2,arguments);t(c,g,za,"range","number",3,arguments);var p=[];if(jsnums.lessThan(b,e)&&jsnums.greaterThan(g,0))for(var w=b;jsnums.lessThanOrEqual(w,e);w=jsnums.add(w,g))p.push(w);else if(jsnums.greaterThan(b,e)&&
jsnums.lessThan(g,0))for(w=b;jsnums.greaterThanOrEqual(w,e);w=jsnums.add(w,g))p.push(w);return types.list(p)});q["list*"]=new m("list*",1,!0,!1,function(c,b,e){var g=[b].concat(e);if(0==e.length)return b;var p=e.pop();ab(c,p,"list*",e.length+2,g);e.unshift(b);return E(c,[types.list(e),p])});q["list-ref"]=new m("list-ref",2,!1,!1,function(c,b,e){ab(c,b,"list-ref",1,arguments);t(c,e,sa,"list-ref","non-negative exact integer",2,arguments);var g=state.captureCurrentContinuationMarks(c).ref("moby-application-position-key");
g=g[g.length-1];for(var p=b,w=jsnums.toFixnum(e),M=0;M<w;M++)(p.isEmpty()||p.rest().isEmpty())&&ca(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("list-ref",g.first()),": index ",new types.ColoredPart(w,g.rest().rest().first())," is too large for list: ",new types.ColoredPart(types.toWrittenString(b),g.rest().first())]),[])),p=p.rest();return p.first()});q["list-tail"]=new m("list-tail",2,!1,!1,function(c,b,e){ab(c,b,"list-tail",1,arguments);t(c,x,sa,"list-tail",
"non-negative exact integer",2,arguments);b=origList;for(var g=jsnums.toFixnum(e),p=0;p<g;p++){if(b.isEmpty()){var w="list-tail: index "+g+" is too large for list: "+types.toWrittenString(origList);ca(types.incompleteExn(types.exnFailContract,w,[]))}b=b.rest()}return b});q.append=new m("append",0,!0,!1,function(c,b){return E(c,b)});q.reverse=new m("reverse",1,!1,!1,function(c,b){ab(c,b,"reverse",1);return b.reverse()});q.map=new m("map",2,!0,!1,function(c,b,e,g){var p=[b,e].concat(g);g.unshift(e);
t(c,b,B,"map","function",1,p);Ja(g,function(M,ba){ab(c,M,"map",ba+2,p)});sb(c,g,"map",p);var w=function(M,ba,Ca){if(ba[0].isEmpty())return Ca.reverse();for(var La=[],Wa=[],$a=0;$a<ba.length;$a++)La.push(ba[$a].first()),Wa.push(ba[$a].rest());return fa(M,La,function(lb){return w(M,Wa,types.cons(lb,Ca))})};return w(b,g,types.EMPTY)});q.andmap=new m("andmap",2,!0,!1,function(c,b,e,g){var p=[b,e].concat(g);g.unshift(e);t(c,b,B,"andmap","function",1,p);Ja(g,function(M,ba){ab(c,M,"andmap",ba+2,p)});sb(c,
g,"andmap",p);var w=function(M,ba){if(ba[0].isEmpty())return!0;for(var Ca=[],La=[],Wa=0;Wa<ba.length;Wa++)Ca.push(ba[Wa].first()),La.push(ba[Wa].rest());return fa(M,Ca,function($a){return $a&&w(M,La)})};return w(b,g)});q.ormap=new m("ormap",2,!0,!1,function(c,b,e,g){var p=[b,e].concat(g);g.unshift(e);t(c,b,B,"ormap","function",1,p);Ja(g,function(M,ba){ab(c,M,"ormap",ba+2,p)});sb(c,g,"ormap",p);var w=function(M,ba){if(ba[0].isEmpty())return!1;for(var Ca=[],La=[],Wa=0;Wa<ba.length;Wa++)Ca.push(ba[Wa].first()),
La.push(ba[Wa].rest());return fa(M,Ca,function($a){return $a||w(M,La)})};return w(b,g)});q.memq=new m("memq",2,!1,!1,function(c,b,e){for(ab(c,e,"memq",2,arguments);!e.isEmpty();){var g=e.first();if(b===g)return e;e=e.rest()}return!1});q.memv=new m("memv",2,!1,!1,function(c,b,e){for(ab(c,e,"memv",2,arguments);!e.isEmpty();){if(V(b,e.first()))return e;e=e.rest()}return!1});q.member=new m("member",2,!1,!1,function(c,b,e){for(ab(c,e,"member",2,arguments);!e.isEmpty();){if(J(b,e.first()))return e;e=e.rest()}return!1});
q["member?"]=new m("member?",2,!1,!1,function(c,b,e){for(ab(c,e,"member?",2,arguments);!e.isEmpty();){if(J(b,e.first()))return!0;e=e.rest()}return!1});q.memf=new m("memf",2,!1,!0,function(c,b,e){t(c,b,B,"memf","function",1,arguments);ab(c,e,"memf",2,arguments);var g=function(p){return p.isEmpty()?!1:fa(b,[p.first()],function(w){return w?p:g(p.rest())})};return g(e)});q.assq=new m("assq",2,!1,!1,function(c,b,e){for(cb(c,e,L,"assq","pair",2,arguments);!e.isEmpty();){var g=e.first().first();if(b===g)return e.first();
e=e.rest()}return!1});q.assv=new m("assv",2,!1,!1,function(c,b,e){for(cb(c,e,L,"assv","pair",2,arguments);!e.isEmpty();){if(V(b,e.first().first()))return e.first();e=e.rest()}return!1});q.assoc=new m("assoc",2,!1,!1,function(c,b,e){for(cb(c,e,L,"assoc","pair",2,arguments);!e.isEmpty();){if(J(b,e.first().first()))return e.first();e=e.rest()}return!1});q.remove=new m("remove",2,!1,!1,function(c,b,e){ab(c,e,"remove",2,arguments);for(var g=e,p=types.EMPTY;!e.isEmpty();){if(J(b,e.first()))return E(c,[p.reverse(),
e.rest()]);p=types.cons(e.first(),p);e=e.rest()}return g});q["remove-all"]=new m("remove-all",2,!1,!1,function(c,b,e){ab(c,e,"remove-all",2,arguments);for(var g=types.EMPTY;!e.isEmpty();)J(b,e.first())||(g=types.cons(e.first(),g)),e=e.rest();return g.reverse()});q.filter=new m("filter",2,!1,!1,function(c,b,e){t(c,b,G(1),"filter","function (arity 1)",1,arguments);ab(c,e,"filter",2);var g=function(p,w,M){return w.isEmpty()?M.reverse():fa(p,[w.first()],function(ba){return ba?g(p,w.rest(),types.cons(w.first(),
M)):g(p,w.rest(),M)})};return g(b,e,types.EMPTY)});q.foldl=new m("foldl",3,!0,!1,function(c,b,e,g,p){p.unshift(g);var w=[b,e].concat(p);t(c,b,B,"foldl","function",1,w);Ja(p,function(M,ba){ab(c,M,"foldl",ba+3,w)});sb(c,p,"foldl",w);return O(b,e,p)});q.foldr=new m("foldr",3,!0,!1,function(c,b,e,g,p){p.unshift(g);var w=[b,e].concat(p);t(c,b,B,"foldr","function",1,w);Ja(p,function(M,ba){ab(c,M,"foldr",ba+3,w)});sb(c,p,"foldr",w);for(g=0;g<p.length;g++)p[g]=p[g].reverse();return O(b,e,p)});q.quicksort=
new m("quicksort",2,!1,!1,P("quicksort"));q.sort=new m("sort",2,!1,!1,P("sort"));q.argmax=new m("argmax",2,!1,!1,function(c,b,e){var g=arguments;t(c,b,B,"argmax","function",1,g);t(c,e,L,"argmax","non-empty list",2,g);var p=function(w,M,ba){return w.isEmpty()?ba:fa(b,[w.first()],function(Ca){t(c,Ca,Da,"argmax","procedure that returns real numbers",1,g);return jsnums.greaterThan(Ca,M)?p(w.rest(),Ca,w.first()):p(w.rest(),M,ba)})};return fa(b,[e.first()],function(w){t(c,w,Da,"argmax","procedure that returns real numbers",
1,g);return p(e.rest(),w,e.first())})});q.argmin=new m("argmin",2,!1,!1,function(c,b,e){var g=arguments;t(c,b,B,"argmin","function",1,g);t(c,e,L,"argmin","non-empty list",2,g);var p=function(w,M,ba){return w.isEmpty()?ba:fa(b,[w.first()],function(Ca){t(c,Ca,Da,"argmin","procedure that returns real numbers",1,g);return jsnums.lessThan(Ca,M)?p(w.rest(),Ca,w.first()):p(w.rest(),M,ba)})};return fa(b,[e.first()],function(w){t(c,w,Da,"argmin","procedure that returns real numbers",1,g);return p(e.rest(),
w,e.first())})});q["build-list"]=new m("build-list",2,!1,!1,function(c,b,e){t(c,b,sa,"build-list","non-negative exact integer",1,arguments);t(c,e,B,"build-list","function",2,arguments);var g=function(p,w){return jsnums.greaterThanOrEqual(p,b)?w.reverse():fa(e,[p],function(M){return g(p+1,types.cons(M,w))})};return g(0,types.EMPTY)});q.box=new m("box",1,!1,!1,function(c,b){return types.box(b)});q["box-immutable"]=new m("box-immutable",1,!1,!1,function(c,b){return types.boxImmutable(b)});q.unbox=new m("unbox",
1,!1,!1,function(c,b){t(c,b,xa,"unbox","box",1);return b.unbox()});q["set-box!"]=new m("set-box!",2,!1,!1,function(c,b,e){t(c,b,function(g){return xa(g)&&g.mutable},"set-box!","mutable box",1,arguments);b.set(e);return types.VOID});q["make-hash"]=new C("make-hash",[new m("make-hash",0,!1,!1,function(){return types.hash(types.EMPTY)}),new m("make-hash",1,!1,!1,function(c,b){cb(c,b,L,"make-hash","list of pairs",1);return types.hash(b)})]);q["make-hasheq"]=new C("make-hasheq",[new m("make-hasheq",0,
!1,!1,function(c){return types.hashEq(types.EMPTY)}),new m("make-hasheq",1,!1,!1,function(c,b){cb(c,b,L,"make-hasheq","list of pairs",1);return types.hashEq(b)})]);q["hash-set!"]=new m("hash-set!",3,!1,!1,function(c,b,e,g){t(c,b,Aa,"hash-set!","hash",1,arguments);b.hash.put(e,g);return types.VOID});q["hash-ref"]=new C("hash-ref",[new m("hash-ref",2,!1,!1,function(c,b,e){t(c,b,Aa,"hash-ref","hash",1,arguments);if(!b.hash.containsKey(e)){var g=state.captureCurrentContinuationMarks(c).ref("moby-application-position-key");
g=g[g.length-1];ca(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("hash-ref",g.first()),": no value found for key ",new types.ColoredPart(types.toWrittenString(e),g.rest().rest().first())]),[]))}return b.hash.get(e)}),new m("hash-ref",3,!1,!1,function(c,b,e,g){t(c,b,Aa,"hash-ref","hash",1,arguments);return b.hash.containsKey(e)?b.hash.get(e):B(g)?fa(g,[],da):g})]);q["hash-remove!"]=new m("hash-remove",2,!1,!1,function(c,b,e){t(c,b,Aa,"hash-remove!","hash",1,arguments);
b.hash.remove(e);return types.VOID});q["hash-map"]=new m("hash-map",2,!1,!1,function(c,b,e){t(c,b,Aa,"hash-map","hash",1,arguments);t(c,e,B,"hash-map","function",2,arguments);var g=b.hash.keys(),p=function(w,M){if(w>=g.length)return M;var ba=b.hash.get(g[w]);return fa(e,[g[w],ba],function(Ca){return p(w+1,types.cons(Ca,M))})};return p(0,types.EMPTY)});q["hash-for-each"]=new m("hash-for-each",2,!1,!1,function(c,b,e){t(c,b,Aa,"hash-for-each","hash",1,arguments);t(c,e,B,"hash-for-each","function",2,
arguments);var g=b.hash.keys(),p=function(w){if(w>=g.length)return types.VOID;var M=b.hash.get(g[w]);return fa(e,[g[w],M],function(ba){return p(w+1)})};return p(0)});q["make-string"]=new m("make-string",2,!1,!1,function(c,b,e){t(c,b,sa,"make-string","non-negative exact integer",1,arguments);t(c,e,l,"make-string","character",2,arguments);for(var g=[],p=0;jsnums.lessThan(p,b);p++)g.push(e.val);return types.string(g)});q.replicate=new m("replicate",2,!1,!1,function(c,b,e){t(c,b,sa,"replicate","non-negative exact integer",
1,arguments);t(c,e,D,"replicate","string",2,arguments);for(var g="",p=e.toString(),w=0;jsnums.lessThan(w,b);w++)g+=p;return types.string(g)});q.string=new m("string",0,!0,!1,function(c,b){Ja(b,function(p,w){t(c,p,l,"string","character",w+1,b)});for(var e=[],g=0;g<b.length;g++)e.push(b[g].val);return types.string(e)});q["string-length"]=new m("string-length",1,!1,!1,function(c,b){t(c,b,D,"string-length","string",1);return b.length});q["string-contains?"]=new m("string-contains?",2,!1,!1,function(c,
b,e){t(c,b,D,"string-contains?","string",1);t(c,e,D,"string-contains?","string",2);return-1<b.toString().indexOf(e.toString())});q["string-ref"]=new m("string-ref",2,!1,!1,function(c,b,e){t(c,b,D,"string-ref","string",1,arguments);t(c,e,sa,"string-ref","non-negative exact integer",2,arguments);var g=jsnums.toFixnum(e);if(g>=b.length){types.toWrittenString(b);var p=state.captureCurrentContinuationMarks(c).ref("moby-application-position-key");p=p[p.length-1];ca(types.incompleteExn(types.exnFailContract,
new types.Message([new types.ColoredPart("string-ref",p.first()),": index ",g," out of range [0, ",b.length-1,"] for string: ",new types.ColoredPart(types.toWrittenString(b),p.rest().first())]),[]))}return types["char"](b.charAt(g))});q["string=?"]=new m("string=?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,D,"string=?","string",w+1,g)});return X(g,function(p,w){return p.toString()===w.toString()})});q["string<>?"]=new m("string<>?",2,!0,!1,function(c,b,e,g){g.unshift(e);
g.unshift(b);Ja(g,function(p,w){t(c,p,D,"string<>?","string",w+1,g)});return!X(g,function(p,w){return p.toString()===w.toString()})});q["string-ci=?"]=new m("string-ci=?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);for(b=0;b<g.length;b++)t(c,g[b],D,"string-ci=?","string",b+1,g),g[b]=g[b].toString().toLowerCase();return X(g,function(p,w){return p===w})});q["string-ci<>?"]=new m("string-ci<>?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);for(b=0;b<g.length;b++)t(c,g[b],D,"string-ci<>?",
"string",b+1,g),g[b]=g[b].toString().toLowerCase();return!X(g,function(p,w){return p===w})});q["string<?"]=new m("string<?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,D,"string<?","string",w+1,g)});return X(g,function(p,w){return p.toString()<w.toString()})});q["string>?"]=new m("string>?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,D,"string>?","string",w+1,g)});return X(g,function(p,w){return p.toString()>w.toString()})});q["string<=?"]=
new m("string<=?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,D,"string<=?","string",w+1,g)});return X(g,function(p,w){return p.toString()<=w.toString()})});q["string>=?"]=new m("string>=?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,D,"string>=?","string",w+1,g)});return X(g,function(p,w){return p.toString()>=w.toString()})});q["string-ci<?"]=new m("string-ci<?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);for(b=0;b<g.length;b++)t(c,
g[b],D,"string-ci<?","string",b+1,g),g[b]=g[b].toString().toLowerCase();return X(g,function(p,w){return p<w})});q["string-ci>?"]=new m("string-ci>?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);for(b=0;b<g.length;b++)t(c,g[b],D,"string-ci>?","string",b+1,g),g[b]=g[b].toString().toLowerCase();return X(g,function(p,w){return p>w})});q["string-ci<=?"]=new m("string-ci<=?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);for(b=0;b<g.length;b++)t(c,g[b],D,"string-ci<=?","string",b+1,g),g[b]=
g[b].toString().toLowerCase();return X(g,function(p,w){return p<=w})});q["string-ci>=?"]=new m("string-ci>=?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);for(b=0;b<g.length;b++)t(c,g[b],D,"string-ci>=?","string",b+1,g),g[b]=g[b].toString().toLowerCase();return X(g,function(p,w){return p>=w})});q.substring=new C("substring",[new m("substring",2,!1,!1,function(c,b,e){t(c,b,D,"substring","string",1,arguments);t(c,e,sa,"substring","non-negative exact integer",2,arguments);var g=state.captureCurrentContinuationMarks(c).ref("moby-application-position-key");
g=g[g.length-1];var p=jsnums.toFixnum(e);if(p>b.length)ca(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("substring",g.first()),": starting index ",new types.ColoredPart(p,g.rest().rest().first())," out of range ","[0, ",b.length,"] for string: ",new types.ColoredPart(types.toWrittenString(b),g.rest().first())]),[]));else return types.string(b.substring(jsnums.toFixnum(p)))}),new m("substring",3,!1,!1,function(c,b,e,g){t(c,b,D,"substring","string",1,arguments);
t(c,e,sa,"substring","non-negative exact integer",2,arguments);t(c,g,sa,"substring","non-negative exact integer",3,arguments);var p=state.captureCurrentContinuationMarks(c).ref("moby-application-position-key");p=p[p.length-1];var w=jsnums.toFixnum(e),M=jsnums.toFixnum(g);w>b.length&&ca(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("substring",p.first()),": starting index ",new types.ColoredPart(w,p.rest().rest().first())," out of range ","[0, ",b.length,"] for string: ",
new types.ColoredPart(types.toWrittenString(b),p.rest().first())]),[]));(M<w||M>b.length)&&ca(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("substring",p.first()),": ending index ",new types.ColoredPart(M,p.rest().rest().rest().first())," out of range ","[0, ",b.length,"] for string: ",new types.ColoredPart(types.toWrittenString(b),p.rest().first())]),[]));return types.string(b.substring(w,M))})]);q["string-append"]=new m("string-append",0,!0,!1,function(c,b){Ja(b,
function(g,p){t(c,g,D,"string-append","string",p+1,b)});for(var e=0;e<b.length;e++)b[e]=b[e].toString();return types.string(b.join(""))});q["string->list"]=new m("string->list",1,!1,!1,function(c,b){t(c,b,D,"string->list","string",1);c=types.EMPTY;for(var e=b.length-1;0<=e;e--)c=types.cons(types["char"](b.charAt(e)),c);return c});q["list->string"]=new m("list->string",1,!1,!1,function(c,b){cb(c,b,l,"list->string","character",1);for(c=[];!b.isEmpty();)c.push(b.first().val),b=b.rest();return types.string(c)});
q["string-copy"]=new m("string-copy",1,!1,!1,function(c,b){t(c,b,D,"string-copy","string",1);return types.string(b.toString())});q["string->symbol"]=new m("string->symbol",1,!1,!1,function(c,b){t(c,b,D,"string->symbol","string",1);return types.symbol(b.toString())});q["symbol->string"]=new m("symbol->string",1,!1,!1,function(c,b){t(c,b,Ua,"symbol->string","symbol",1);return types.string(b.toString())});q.format=new m("format",1,!0,!1,function(c,b,e){t(c,b,D,"format","string",1,[b].concat(e));return types.string(helpers.format(b,
e,"format"))});q.printf=new m("printf",1,!0,!1,function(c,b,e){t(c,b,D,"printf","string",1,[b].concat(e));b=helpers.format(b,e,"printf");c.getDisplayHook()(b);return types.VOID});q["string->int"]=new m("string->int",1,!1,!1,function(c,b){t(c,b,function(e){return D(e)&&1==e.length},"string->int","1-letter string",1);return b.charCodeAt(0)});q["int->string"]=new m("int->string",1,!1,!1,function(c,b){t(c,b,function(e){if(!Q(e))return!1;e=jsnums.toFixnum(e);return 0<=e&&55296>e||57343<e&&1114111>=e},
"int->string","exact integer in [0,55295] or [57344,1114111]",1);return types.string(String.fromCharCode(jsnums.toFixnum(b)))});q.explode=new m("explode",1,!1,!1,function(c,b){t(c,b,D,"explode","string",1);c=types.EMPTY;for(var e=b.length-1;0<=e;e--)c=types.cons(types.string(b.charAt(e)),c);return c});q.implode=new m("implode",1,!1,!1,function(c,b){cb(c,b,function(e){return D(e)&&1==e.length},"implode","1-letter strings",1);for(c=[];!b.isEmpty();)c.push(b.first().toString()),b=b.rest();return types.string(c)});
q["string-alphabetic?"]=new m("string-alphabetic?",1,!1,!1,function(c,b){t(c,b,D,"string-alphabetic?","string",1);return ia(b)});q["string-ith"]=new m("string-ith",2,!1,!1,function(c,b,e){t(c,b,D,"string-ith","string",1,arguments);t(c,e,function(g){return sa(g)&&jsnums.lessThan(g,b.length)},"string-ith","exact integer in [0, length of the given string minus 1 ("+(b.length-1)+")]",2,arguments);return types.string(b.charAt(jsnums.toFixnum(e)))});q["string-lower-case?"]=new m("string-lower-case?",1,
!1,!1,function(c,b){t(c,b,D,"string-lower-case?","string",1);c=b.toString();return ia(b)&&c.toLowerCase()===c});q["string-numeric?"]=new m("string-numeric?",1,!1,!1,function(c,b){t(c,b,D,"string-numeric?","string",1);a:{for(c=0;c<b.length;c++)if(!("0"<=b.charAt(c)&&"9">=b.charAt(c))){b=!1;break a}b=!0}return b});q["string-upper-case?"]=new m("string-upper-case?",1,!1,!1,function(c,b){t(c,b,D,"string-upper-case?","string",1);c=b.toString();return ia(b)&&c.toUpperCase()===c});q["string-whitespace?"]=
new m("string-whitespace?",1,!1,!1,function(c,b){t(c,b,D,"string-whitespace?","string",1);return Ba(b)});q["build-string"]=new m("build-string",2,!1,!1,function(c,b,e){t(c,b,sa,"build-string","non-negative exact integer",1,arguments);t(c,e,B,"build-string","function",2,arguments);var g=function(p,w){return jsnums.greaterThanOrEqual(p,b)?types.string(w):fa(e,[p],function(M){t(c,M,l,"build-string","procedure that returns a char",2);return g(p+1,w.push(M.val))})};return g(0,[])});q["string->immutable-string"]=
new m("string->immutable-string",1,!1,!1,function(c,b){t(c,b,D,"string->immutable-string","string",1);return b.toString()});q["string-set!"]=new m("string-set!",3,!1,!1,function(c,b,e,g){t(c,b,function(w){return D(w)&&"string"!=typeof w},"string-set!","mutable string",1,arguments);t(c,e,sa,"string-set!","non-negative exact integer",2,arguments);t(c,g,l,"string-set!","character",3,arguments);if(jsnums.greaterThanOrEqual(e,b.length)){var p="string-set!: index "+n+" out of range [0, "+(b.length-1)+"] for string: "+
types.toWrittenString(b);ca(types.incompleteExn(types.exnFailContract,p,[]))}b.set(jsnums.toFixnum(e),g.val);return types.VOID});q["string-fill!"]=new m("string-fill!",2,!1,!1,function(c,b,e){t(c,b,function(p){return D(p)&&"string"!=typeof p},"string-fill!","mutable string",1,arguments);t(c,e,l,"string-fill!","character",2,arguments);for(var g=0;g<b.length;g++)b.set(g,e.val);return types.VOID});q["make-vector"]=new m("make-vector",2,!1,!1,function(c,b,e){t(c,b,sa,"make-vector","non-negative exact integer",
1,arguments);for(var g=jsnums.toFixnum(b),p=[],w=0;w<g;w++)p.push(e);return types.vector(p)});q.vector=new m("vector",0,!0,!1,function(c,b){return types.vector(b)});q["vector-length"]=new m("vector-length",1,!1,!1,function(c,b){t(c,b,ra,"vector-length","vector",1);return b.length()});q["vector-ref"]=new m("vector-ref",2,!1,!1,function(c,b,e){t(c,b,ra,"vector-ref","vector",1,arguments);t(c,e,sa,"vector-ref","non-negative exact integer",2,arguments);var g=jsnums.toFixnum(e);if(g>=b.length()){var p=
"vector-ref: index "+g+" out of range [0, "+(b.length()-1)+"] for vector: "+types.toWrittenString(b);ca(types.incompleteExn(types.exnFailContract,p,[]))}return b.ref(g)});q["vector-set!"]=new m("vector-set!",3,!1,!1,function(c,b,e,g){t(c,b,ra,"vector-set!","vector",1,arguments);t(c,e,sa,"vector-set!","non-negative exact integer",2,arguments);var p=jsnums.toFixnum(e);if(p>=b.length()){var w="vector-set!: index "+p+" out of range [0, "+(b.length()-1)+"] for vector: "+types.toWrittenString(b);ca(types.incompleteExn(types.exnFailContract,
w,[]))}b.set(p,g);return types.VOID});q["vector->list"]=new m("vector->list",1,!1,!1,function(c,b){t(c,b,ra,"vector->list","vector",1);return b.toList()});q["list->vector"]=new m("list->vector",1,!1,!1,function(c,b){ab(c,b,"list->vector",1);return types.vector(helpers.schemeListToArray(b))});q["build-vector"]=new m("build-vector",2,!1,!1,function(c,b,e){t(c,b,sa,"build-vector","non-negative exact integer",1,arguments);t(c,e,B,"build-vector","function",2,arguments);var g=function(p,w){return jsnums.greaterThanOrEqual(p,
b)?types.vector(w):fa(e,[p],function(M){w.push(M);return g(p+1,w)})};return g(0,[])});q["char=?"]=new m("char=?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,l,"char=?","character",w+1,g)});return X(g,function(p,w){return p.val===w.val})});q["char<?"]=new m("char<?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,l,"char<?","character",w+1,g)});return X(g,function(p,w){return p.val<w.val})});q["char>?"]=new m("char>?",2,!0,!1,function(c,
b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,l,"char>?","character",w+1,g)});return X(g,function(p,w){return p.val>w.val})});q["char<=?"]=new m("char<=?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,l,"char<=?","character",w+1,g)});return X(g,function(p,w){return p.val<=w.val})});q["char>=?"]=new m("char>=?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,l,"char>=?","character",w+1,g)});return X(g,function(p,w){return p.val>=
w.val})});q["char-ci=?"]=new m("char-ci=?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,l,"char-ci=?","character",w+1,g)});return X(g,function(p,w){return p.val.toLowerCase()===w.val.toLowerCase()})});q["char-ci<?"]=new m("char-ci<?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,l,"char-ci<?","character",w+1,g)});return X(g,function(p,w){return p.val.toLowerCase()<w.val.toLowerCase()})});q["char-ci>?"]=new m("char-ci>?",2,!0,!1,function(c,
b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,l,"char-ci>?","character",w+1,g)});return X(g,function(p,w){return p.val.toLowerCase()>w.val.toLowerCase()})});q["char-ci<=?"]=new m("char-ci<=?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,p,l,"char-ci<=?","character",w+1,g)});return X(g,function(p,w){return p.val.toLowerCase()<=w.val.toLowerCase()})});q["char-ci>=?"]=new m("char-ci>=?",2,!0,!1,function(c,b,e,g){g.unshift(e);g.unshift(b);Ja(g,function(p,w){t(c,
p,l,"char-ci>=?","character",w+1,g)});return X(g,function(p,w){return p.val.toLowerCase()>=w.val.toLowerCase()})});q["char-alphabetic?"]=new m("char-alphabetic?",1,!1,!1,function(c,b){t(c,b,l,"char-alphabetic?","character",1);return ia(b.val)});q["char-numeric?"]=new m("char-numeric?",1,!1,!1,function(c,b){t(c,b,l,"char-numeric?","character",1);return"0"<=b.val&&"9">=b.val});q["char-whitespace?"]=new m("char-whitespace?",1,!1,!1,function(c,b){t(c,b,l,"char-whitespace?","character",1);return Ba(b.val)});
q["char-upper-case?"]=new m("char-upper-case?",1,!1,!1,function(c,b){t(c,b,l,"char-upper-case?","character",1);return ia(b.val)&&b.val.toUpperCase()===b.val});q["char-lower-case?"]=new m("char-lower-case?",1,!1,!1,function(c,b){t(c,b,l,"char-lower-case?","character",1);return ia(b.val)&&b.val.toLowerCase()===b.val});q["char->integer"]=new m("char->integer",1,!1,!1,function(c,b){t(c,b,l,"char->integer","character",1);return b.val.charCodeAt(0)});q["integer->char"]=new m("integer->char",1,!1,!1,function(c,
b){t(c,b,function(e){if(!Q(e))return!1;e=jsnums.toFixnum(e);return 0<=e&&55296>e||57343<e&&1114111>=e},"integer->char","exact integer in [0,#x10FFFF], not in [#xD800,#xDFFF]",1);return types["char"](String.fromCharCode(jsnums.toFixnum(b)))});q["char-upcase"]=new m("char-upcase",1,!1,!1,function(c,b){t(c,b,l,"char-upcase","character",1);return types["char"](b.val.toUpperCase())});q["char-downcase"]=new m("char-downcase",1,!1,!1,function(c,b){t(c,b,l,"char-downcase","character",1);return types["char"](b.val.toLowerCase())});
q["make-posn"]=new m("make-posn",2,!1,!1,function(c,b,e){return types.posn(b,e)});q["posn-x"]=new m("posn-x",1,!1,!1,function(c,b){t(c,b,types.isPosn,"posn-x","posn",1);return types.posnX(b)});q["posn-y"]=new m("posn-y",1,!1,!1,function(c,b){t(c,b,types.isPosn,"posn-y","posn",1);return types.posnY(b)});q["key=?"]=new m("key=?",2,!1,!1,function(c,b,e){types.isChar(b)&&(b=b.getValue());types.isChar(e)&&(e=e.getValue());return b.toString().toLowerCase()===e.toString().toLowerCase()});q["image?"]=new m("image?",
1,!1,!1,function(c,b){return Y(b)});q["image=?"]=new m("image=?",2,!1,!1,function(c,b,e){t(c,b,Y,"image=?","image",1);t(c,e,Y,"image=?","image",2);return J(b,e)});q["make-color"]=new C("make-color",[new m("make-color",3,!1,!1,function(c,b,e,g){t(c,b,Ha,"make-color","exact number between 0 and 255",1,arguments);t(c,e,Ha,"make-color","exact number between 0 and 255",2,arguments);t(c,g,Ha,"make-color","exact number between 0 and 255",3,arguments);return types.color(jsnums.toFixnum(b),jsnums.toFixnum(e),
jsnums.toFixnum(g))}),new m("make-color",4,!1,!1,function(c,b,e,g,p){t(c,b,Ha,"make-color","exact number between 0 and 255",1,arguments);t(c,e,Ha,"make-color","exact number between 0 and 255",2,arguments);t(c,g,Ha,"make-color","exact number between 0 and 255",3,arguments);t(c,p,Ha,"make-color","exact number between 0 and 255",4,arguments);return types.color(jsnums.toFixnum(b),jsnums.toFixnum(e),jsnums.toFixnum(g),jsnums.toFixnum(p))})]);q["color-red"]=new m("color-red",1,!1,!1,function(c,b){t(c,b,
types.isColor,"color-red","color",1);return types.colorRed(b)});q["color-green"]=new m("color-green",1,!1,!1,function(c,b){t(c,b,types.isColor,"color-green","color",1);return types.colorGreen(b)});q["color-blue"]=new m("color-blue",1,!1,!1,function(c,b){t(c,b,types.isColor,"color-blue","color",1);return types.colorBlue(b)});q["color-alpha"]=new m("color-alpha",1,!1,!1,function(c,b){t(c,b,types.isColor,"color-alpha","color",1);return types.colorAlpha(b)});q["empty-scene"]=new C("empty-scene",[new m("empty-scene",
2,!1,!1,function(c,b,e){t(c,b,pa,"empty-scene","non-negative number",1,arguments);t(c,e,pa,"empty-scene","non-negative number",2,arguments);var g=y.get("white");return world.Kernel.sceneImage(jsnums.toFixnum(b),jsnums.toFixnum(e),[],!0,g)}),new m("empty-scene",3,!1,!1,function(c,b,e,g){t(c,b,pa,"empty-scene","non-negative number",1,arguments);t(c,e,pa,"empty-scene","non-negative number",2,arguments);t(c,g,H,"empty-scene","color",3,arguments);y.get(g)&&(g=y.get(g));return world.Kernel.sceneImage(jsnums.toFixnum(b),
jsnums.toFixnum(e),[],!0,g)})]);q["put-image"]=new m("put-image",4,!1,!1,function(c,b,e,g,p){t(c,b,Y,"put-image","image",1,arguments);t(c,e,Da,"put-image","real",2,arguments);t(c,g,Da,"put-image","real",3,arguments);t(c,p,function(M){return A(M)||Y(M)},"put-image","image",4,arguments);e=jsnums.toFixnum(e);g=jsnums.toFixnum(g);if(A(p))return p.add(b,e,p.getHeight()-g);var w=world.Kernel.sceneImage(p.getWidth(),p.getHeight(),[],!1,null);w=w.add(p,p.getWidth()/2,p.getHeight()/2);return w=w.add(b,e,p.getHeight()-
g)});q["place-image"]=new m("place-image",4,!1,!1,function(c,b,e,g,p){t(c,b,Y,"place-image","image",1,arguments);t(c,e,Da,"place-image","real",2,arguments);t(c,g,Da,"place-image","real",3,arguments);t(c,p,function(M){return A(M)||Y(M)},"place-image","image",4,arguments);e=jsnums.toFixnum(e);g=jsnums.toFixnum(g);if(A(p))return p.add(b,e,g);var w=world.Kernel.sceneImage(p.getWidth(),p.getHeight(),[],!1,null);w=w.add(p,p.getWidth()/2,p.getHeight()/2);return w=w.add(b,e,g)});q["place-image/align"]=new m("place-image/align",
6,!1,!1,function(c,b,e,g,p,w,M){t(c,b,Y,"place-image/align","image",1,arguments);t(c,e,Da,"place-image/align","real number",2,arguments);t(c,g,Da,"place-image/align","real number",3,arguments);t(c,p,T,"place-image/align","x-place",4,arguments);t(c,w,qa,"place-image/align","y-place",5,arguments);t(c,M,function(Ca){return A(Ca)||Y(Ca)},"place-image/align","image",6,arguments);e=jsnums.toFixnum(e);g=jsnums.toFixnum(g);"left"==p?e+=b.getWidth()/2:"right"==p&&(e-=b.getWidth()/2);"top"==w?g+=b.getHeight()/
2:"bottom"==w&&(g-=b.getHeight()/2);if(A(M))return M.add(b,e,g);var ba=world.Kernel.sceneImage(M.getWidth(),M.getHeight(),[],!1,null);ba=ba.add(M,M.getWidth()/2,M.getHeight()/2);return ba=ba.add(b,e,g)});q["scene+line"]=new m("scene+line",6,!1,!1,function(c,b,e,g,p,w,M){t(c,b,Y,"scene+line","image",1,arguments);t(c,e,Da,"scene+line","finite real number",2,arguments);t(c,g,Da,"scene+line","finite real number",3,arguments);t(c,p,Da,"scene+line","finite real number",4,arguments);t(c,w,Da,"scene+line",
"finite real number",5,arguments);t(c,M,H,"scene+line","color",6,arguments);y.get(M)&&(M=y.get(M));newScene=world.Kernel.sceneImage(jsnums.toFixnum(b.getWidth()),jsnums.toFixnum(b.getHeight()),[],!1,null);newScene=newScene.add(b,b.getWidth()/2,b.getHeight()/2);line=world.Kernel.lineImage(jsnums.toFixnum(p-e),jsnums.toFixnum(w-g),M);leftMost=Math.min(e,p);topMost=Math.min(g,w);return newScene.add(line,line.getWidth()/2+leftMost,line.getHeight()/2+topMost)});q["put-pinhole"]=new m("put-pinhole",3,!1,
!1,function(c,b,e,g){t(c,b,Y,"put-pinhole","image",1,arguments);t(c,e,Da,"put-pinhole","real",2,arguments);t(c,g,Da,"put-pinhole","real",3,arguments);return b.updatePinhole(jsnums.toFixnum(e),jsnums.toFixnum(g))});q.circle=new m("circle",3,!1,!1,function(c,b,e,g){t(c,b,pa,"circle","non-negative number",1,arguments);t(c,e,K,"circle",'style ("solid" / "outline") or an opacity value [0-255])',2,arguments);t(c,g,H,"circle","color",3,arguments);y.get(g)&&(g=y.get(g));return world.Kernel.circleImage(jsnums.toFixnum(b),
e.toString(),g)});q.star=new C("star",[new m("star",5,!1,!1,function(c,b,e,g,p,w){t(c,b,R,"star","positive integer greater than or equal to 3",1,arguments);t(c,e,pa,"star","non-negative number",2,arguments);t(c,g,pa,"star","non-negative number",3,arguments);t(c,p,K,"star",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);t(c,w,H,"star","color",5,arguments);y.get(w)&&(w=y.get(w));return world.Kernel.starImage(jsnums.toFixnum(b),jsnums.toFixnum(e),jsnums.toFixnum(g),p.toString(),
w)}),new m("star",3,!1,!1,function(c,b,e,g){t(c,b,pa,"star","non-negative number",1,arguments);t(c,e,K,"star",'style ("solid" / "outline") or an opacity value [0-255])',2,arguments);t(c,g,H,"star","color",3,arguments);y.get(g)&&(g=y.get(g));return world.Kernel.polygonImage(jsnums.toFixnum(b),jsnums.toFixnum(5),jsnums.toFixnum(2),e.toString(),g,"star")})]);q["radial-star"]=new m("radial-star",5,!1,!1,function(c,b,e,g,p,w){t(c,b,function(M){return sa(M)&&jsnums.greaterThanOrEqual(M,2)},"radial-star",
"positive integer greater than or equal to 2",1,arguments);t(c,e,function(M){return Da(M)&&jsnums.greaterThan(M,0)},"radial-star","positive number",2,arguments);t(c,g,function(M){return Da(M)&&jsnums.greaterThan(M,0)},"radial-star","positive number",3,arguments);t(c,p,K,"radial-star",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);t(c,w,H,"radial-star","color",5,arguments);y.get(w)&&(w=y.get(w));return world.Kernel.starImage(jsnums.toFixnum(b),jsnums.toFixnum(e),jsnums.toFixnum(g),
p.toString(),w)});q.rectangle=new m("rectangle",4,!1,!1,function(c,b,e,g,p){t(c,b,pa,"rectangle","non-negative number",1,arguments);t(c,e,pa,"rectangle","non-negative number",2,arguments);t(c,g,K,"rectangle",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);t(c,p,H,"rectangle","color",4,arguments);y.get(p)&&(p=y.get(p));return world.Kernel.rectangleImage(jsnums.toFixnum(b),jsnums.toFixnum(e),g.toString(),p)});q.polygon=new m("polygon",3,!1,!1,function(c,b,e,g){jb(c,b,3,"polygon",
1);t(c,b,function(p){return ha(p,types.isPosn)},"polygon","list of posns",1,arguments);t(c,e,K,"polygon",'style ("solid" / "outline") or an opacity value [0-255])',2,arguments);t(c,g,H,"polygon","color",3,arguments);y.get(g)&&(g=y.get(g));return world.Kernel.posnImage(helpers.flattenSchemeListToArray(b),e.toString(),g)});q["regular-polygon"]=new m("regular-polygon",4,!1,!1,function(c,b,e,g,p){t(c,b,pa,"regular-polygon","non-negative number",1,arguments);t(c,e,R,"regular-polygon","positive integer greater than or equal to 3",
2,arguments);t(c,g,K,"regular-polygon",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);t(c,p,H,"regular-polygon","color",4,arguments);y.get(p)&&(p=y.get(p));return world.Kernel.polygonImage(jsnums.toFixnum(b),jsnums.toFixnum(e),jsnums.toFixnum(1),g.toString(),p)});q["add-polygon"]=new m("add-polygon",4,!1,!1,function(c,b,e,g,p){jb(c,e,3,"add-polygon",1);t(c,b,Y,"add-polygon","image",1,arguments);t(c,e,function(La){return ha(La,types.isPosn)},"add-polygon","list of posns",2,
arguments);t(c,g,K,"add-polygon",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);t(c,p,H,"add-polygon","color",4,arguments);y.get(p)&&(p=y.get(p));var w=helpers.flattenSchemeListToArray(e),M=w.map(function(La){return La._fields[0]}),ba=w.map(function(La){return La._fields[1]});M=M.map(function(La){return jsnums.toFixnum(La)});ba=ba.map(function(La){return jsnums.toFixnum(La)});M=-Math.round(Math.min.apply(null,M));ba=-Math.round(Math.min.apply(null,ba));console.log("deltaX",
M,"deltaY",ba);var Ca=world.Kernel.posnImage(w,g.toString(),p);console.log("primitve is passing posns",w);return world.Kernel.overlayImage(Ca,b,M,ba)});q["star-polygon"]=new m("star-polygon",5,!1,!1,function(c,b,e,g,p,w){t(c,b,pa,"star-polygon","non-negative number",1,arguments);t(c,e,R,"star-polygon","positive integer greater than or equal to 3",2,arguments);t(c,g,ta,"star-polygon","positive integer greater than or equal to 1",3,arguments);t(c,p,K,"star-polygon",'style ("solid" / "outline") or an opacity value [0-255])',
4,arguments);t(c,w,H,"star-polygon","color",5,arguments);y.get(w)&&(w=y.get(w));return world.Kernel.polygonImage(jsnums.toFixnum(b),jsnums.toFixnum(e),jsnums.toFixnum(g),p.toString(),w)});q.rhombus=new m("rhombus",4,!1,!1,function(c,b,e,g,p){t(c,b,pa,"rhombus","non-negative number",1,arguments);t(c,e,pa,"rhombus","non-negative number",2,arguments);t(c,g,K,"rhombus",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);t(c,p,H,"rhombus","color",4,arguments);y.get(p)&&(p=y.get(p));
return world.Kernel.rhombusImage(jsnums.toFixnum(b),jsnums.toFixnum(e),g.toString(),p)});q.square=new m("square",3,!1,!1,function(c,b,e,g){t(c,b,pa,"square","non-negative number",1,arguments);t(c,e,K,"square",'style ("solid" / "outline") or an opacity value [0-255])',2,arguments);t(c,g,H,"square","color",3,arguments);y.get(g)&&(g=y.get(g));return world.Kernel.squareImage(jsnums.toFixnum(b),e.toString(),g)});q.triangle=new m("triangle",3,!1,!1,function(c,b,e,g){t(c,b,pa,"triangle","non-negative number",
1,arguments);t(c,e,K,"triangle",'style ("solid" / "outline") or an opacity value [0-255])',2,arguments);t(c,g,H,"triangle","color",3,arguments);y.get(g)&&(g=y.get(g));return world.Kernel.triangleImage(jsnums.toFixnum(b),jsnums.toFixnum(300),jsnums.toFixnum(b),e.toString(),g)});q["triangle/sas"]=new m("triangle/sas",5,!1,!1,function(c,b,e,g,p,w){t(c,b,pa,"triangle/sas","non-negative number",1,arguments);t(c,e,Pa,"triangle/sas","angle less than 180 degrees and greater than 0 degrees",2,arguments);t(c,
g,pa,"triangle/sas","non-negative number",3,arguments);t(c,p,K,"triangle/sas",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);t(c,w,H,"triangle/sas","color",5,arguments);y.get(w)&&(w=y.get(w));b=jsnums.toFixnum(b);e=jsnums.toFixnum(e%360);g=jsnums.toFixnum(g);var M=b*b+g*g-2*b*g*Math.cos(e*Math.PI/180),ba=Math.sqrt(M);0>=M?ca(types.incompleteExn(types.exnFailContract,"The given side, angle and side will not form a triangle: "+b+", "+e+", "+g,[])):(1E-5<ba-(b+g)||1E-5<b-(ba+
g)||1E-5<g-(b+ba))&&ca(types.incompleteExn(types.exnFailContract,"The given side, angle and side will not form a triangle: "+b+", "+e+", "+g,[]));M=180/Math.PI*Math.acos((ba*ba+g*g-b*b)/(2*ba*g));return world.Kernel.triangleImage(jsnums.toFixnum(g),jsnums.toFixnum(M),jsnums.toFixnum(ba),p.toString(),w)});q["triangle/sss"]=new m("triangle/sss",5,!1,!1,function(c,b,e,g,p,w){t(c,b,pa,"triangle/sss","non-negative number",1,arguments);t(c,e,pa,"triangle/sss","non-negative number",2,arguments);t(c,g,pa,
"triangle/sss","non-negative number",3,arguments);t(c,p,K,"triangle/sss",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);t(c,w,H,"triangle/sss","color",5,arguments);y.get(w)&&(w=y.get(w));b=jsnums.toFixnum(b);e=jsnums.toFixnum(e);g=jsnums.toFixnum(g);(1E-5<g-(b+e)||1E-5<b-(g+e)||1E-5<e-(b+g))&&ca(types.incompleteExn(types.exnFailContract,"The given sides will not form a triangle: "+b+", "+e+", "+g,[]));var M=180/Math.PI*Math.acos((e*e+g*g-b*b)/(2*e*g));return world.Kernel.triangleImage(jsnums.toFixnum(g),
jsnums.toFixnum(M),jsnums.toFixnum(e),p.toString(),w)});q["triangle/ass"]=new m("triangle/ass",5,!1,!1,function(c,b,e,g,p,w){t(c,b,Pa,"triangle/ass","angle less than 180 degrees and greater than 0 degrees",1,arguments);t(c,e,pa,"triangle/ass","non-negative number",2,arguments);t(c,g,pa,"triangle/ass","non-negative number",3,arguments);t(c,p,K,"triangle/ass",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);t(c,w,H,"triangle/ass","color",5,arguments);b=jsnums.toFixnum(b%360);
e=jsnums.toFixnum(e);g=jsnums.toFixnum(g);y.get(w)&&(w=y.get(w));1E-5<b-180&&ca(types.incompleteExn(types.exnFailContract,"The given angle, side and side will not form a triangle: "+b+", "+e+", "+g,[]));return world.Kernel.triangleImage(jsnums.toFixnum(g),jsnums.toFixnum(b),jsnums.toFixnum(e),p.toString(),w)});q["triangle/ssa"]=new m("triangle/ssa",5,!1,!1,function(c,b,e,g,p,w){t(c,b,pa,"triangle/ssa","non-negative number",1,arguments);t(c,e,pa,"triangle/ssa","non-negative number",2,arguments);t(c,
g,Pa,"triangle/ssa","angle less than 180 degrees and greater than 0 degrees",3,arguments);t(c,p,K,"triangle/ssa",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);t(c,w,H,"triangle/ssa","color",5,arguments);y.get(w)&&(w=y.get(w));b=jsnums.toFixnum(b);e=jsnums.toFixnum(e);g=jsnums.toFixnum(g%360);1E-5<g-180&&ca(types.incompleteExn(types.exnFailContract,"The given side, side and angle will not form a triangle: "+b+", "+e+", "+g,[]));var M=b*b+e*e-2*b*e*Math.cos(g*Math.PI/180),
ba=Math.sqrt(M);0>=M?ca(types.incompleteExn(types.exnFailContract,"The given side, side and angle will not form a triangle: "+b+", "+e+", "+g,[])):(1E-5<ba-(b+e)||1E-5<b-(ba+e)||1E-5<e-(b+ba))&&ca(types.incompleteExn(types.exnFailContract,"The given side, side and angle will not form a triangle: "+b+", "+e+", "+g,[]));M=180/Math.PI*Math.acos((e*e+ba*ba-b*b)/(2*e*ba));return world.Kernel.triangleImage(jsnums.toFixnum(ba),jsnums.toFixnum(M),jsnums.toFixnum(e),p.toString(),w)});q["triangle/aas"]=new m("triangle/aas",
5,!1,!1,function(c,b,e,g,p,w){t(c,b,Pa,"triangle/aas","angle less than 180 degrees and greater than 0 degrees",1,arguments);t(c,e,Pa,"triangle/aas","angle less than 180 degrees and greater than 0 degrees",2,arguments);t(c,g,pa,"triangle/aas","non-negative number",3,arguments);t(c,p,K,"triangle/aas",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);t(c,w,H,"triangle/aas","color",5,arguments);y.get(w)&&(w=y.get(w));b=jsnums.toFixnum(b%360);e=jsnums.toFixnum(e%360);g=jsnums.toFixnum(g);
var M=180-b-e;1E-5<0-M&&ca(types.incompleteExn(types.exnFailContract,"The given angle, angle and side will not form a triangle: "+b+", "+e+", "+g,[]));M=g/Math.sin(M*Math.PI/180)*Math.sin(e*Math.PI/180);return world.Kernel.triangleImage(jsnums.toFixnum(g),b,jsnums.toFixnum(M),p.toString(),w)});q["triangle/asa"]=new m("triangle/asa",5,!1,!1,function(c,b,e,g,p,w){t(c,b,Pa,"triangle/asa","angle less than 180 degrees and greater than 0 degrees",1,arguments);t(c,e,pa,"triangle/asa","non-negative number",
2,arguments);t(c,g,Pa,"triangle/asa","angle less than 180 degrees and greater than 0 degrees",3,arguments);t(c,p,K,"triangle/asa",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);t(c,w,H,"triangle/asa","color",5,arguments);y.get(w)&&(w=y.get(w));b=jsnums.toFixnum(b%360);e=jsnums.toFixnum(e);g=jsnums.toFixnum(g%360);var M=180-(b+g);1E-5<0-M&&ca(types.incompleteExn(types.exnFailContract,"The given angle, side and angle will not form a triangle: "+b+", "+e+", "+g,[]));return world.Kernel.triangleImage(jsnums.toFixnum(e*
Math.sin(g*Math.PI/180)/Math.sin(M*Math.PI/180)),b,jsnums.toFixnum(e),p.toString(),w)});q["triangle/saa"]=new m("triangle/saa",5,!1,!1,function(c,b,e,g,p,w){t(c,b,pa,"triangle/saa","non-negative number",1,arguments);t(c,e,Pa,"triangle/saa","angle less than 180 degrees and greater than 0 degrees",2,arguments);t(c,g,Pa,"triangle/saa","angle less than 180 degrees and greater than 0 degrees",3,arguments);t(c,p,K,"triangle/saa",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);t(c,
w,H,"triangle/saa","color",5,arguments);y.get(w)&&(w=y.get(w));b=jsnums.toFixnum(b);e=jsnums.toFixnum(e%360);g=jsnums.toFixnum(g%360);var M=180-g-e,ba=b/Math.sin(M*Math.PI/180),Ca=ba*Math.sin(e*Math.PI/180);return world.Kernel.triangleImage(jsnums.toFixnum(ba*Math.sin(g*Math.PI/180)),M,jsnums.toFixnum(Ca),p.toString(),w)});q["right-triangle"]=new m("right-triangle",4,!1,!1,function(c,b,e,g,p){t(c,b,pa,"right-triangle","non-negative number",1,arguments);t(c,e,pa,"right-triangle","non-negative number",
2,arguments);t(c,g,K,"right-triangle",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);t(c,p,H,"right-triangle","color",4,arguments);y.get(p)&&(p=y.get(p));return world.Kernel.triangleImage(jsnums.toFixnum(b),jsnums.toFixnum(270),jsnums.toFixnum(e),g.toString(),p)});q["isosceles-triangle"]=new m("isosceles-triangle",4,!1,!1,function(c,b,e,g,p){t(c,b,pa,"isosceles-triangle","non-negative number",1,arguments);t(c,e,Pa,"isosceles-triangle","angle less than 180 degrees and greater than 0 degrees",
2,arguments);t(c,g,K,"isosceles-triangle",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);t(c,p,H,"isosceles-triangle","color",4,arguments);y.get(p)&&(p=y.get(p));var w=0>e?-1:1,M=(180-Math.abs(e))/2;return world.Kernel.triangleImage(jsnums.toFixnum(2*b*Math.sin(Math.abs(e)*Math.PI/180/2)),jsnums.toFixnum(360-M)*w,jsnums.toFixnum(b),g.toString(),p)});q.ellipse=new m("ellipse",4,!1,!1,function(c,b,e,g,p){t(c,b,pa,"ellipse","non-negative number",1,arguments);t(c,e,pa,"ellipse",
"non-negative number",2,arguments);t(c,g,K,"ellipse",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);t(c,p,H,"ellipse","color",4,arguments);y.get(p)&&(p=y.get(p));return world.Kernel.ellipseImage(jsnums.toFixnum(b),jsnums.toFixnum(e),g.toString(),p)});q.line=new m("line",3,!1,!1,function(c,b,e,g){t(c,b,Da,"line","finite real number",1,arguments);t(c,e,Da,"line","finite real number",2,arguments);t(c,g,H,"line","color",3,arguments);y.get(g)&&(g=y.get(g));return world.Kernel.lineImage(jsnums.toFixnum(b),
jsnums.toFixnum(e),g)});q["add-line"]=new m("add-line",6,!1,!1,function(c,b,e,g,p,w,M){t(c,b,Y,"add-line","image",1,arguments);t(c,e,Da,"add-line","finite real number",2,arguments);t(c,g,Da,"add-line","finite real number",3,arguments);t(c,p,Da,"add-line","finite real number",4,arguments);t(c,w,Da,"add-line","finite real number",5,arguments);t(c,M,H,"add-line","color",6,arguments);y.get(M)&&(M=y.get(M));e=jsnums.toFixnum(e);p=jsnums.toFixnum(p);g=jsnums.toFixnum(g);w=jsnums.toFixnum(w);var ba=world.Kernel.lineImage(p-
e,w-g,M);return world.Kernel.overlayImage(ba,b,-Math.min(e,p),-Math.min(g,w))});q.overlay=new m("overlay",2,!0,!1,function(c,b,e,g){var p=[b,e].concat(g);t(c,b,Y,"overlay","image",1,p);t(c,e,Y,"overlay","image",2,p);Ja(g,function(M,ba){t(c,M,Y,"overlay","image",ba+3)},arguments);p=world.Kernel.overlayImage(b,e,"middle","middle");for(var w=0;w<g.length;w++)p=world.Kernel.overlayImage(p,g[w],"middle","middle");return p});q["overlay/xy"]=new m("overlay/xy",4,!1,!1,function(c,b,e,g,p){t(c,b,Y,"overlay/xy",
"image",1,arguments);t(c,e,Da,"overlay/xy","finite real number",2,arguments);t(c,g,Da,"overlay/xy","finite real number",3,arguments);t(c,p,Y,"overlay/xy","image",4,arguments);return world.Kernel.overlayImage(b,p,jsnums.toFixnum(e),jsnums.toFixnum(g))});q["overlay/align"]=new m("overlay/align",4,!0,!1,function(c,b,e,g,p,w){Ya(c,b,T,"overlay/align","x-place",1,arguments);Ya(c,e,qa,"overlay/align","y-place",2,arguments);Ya(c,g,Y,"overlay/align","image",3,arguments);Ya(c,p,Y,"overlay/align","image",4,
arguments);Ja(w,function(Ca,La){t(c,Ca,Y,"overlay/align","image",La+4)},arguments);for(var M=world.Kernel.overlayImage(g,p,b.toString(),e.toString()),ba=0;ba<w.length;ba++)M=world.Kernel.overlayImage(M,w[ba],b.toString(),e.toString());return M});q.underlay=new m("underlay",2,!0,!1,function(c,b,e,g){Ya(c,b,Y,"underlay","image",1,arguments);Ya(c,e,Y,"underlay","image",2,arguments);Ja(g,function(M,ba){t(c,M,Y,"underlay","image",ba+3)},arguments);for(var p=world.Kernel.overlayImage(e,b,"middle","middle"),
w=0;w<g.length;w++)p=world.Kernel.overlayImage(g[w],p,"middle","middle");return p});q["underlay/xy"]=new m("underlay/xy",4,!1,!1,function(c,b,e,g,p){t(c,b,Y,"underlay/xy","image",1,arguments);t(c,e,Da,"underlay/xy","finite real number",2,arguments);t(c,g,Da,"underlay/xy","finite real number",3,arguments);t(c,p,Y,"underlay/xy","image",4,arguments);return world.Kernel.overlayImage(p,b,-jsnums.toFixnum(e),-jsnums.toFixnum(g))});q["underlay/align"]=new m("underlay/align",4,!0,!1,function(c,b,e,g,p,w){Ya(c,
b,T,"underlay/align","x-place",1,arguments);Ya(c,e,qa,"underlay/align","y-place",2,arguments);Ya(c,g,Y,"underlay/align","image",3,arguments);Ya(c,p,Y,"underlay/align","image",4,arguments);Ja(w,function(Ca,La){t(c,Ca,Y,"underlay/align","image",La+4)},arguments);for(var M=world.Kernel.overlayImage(p,g,b.toString(),e.toString()),ba=0;ba<w.length;ba++)M=world.Kernel.overlayImage(w[ba],M,b.toString(),e.toString());return M});q.beside=new m("beside",2,!0,!1,function(c,b,e,g){Ya(c,b,Y,"beside","image",1,
arguments);Ya(c,e,Y,"beside","image",2,arguments);Ja(g,function(M,ba){t(c,M,Y,"beside","image",ba+4)},arguments);for(var p=world.Kernel.overlayImage(b,e,"beside","middle"),w=0;w<g.length;w++)p=world.Kernel.overlayImage(p,g[w],"beside","middle");return p});q["beside/align"]=new m("beside/align",3,!0,!1,function(c,b,e,g,p){Ya(c,b,qa,"beside/align","y-place",1,arguments);Ya(c,e,Y,"beside/align","image",2,arguments);Ya(c,g,Y,"beside/align","image",3,arguments);Ja(p,function(ba,Ca){t(c,ba,Y,"beside","image",
Ca+3)},arguments);for(var w=world.Kernel.overlayImage(e,g,"beside",b.toString()),M=0;M<p.length;M++)w=world.Kernel.overlayImage(w,p[M],"beside",b.toString());return w});q.above=new m("above",2,!0,!1,function(c,b,e,g){Ya(c,b,Y,"above","image",1,arguments);Ya(c,e,Y,"above","image",2,arguments);Ja(g,function(M,ba){t(c,M,Y,"above","image",ba+4)},arguments);for(var p=world.Kernel.overlayImage(b,e,"middle","above"),w=0;w<g.length;w++)p=world.Kernel.overlayImage(p,g[w],"middle","above");return p});q["above/align"]=
new m("above/align",3,!0,!1,function(c,b,e,g,p){Ya(c,b,T,"above/align","x-place",1,arguments);Ya(c,e,Y,"above/align","image",1,arguments);Ya(c,g,Y,"above/align","image",2,arguments);Ja(p,function(ba,Ca){t(c,ba,Y,"above/align","image",Ca+4)},arguments);var w,M=world.Kernel.overlayImage(e,g,b.toString(),"above");for(w=0;w<p.length;w++)M=world.Kernel.overlayImage(M,p[w],b.toString(),"above");return M});q.rotate=new m("rotate",2,!1,!1,function(c,b,e){t(c,b,Da,"rotate","finite real number",1,arguments);
t(c,e,Y,"rotate","image",2,arguments);b=jsnums.toFixnum(b)%360;return world.Kernel.rotateImage(-1*b,e)});q["scale/xy"]=new m("scale/xy",3,!1,!1,function(c,b,e,g){t(c,b,pa,"scale/xy","non-negative number",1,arguments);t(c,e,pa,"scale/xy","non-negative number",2,arguments);t(c,g,Y,"scale/xy","image",3,arguments);return world.Kernel.scaleImage(jsnums.toFixnum(b),jsnums.toFixnum(e),g)});q.scale=new m("scale",2,!1,!1,function(c,b,e){t(c,b,pa,"scale","non-negative number",1,arguments);t(c,e,Y,"scale","image",
2,arguments);return world.Kernel.scaleImage(jsnums.toFixnum(b),jsnums.toFixnum(b),e)});q.crop=new m("crop",5,!1,!1,function(c,b,e,g,p,w){t(c,b,Da,"crop","finite real number",1,arguments);t(c,e,Da,"crop","finite real number",2,arguments);t(c,g,pa,"crop","non-negative number",3,arguments);t(c,p,pa,"crop","non-negative number",4,arguments);t(c,w,Y,"crop","image",5,arguments);return world.Kernel.cropImage(jsnums.toFixnum(b),jsnums.toFixnum(e),jsnums.toFixnum(g),jsnums.toFixnum(p),w)});q.frame=new m("frame",
1,!1,!1,function(c,b){t(c,b,Y,"frame","image",1,arguments);return world.Kernel.frameImage(b)});q["flip-vertical"]=new m("flip-vertical",1,!1,!1,function(c,b){t(c,b,Y,"flip-vertical","image",1,arguments);return world.Kernel.flipImage(b,"vertical")});q["flip-horizontal"]=new m("flip-horizontal",1,!1,!1,function(c,b){t(c,b,Y,"flip-horizontal","image",1,arguments);return world.Kernel.flipImage(b,"horizontal")});q["reflect-x"]=new m("reflect-x",1,!1,!1,function(c,b){t(c,b,Y,"reflect-x","image",1,arguments);
return world.Kernel.flipImage(b,"vertical")});q["reflect-y"]=new m("reflect-y",1,!1,!1,function(c,b){t(c,b,Y,"reflect-y","image",1,arguments);return world.Kernel.flipImage(b,"horizontal")});q.text=new m("text",3,!1,!1,function(c,b,e,g){t(c,b,D,"text","string",1,arguments);t(c,e,function(p){return sa(p)&&jsnums.greaterThan(p,0)&&Ha(p)},"text","exact integer between 1 and 255",2,arguments);t(c,g,H,"text","color",3,arguments);y.get(g)&&(g=y.get(g));return world.Kernel.textImage(b.toString(),jsnums.toFixnum(e),
g,"normal","Arial","","",!1)});q["text/font"]=new C("text/font",[new m("text/font",8,!1,!1,function(c,b,e,g,p,w,M,ba,Ca){t(c,b,D,"text/font","string",1,arguments);t(c,e,function(La){return sa(La)&&jsnums.greaterThan(La,0)&&Ha(La)},"text/font","exact integer between 1 and 255",2,arguments);t(c,g,H,"text/font","color",3,arguments);t(c,p,function(La){return D(La)||!La},"text/font","face",4,arguments);t(c,w,Z,"text/font","family",5,arguments);t(c,M,la,"text/font",'style ("solid" or "outline")',6,arguments);
t(c,ba,k,"text/font","weight",7,arguments);t(c,Ca,Za,"text/font","underline?",8,arguments);y.get(g)&&(g=y.get(g));return world.Kernel.textImage(b.toString(),jsnums.toFixnum(e),g,p.toString(),w.toString(),M.toString(),ba.toString(),Ca)}),new m("text/font",9,!1,!1,function(c,b,e,g,p,w,M,ba,Ca,La){t(c,b,D,"text/font","string",1,arguments);t(c,e,function(Wa){return sa(Wa)&&jsnums.greaterThan(Wa,0)&&Ha(Wa)},"text/font","exact integer between 1 and 255",2,arguments);t(c,g,H,"text/font","color",3,arguments);
t(c,p,function(Wa){return D(Wa)||!Wa},"text/font","face",4,arguments);t(c,w,Z,"text/font","family",5,arguments);t(c,M,la,"text/font",'style ("solid" or "outline")',6,arguments);t(c,ba,k,"text/font","weight",7,arguments);t(c,Ca,Za,"text/font","underline?",8,arguments);t(c,La,Za,"text/font","outline?",9,arguments);y.get(g)&&(g=y.get(g));return world.Kernel.textImage(b.toString(),jsnums.toFixnum(e),g,p.toString(),w.toString(),M.toString(),ba.toString(),Ca,La)})]);q["play-sound"]=new m("play-sound",2,
!1,!1,function(c,b,e){t(c,b,D,"play-sound","string",1);t(c,e,Za,"play-sound","boolean",2);return ja(function(g,p){Bb(b.toString());var w=document.createElement("audio");w.src=b.toString();w.addEventListener("canplay",function(){var M=new world.Kernel.fileAudio(b.toString(),!1,w);c.addBreakRequestedListener(function(){M.audio.pause();return!0});if(e)return g(!0);w.addEventListener("ended",function(){return g(!0)})});w.addEventListener("error",function(M){g(!1)});w.src=b.toString()})});q["bitmap/url"]=
q["image-url"]=new m("bitmap/url",1,!1,!1,function(c,b){t(c,b,D,"bitmap/url","string",1);var e=b.toString();b=c.getImageProxyHook()?c.getImageProxyHook()+"?url="+encodeURIComponent(b.toString()):b.toString();return ja(function(g,p){Bb(e);var w=new Image;w.onload=function(){world.Kernel.fileImage(b,w,g)};w.onerror=function(M){g(types.schemeError(types.incompleteExn(types.exnFail," (unable to load: "+e+")",[])))};w.src=b})});q["video/url"]=new m("video/url",1,!1,!1,function(c,b){t(c,b,D,"video-url",
"string",1);return ja(function(e,g){Bb(b.toString());var p=document.createElement("video");p.src=b.toString();p.addEventListener("canplay",function(){e(world.Kernel.fileVideo(b.toString(),p));c.addBreakRequestedListener(function(){p.pause();return!0})});p.addEventListener("error",function(w){e(types.schemeError(types.incompleteExn(types.exnFail," (unable to load: "+b+")",[])))});p.src=b.toString()})});q["image-width"]=new m("image-width",1,!1,!1,function(c,b){t(c,b,Y,"image-width","image",1);return b.getWidth()});
q["image-height"]=new m("image-height",1,!1,!1,function(c,b){t(c,b,Y,"image-height","image",1);return b.getHeight()});q["image-baseline"]=new m("image-baseline",1,!1,!1,function(c,b){t(c,b,Y,"image-baseline","image",1);return b.getBaseline()});q["image->color-list"]=new m("image->color-list",1,!1,!1,function(c,b){t(c,b,Y,"image->color-list","image",1);c=b.getWidth();var e=b.getHeight(),g=world.Kernel.makeCanvas(c,e).getContext("2d");b.render(g,0,0);b=g.getImageData(0,0,c,e).data;var p=[];for(c=0;c<
b.length;c+=4){e=b[c];g=b[c+1];var w=b[c+2];var M=b[c+3];p.push(types.color(e,g,w,M))}return types.list(p)});var ob=function(c,b,e,g,p,w){cb(c,b,H,"color-list->image","image",1);t(c,e,pa,"color-list->image","non-negative number",2);t(c,g,pa,"color-list->image","non-negative number",3);t(c,p,sa,"color-list->image","natural",4);t(c,w,sa,"color-list->image","natural",5);e=Math.max(jsnums.toFixnum(e),1);g=Math.max(jsnums.toFixnum(g),1);c=world.Kernel.makeCanvas(e,g);p=c.getContext("2d");e=p.createImageData(e,
g);g=e.data;for(var M=0;b!==types.EMPTY;)w=b.first(),g[M]=jsnums.toFixnum(types.colorRed(w)),g[M+1]=jsnums.toFixnum(types.colorGreen(w)),g[M+2]=jsnums.toFixnum(types.colorBlue(w)),g[M+3]=jsnums.toFixnum(types.colorAlpha(w)),M+=4,b=b.rest();p.putImageData(e,0,0);var ba=c.toDataURL("image/png");return ja(function(Ca,La){var Wa=new Image;Wa.onload=function(){world.Kernel.fileImage(ba,Wa,Ca)};Wa.onerror=function($a){Ca(types.schemeError(types.incompleteExn(types.exnFail," (unable to load image from color-list)",
[])))};Wa.src=ba})};q["color-list->image"]=new m("color-list->image",5,!1,!1,function(c,b,e,g,p,w){return ob(c,b,e,g,p,w)});q["color-list->image"]=new m("color-list->image",5,!1,!1,function(c,b,e,g,p,w){return ob(c,b,e,g,p,w)});q["color-list->bitmap"]=new m("color-list->bitmap",3,!1,!1,function(c,b,e,g){return ob(c,b,e,g,0,0)});q["mode?"]=new m("mode?",1,!1,!1,function(c,b){return K(b)});q["image-color?"]=new m("image-color?",1,!1,!1,function(c,b){return H(b)});q["name->color"]=new m("name->color",
1,!1,!1,function(c,b){return N(b)||!1});q["x-place?"]=new m("x-place?",1,!1,!1,function(c,b){return T(b)});q["y-place?"]=new m("y-place?",1,!1,!1,function(c,b){return qa(b)});q["angle?"]=new m("angle?",1,!1,!1,function(c,b){return Pa(b)});q["side-count?"]=new m("side-count?",1,!1,!1,function(c,b){return R(b)});q["step-count?"]=new m("step-count?",1,!1,!1,function(c,b){return ta(b)});var Fb=ma.extend({init:function(c,b){this._super("stop-when");this.handler=c;this.last_picture=b},configure:function(c){return c.updateAll({stopWhen:this.handler,
lastPicture:this.last_picture})}}),pb=ma.extend({init:function(c,b,e){this._super("on-tick");this.handler=c;this.effectHandler=b;this.aDelay=e},configure:function(c){var b={onTick:this.handler,onTickEffect:this.effectHandler,tickDelay:jsnums.toFixnum(jsnums.multiply(1E3,this.aDelay))};return c.updateAll(b)}}),Cb=ma.extend({init:function(c){this._super("on-redraw");this.handler=c},configure:function(c){return c.updateAll({onRedraw:this.handler})}}),xb=!1;void 0!==window.plt&&(P=plt.wescheme.BrowserDetect,
xb="Explorer"===P.browser&&11>P.version);var vb=xb?types.rational(1,8):types.rational(1,28);q["on-tick"]=new C("on-tick",[new m("on-tick",1,!1,!1,function(c,b){t(c,b,B,"on-tick","function",1);W(c,"on-tick",1,b.numParams);return new pb(b,new m("",1,!1,!1,function(e,g){return types.effectDoNothing()}),vb)}),new m("on-tick",2,!1,!1,function(c,b,e){t(c,b,B,"on-tick","function",1,arguments);W(c,"on-tick",1,b.numParams);t(c,e,pa,"on-tick","non-negative number",2,arguments);return new pb(b,new m("",1,!1,
!1,function(g,p){return types.effectDoNothing()}),xb?Math.max(jsnums.toFixnum(e),jsnums.toFixnum(vb)):e)})]);q["on-tick!"]=new C("on-tick!",[new m("on-tick!",2,!1,!1,function(c,b,e){t(c,b,B,"on-tick!","function",1,arguments);W(c,"on-tick!",1,b.numParams);t(c,e,B,"on-tick!","function",2,arguments);return new pb(b,e,vb)}),new m("on-tick!",3,!1,!1,function(c,b,e,g){t(c,b,B,"on-tick!","function",1,arguments);W(c,"on-tick!",1,b.numParams);t(c,e,B,"on-tick!","function",2,arguments);t(c,g,pa,"on-tick!",
"non-negative number",3,arguments);return new pb(b,e,xb?Math.max(jsnums.toFixnum(g),jsnums.toFixnum(vb)):g)})]);q["on-tap"]=new m("on-tap",1,!1,!1,wa("on-tap","onTap",3));q["on-tilt"]=new m("on-tilt",1,!1,!1,wa("on-tilt","onTilt",3));q["on-key"]=new m("on-key",1,!1,!1,wa("on-key","onKey",2));q["on-key!"]=new m("on-key!",2,!1,!1,ka("on-key!","onKey"));q["on-mouse"]=new m("on-mouse",1,!1,!1,wa("on-mouse","onMouse",4));q["mouse-event?"]=new m("mouse-event?",1,!0,!1,function(c,b){return Ea(b)});q["mouse=?"]=
new m("mouse=?",2,!0,!1,function(c,b,e){t(c,b,Ea,"mouse-event?","mouse-event",1);t(c,e,Ea,"mouse-event?","mouse-event",2);return b===e});q["stop-when"]=new C("stop-when",[new m("stop-when",1,!1,!1,function(c,b){t(c,b,B,"stop-when","function",1);W(c,"stop-when",1,b.numParams);return new Fb(b,null)}),new m("stop-when",2,!1,!1,function(c,b,e){t(c,b,B,"stop-when","function",1);W(c,"stop-when",1,b.numParams);t(c,e,B,"stop-when","function",2);return new Fb(b,e)})]);q["stop-when!"]=new m("stop-when!",2,
!1,!1,ka("stop-when!","stopWhen"));q["on-redraw"]=new m("on-redraw",1,!1,!1,function(c,b){t(c,b,B,"on-redraw","function",1);W(c,"on-redraw",1,b.numParams);return new Cb(b)});q["to-draw"]=new m("to-draw",1,!1,!1,function(c,b){t(c,b,B,"to-draw","function",1);W(c,"to-draw",1,b.numParams);return new Cb(b)});q["on-draw"]=new C("on-draw",[new m("on-draw",1,!1,!1,function(c,b){t(c,b,B,"on-draw","function",1);W(c,"on-draw",1,b.numParams);return new (ma.extend({init:function(){this._super("on-draw")},configure:function(e){return e.updateAll({onDraw:b})}}))}),
new m("on-draw",2,!1,!1,function(c,b,e){t(c,b,B,"on-draw","function",1,arguments);t(c,e,B,"on-draw","function",2,arguments);W(c,"on-draw",1,b.numParams);return new (ma.extend({init:function(){this._super("on-draw")},configure:function(g){return g.updateAll({onDraw:b,onDrawCss:e})}}))})]);q["initial-effect"]=new m("initial-effect",1,!1,!1,function(c,b){return new (ma.extend({init:function(){this._super("initial-effect")},configure:function(e){return e.updateAll({initialEffect:b})}}))});var Gb=function(c){cb(void 0,
c,function(e){return U(e)&&2==F(e)},"js-p","list of (list of X Y)",1);c=oa(c);var b=jsworld.MobyJsworld.p(c);b.toWrittenString=function(e){return"(js-p)"};b.toDisplayedString=b.toWrittenString;b.toDomNode=function(e){return b};return helpers.wrapJsObject(b)};q["js-p"]=new C("js-p",[new m("js-p",0,!1,!1,function(c){return Gb(types.EMPTY)}),new m("js-p",1,!1,!1,function(c,b){return Gb(b)})]);var mb=function(c){cb(void 0,c,Ga,"js-div","(listof X Y)",1);c=oa(c);var b=jsworld.MobyJsworld.div(c);b.toWrittenString=
function(e){return"(js-div)"};b.toDisplayedString=b.toWrittenString;b.toDomNode=function(e){return b};return helpers.wrapJsObject(b)};q["js-div"]=new C("js-div",[new m("js-div",0,!1,!1,function(c){return mb(types.EMPTY)}),new m("js-div",1,!1,!1,function(c,b){return mb(b)})]);var fb=function(c){return function(b,e,g,p){t(b,e,B,c,"function",1);t(b,g,B,c,"function",2);cb(void 0,p,Ga,c,"(listof X Y)",3);b=p?oa(p):{};var w=jsworld.MobyJsworld.buttonBang(e,g,b);w.toWrittenString=function(M){return"("+c+
" ...)"};w.toDisplayedString=w.toWrittenString;w.toDomNode=function(M){return w};return helpers.wrapJsObject(w)}},Hb=function(c,b,e){var g=new types.PrimProc("",1,!1,!1,function(p,w){return types.EMPTY});return fb("js-button")(c,b,g,e)};q["js-button"]=new C("js-button",[new m("js-button",1,!1,!1,function(c,b){return Hb(c,b)}),new m("js-button",2,!1,!1,function(c,b,e){return Hb(c,b,e)})]);q["js-button!"]=new C("js-button!",[new m("js-button!",2,!1,!1,fb("js-button!")),new m("js-button!",3,!1,!1,fb("js-button!"))]);
var kb=function(c,b,e){t(aState,c,D,"js-input","string",1);t(aState,b,B,"js-input","function",2);cb(void 0,e,Ga,"js-input","(listof X Y)",3);e=e?oa(e):{};var g=jsworld.MobyJsworld.input(c,b,e);g.toWrittenString=function(p){return"(js-input ...)"};g.toDisplayedString=g.toWrittenString;g.toDomNode=function(p){return g};return helpers.wrapJsObject(g)};q["js-input"]=new C("js-input",[new m("js-input",2,!1,!1,function(c,b,e){return kb(b,e)}),new m("js-input",3,!1,!1,function(c,b,e,g){return kb(b,updateF,
g)})]);var Db=function(c,b){t(aState,c,D,"js-img","string",1);cb(void 0,b,Ga,"js-img","(listof X Y)",2);b=oa(b);var e=jsworld.MobyJsworld.img(c,b);e.toWrittenString=function(g){return"(js-img ...)"};e.toDisplayedString=e.toWrittenString;e.toDomNode=function(g){return e};return helpers.wrapJsObject(e)};q["js-img"]=new C("js-img",[new m("js-img",1,!1,!1,function(c,b){return Db(b,types.EMPTY)}),new m("js-img",2,!1,!1,function(c,b,e){return Db(b,e)})]);q["js-text"]=new m("js-text",1,!1,!1,function(c,
b){t(c,b,D,"js-text","string",1);var e=jsworld.MobyJsworld.text(b,[]);e.toWrittenString=function(g){return"(js-text ...)"};e.toDisplayedString=e.toWrittenString;e.toDomNode=function(g){return e};return helpers.wrapJsObject(e)});var Eb=function(c,b,e){cb(void 0,c,D,"js-select","listof string",1);t(aState,b,B,"js-select","function",2);cb(void 0,e,Ga,"js-select","(listof X Y)",3);e=e?oa(e):{};c=helpers.deepListToArray(c);var g=jsworld.MobyJsworld.select(c,b,e);g.toWrittenString=function(p){return"(js-select ...)"};
g.toDisplayedString=g.toWrittenString;g.toDomNode=function(p){return g};return helpers.wrapJsObject(g)};q["js-select"]=new C("js-select",[new m("js-select",2,!1,!1,function(c,b,e){return Eb(b,e)}),new m("js-select",3,!1,!1,function(c,b,e,g){return Eb(b,e,g)})]);q["big-bang"]=q["js-big-bang"]=new m("big-bang",1,!0,!1,function(c,b,e){Ja(e,function(p,w){t(c,p,function(M){return M instanceof ma||U(M)||types.isWorldConfig(M)},"big-bang","handler",w+2,[c,b].concat(e))});var g=helpers.map(function(p){return p instanceof
ma?function(w){return p.configure(w)}:p},e);return ja(function(p,w){var M=function(){ba.breaker()};c.addBreakRequestedListener(M);var ba=jsworld.MobyJsworld.bigBang(b,c.getToplevelNodeHook()(),g,w,function(Ca){c.removeBreakRequestedListener(M);p(Ca)})})});q.animate=new m("animate",1,!1,!1,function(c,b){t(c,b,B,"animate","function",1);t(c,b,G(1),"animate","1-argument function",1);b=[new pb(q.add1,new m("",1,!1,!1,function(g,p){return types.effectDoNothing()}),vb),new Cb(b)];var e=helpers.map(function(g){return g instanceof
ma?function(p){return g.configure(p)}:g},b);return ja(function(g,p){var w=function(){M.breaker()};c.addBreakRequestedListener(w);var M=jsworld.MobyJsworld.bigBang(1,c.getToplevelNodeHook()(),e,p,function(ba){c.removeBreakRequestedListener(w);g(ba)})})});var zb=function(c){cb(void 0,c,Ga,"empty-page","(listof X Y)",1);c=oa(c);return jsworld.MobyJsworld.emptyPage(c)};q["empty-page"]=new C("empty-page",[new m("empty-page",0,!1,!1,function(c){return zb(types.EMPTY)}),new m("empty-page",1,!1,!1,function(c,
b){return zb(b)})]);q["place-on-page"]=new m("empty-page",4,!1,!1,function(c,b,e,g,p){return jsworld.MobyJsworld.placeOnPage(b,e,g,p)});q["make-world-config"]=new m("make-world-config",2,!0,!1,function(c,b,e,g){var p=[b,e].concat(g);t(c,b,B,"make-world-config","function",1,p);t(c,e,G(1),"make-world-config","function (arity 1)",2,p);Ja(g,function(w,M){t(c,w,B,"make-world-config","handler",M+3,p)});G(g.length)(b)||ca(types.incompleteExn(types.exnFailContract,"make-world-config: 1st argument must have arity equal to the number of arguments after the second",
[]));return types.worldConfig(b,e,g)});q["make-effect-type"]=rb("make-effect-type",4,[!1],!1,function(c,b,e,g,p,w,M){t(b,e,Ua,"make-effect-type","string",1,c);t(b,g,function(ba){return!1===ba||types.isEffectType(ba)},"make-effect-type","effect type or #f",2,c);t(b,p,sa,"make-effect-type","exact non-negative integer",3,c);t(b,w,B,"make-effect-type","function",4,c);t(b,M,function(ba){return!1===ba||B(ba)},"make-effect-type","procedure or #f",6,c);c=p+1+(g?g.numberOfArgs:0);M&&!G(c)(M)&&ca(types.incompleteExn(types.exnFailContract,
helpers.format("make-effect-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",[c,M]),[]));M=M?Qa(b,M):!1;b=types.makeEffectType(e.toString(),g,p,w,M,ua(b));return Na(b)});q["effect-type?"]=new m("effect-type?",1,!1,!1,function(c,b){return types.isEffectType(b)});q["effect?"]=new m("effect?",1,!1,!1,function(c,b){return types.isEffect(b)});q["make-render-effect-type"]=rb("make-render-effect-type",4,[!1],!1,function(c,b,e,g,p,w,M){t(b,e,Ua,"make-render-effect-type",
"string",1,c);t(b,g,function(ba){return!1===ba||types.isEffectType(ba)},"make-render-effect-type","effect type or #f",2,c);t(b,p,sa,"make-render-effect-type","exact non-negative integer",3,c);t(b,w,B,"make-render-effect-type","function",4,c);t(b,M,function(ba){return!1===ba||B(ba)},"make-render-effect-type","procedure or #f",6,c);c=p+1+(g?g.numberOfArgs:0);M&&!G(c)(M)&&ca(types.incompleteExn(types.exnFailContract,helpers.format("make-effect-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",
[c,M]),[]));b=M?Qa(b,M):!1;e=types.makeRenderEffectType(e.toString(),g,p,w,b);return Na(e)});q["render-effect-type?"]=new m("render-effect-type?",1,!1,!1,function(c,b){return types.isRenderEffectType(b)});q["render-effect?"]=new m("render-effect?",1,!1,!1,function(c,b){return types.isRenderEffect(b)});q["world-with-effects"]=new m("world-with-effects",2,!1,!1,function(c,b,e){t(c,b,Va,"world-with-effects","compound effect",1,arguments);return jsworld.Jsworld.with_multiple_effects(e,helpers.flattenSchemeListToArray(b))});
q["make-render-effect"]=new m("make-render-effect",2,!1,!1,function(c,b,e){return types.makeRenderEffect(b,e)});q["render-effect?"]=new m("render-effect?",1,!1,!1,function(c,b){return types.isRenderEffect(b)});q["render-effect-dom-node"]=new m("render-effect-dom-node",1,!1,!1,function(c,b){t(c,b,types.isRenderEffect,"render-effect-dom-node","render-effect",1);return types.renderEffectDomNode(b)});q["render-effect-effects"]=new m("render-effect-effects",1,!1,!1,function(c,b){t(c,b,types.isRenderEffect,
"render-effect-effects","render-effect",1);return types.renderEffectEffects(b)});q["scheme->prim-js"]=new m("scheme->prim-js",1,!1,!1,function(c,b){t(c,b,function(g){return Da(g)||D(g)||Ua(g)||l(g)||Za(g)||ra(g)},"scheme->prim-js","real number, string, symbol, char, boolean, or vector",1);if(Da(b)){jsnums.equals(b,jsnums.nan)||jsnums.equals(b,jsnums.inf)||jsnums.equals(b,jsnums.negative_inf)||!jsnums.greaterThan(b,9E15)&&!jsnums.lessThan(b,-9E15)||ca(types.incompleteExn(types.exnFailContract,helpers.format("scheme->primitive-js: only numbers in [-9e15, 9e15] are accurately representable in javascript; given: ~s",
[b]),[]));var e=jsnums.toFixnum(b)}else D(b)?e=b.toString():Ua(b)||l(b)?e=b.val:Za(b)?e=b:ra(b)&&(e=b.elts.slice(0));return helpers.wrapJsObject(e)});q["prim-js->scheme"]=new m("prim-js->scheme",1,!1,!1,function(c,b){t(c,b,function(e){return Ka(e)&&("number"==typeof e.obj||"string"==typeof e.obj||"boolean"==typeof e.obj||"function"==typeof e.obj||e.obj instanceof Array)},"prim-js->scheme","javascript number, string, boolean, function, or array",1);if("number"===typeof b.obj)return types["float"](b.obj);
if("string"===typeof b.obj||"boolean"===typeof b.obj)return b.obj;if("function"===typeof b.obj)return new m("",0,!0,!1,function(e){return b.obj.apply(null,e)});if(b.obj instanceof Array)return types.vector(b.obj.slice(0))});q["procedure->cps-js-fun"]=new m("procedure->cps-js-fun",1,!1,!1,function(c,b){t(c,b,B,"procedure->cps-js-fun","function",1);var e=ua(c);return types.jsObject(b.name+" (cps)",function(){var g=helpers.map(helpers.wrapJsObject,arguments),p=0==g.length?function(){}:g.shift();e(b,
g,p)})});q["procedure->void-js-fun"]=new m("procedure->void-js-fun",1,!1,!1,function(c,b){t(c,b,B,"procedure->void-js-fun","function",1);var e=ua(c);return types.jsObject(b.name+" (void)",function(){var g=helpers.map(helpers.wrapJsObject,arguments);e(b,g,function(){})})});q["js-==="]=new m("js-===",2,!1,!1,function(c,b,e){t(c,b,Ka,"js-===","javascript value",1);t(c,e,Ka,"js-===","javascript value",2);return b.obj===e.obj});q["js-get-named-object"]=new m("js-get-named-object",1,!1,!1,function(c,b){t(c,
b,D,"js-get-named-object","string",1);c=b.toString();return types.jsObject(c,"window"===c?window:window[c])});q["js-get-field"]=new m("js-get-field",2,!0,!1,function(c,b,e,g){g.unshift(e);var p=[b].concat(g);t(c,b,Ka,"js-get-field","js-object",1,p);Ja(g,function(ba,Ca){t(c,ba,D,"js-get-field","string",Ca+2,p)});e=[b.name];b=b.obj;for(var w=0;w<g.length;w++){if(void 0===b){var M=e.join("");ca(types.incompleteExn(types.exnFailContract,helpers.format("js-get-field: tried to access field ~a of ~a, but ~a was undefined",
[g[w],M,M]),[]))}e.push('["'+g[w].toString()+'"]');b=b[g[w].toString()]}return types.jsObject(e.join(""),b)});q["js-set-field!"]=new m("js-set-field!",3,!1,!1,function(c,b,e,g){t(c,b,function(p){return Ka(p)&&"object"==typeof p.obj},"js-set-field!","javascript object",1,arguments);t(c,e,D,"js-set-field!","string",2,arguments);b.obj[e.toString()]=Ka(g)?g.obj:g;return types.VOID});q["js-typeof"]=new m("js-typeof",1,!1,!1,function(c,b){t(c,b,Ka,"js-typeof","js-object",1);return typeof b.obj});q["js-instanceof"]=
new m("js-instanceof",2,!1,!1,function(c,b,e){t(c,b,Ka,"js-instanceof","js-object",1,arguments);t(c,e,db,"js-instanceof","javascript function",2,arguments);return b.obj instanceof e.obj});q["js-call"]=new m("js-call",2,!0,!1,function(c,b,e,g){var p=[b,e].concat(g);t(c,b,db,"js-call","javascript function",1,p);t(c,e,function(w){return!1===w||Ka(w)&&"object"==typeof w.obj},"js-call","javascript object or false",2,p);c=helpers.map(function(w){return Ka(w)?w.obj:w},g);b=b.obj.apply(e?e.obj:null,c);return void 0===
b?types.VOID:helpers.wrapJsObject(b)});q["js-new"]=new m("js-new",1,!0,!1,function(c,b,e){Ya(c,b,db,"js-new","javascript function",1);var g=helpers.map(function(p){return Ka(p)?p.obj:p},e);c=function(){b.obj.apply(this,g)};c.prototype=b.obj.prototype;return helpers.wrapJsObject(new c)});q["js-make-hash"]=new C("js-make-hash",[new m("js-make-hash",0,!1,!1,function(){return types.jsObject("hash",{})}),new m("js-make-hash",1,!1,!1,function(c,b){cb(c,b,function(p){return Ga(p)&&D(p.first())},"js-make-hash",
"(listof string X)",1);for(c={};!b.isEmpty();){var e=b.first().first().toString(),g=b.first().rest().first();c[e]=Ka(g)?g.obj:g;b=b.rest()}return types.jsObject("hash",c)})]);q.eof=types.EOF;q.e=jsnums.e;q.empty=types.EMPTY;q["false"]=!1;q["true"]=!0;q.pi=jsnums.pi;q["null"]=types.EMPTY;q["empty-image"]=world.Kernel.sceneImage(0,0,[],!0);q["js-undefined"]=types.jsObject("undefined",void 0);q["js-null"]=types.jsObject("null",null);primitive.getPrimitive=function(c,b){return q[c]};primitive.isPrimitive=
function(c){return c instanceof m};primitive.addPrimitive=function(c,b){q[c]=b};primitive.Primitive=m;primitive.CasePrimitive=C;primitive.setCALL=function(c){fa=function(b,e,g){return new c(b,e,g)}};primitive.setPAUSE=function(c){ja=function(b){return new c(b)}}})();var control={};
(function(){var W=function(B){this.depth=B};W.prototype.invoke=function(B){debug("SET "+this.depth);if(0>B.vstack.length-1-(this.depth||0))throw types.internalError("vstack not long enough",B.captureCurrentContinuationMarks(aState));B.setn(this.depth,B.v)};var fa=function(B){this.n=B};fa.prototype.invoke=function(B){B.pushn(this.n)};var ja=function(B){this.depth=B};ja.prototype.invoke=function(B){debug("SWAP "+this.depth);if(0>B.vstack.length-1-(this.depth||0))throw types.internalError("vstack not long enough",
B.captureCurrentContinuationMarks(aState));var J=B.vstack[B.vstack.length-1-(this.depth||0)];B.vstack[B.vstack.length-1-(this.depth||0)]=B.v;B.v=J};var q=function(B){this.n=B};q.prototype.invoke=function(B){B.popn(this.n)};var m=function(B,J){this.prefix=B;this.body=J};m.prototype.invoke=function(B){C(B,this.prefix);var J=[],V;for(V=0;V<this.body.length;V++)J.push(this.body[V]);B.pushManyControls(J)};var C=function(B,J){for(var V=J.numLifts,Y=new types.PrefixValue,A=0;A<J.toplevels.length+V;A++){var H=
J.toplevels[A];if(!1===H)Y.addSlot();else if("module-variable"===H.$){var N=B,Z=Y,la=H;H=la.modidx.path;la=la.sym+"";var k=primitive.getPrimitive(la,H);N.globals[la]="undefined"!==typeof k?new types.GlobalBucket(la,k):new types.GlobalBucket(la,new types.ModuleVariableRecord(H,la));Z.addSlot(N.globals[la])}else if("global-bucket"===H.$)N=B,Z=Y,H=H.value+"",N.globals[H]||(N.globals[H]=new types.GlobalBucket(H,types.UNDEFINED)),Z.addSlot(N.globals[H]);else throw types.internalError("unable to install toplevel element "+
H,state.captureCurrentContinuationMarks(B));}B.vstack.push(Y)},da=function(B){this.value=B};da.prototype.invoke=function(B){B.v=this.value};var na=function(B,J,V){this.test=B;this.thenPart=J;this.elsePart=V};na.prototype.invoke=function(B){var J=[];J.push(this.test);J.push(new v(this.thenPart,this.elsePart));B.pushManyControls(J)};var v=function(B,J){this.thenPart=B;this.elsePart=J};v.prototype.invoke=function(B){debug("BRANCH");!1!==B.v&&void 0!==B.v?B.pushControl(this.thenPart):B.pushControl(this.elsePart)};
var u=function(B){this.name=B};u.prototype.invoke=function(B){var J=this;throw new Oa(function(V,Y){if(B.invokedModules[J.name])V(types.VOID);else{var A=function(N){return"undefined"!==typeof window.COLLECTIONS&&window.COLLECTIONS[N]},H=function(){V(types.schemeError(types.incompleteExn(types.exn,"unable to load "+J.name+": it isn't in the set of known collections",[])))};A(J.name)?G(B,window.COLLECTIONS[J.name],V):B.hooks.dynamicModuleLoader(J.name,function(){A(J.name)?G(B,window.COLLECTIONS[J.name],
V):H()},H)}});};var G=function(B,J,V){B.clearForEval({preserveBreak:!0,clearGlobals:!0});interpret.load(J.bytecode,B);interpret.run(B,function(){for(var Y={},A=0;A<J.provides.length;A++){var H=J.provides[A],N=B.globals[H];if(N)Y[H]=N.value;else{V(types.schemeError(types.exn("module "+J.name+" is missing an expected definition for "+H)));return}}B.invokedModules[J.name]={record:J,providedValues:Y};V(types.VOID)},function(Y){V(Y)})},F=function(B){this.forms=B};F.prototype.invoke=function(B){for(var J=
this.forms,V=[],Y=0;Y<J.length;Y++)V.push(J[Y]);B.pushManyControls(V)};var E=function(B){this.seq=B};E.prototype.invoke=function(B){if(1===this.seq.length)B.pushControl(this.seq[0]);else{for(var J=[],V=1;V<this.seq.length;V++)J.push(this.seq[V]);B.pushManyControls([this.seq[0],new O(J)])}};var O=function(B){this.rest=B};O.prototype.invoke=function(B){B.pushControl(new da(B.v));B.pushManyControls(this.rest)};var P=function(B,J,V){this.depth=B;this.pos=J;this.loc=V};P.prototype.invoke=function(B){B.v=
B.refPrefix(this.depth,this.pos,this.loc)};var X=function(B,J){this.pos=B;this.isUnbox=J};X.prototype.invoke=function(B){var J=B.peekn(this.pos);this.isUnbox&&(J=J.unbox());B.v=J};var ia=function(B){this.name=B+""};ia.prototype.invoke=function(B){var J=primitive.getPrimitive(this.name,void 0);if(!J)throw types.internalError("Primitive "+this.name+" not implemented!",state.captureCurrentContinuationMarks(B));B.v=J};var Ba=function(B){this.name=B.name;this.locs=B.locs;this.numParams=B.numParams;this.paramTypes=
B.paramTypes;this.isRest=B.isRest;this.closureMap=B.closureMap;this.closureTypes=B.closureTypes;this.body=B.body};Ba.prototype.invoke=function(B){B.v=new types.ClosureValue(this.name,this.locs,this.numParams,this.paramTypes,this.isRest,ma(B,this.closureMap,this.closureTypes),this.body)};var ma=function(B,J,V){V=[];for(var Y=0;Y<J.length;Y++){var A=B.peekn(J[Y]);V.push(A)}return V},wa=function(B,J){this.procs=B;this.body=J};wa.prototype.invoke=function(B){for(var J=[],V=this.procs.length,Y=0;Y<V;Y++)J.push(this.procs[Y]),
J.push(new W(V-1-Y));J.push(new ka(this.procs));J.push(this.body);B.pushManyControls(J)};var ka=function(B){this.procs=B};ka.prototype.invoke=function(B){for(var J=this.procs.length,V=0;V<J;V++){var Y=this.procs[V];B.peekn(J-1-V).closureVals=ma(B,Y.closureMap,Y.closureTypes)}};var oa=function(B,J){this.ids=B;this.body=J};oa.prototype.invoke=function(B){var J=[];J.push(this.body);J.push(new ca(this.ids));B.pushManyControls(J)};var ca=function(B){this.ids=B};ca.prototype.invoke=function(B){debug("DEF_VALUES");
state.captureCurrentContinuationMarks(B).ref("moby-application-position-key");var J=B.v;if(J instanceof types.ValuesWrapper){this.ids.length!==J.elts.length&&helpers.raise(types.exnFailContractArity("define-values: expected "+this.ids.length+" values, but received "+J.elts.length,state.captureCurrentContinuationMarks(B)));for(var V=0;V<this.ids.length;V++)B.setPrefix(this.ids[V].depth,this.ids[V].pos,J.elts[V])}else 1!==this.ids.length?helpers.raise(types.exnFailContractArity("define-values: expected "+
this.ids.length+" values, but only received one: "+J,state.captureCurrentContinuationMarks(B))):B.setPrefix(this.ids[0].depth,this.ids[0].pos,J)};var ua=function(B,J){this.rator=B;this.rands=J};ua.prototype.invoke=function(B){var J=this.rator,V=this.rands,Y=[];0!==V.length&&Y.push(new fa(V.length));Y.push(J);0!==V.length&&Y.push(new W(V.length-1));for(J=0;J<V.length;J++)J!==V.length-1?(Y.push(V[J]),Y.push(new W(J))):(Y.push(V[V.length-1]),Y.push(new ja(V.length-1)));Y.push(new Qa(V.length));B.pushManyControls(Y)};
var Qa=function(B){this.n=B};Qa.prototype.invoke=function(B){debug("CALL "+this.n);var J=B.popn(this.n),V=B.v,Y=this.n;V=Fa(B,Y,V,J);V.callProcedure(B,V,Y,J)};var Sa=function(B,J,V,Y){0!==B.cstack.length&&B.cstack[B.cstack.length-1]instanceof q&&B.cstack.pop().invoke(B);var A=[];A.push(B);if(V<J.numParams)var H;if(J.isRest){for(H=0;H<J.numParams;H++)A.push(Y.shift());var N=[];for(H=0;H<V-J.numParams;H++)N.push(Y.shift());A.push(N)}else for(H=0;H<J.numParams;H++)A.push(Y.shift());V=J.impl.apply(J.impl,
A);Xa(B,V,J)},Xa=function(B,J,V){if(J instanceof Ra){B.cstack.push(new bb(J.k,V));V=J.operands.length;var Y,A=[types.NoLocation];for(Y=0;Y<V;Y++)A.push(types.NoLocation);aHash={};aHash["moby-application-position-key"]=types.list(A);B.pushControl(types.contMarkRecordControl(aHash));V=J.operator;Y=J.operands.length;J=J.operands;V=Fa(B,Y,V,J);V.callProcedure(B,V,Y,J)}else{if(J instanceof Na)throw new Oa(J.onPause);V.assignsToValueRegister||(B.v=J)}},Oa=function(B){this.onPause=B},Ra=function(B,J,V){this.operator=
B;this.operands=J;this.k=V},bb=function(B,J){this.k=B;this.procValue=J};bb.prototype.invoke=function(B){Xa(B,this.k(B.v),this.procValue)};primitive.setCALL(Ra);var Na=function(B){this.onPause=B};primitive.setPAUSE(Na);var za=function(B,J,V,Y){0!==B.cstack.length&&B.cstack[B.cstack.length-1]instanceof q?(B.cstack.pop().invoke(B),V=Q(B,J,Y,V),B.pushControl(new q(V))):2<=B.cstack.length&&types.isContMarkRecordControl(B.cstack[B.cstack.length-1])&&B.cstack[B.cstack.length-2]instanceof q?(B.cstack[B.cstack.length-
2].invoke(B),V=Q(B,J,Y,V),B.cstack[B.cstack.length-2]=new q(V)):(V=Q(B,J,Y,V),B.pushControl(new q(V)));B.pushControl(J.body)},Da=function(B,J,V,Y){B.v=1===V?Y[0]:new types.ValuesWrapper(Y);B.vstack=J.vstack;B.cstack=J.cstack},Fa=function(B,J,V,Y){var A=function(){var y="";if(0<Y.length){y=[":"];for(var K=0;K<Y.length;K++)y.push(types.toWrittenString(Y[K]));y=y.join(" ")}return y},H=function(y){var K=[];if(0<Y.length)for(var T=0;T<Y.length;T++)K.push(new types.ColoredPart(Y[T]+(T<Y.length-1?" ":""),
y.first())),y=y.rest();return K},N=types.getProcedureType(V);if(!N){A("; arguments were:");A=state.captureCurrentContinuationMarks(B).ref("moby-application-position-key");for(var Z=A=A[A.length-1],la;!Z.isEmpty();)la=Z.first().elts,Z=Z.rest();Z=H(A.rest());Z=types.vector([la[0],la[1],la[2],la[3],1]);la=types.vector([la[0],la[1]+la[4]-1,la[2],la[3]+la[4]-1,1]);var k=V.toWrittenString?V.toWrittenString():V.toString();helpers.raise(types.incompleteExn(types.exnFailContract,new types.Message([new types.MultiPart("function call",
[Z,la],!0),": expected function, given: ",new types.ColoredPart(k,A.first())]),[]))}if("CaseLambdaValue"===N){for(A=0;A<V.closures.length;A++)if(J===V.closures[A].numParams||J>V.closures[A].numParams&&V.closures[A].isRest)return V.closures[A]=za,V.closures[A];la=[];for(A=0;A<V.closures.length;A++)la.push(V.closures[A].numParams+"");A=state.captureCurrentContinuationMarks(B).ref("moby-application-position-key");A=A[A.length-1];Z=H(A.rest());helpers.raise(types.incompleteExn(types.exnFailContractArity,
new types.Message([new types.ColoredPart(V.name?V.name:"#<case-lambda-procedure>",A.first()),": expects [",la.join(", "),"] arguments, but given ",J,new types.GradientPart(Z)]),[]))}else if("CasePrimitive"===N){for(A=0;A<V.cases.length;A++)if(J===V.cases[A].numParams||J>V.cases[A].numParams&&V.cases[A].isRest)return V.cases[A].callProcedure=Sa,V.cases[A];la=[];for(A=0;A<V.cases.length;A++)la.push(V.cases[A].numParams+"");A=state.captureCurrentContinuationMarks(B).ref("moby-application-position-key");
A=A[A.length-1];Z=H(A.rest());helpers.raise(types.incompleteExn(types.exnFailContractArity,new types.Message([new types.ColoredPart(V.name,A.first()),": expects ",la.join(" or ")," arguments, but given ",J,0<Z.length?": ":"",0<Z.length?new types.GradientPart(Z):""]),[]))}if("ContinuationClosureValue"===N)return V.callProcedure=Da,V;if(J===V.numParams||J>V.numParams&&V.isRest)return V.callProcedure=primitive.isPrimitive(V)?Sa:za,V;A=state.captureCurrentContinuationMarks(B).ref("moby-application-position-key");
A=A[A.length-1];Z=H(A.rest());helpers.raise(types.incompleteExn(types.exnFailContractArityWithPosition,new types.Message([new types.ColoredPart(""+(V.name!==types.EMPTY?V.name:"anonymous function"),A.first()),": expects ",V.isRest?"at least ":"",void 0!=V.locs?new types.MultiPart(V.numParams+" argument"+(1==V.numParams?"":"s"),V.locs.slice(1),!1):V.numParams+" argument"+(1==V.numParams?"":"s"),", but given ",J,0<Z.length?": ":"",0<Z.length?new types.GradientPart(Z):""]),[]))},Q=function(B,J,V,Y){var A=
0;if(J.isRest){var H=types.EMPTY,N;for(N=0;N<Y-J.numParams;N++)H=types.cons(V.pop(),H);B.pushValue(H);A++}for(N=V.length-1;0<=N;N--)B.pushValue(V[N]),A++;for(N=J.closureVals.length-1;0<=N;N--)B.pushValue(J.closureVals[N]),A++;return A},sa=function(B,J,V){this.key=B;this.val=J;this.body=V};sa.prototype.invoke=function(B){var J=[];J.push(this.key);J.push(new pa(this.val,this.body));B.pushManyControls(J)};var pa=function(B,J){this.val=B;this.body=J};pa.prototype.invoke=function(B){var J=B.v,V=[];V.push(this.val);
V.push(new Pa(J,this.body));B.pushManyControls(V)};var Pa=function(B,J){this.key=B;this.body=J};Pa.prototype.invoke=function(B){var J=B.v;if(0!==B.cstack.length&&types.isContMarkRecordControl(B.cstack[B.cstack.length-1]))B.pushControl(B.cstack.pop().update(this.key,J));else{var V={};V[this.key.val]=J;B.pushControl(types.contMarkRecordControl(V))}B.pushControl(this.body)};var R=function(B,J){this.proc=B;this.argsExpr=J};R.prototype.invoke=function(B){var J=[];J.push(this.proc);J.push(new ta(this.argsExpr));
B.pushManyControls(J)};var ta=function(B){this.expr=B};ta.prototype.invoke=function(B){var J=[];J.push(this.expr);J.push(new Ua(B.v));B.pushManyControls(J)};var Ua=function(B){this.procVal=B};Ua.prototype.invoke=function(B){var J=B.v;B.v=this.procVal;if(J instanceof types.ValuesWrapper){var V=J.elts;for(J=V.length-1;0<=J;J--)B.pushValue(V[J]);B.pushControl(new Qa(V.length))}else B.pushValue(J),B.pushControl(new Qa(1))};var l=function(B,J){this.rhs=B;this.body=J};l.prototype.invoke=function(B){var J=
[];B.pushn(1);J.push(this.rhs);J.push(new W(0));J.push(this.body);J.push(new q(1));B.pushManyControls(J)};var D=function(B){this.count=B.count;this.isBoxes=B.isBoxes;this.body=B.body};D.prototype.invoke=function(B){var J=[],V=this.count;B.pushn(V);if(this.isBoxes)for(var Y=0;Y<V;Y++)B.setn(Y,types.box(types.UNDEFINED));J.push(this.body);J.push(new q(V));B.pushManyControls(J)};var L=function(B,J){this.pos=B;this.body=J};L.prototype.invoke=function(B){B.setn(this.pos,types.box(B.peekn(this.pos)));B.pushControl(this.body)};
var U=function(B){this.count=B.count;this.pos=B.pos;this.isBoxes=B.isBoxes;this.rhs=B.rhs;this.body=B.body};U.prototype.invoke=function(B){var J=[];J.push(this.rhs);J.push(new ha(this.count,this.pos,this.isBoxes,this.body));B.pushManyControls(J)};var ha=function(B,J,V,Y){this.count=B;this.pos=J;this.isBoxes=V;this.body=Y};ha.prototype.invoke=function(B){var J=B.v;J instanceof types.ValuesWrapper?(this.count!==J.elts.length&&helpers.raise(types.exnFailContractArity("expected "+this.count+" values, but received "+
J.elts.length,B.captureCurrentContinuationMarks(aState))),J=J.elts):(1!==this.count&&helpers.raise(types.exnFailContractArity("expected "+this.count+" values, but received one",B.captureCurrentContinuationMarks(aState))),J=[J]);if(this.isBoxes)for(var V=0;V<this.count;V++)B.peekn(V+this.pos).set(J[V]);else for(V=0;V<this.count;V++)B.setn(V+this.pos,J[V]);B.pushControl(this.body)};var ra=function(B){this.id=B.id;this.rhs=B.rhs;this.isUndefOk=B.isUndefOk};ra.prototype.invoke=function(B){var J=[];J.push(this.rhs);
J.push(new xa(this.id.depth,this.id.pos,this.isUndefOk));B.pushManyControls(J)};var xa=function(B,J,V){this.depth=B;this.pos=J;this.isUndefOk=V};xa.prototype.invoke=function(B){debug("SET_TOPLEVEL "+this.depth+", "+this.pos);if(0>B.vstack.length-1-(this.depth||0))throw types.internalError("vstack not long enough",state.captureCurrentContinuationMarks(B));B.setPrefix(this.depth,this.pos,B.v)};var Aa=function(B){this.toplevel=B};Aa.prototype.invoke=function(B){B.v=new types.VariableReference(B.vstack[B.vstack.length-
1-this.toplevel.depth],this.toplevel.pos)};var Ta=function(B){this.genId=B+""};Ta.prototype.invoke=function(B){B.v=B.heap[this.genId]};var Ha=function(B,J){this.name=B;this.clauses=J};Ha.prototype.invoke=function(B){var J=this.clauses;0===J.length?B.v=new types.CaseLambdaValue(this.name,[]):(B.pushControl(new Za(this.name,types.list(J).rest(),types.list([]))),B.pushControl(J[0]))};var Za=function(B,J,V){this.name=B;this.lamsToEvaluate=J;this.evaluatedLams=V};Za.prototype.invoke=function(B){var J=
B.v;if(this.lamsToEvaluate.isEmpty()){J=types.cons(J,this.evaluatedLams).reverse();for(var V=[];!J.isEmpty();)V.push(J.first()),J=J.rest();B.v=new types.CaseLambdaValue(this.name,V)}else B.pushControl(new Za(this.name,this.lamsToEvaluate.rest(),types.cons(J,this.evaluatedLams))),B.pushControl(this.lamsToEvaluate.first())};control.processPrefix=C;control.ConstantControl=da;control.BranchControl=na;control.SeqControl=F;control.Beg0Control=E;control.ModControl=m;control.Prefix=function(B){this.numLifts=
B.numLifts;this.toplevels=B.toplevels};control.ToplevelControl=P;control.DefValuesControl=oa;control.LamControl=Ba;control.PrimvalControl=ia;control.ApplicationControl=ua;control.LocalrefControl=X;control.ApplyValuesControl=R;control.LetOneControl=l;control.LetVoidControl=D;control.BoxenvControl=L;control.InstallValueControl=U;control.WithContMarkControl=sa;control.AssignControl=ra;control.VarrefControl=Aa;control.ClosureControl=Ta;control.CaseLamControl=Ha;control.LetRecControl=wa;control.CallControl=
Qa;control.RequireControl=u;control.PauseException=Oa})();var loader={};
(function(){var W=function(q,m){switch(m.$){case "mod":return new control.ModControl(ja(m.prefix),fa(q,m.body));case "def-values":return new control.DefValuesControl(m.ids,W(q,m.body));case "indirect":return new control.ConstantControl(q.heap[m.value]);case "apply-values":return new control.ApplyValuesControl(W(q,m.proc),W(q,m["args-expr"]));case "toplevel":return new control.ToplevelControl(m.depth,m.pos,m.loc);case "constant":return new control.ConstantControl(m.value);case "req":return new control.RequireControl(m.reqs+
"");case "seq":return new control.SeqControl(fa(q,m.forms));case "application":return new control.ApplicationControl(W(q,m.rator),fa(q,m.rands));case "localref":return new control.LocalrefControl(m.pos,m["unbox?"]);case "primval":return new control.PrimvalControl(m.value);case "branch":return new control.BranchControl(W(q,m.test),W(q,m.then),W(q,m["else"]));case "lam":return new control.LamControl({name:m.name,locs:m.locs,numParams:m["num-params"],paramTypes:m["param-types"],isRest:m["rest?"],closureMap:m["closure-map"],
closureTypes:m["closure-types"],body:W(q,m.body)});case "let-one":return new control.LetOneControl(W(q,m.rhs),W(q,m.body));case "let-void":return new control.LetVoidControl({count:m.count,isBoxes:m["boxes?"],body:W(q,m.body)});case "beg0":return new control.Beg0Control(fa(q,m.seq));case "boxenv":return new control.BoxenvControl(m.pos,W(q,m.body));case "install-value":return new control.InstallValueControl({count:m.count,pos:m.pos,isBoxes:m["boxes?"],rhs:W(q,m.rhs),body:W(q,m.body)});case "with-cont-mark":return new control.WithContMarkControl(W(q,
m.key),W(q,m.val),W(q,m.body));case "assign":return new control.AssignControl({id:W(q,m.id),rhs:W(q,m.rhs),isUndefOk:m["undef-ok?"]});case "varref":return new control.VarrefControl(W(q,m.toplevel));case "closure":return new control.ClosureCommand(m["gen-id"]);case "case-lam":return new control.CaseLamControl(m.name,fa(q,m.clauses));case "let-rec":return new control.LetRecControl(fa(q,m.procs),W(q,m.body));default:throw types.internalError("I don't know how to handle "+sys.inspect(m),state.captureCurrentContinuationMarks(q));
}},fa=function(q,m){for(var C=[],da=0;da<m.length;da++)C.push(W(q,m[da]));return C},ja=function(q){return new control.Prefix({numLifts:q["num-lifts"],toplevels:q.toplevels})};loader.loadCode=W;loader.loadPrefix=ja})();var interpret={};
(function(){var W=function(C,da,na){function v(){for(var F=5E4;!C.isStuck()&&0<F;)m(C),F--;if(C.breakRequested)na(types.schemeError(types.exnBreak("user break",state.captureCurrentContinuationMarks(C),new types.ContinuationClosureValue(C.vstack,C.cstack))));else if(0>=F){var E=C.save();setTimeout(function(){C.restore(E);W(C,da,na)},0)}else da(C.v)}da||=function(F){};na||=function(F){throw F;};try{v()}catch(F){if(F instanceof control.PauseException){var u=q(C,da,na),G=ja(C);F.onPause(u,G)}else types.isSchemeError(F)&&
types.isIncompleteExn(F.val)&&(u=state.captureCurrentContinuationMarks(C),F=types.schemeError(F.val.constructor.apply(null,[F.val.msg,u].concat(F.val.otherArgs)))),na(F)}},fa=function(C,da,na,v,u){var G=C.save();C.clearForEval({preserveBreak:!0});C.pushControl(new control.ApplicationControl(new control.ConstantControl(da),helpers.map(function(F){return new control.ConstantControl(F)},na)));try{W(C,function(F){C.restore(G);v(F)},function(F){C.restore(G);u(F)})}catch(F){throw C.restore(G),F;}},ja=function(C){return function(da,
na,v,u){return fa(C,da,na,v,u)}},q=function(C,da,na){var v=C.save();C.clearForEval({preserveBreak:!0});return function(u){C.restore(v);if(types.isSchemeError(u)){if(types.isIncompleteExn(u.val)){var G=state.captureCurrentContinuationMarks(C);u=types.schemeError(u.val.constructor.apply(null,[u.val.msg,G].concat(u.val.otherArgs)))}na(u)}else types.isInternalError(u)?na(u):(C.v=u,W(C,da,na))}},m=function(C){var da=C.popControl();debugF(function(){return sys.inspect(da)});if(da.invoke)da.invoke(C);else throw types.internalError("I don't know how to handle "+
sys.inspect(da),state.captureCurrentContinuationMarks(C));};primitive.addPrimitive("call/cc",new primitive.Primitive("call/cc",1,!1,!0,function(C,da){var na=new types.ContinuationClosureValue(C.vstack,C.cstack);C.pushValue(na);C.v=da;C.pushControl(new control.CallControl(1))}));interpret.load=function(C,da){da||=new state.State;try{for(var na=da,v=C["compiled-indirects"],u=0;u<v.length;u++){for(var G=v[u],F=G.lam,E=F["num-params"],O=F["param-types"],P=F["rest?"],X,ia=na,Ba=F["closure-map"],ma=[],
wa=0;wa<Ba.length;wa++){var ka=ia.peekn(Ba[wa]);ma.push(ka)}X=ma;var oa=new control.ConstantControl(!1);na.heap[G.id]=new types.ClosureValue(G.id,E,O,P,X,oa)}for(u=0;u<v.length;u++)G=v[u],F=G.lam,na.heap[G.id].body=loader.loadCode(na,F.body);var ca=loader.loadPrefix(C.prefix);control.processPrefix(da,ca);da.pushControl(loader.loadCode(da,C.code))}catch(ua){throw types.isSchemeError(ua)&&types.isExn(ua.val)&&!types.isContinuationMarkSet(types.exnContMarks(ua.val))&&types.exnSetContMarks(ua.val,state.captureCurrentContinuationMarks(da)),
ua;}return da};interpret.step=m;interpret.run=W;interpret.call=fa})();
