var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(e){var u=0;return function(){return u<e.length?{done:!1,value:e[u++]}:{done:!0}}};$jscomp.arrayIterator=function(e){return{next:$jscomp.arrayIteratorImpl(e)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,u,y){e!=Array.prototype&&e!=Object.prototype&&(e[u]=y.value)};$jscomp.getGlobal=function(e){e=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,e];for(var u=0;u<e.length;++u){var y=e[u];if(y&&y.Math==Math)return y}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(e,u){this.$jscomp$symbol$id_=e;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:u})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function e(y){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(y||"")+"_"+u++,y)}var u=0;return e}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.iterator;e||(e=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[e]&&$jscomp.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.asyncIterator;e||(e=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(e){$jscomp.initSymbolIterator();e={next:e};e[$jscomp.global.Symbol.iterator]=function(){return this};return e};
$jscomp.iteratorFromArray=function(e,u){$jscomp.initSymbolIterator();e instanceof String&&(e+="");var y=0,b={next:function(){if(y<e.length){var c=y++;return{value:u(c,e[c]),done:!1}}b.next=function(){return{done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};
$jscomp.polyfill=function(e,u,y,b){if(u){y=$jscomp.global;e=e.split(".");for(b=0;b<e.length-1;b++){var c=e[b];c in y||(y[c]={});y=y[c]}e=e[e.length-1];b=y[e];u=u(b);u!=b&&null!=u&&$jscomp.defineProperty(y,e,{configurable:!0,writable:!0,value:u})}};$jscomp.polyfill("Array.prototype.values",function(e){return e?e:function(){return $jscomp.iteratorFromArray(this,function(e,y){return y})}},"es8","es3");
$jscomp.polyfill("Array.prototype.entries",function(e){return e?e:function(){return $jscomp.iteratorFromArray(this,function(e,y){return[e,y]})}},"es6","es3");$jscomp.polyfill("Array.prototype.keys",function(e){return e?e:function(){return $jscomp.iteratorFromArray(this,function(e){return e})}},"es6","es3");$jscomp.findInternal=function(e,u,y){e instanceof String&&(e=String(e));for(var b=e.length,c=0;c<b;c++){var v=e[c];if(u.call(y,v,c,e))return{i:c,v:v}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(e){return e?e:function(e,y){return $jscomp.findInternal(this,e,y).v}},"es6","es3");$jscomp.polyfill("Object.is",function(e){return e?e:function(e,y){return e===y?0!==e||1/e===1/y:e!==e&&y!==y}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(e){return e?e:function(e,y){var b=this;b instanceof String&&(b=String(b));var c=b.length;y=y||0;for(0>y&&(y=Math.max(y+c,0));y<c;y++){var v=b[y];if(v===e||Object.is(v,e))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(e,u,y){if(null==e)throw new TypeError("The 'this' value for String.prototype."+y+" must not be null or undefined");if(u instanceof RegExp)throw new TypeError("First argument to String.prototype."+y+" must not be a regular expression");return e+""};$jscomp.polyfill("String.prototype.includes",function(e){return e?e:function(e,y){return-1!==$jscomp.checkStringArgs(this,e,"includes").indexOf(e,y||0)}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(e){return e?e:function(e,y,b){var c=this.length||0;0>y&&(y=Math.max(0,c+y));if(null==b||b>c)b=c;b=Number(b);0>b&&(b=Math.max(0,c+b));for(y=Number(y||0);y<b;y++)this[y]=e;return this}},"es6","es3");
var sys={print:function(e){e=e.toString().replace(/\n/g,"<br />");document.write(e)},error:function(e){"undefined"!==typeof console&&console.log?e.stack?console.log(e.stack):console.log("Error: "+str):(e=e.toString().replace(/\n/g,"<br />"),document.write("<br />Error: "+e+"<br />"))},inspect:function(e){return e+""}},DEBUG_ON=!1,setDebug=function(e){DEBUG_ON=e},debug=function(e){DEBUG_ON&&sys.print(e)},debugF=function(e){DEBUG_ON&&sys.print(e())},hasOwnProperty={}.hasOwnProperty,deepEqual=function(e,
u){if(e===u)return!0;var y;if(e instanceof Array){if(u instanceof Array){for(y=0;y<e.length;y++)if(!deepEqual(e[y],u[y]))return!1;return!0}return!1}if("string"===typeof e||"number"===typeof e)return e===u;for(y in e)if(hasOwnProperty.call(e,y)&&"_eqHashCode"!==y&&"_isList"!==y&&(!hasOwnProperty.call(u,y)||!deepEqual(e[y],u[y])))return!1;for(y in u)if(hasOwnProperty.call(u,y)&&"_eqHashCode"!==y&&"_isList"!==y&&(!hasOwnProperty.call(e,y)||!deepEqual(e[y],u[y])))return!1;return!0},assert={equal:function(e,
u){if(e!==u)throw Error("AssertError: "+e+" equal "+u);},deepEqual:function(e,u){if(!deepEqual(e,u))throw Error("AssertError: "+e+" deepEqual "+u);},ok:function(e){if(!e)throw Error("AssertError: not ok: "+e);},throwsExn:function(e){try{e.apply(null,[])}catch(u){return}throw Error("AssertError: Throw expected, none received.");}};this.JSON||(this.JSON={});
(function(){function e(c){return 10>c?"0"+c:c}function u(b){c.lastIndex=0;return c.test(b)?'"'+b.replace(c,function(c){var b=m[c];return"string"===typeof b?b:"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function y(c,b){var C=v,B=b[c];B&&"object"===typeof B&&"function"===typeof B.toJSON&&(B=B.toJSON(c));"function"===typeof q&&(B=q.call(b,c,B));switch(typeof B){case "string":return u(B);case "number":return isFinite(B)?String(B):"null";case "boolean":case "null":return String(B);
case "object":if(!B)return"null";v+=Q;var e=[];if("[object Array]"===Object.prototype.toString.apply(B)){var m=B.length;for(c=0;c<m;c+=1)e[c]=y(c,B)||"null";b=0===e.length?"[]":v?"[\n"+v+e.join(",\n"+v)+"\n"+C+"]":"["+e.join(",")+"]";v=C;return b}if(q&&"object"===typeof q)for(m=q.length,c=0;c<m;c+=1){var V=q[c];"string"===typeof V&&(b=y(V,B))&&e.push(u(V)+(v?": ":":")+b)}else for(V in B)Object.hasOwnProperty.call(B,V)&&(b=y(V,B))&&e.push(u(V)+(v?": ":":")+b);b=0===e.length?"{}":v?"{\n"+v+e.join(",\n"+
v)+"\n"+C+"}":"{"+e.join(",")+"}";v=C;return b}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(c){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(c){return this.valueOf()});var b=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
c=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,v,Q,m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},q;"function"!==typeof JSON.stringify&&(JSON.stringify=function(c,b,e){var C;Q=v="";if("number"===typeof e)for(C=0;C<e;C+=1)Q+=" ";else"string"===typeof e&&(Q=e);if((q=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return y("",{"":c})});
"function"!==typeof JSON.parse&&(JSON.parse=function(c,q){function C(c,b){var e,B=c[b];if(B&&"object"===typeof B)for(e in B)if(Object.hasOwnProperty.call(B,e)){var m=C(B,e);void 0!==m?B[e]=m:delete B[e]}return q.call(c,b,B)}c=String(c);b.lastIndex=0;b.test(c)&&(c=c.replace(b,function(c){return"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(c.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return c=eval("("+c+")"),"function"===typeof q?C({"":c},""):c;throw new SyntaxError("JSON.parse");})})();var helpers={};
(function(){var e=function(c){throw types.schemeError(c);},u=function(c,b,m,G){c=state.captureCurrentContinuationMarks(c).ref("moby-application-position-key");var q=c[c.length-1],C=function(c){var b=[],q,C=[];for(q=0;q<G.length;q++)state.isState(G[q])||void 0!==G[q].name&&""===G[q].name||C.push(G[q]);window.wtf=G[2];for(q=0;q<C.length;q++)c.isEmpty()||(q!=m-1&&b.push(new types.ColoredPart(types.toWrittenString(C[q])+" ",c.first())),c=c.rest());0<b.length&&(c=b[b.length-1].text,c=c.substring(0,c.length-
1),b[b.length-1]=new types.ColoredPart(c,b[b.length-1].location));return b};c=function(c){var b=q,C;for(C=0;C<c;C++)b=b.rest();return b.first()};var V=b.typeName+"",v=V.substring(0,1);G&&(C=C(q.rest()),0<C.length&&e(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart(b.functionName,q.first()),": expects ","a"===v||"e"===v||"i"===v||"o"===v||"u"===v?"an ":"a ",V," as ",b.ordinalPosition," argument, but given: ",new types.ColoredPart(types.toWrittenString(b.actualValue),
c(m)),"; other arguments were: ",new types.GradientPart(C)]),[])));e(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart(b.functionName,q.first()),": expects ","a"===v||"e"===v||"i"===v||"o"===v||"u"===v?"an ":"a ",V," as ",b.ordinalPosition," argument, but given: ",new types.ColoredPart(types.toWrittenString(b.actualValue),c(m))]),[]))},y=function(c,b,m,G){if(c instanceof state.State){var q=state.captureCurrentContinuationMarks(c).ref("moby-application-position-key");
void 0!==q[q.length-1]&&u(c,b,m,G)}if(G&&1<G.length){c=["~a: expects type ~a as ~a arguments, but given: ~s; other arguments were:"];for(q=0;q<G.length;q++)q!=m-1&&c.push(types.toWrittenString(G[q]));m=c.join(" ");e(types.incompleteExn(types.exnFailContract,helpers.format(m,[b.functionName,b.typeName,b.ordinalPosition,b.actualValue]),[]))}else e(types.incompleteExn(types.exnFailContract,helpers.format("~a: expects argument of type ~a, but given: ~s",[b.functionName,b.typeName,b.actualValue]),[]))},
b=function(c,b,e,m,B,v,T){e(b)||y(c,{functionName:m,typeName:B,ordinalPosition:helpers.ordinalize(v),actualValue:b},v,T)},c=function(c){var b;c=b=c;if(b===types.EMPTY)return!0;for(;;){if(!types.isPair(b))return!1;if(types.isPair(c)){if(!0===c._isList)return!0;c=c.rest()}b=b.rest();if(types.isPair(b)){if(b._isList)return c._isList=!0;b=b.rest();if(types.isPair(b)&&b._isList)return c._isList=!0}if(b===types.EMPTY)return c._isList=!0;if(c===b)return!1}},v=function(b,C){if(!c(b))return!1;for(;types.isPair(b);){if(!C(b.first()))return!1;
b=b.rest()}return b===types.EMPTY},Q=function(c){var b=c;if(b===types.EMPTY)return[];if(types.isPair(b))for(c=[];!b.isEmpty();)c.push(Q(b.first())),b=b.rest();return c},m=function(b){if(!c(b))return[b];for(var q=[];!b.isEmpty();)q=q.concat(m(b.first())),b=b.rest();return q};helpers.format=function(b,c,m){var q=function(){m=m||"#<function>";var q=b.match(/~[sSaA]/g);q=[m+": format string requires "+(null==q?0:q.length)+" arguments, but given "+c.length+"; arguments were:",types.toWrittenString(b)];
for(var C=0;C<c.length;C++)q.push(types.toWrittenString(c[C]));e(types.incompleteExn(types.exnFailContract,q.join(" "),[]))},C=c.slice(0),v=b.replace(/~[sSaAn%~]/g,function(b){if("~~"==b)return"~";if("~n"==b||"~%"==b)return"\n";if("~s"==b||"~S"==b)return 0==C.length&&q(),types.toWrittenString(C.shift());if("~a"==b||"~A"==b)return 0==C.length&&q(),types.toDisplayedString(C.shift());throw types.internalError("format: string.replace matched invalid regexp",!1);});0<C.length&&q();return v};helpers.forEachK=
function(b,c,e,m){var q=function(C){if(C>=b.length)m&&m();else try{c(b[C],function(){q(C+1)})}catch(T){e(T)}};q(0)};helpers.reportError=function(b){var c="undefined"!=typeof console&&"undefined"!=typeof console.log?function(b){console.log(b)}:function(b){alert(b)};"string"==typeof b?c(b):types.isSchemeError(b)?types.isExn(b.val)?c(""+types.exnMessage(b.val)):c(b.val):b.message?c(b.message):c(b.toString())};helpers.raise=e;helpers.procArityContains=function(b){return function(c){var q=function(c){return c instanceof
types.ContinuationClosureValue?!0:c.numParams==b||c.isRest&&c.numParams<=b},e=[];if(c instanceof types.ContinuationClosureValue||c instanceof types.ClosureValue||c instanceof types.PrimProc)return q(c);c instanceof types.CasePrimitive?e=c.cases:c instanceof types.CaseLambdaValue&&(e=c.closures);for(c=0;c<e.length;c++)if(q(e[c]))return!0;return!1}};helpers.throwCheckError=y;helpers.isList=c;helpers.isListOf=v;helpers.check=b;helpers.checkVarArity=function(c,e,m,v,B,y,T){if(0<T.length&&T[T.length-1]instanceof
Array){var q=[],C;for(C=0;C<T.length-1;C++)q.push(T[C]);T=q.concat(T[T.length-1]);b(c,e,m,v,B,y,T)}else b(c,e,m,v,B,y,T)};helpers.checkListOf=function(b,c,e,m,B,y,T){v(c,e)||helpers.throwCheckError(b,{functionName:m,typeName:"list of "+B,ordinalPosition:helpers.ordinalize(y),actualValue:c},y,T)};helpers.map=function(b,c){for(var q=Array(c.length),e=0;e<c.length;e++)q[e]=b(c[e]);return q};helpers.schemeListToArray=function(b){for(var c=[];!b.isEmpty();)c.push(b.first()),b=b.rest();return c};helpers.deepListToArray=
Q;helpers.flattenSchemeListToArray=m;helpers.assocListToHash=function(b){for(var c={};!b.isEmpty();){var q=b.first().first(),e=b.first().rest().first();c[q]=e;b=b.rest()}return c};helpers.ordinalize=function(b){if(11==b%100)return b+"th";var c=b;switch(b%10){case 1:c+="st";break;case 2:c+="nd";break;case 3:c+="rd";break;default:c+="th"}return c};helpers.wrapJsObject=function(b){return void 0===b?types.jsObject("undefined",b):null===b?types.jsObject("null",b):"function"==typeof b?types.jsObject("function",
b):b instanceof Array?types.jsObject("array",b):"string"==typeof b?types.jsObject("'"+b.toString()+"'",b):types.jsObject(b.toString(),b)};helpers.getKeyCodeName=function(b){b=b.charCode||b.keyCode;switch(b){case 8:b="\b";break;case 16:b="shift";break;case 17:b="control";break;case 19:b="pause";break;case 27:b="escape";break;case 33:b="prior";break;case 34:b="next";break;case 35:b="end";break;case 36:b="home";break;case 37:b="left";break;case 38:b="up";break;case 39:b="right";break;case 40:b="down";
break;case 42:b="print";break;case 45:b="insert";break;case 46:b=String.fromCharCode(127);break;case 144:b="numlock";break;case 145:b="scroll";break;default:b=112<=b&&123>=b?"f"+(b-111):""}return b};helpers.maybeCallAfterAttach=function(b){for(b=[b];0!==b.length;){var c=b.pop();c.afterAttach&&c.afterAttach(c);if(c.hasChildNodes&&c.hasChildNodes()){c=c.childNodes;for(var e=0;e<c.length;e++)b.push(c[e])}}};helpers.makeLocationDom=function(b){var c=document.createElement("span"),e=document.createElement("span"),
q=document.createElement("span"),m=document.createElement("span"),v=document.createElement("span"),y=document.createElement("span");c.className="location-reference";e.className="location-id";q.className="location-offset";m.className="location-line";v.className="location-column";y.className="location-span";e.appendChild(document.createTextNode(b.id+""));q.appendChild(document.createTextNode(b.offset+""));m.appendChild(document.createTextNode(b.line+""));v.appendChild(document.createTextNode(b.column+
""));y.appendChild(document.createTextNode(b.span+""));c.appendChild(e);c.appendChild(q);c.appendChild(m);c.appendChild(v);c.appendChild(y);return c};helpers.isLocationDom=function(b){return b&&(b.nodeType===Node.TEXT_NODE||b.nodeType===Node.ELEMENT_NODE)&&"location-reference"===b.className}})();var jsworld={};
(function(){function e(){}function u(b){b=da.indexOf(b);-1!=b&&da.splice(b,1)}function y(){A=new e;da=[];for(var b=0;b<h.length;b++)h[b]();h=[];Fa=!1}function b(c,h){if(Fa)setTimeout(function(){b(c,h)},100);else{var J=A;Fa=!0;var k=function(c){A=c;A instanceof ma?(c=A.getEffects(),helpers.forEachK(c,function(c,z){c.invokeEffect(b,z)},function(b){throw b;},function(){A=A.getWorld();w()})):w()},z=function(b,c){b(A,J,c)},F=function(b){A=J;throw b;},w=function(){helpers.forEachK(da,z,F,function(){Fa=
!1;h()})};try{c(A,k)}catch(Ua){throw A=J,"undefined"!==typeof console&&console.log&&Ua.stack&&console.log(Ua.stack),Ua;}}}function c(b,c){for(var h=Array(b.length),k=0;k<b.length;k++)h[k]=c(b[k]);return h}function v(b,c){for(var h=[],k=0;k<b.length;k++)h=h.concat(c(b[k]));return h}function Q(b,c){for(var h=0;h<b.length;h++)if(b[h]==c)return!0;return!1}function m(b){var c=[b];for(b=b.firstChild;null!=b;b=b.nextSibling)c.push(m(b));return c}function q(b){var c=[b.node];if(1==b.node.jsworldOpaque)return c;
for(var h=0;h<b.children.length;h++)c=c.concat(q(b.children[h]));return c}function C(b,c){return b&&c&&b===c}function V(b){var c=[];if(1==b.node.jsworldOpaque)return[];for(var h=0;h<b.children.length;h++)c.push({relation:"parent",parent:b.node,child:b.children[h].node});for(h=0;h<b.children.length-1;h++)c.push({relation:"neighbor",left:b.children[h].node,right:b.children[h+1].node});for(h=0;h<b.children.length;h++)c=c.concat(V(b.children[h]));return c}function G(b,c,h){function k(b,c){c=b.compareDocumentPosition(c);
return c&b.DOCUMENT_POSITION_CONTAINED_BY?1:c&b.DOCUMENT_POSITION_CONTAINS||c&b.DOCUMENT_POSITION_FOLLOWING?-1:c&b.DOCUMENT_POSITION_PRECEDING?1:0}for(var z=0;z<h.length;z++)if("parent"==h[z].relation){var F=h[z].parent,J=h[z].child;C(J.parentNode,F)||F.appendChild(J)}for(F=!0;F;)for(F=!1,z=0;z<h.length;z++)if("neighbor"==h[z].relation){J=h[z].left;var w=h[z].right;C(J.nextSibling,w)||(J.parentNode.insertBefore(J,w),F=!0)}try{var e=c.concat(b).sort(k)}catch(Za){e=null}h=b;for(b=b.parentNode;h!=b;){for(;null!=
h.firstChild&&!h.jsworldOpaque;)h=h.firstChild;for(;h!=b;){J=h.nextSibling;F=h.parentNode;w=!1;if(null!=e)for(;0<e.length&&0<=k(h,e[0]);){if(z=e.shift(),C(z,h)){w=!0;break}}else for(z=0;z<c.length;z++)if(C(c[z],h)){w=!0;break}if(!w){if(!h.isJsworldOpaque)for(;null!=h.firstChild;)h.parentNode.appendChild(h.firstChild);J=h.nextSibling;h.parentNode.removeChild(h)}if(null==J)h=F;else{h=J;break}}}U(c)}function B(b){return b.replace(/\-(.)/g,function(b,c){return c.toUpperCase()})}function aa(b,c){for(var h=
0;h<c.length;h++)b.style[B(c[h].attrib)]=c[h].values.join(" ")}function T(b,c){for(var h=0;h<b.length;h++);for(h=0;h<c.length;h++)if("id"in c[h])for(var k=0;k<b.length;k++){var z=b[k];var F=c[h];z=F.id.match(/^\./)?"class"in z&&Q(z["class"].split(/\s+/),F.id.substring(1)):"id"in z&&z.id==F.id;z&&aa(b[k],c[h].attribs)}else aa(c[h].node,c[h].attribs)}function U(b){for(var c=0;c<b.length;c++)if(b[c].onWorldChange)b[c].onWorldChange(A)}function X(b,c,h,k,z,F){c instanceof e?k(b,function(c){var k=qa(c),
J=q(k);z(b,function(b){T(J,v(b,ba));G(h,J,V(k));F()})}):na(function(F){function J(b,c){return Ga?c(Ga):z(b,c)}(function(b,c){return ka?c(ka):k(b,c)})(c,function(w){k(b,function(k){J(c,function(c){z(b,function(b){var z=qa(k),J=q(z);w!==k?(ka=k,T(J,v(b,ba)),G(h,J,V(z))):c!==b&&(Ga=b,T(J,v(b,ba)));F()})})})})},F)}function na(b,c){if(void 0!=D){var h=new ha;b(function(){h.restore();c()})}else b(c)}function ha(){this.focused=D;this.selectionStart=D.selectionStart;this.selectionEnd=D.selectionEnd}function ea(b,
c,h,k,z){this.top=b;this.world=c;this.handlers=k;this.handlerCreators=h;this.attribs=z}function Ba(h,k,e,q,z){y();var F=c(e,function(b){return b()});0<w.length&&w[w.length-1].pause();var J=new ea(h,k,e,F,q);w.push(J);da.push(function(b,c,h){J.world=b;h()});var m=new ca(function(b,c){c(!1)},function(b,c){c(b)});for(e=0;e<F.length;e++)if(F[e]instanceof ca)m=F[e];else F[e].onRegister(h);da.push(function(b,c,F){m.test(b,function(k){k?(k=m.last_picture_handler(),k.onRegister(h),k._listener(b,c,function(b){F()}),
H.shutdown(),z(b)):F()})});M(h,q);b(function(b,c){c(k)},fa)}function ca(b,c,h){this.test=b;this.receiver=c;this.last_picture_handler=h}function K(b,c,h){b.addEventListener?b.addEventListener(c,h,!1):b.attachEvent("on"+c,h,!1)}function W(c,k,w){var J=function(c){b(function(b,h){w(b,c,h)},fa)};K(c,k,J);h.push(function(){ta(c,k,J)})}function pa(c,k,w){var J=function(c){setTimeout(function(){b(function(b,h){w(b,c,h)},fa)},0)};K(c,k,J);h.push(function(){ta(c,k,J)})}function la(b){K(b,"focus",function(c){D=
b});K(b,"blur",function(b){D=void 0});return b}function qa(b){return isPage(b)?qa(m(b.toDomNode())):void 0==b.length?{node:b,children:[]}:{node:b[0],children:c(b.slice(1),qa)}}function Z(b){return{attrib:b[0],values:b.slice(1)}}function ba(b){var h=c(b.slice(1),Z);return"string"==typeof b[0]?[{id:b[0],attribs:h}]:"length"in b[0]?c(b[0],function(b){return{id:b,attribs:h}}):[{node:b[0],attribs:h}]}function ra(b,c){if(!isPage(b))if(!b instanceof Array&&sa(b,c),0==b.length&&sa(b,c),b[0].nodeType==Node.TEXT_NODE){if(1<
b.length)throw new Y(helpers.format("Text node ~s can not have children",[b]),b);}else if(b[0].nodeType==Node.ELEMENT_NODE)for(c=1;c<b.length;c++)ra(b[c],b);else throw new Y(helpers.format("expected a Text or an Element, received ~s within ~s",[b,c]),b[0]);}function Y(b,c){this.msg=b;this.elt=c}function M(b,c){if(c)for(a in c)Object.hasOwnProperty.call(c,a)&&("function"==typeof c[a]?W(b,a,c[a]):b[a]=c[a]);return b}function N(b){return la(M(document.createElement("div"),b))}function ua(b,c){c=document.createElement("div");
c.appendChild(document.createTextNode(b));c.style["white-space"]="pre";c.jsworldOpaque=!0;return c}function ia(b){var c=document.createElement("option");c.text=b.value;c.value=b.value;return c}jsworld.Jsworld={};var H=jsworld.Jsworld,D=!1,fa=function(){},A=new e,Fa=!1,da=[],h=[],w=[];H.shutdown=function(){for(;0<w.length;){var b=w.pop();b&&b.pause()}y()};H.change_world=b;Number.prototype.NaN0=function(){return isNaN(this)?0:this};H.getPosition=function(b){for(var c=0,h=0;b.offsetParent;)c+=b.offsetLeft+
(b.currentStyle?parseInt(b.currentStyle.borderLeftWidth).NaN0():0),h+=b.offsetTop+(b.currentStyle?parseInt(b.currentStyle.borderTopWidth).NaN0():0),b=b.offsetParent;c+=b.offsetLeft+(b.currentStyle?parseInt(b.currentStyle.borderLeftWidth).NaN0():0);h+=b.offsetTop+(b.currentStyle?parseInt(b.currentStyle.borderTopWidth).NaN0():0);return{x:c,y:h}};var O=0;H.gensym=function(){return O++};H.map=c;H.mapi=function(b,c){for(var h=Array(b.length),k=0;k<b.length;k++)h[k]=c(b[k],k);return h};H.fold=function(b,
c,h){for(var k=0;k<b.length;k++)c=h(b[k],c);return c};H.augment=function(b,c){var h={},k;for(k in b)h[k]=b[k];for(k in c)h[k]=c[k];return h};H.assoc_cons=function(b,c,h){var k={},z;for(z in b)k[z]=b[z];k[c]=h;return k};H.cons=function(b,c){return[b].concat(c)};H.append=function(b,c){return b.concat(c)};H.array_join=function(b,c){for(var h=[],k=0;k<b.length;k++)h.push([b[k],c[k]]);return h};H.removeq=function(b,c){for(var h=0;h<b.length;h++)if(b[h]===c)return b.slice(0,h).concat(b.slice(h+1));return b};
H.removef=function(b,c){for(c=0;c<b.length;c++)if(f(b[c]))return b.slice(0,c).concat(b.slice(c+1));return b};H.filter=function(b,c){for(var h=[],k=0;k<b.length;k++)c(b[k])&&h.push(b[k]);return h};H.without=function(b,c){var h={},k;for(k in b)k!=c&&(h[k]=b[k]);return h};H.memberq=function(b,c){for(var h=0;h<b.length;h++)if(b[h]===c)return!0;return!1};H.member=Q;H.head=function(b){return b[0]};H.tail=function(b){return b.slice(1,b.length)};H.node_to_tree=m;var ka,Ga;ha.prototype.restore=function(){if(this.focused.parentNode)this.focused.selectionStart=
this.selectionStart,this.focused.selectionEnd=this.selectionEnd,this.focused.focus();else if(this.focused.id){var b=document.getElementById(this.focused.id);b&&(b.selectionStart=this.selectionStart,b.selectionEnd=this.selectionEnd,b.focus())}};ea.prototype.restart=function(){Ba(this.top,this.world,this.handlerCreators,this.attribs)};ea.prototype.pause=function(){for(var b=0;b<this.handlers.length;b++)if(!(this.handlers[b]instanceof ca))this.handlers[b].onUnregister(top)};H.big_bang=Ba;H.on_tick=function(c,
h){return function(){var k,w=function(){k=setTimeout(z,c)},z=function(){b(h,w)};return{onRegister:function(b){w()},onUnregister:function(b){k&&clearTimeout(k)}}}};H.on_key=function(c){return function(){var h=!1,k=function(){h=!1},w,z=function(b,h){c(b,w,h)},F=function(c){if(27!=c.keyCode){w=c;if("keydown"!==w.type||""!==helpers.getKeyCodeName(w)||w.altKey)"keydown"===w.type&&""!==helpers.getKeyCodeName(w)&&xa(w);else return!1;Ea(w);h!==w.type&&(h=w.type,b(z,k))}};return{onRegister:function(b){K(b,
"keypress",F);K(b,"keydown",F)},onUnregister:function(b){ta(b,"keypress",F);ta(b,"keydown",F)}}}};H.on_mouse=function(c){return function(){var h,k,w=!1,z=function(){w=!1},F=function(b,z){c(b,h,z)},e=function(c){h=c;k&&k.focus();xa(h);Ea(h);w||(w=!0,b(F,z))};return{onRegister:function(b){k=b;K(k,"mousedown",e);K(k,"mouseup",e);K(k,"mousemove",e)},onUnregister:function(b){ta(b,"mousedown",e);ta(b,"mouseup",e);ta(b,"mousemove",e)}}}};H.on_tap=function(c){return function(){var h,k,w=!1,z=function(){w=
!1},F=function(b,z){c(b,h,z)},e=function(c){h=c;k&&k.focus();xa(h);Ea(h);w||(w=!0,b(F,z))};return{onRegister:function(b){k=b;K(k,"touchstart",e)},onUnregister:function(b){ta(b,"touchstart",e)}}}};H.on_tilt=function(c){return function(){var h=0,k=0,w,z=function(b,z){c(b,h,k,z)},F=function(){b(z,e)},e=function(){w=setTimeout(F,250)};if(window.DeviceOrientationEvent){var q=function(b){xa(b);Ea(b);null===b.gamma||null===b.beta?w&&(clearTimeout(w),w=void 0):0===window.orientation?(h=b.gamma,k=b.beta):
90===window.orientation?(h=b.beta,k=-b.gamma):-90===window.orientation?(h=-b.beta,k=b.gamma):180===window.orientation?(h=-b.gamma,k=-b.beta):(h=b.gamma,k=b.beta)};return{onRegister:function(b){K(window,"deviceorientation",q);e()},onUnregister:function(b){w&&clearTimeout(w);ta(window,"deviceorientation",q)}}}return{onRegister:function(b){},onUnregister:function(b){}}}};H.on_draw=function(b,c){var h,k=function(b){ra(b,b);h(b)},z=function(c,z){h=z;b(c,k)};return function(){var b={_top:null,_listener:function(h,
k,F){X(h,k,b._top,z,c,F)},onRegister:function(c){b._top=c;da.push(b._listener)},onUnregister:function(c){u(b._listener)}};return b}};H.stop_when=function(b,c,h){return function(){void 0==c&&(c=function(b,c){c(b)});return new ca(b,c,h)}};H.on_world_change=function(b){var c=function(c,h,z){b(c,z)};return function(){return{onRegister:function(b){da.push(c)},onUnregister:function(b){u(c)}}}};var ta=function(b,c,h){b.addEventListener?b.removeEventListener(c,h,!1):b.detachEvent("on"+c,h,!1)},sa=function(b,
c){throw new Y(helpers.format("Expected a non-empty array, received ~s within ~s",[b,c]),b);};Y.prototype.toString=function(){return"on-draw: "+this.msg};H.p=function(b){return la(M(document.createElement("p"),b))};H.div=N;H.button=function(b,c){var h=document.createElement("button");h.onclick=function(b){return!1};W(h,"click",b);return la(M(h,c))};var xa=function(b){b.preventDefault?b.preventDefault():b.returnValue=!1},Ea=function(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0},za=function(b){K(b,
"click",function(b){Ea(b)});return b};H.input=function(b,c,h){b=b.toLowerCase();var w={text:Aa,password:Aa,checkbox:k};if(w[b])return w[b](b,c,h);throw Error("js-input: does not currently support type "+b);};var Aa=function(c,h,k){var w=document.createElement("input");w.type=c;pa(w,"keypress",function(b,c,z){h(b,w.value,z)});var z=w.value,F=setInterval(function(){w.parentNode?z!=w.value&&(z=w.value,b(function(b,c){h(b,w.value,c)},fa)):clearInterval(F)},1E3);return za(la(M(w,k)))},k=function(b,c,h){var k=
document.createElement("input");k.type=b;pa(k,"change",function(b,h,w){c(b,k.checked,w)});K(k,"click",function(b){Ea(b)});return M(k,h)};H.text=ua;H.select=function(b,c,h){for(var k=document.createElement("select"),z=0;z<c.length;z++)k.add(ia({value:c[z]}),null);k.jsworldOpaque=!0;W(k,"change",h);return la(M(k,b))};H.textarea=function(b){return la(M(document.createElement("textarea"),b))};H.h1=function(b){return la(M(document.createElement("h1"),b))};H.canvas=function(b){return la(M(document.createElement("canvas"),
b))};H.img=function(b,c){var h=document.createElement("img");h.src=b;return la(M(h,c))};H.raw_node=function(b,c){return la(M(b,c))};var ma=function(b,c){b instanceof ma?(this.w=b.w,this.e=b.e.concat(c)):(this.w=b,this.e=c)};ma.prototype.getWorld=function(){return this.w};ma.prototype.getEffects=function(){return this.e};H.with_effect=function(b,c){return new ma(b,[c])};H.with_multiple_effects=function(b,c){return new ma(b,c)};H.has_effects=function(b){return b instanceof ma};H.alert_effect=function(b){return new va(b)};
var va=function(b){this.msg=b};va.prototype.invokeEffect=function(b){alert(this.msg);b()};H.music_effect=function(b){return new I(b)};var I=function(b){this.musicUrl=b};I.prototype.invokeEffect=function(b){(new Audio(url)).play();b()};var Pa=function(b,c){"undefined"===typeof b&&(b=[]);this.elts=b;this.attribs=c};Pa.prototype.add=function(b,c,h){return new Pa(this.elts.concat([{elt:b,positionTop:h,positionLeft:c}]),this.attribs)};Pa.prototype.toDomNode=function(){for(var b=N(),c=0;c<this.elts.length;c++){var h=
this.elts[c].elt;h.style||(h.style="");h.style.position="absolute";h.style.left=this.elts[c].positionLeft+"px";h.style.top=this.elts[c].positionTop+"px";b.appendChild(h)}M(b,this.attribs);return b};isPage=function(b){return b instanceof Pa};H.isPage=isPage;H.emptyPage=function(b){return new Pa([],b)};H.placeOnPage=function(b,c,h,k){"string"===typeof b&&(b=ua(b));return k.add(b,c,h)};H.getCurrentWorld=function(){return A}})();var __PLTNUMBERS_TOP__;
"undefined"!==typeof exports?__PLTNUMBERS_TOP__=exports:(this.jsnums||(this.jsnums={}),__PLTNUMBERS_TOP__=this.jsnums);
(function(){function e(d){return new RegExp("^([+-]?["+d+"]+)/(["+d+"]+)$")}function u(d){return new RegExp("^(?:([+-]?)((["+(d+"]*)\\.(["+d+"]+)|([")+(d+"]+)\\.(["+d+"]*)))$"))}function y(d,g){return new RegExp("^(?:([+-]?(?:["+(d+"]+|[")+(d+"]*\\.["+d+"]+|[")+(d+"]+\\.["+d+"]*))[")+g+"]([+-]?["+d+"]+))$")}function b(d){return 2===d?"01":8===d?"0-7":10===d?"0-9":16===d?"0-9a-fA-F":h("digitsForRadix: invalid radix",this,d)}function c(d){return 2===d||8===d||10===d?"defsl":16===d?"sl":h("expMarkForRadix: invalid radix",
this,d)}function v(d){this.defaultp=function(){return 0==d};this.exactp=function(){return 1==d};this.inexactp=function(){return 2==d}}function Q(d,g,p,t){var P=d.match(e(b(g)));if(P)return R.makeInstance(Q(P[1],g,p),Q(P[2],g,p));if("+nan.0"===d||"-nan.0"===d)return E.nan;if("+inf.0"===d)return E.inf;if("-inf.0"===d)return E.neginf;if("-0.0"===d)return eb;if(P=d.match(u(b(g)))){d=P[1];var Wa=void 0!==P[3]?P[3]:P[5];t=void 0!==P[4]?P[4]:P[6];d="-"==d?-1:1;P=""===Wa?0:p.intAsExactp()?Q(Wa,g,v.on,!0):
parseInt(Wa,g);Wa=""===t?0:p.intAsExactp()?Q(t,g,v.on,!0):parseInt(t,g);g=p.intAsExactp()?Ua(g,t.length):Math.pow(g,t.length);g=""===t?0:p.intAsExactp()?J(Wa,g):Wa/g;p.floatAsInexactp()?(p=I(d,k(P,g)),p="number"===typeof p?E.makeInstance(p):p.toInexact()):p=I(d,k(P,g));return p}if(P=d.match(y(b(g),c(g))))return d=Q(P[1],g,p),p=Q(P[2],g,p),I(d,Ua(g,p));if(d.match(new RegExp("^[+-]?["+b(g)+"]+$")))return g=parseInt(d,g),Sa(g)?Ia(d):p.intAsExactp()?g:E.makeInstance(g);if(t)0===d.length&&h("no digits"),
h("bad number: "+d,this);else return!1}function m(d,g,b){null!=d&&("number"==typeof d?this.fromNumber(d,g,b):null==g&&"string"!=typeof d?this.fromString(d,256):this.fromString(d,g))}function q(){return new m(null)}function C(d,g,b,p,c,t){for(;0<=--t;){var P=g*this[d++]+b[p]+c;c=Math.floor(P/67108864);b[p++]=P&67108863}return c}function V(d,g,b,p,c,t){var P=g&32767;for(g>>=15;0<=--t;){var h=this[d]&32767,Wa=this[d++]>>15,z=g*h+Wa*P;h=P*h+((z&32767)<<15)+b[p]+(c&1073741823);c=(h>>>30)+(z>>>15)+g*Wa+
(c>>>30);b[p++]=h&1073741823}return c}function G(d,g,b,p,c,t){var P=g&16383;for(g>>=14;0<=--t;){var h=this[d]&16383,Wa=this[d++]>>14,z=g*h+Wa*P;h=P*h+((z&16383)<<14)+b[p]+c;c=(h>>28)+(z>>14)+g*Wa;b[p++]=h&268435455}return c}function B(d,g){d=yb[d.charCodeAt(g)];return null==d?-1:d}function aa(d){var g=q();g.fromInt(d);return g}function T(d){var g=this.s-d.s;if(0!=g)return g;var P=this.t;g=0>this.s?d.t-P:P-d.t;if(0!=g)return g;for(;0<=--P;)if(0!=(g=this[P]-d[P]))return g;return 0}function U(d){var g=
1,P;0!=(P=d>>>16)&&(d=P,g+=16);0!=(P=d>>8)&&(d=P,g+=8);0!=(P=d>>4)&&(d=P,g+=4);0!=(P=d>>2)&&(d=P,g+=2);0!=d>>1&&(g+=1);return g}function X(d){var g=q();this.abs().divRemTo(d,null,g);0>this.s&&0<g.compareTo(m.ZERO)&&d.subTo(g,g);return g}function na(d){this.m=d}function ha(d){this.m=d;this.mp=d.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<d.DB-15)-1;this.mt2=2*d.t}function ea(d){return 0==this.compareTo(d)}function Ba(d,g){return d&g}function ca(d,g){return d|g}function K(d,g){return d^
g}function W(d,g){return d&~g}function pa(d){var g=q();this.addTo(d,g);return g}function la(d){var g=q();this.subTo(d,g);return g}function qa(d){var g=q();this.multiplyTo(d,g);return g}function Z(d){var g=q();this.divRemTo(d,g,null);return g}function ba(d){var g=q();this.divRemTo(d,null,g);return g}function ra(d){var g=q(),b=q();this.divRemTo(d,g,b);return[g,b]}function Y(){}function M(d){return d}function N(d){return this.bnpExp(d,new Y)}function ua(d){this.r2=q();this.q3=q();m.ONE.dlShiftTo(2*d.t,
this.r2);this.mu=this.r2.divide(d);this.m=d}function ia(d){var g=0>this.s?this.negate():this.clone();d=0>d.s?d.negate():d.clone();if(0>g.compareTo(d)){var b=g;g=d;d=b}b=g.getLowestSetBit();var P=d.getLowestSetBit();if(0>P)return g;b<P&&(P=b);0<P&&(g.rShiftTo(P,g),d.rShiftTo(P,d));for(;0<g.signum();)0<(b=g.getLowestSetBit())&&g.rShiftTo(b,g),0<(b=d.getLowestSetBit())&&d.rShiftTo(b,d),0<=g.compareTo(d)?(g.subTo(d,g),g.rShiftTo(1,g)):(d.subTo(g,d),d.rShiftTo(1,d));0<P&&d.lShiftTo(P,d);return d}function H(d){return function(){var g=
this.toInexact();return g[d].apply(g,arguments)}}var D=__PLTNUMBERS_TOP__,fa=function(d,g,b){b=b||{};return function(P,p){if(b.isXSpecialCase&&b.isXSpecialCase(P))return b.onXSpecialCase(P,p);if(b.isYSpecialCase&&b.isYSpecialCase(p))return b.onYSpecialCase(P,p);if("number"===typeof P&&"number"===typeof p)return d(P,p);"number"===typeof P&&(P=da(P,p));"number"===typeof p&&(p=da(p,P));P.level<p.level&&(P=P.liftTo(p));p.level<P.level&&(p=p.liftTo(P));return g(P,p)}},A=function(d){var g=d.match(y(b(10),
c(10)));return g?(d=g[1].match(/^([^.]*)(.*)$/),g=Number(g[2]),0===d[2].length?d[1]+Fa(g):g>=d[2].length-1?d[1]+d[2].substring(1)+Fa(g-(d[2].length-1)):d[1]+d[2].substring(1,1+g)):d},Fa=function(d){var g=[];g.length=d;for(var b=0;b<d;b++)g[b]="0";return g.join("")},da=function(d,g){switch(g.level){case 0:return Ia(d);case 1:return new R(d,1);case 2:return new E(d);case 3:return new L(d,0);default:h("IMPOSSIBLE: cannot lift fixnum integer to "+g.toString(),d,g)}},h=function(d,g,b){D.onThrowRuntimeError(d,
g,b)},w=function(d){return"number"===typeof d||d instanceof R||d instanceof E||d instanceof L||d instanceof m},O=function(d){return"number"===typeof d||w(d)&&d.isRational()},ka=function(d){return"number"===typeof d||w(d)&&d.isReal()},Ga=function(d){return"number"===typeof d||w(d)&&d.isExact()},ta=function(d){return"number"===typeof d?!1:w(d)&&d.isInexact()},sa=function(d){return"number"===typeof d||w(d)&&d.isInteger()},xa=function(d){return"number"===typeof d||w(d)&&d.isInteger()&&d.isExact()},Ea=
function(d){return"number"===typeof d?d:d.toFixnum()},za=function(d){return"number"===typeof d?d:d.toExact()},Aa=function(d){return"number"===typeof d?E.makeInstance(d):d.toInexact()},k=function(d,g){return"number"===typeof d&&"number"===typeof g&&Sa(d+g)?Ia(d).add(Ia(g)):d instanceof E&&g instanceof E?d.add(g):ma(d,g)},ma=fa(function(d,g){var b=d+g;return Sa(b)?Ia(d).add(Ia(g)):b},function(d,g){return d.add(g)},{isXSpecialCase:function(d){return xa(d)&&p(d)},onXSpecialCase:function(d,g){return g},
isYSpecialCase:function(d){return xa(d)&&p(d)},onYSpecialCase:function(d,g){return d}}),va=fa(function(d,g){var b=d-g;return Sa(b)?Ia(d).subtract(Ia(g)):b},function(d,g){return d.subtract(g)},{isXSpecialCase:function(d){return xa(d)&&p(d)},onXSpecialCase:function(d,g){return Ka(g)},isYSpecialCase:function(d){return xa(d)&&p(d)},onYSpecialCase:function(d,g){return d}}),I=function(d,g){if("number"===typeof d&&"number"===typeof g){var b=d*g;return Sa(b)?Ia(d).multiply(Ia(g)):b}return d instanceof E&&
g instanceof E?d.multiply(g):Pa(d,g)},Pa=fa(function(d,g){var b=d*g;return Sa(b)?Ia(d).multiply(Ia(g)):b},function(d,g){return d.multiply(g)},{isXSpecialCase:function(d){return xa(d)&&(p(d)||t(d)||ja(d))},onXSpecialCase:function(d,g){if(p(d))return 0;if(t(d))return g;if(ja(d))return Ka(g)},isYSpecialCase:function(d){return xa(d)&&(p(d)||t(d)||ja(d))},onYSpecialCase:function(d,g){if(p(g))return 0;if(t(g))return d;if(ja(g))return Ka(d)}}),J=fa(function(d,g){p(g)&&h("/: division by zero",d,g);var b=
d/g;return Sa(b)?Ia(d).divide(Ia(g)):Math.floor(b)!==b?R.makeInstance(d,g):b},function(d,g){return d.divide(g)},{isXSpecialCase:function(d){return Da(d,0)},onXSpecialCase:function(d,g){Da(g,0)&&h("/: division by zero",d,g);return 0},isYSpecialCase:function(d){return Da(d,0)},onYSpecialCase:function(d,g){h("/: division by zero",d,g)}}),Ca=fa(function(d,g){return d===g},function(d,g){return d.equals(g)}),Da=function(d,g){if(d===g)return!0;if("number"===typeof d&&"number"===typeof g||d===eb||g===eb)return d===
g;if(d instanceof L||g instanceof L)return Da(Ra(d),Ra(g))&&Da(fb(d),fb(g));var b=Ga(d),P=Ga(g);return(b&&P||!b&&!P)&&Ca(d,g)},$a=fa(function(d,g){return d>=g},function(d,g){ka(d)&&ka(g)||h(">=: couldn't be applied to complex number",d,g);return d.greaterThanOrEqual(g)}),z=fa(function(d,g){return d<=g},function(d,g){ka(d)&&ka(g)||h("<=: couldn't be applied to complex number",d,g);return d.lessThanOrEqual(g)}),F=fa(function(d,g){return d>g},function(d,g){ka(d)&&ka(g)||h(">: couldn't be applied to complex number",
d,g);return d.greaterThan(g)}),oa=fa(function(d,g){return d<g},function(d,g){ka(d)&&ka(g)||h("<: couldn't be applied to complex number",d,g);return d.lessThan(g)}),Ua=function(){var d=fa(function(d,g){var b=Math.pow(d,g);return Sa(b)?Ia(d).expt(Ia(g)):b},function(d,g){return Ca(g,0)?k(g,1):d.expt(g)});return function(g,b){return Ca(b,0)?k(b,1):ka(b)&&oa(b,0)?d(J(1,g),Ka(b)):d(g,b)}}(),Oa=function(d){return Da(d,0)?1:"number"===typeof d?E.makeInstance(Math.exp(d)):d.exp()},Za=function(d,b){sa(d)||
h("modulo: the first argument "+d+" is not an integer.",d,b);sa(b)||h("modulo: the second argument "+b+" is not an integer.",d,b);if("number"===typeof d)return d%=b,0>b?0>=d?d:d+b:0>d?d+b:d;d=g(S(d),S(b));return oa(b,0)?z(d,0)?d:k(d,b):oa(d,0)?k(d,b):d},db=function(d){return"number"===typeof d?d:d.numerator()},sb=function(d){return"number"===typeof d?1:d.denominator()},wa=function(d){return"number"===typeof d?0<=d?(d=Math.sqrt(d),Math.floor(d)===d?d:E.makeInstance(d)):L.makeInstance(0,wa(-d)):d.sqrt()},
Ma=function(d){return"number"===typeof d?Math.abs(d):d.abs()},S=function(d){return"number"===typeof d?d:d.floor()},l=function(d){return"number"===typeof d?d:d.ceiling()},Ha=function(d){return"number"===typeof d?d:d.conjugate()},ya=function(d){return Da(d,1)?0:"number"===typeof d?E.makeInstance(Math.log(d)):d.log()},Ja=function(d){return"number"===typeof d?0<d?0:E.pi:d.angle()},Xa=function(d){return Da(d,0)?0:"number"===typeof d?E.makeInstance(Math.tan(d)):d.tan()},cb=function(d){return Da(d,0)?0:
"number"===typeof d?E.makeInstance(Math.atan(d)):d.atan()},gb=function(d){return Da(d,0)?1:"number"===typeof d?E.makeInstance(Math.cos(d)):d.cos()},mb=function(d){return Da(d,0)?0:"number"===typeof d?E.makeInstance(Math.sin(d)):d.sin()},hb=function(d){return Da(d,1)?0:"number"===typeof d?E.makeInstance(Math.acos(d)):d.acos()},nb=function(d){return Da(d,0)?0:"number"===typeof d?E.makeInstance(Math.asin(d)):d.asin()},fb=function(d){return"number"===typeof d?0:d.imaginaryPart()},Ra=function(d){return"number"===
typeof d?d:d.realPart()},ob=function(d){return"number"===typeof d?d:d.round()},ab=function(d){return I(d,d)},ib=function(d){sa(d)||h("integer-sqrt: the argument "+d.toString()+" is not an integer.",d);return"number"===typeof d?0>d?L.makeInstance(0,Math.floor(Math.sqrt(-d))):Math.floor(Math.sqrt(d)):d.integerSqrt()},jb=function(d,g){sa(d)||h("quotient: the first argument "+d.toString()+" is not an integer.",d);sa(g)||h("quotient: the second argument "+g.toString()+" is not an integer.",g);return pb(d,
g)},kb=function(d,g){sa(d)||h("remainder: the first argument "+d.toString()+" is not an integer.",d);sa(g)||h("remainder: the second argument "+g.toString()+" is not an integer.",g);return Ab(d,g)},qb=function(d){return"number"===typeof d?isFinite(d):d.isFinite()},Sa=function(d){return-9E15>d||9E15<d},Ka=function(d){return"number"===typeof d?-d:d.negate()},tb=function(d,g){for(var b=1;;){if(p(g))return b;Ca(Za(g,2),0)?(d=I(d,d),g=J(g,2)):(b=I(b,d),g=va(g,1))}},Qa=function(d,g,b){b=b||{};return function(p,
c){p instanceof R?p=db(p):p instanceof L&&(p=Ra(p));c instanceof R?c=db(c):c instanceof L&&(c=Ra(c));if("number"===typeof p&&"number"===typeof c){var t=d(p,c);if(!Sa(t)||b.ignoreOverflow)return t}if(p instanceof E||c instanceof E)return b.doNotCoerseToFloating?d(Ea(p),Ea(c)):E.makeInstance(d(Ea(p),Ea(c)));"number"===typeof p&&(p=Ia(p));"number"===typeof c&&(c=Ia(c));return g(p,c)}},rb=function(d,g,b){b=b||{};return function(p){p instanceof R?p=db(p):p instanceof L&&(p=Ra(p));if("number"===typeof p){var c=
d(p);if(!Sa(c)||b.ignoreOverflow)return c}if(p instanceof E)return d(Ea(p));"number"===typeof p&&(p=Ia(p));return g(p)}},g=Qa(function(d,g){return d%g},function(d,g){return X.call(d,g)}),d=Qa(function(d,g){for(var b;0!==g;)b=d,d=g,g=b%g;return d},function(d,g){return ia.call(d,g)}),p=rb(function(d){return 0===d},function(d){return ea.call(d,m.ZERO)}),t=rb(function(d){return 1===d},function(d){return ea.call(d,m.ONE)}),ja=rb(function(d){return-1===d},function(d){return ea.call(d,m.NEGATIVE_ONE)}),
La=Qa(function(d,g){return d+g},function(d,g){return pa.call(d,g)}),Ib=Qa(function(d,g){return d-g},function(d,g){return la.call(d,g)}),Na=Qa(function(d,g){return d*g},function(d,g){return qa.call(d,g)}),pb=Qa(function(d,g){return(d-d%g)/g},function(d,g){return Z.call(d,g)}),Ab=Qa(function(d,g){return d%g},function(d,g){return ba.call(d,g)}),Va=Qa(function(d,g){return d/g},function(d,g){return Ea(d)/Ea(g)},{ignoreOverflow:!0,doNotCoerseToFloating:!0}),Bb=Qa(function(d,g){return d===g},function(d,
g){return ea.call(d,g)},{doNotCoerseToFloating:!0}),zb=Qa(function(d,g){return d>g},function(d,g){return 0<T.call(d,g)},{doNotCoerseToFloating:!0}),ub=Qa(function(d,g){return d<g},function(d,g){return 0>T.call(d,g)},{doNotCoerseToFloating:!0}),Cb=Qa(function(d,g){return d>=g},function(d,g){return 0<=T.call(d,g)},{doNotCoerseToFloating:!0}),Jb=Qa(function(d,g){return d<=g},function(d,g){return 0>=T.call(d,g)},{doNotCoerseToFloating:!0}),R=function(d,g){this.n=d;this.d=g};R.prototype.toString=function(){return t(this.d)?
this.n.toString()+"":this.n.toString()+"/"+this.d.toString()};R.prototype.level=1;R.prototype.liftTo=function(d){return 2===d.level?new E(Va(this.n,this.d)):3===d.level?new L(this,0):h("invalid level of Number",this,d)};R.prototype.isFinite=function(){return!0};R.prototype.equals=function(d){return d instanceof R&&Bb(this.n,d.n)&&Bb(this.d,d.d)};R.prototype.isInteger=function(){return t(this.d)};R.prototype.isRational=function(){return!0};R.prototype.isReal=function(){return!0};R.prototype.add=function(d){return R.makeInstance(La(Na(this.n,
d.d),Na(this.d,d.n)),Na(this.d,d.d))};R.prototype.subtract=function(d){return R.makeInstance(Ib(Na(this.n,d.d),Na(this.d,d.n)),Na(this.d,d.d))};R.prototype.negate=function(){return R.makeInstance(-this.n,this.d)};R.prototype.multiply=function(d){return R.makeInstance(Na(this.n,d.n),Na(this.d,d.d))};R.prototype.divide=function(d){(p(this.d)||p(d.n))&&h("/: division by zero",this,d);return R.makeInstance(Na(this.n,d.d),Na(this.d,d.n))};R.prototype.toExact=function(){return this};R.prototype.toInexact=
function(){return E.makeInstance(this.toFixnum())};R.prototype.isExact=function(){return!0};R.prototype.isInexact=function(){return!1};R.prototype.toFixnum=function(){return Va(this.n,this.d)};R.prototype.numerator=function(){return this.n};R.prototype.denominator=function(){return this.d};R.prototype.greaterThan=function(d){return zb(Na(this.n,d.d),Na(this.d,d.n))};R.prototype.greaterThanOrEqual=function(d){return Cb(Na(this.n,d.d),Na(this.d,d.n))};R.prototype.lessThan=function(d){return ub(Na(this.n,
d.d),Na(this.d,d.n))};R.prototype.lessThanOrEqual=function(d){return Jb(Na(this.n,d.d),Na(this.d,d.n))};R.prototype.integerSqrt=function(){var d=wa(this);return O(d)?za(S(d)):ka(d)?za(S(d)):L.makeInstance(za(S(Ra(d))),za(S(fb(d))))};R.prototype.sqrt=function(){if(Cb(this.n,0)){var d=wa(this.n),g=wa(this.d);return Ca(S(d),d)&&Ca(S(g),g)?R.makeInstance(d,g):E.makeInstance(Va(d,g))}d=wa(Ka(this.n));g=wa(this.d);return Ca(S(d),d)&&Ca(S(g),g)?L.makeInstance(0,R.makeInstance(d,g)):L.makeInstance(0,E.makeInstance(Va(d,
g)))};R.prototype.abs=function(){return R.makeInstance(Ma(this.n),this.d)};R.prototype.floor=function(){var d=pb(this.n,this.d);return ub(this.n,0)?va(d,1):d};R.prototype.ceiling=function(){var d=pb(this.n,this.d);return ub(this.n,0)?d:k(d,1)};R.prototype.conjugate=function(){return this};R.prototype.magnitude=R.prototype.abs;R.prototype.log=function(){return E.makeInstance(Math.log(this.n/this.d))};R.prototype.angle=function(){return p(this.n)?0:zb(this.n,0)?0:E.pi};R.prototype.tan=function(){return E.makeInstance(Math.tan(Va(this.n,
this.d)))};R.prototype.atan=function(){return E.makeInstance(Math.atan(Va(this.n,this.d)))};R.prototype.cos=function(){return E.makeInstance(Math.cos(Va(this.n,this.d)))};R.prototype.sin=function(){return E.makeInstance(Math.sin(Va(this.n,this.d)))};R.prototype.expt=function(d){return xa(d)&&$a(d,0)?tb(this,d):E.makeInstance(Math.pow(Va(this.n,this.d),Va(d.n,d.d)))};R.prototype.exp=function(){return E.makeInstance(Math.exp(Va(this.n,this.d)))};R.prototype.acos=function(){return E.makeInstance(Math.acos(Va(this.n,
this.d)))};R.prototype.asin=function(){return E.makeInstance(Math.asin(Va(this.n,this.d)))};R.prototype.imaginaryPart=function(){return 0};R.prototype.realPart=function(){return this};R.prototype.round=function(){var d=Ca(this.d,2),g=ub(this.n,0),b=this.n;g&&(b=Ka(b));var p=pb(b,this.d);d?p=k(p,1):(d=Ab(b,this.d),F(I(d,2),this.d)&&(p=k(p,1)));g&&(p=Ka(p));return p};R.makeInstance=function(g,b){void 0===g&&h("n undefined",g,b);void 0===b&&(b=1);p(b)&&h("division by zero: "+g+"/"+b);ub(b,0)&&(g=Ka(g),
b=Ka(b));var c=d(Ma(g),Ma(b));g=pb(g,c);b=pb(b,c);return t(b)||p(g)?g:new R(g,b)};var E=function(d){this.n=d},vb=new E(Number.NaN),Kb=new E(Number.POSITIVE_INFINITY),Db=new E(Number.NEGATIVE_INFINITY),Eb=new E(Number.POSITIVE_INFINITY),Fb=new E(Number.NEGATIVE_INFINITY),eb=new E(-0),Gb=new E(0);E.pi=new E(Math.PI);E.e=new E(Math.E);E.nan=vb;E.inf=Kb;E.neginf=Db;E.makeInstance=function(d){return isNaN(d)?E.nan:d===Number.POSITIVE_INFINITY?E.inf:d===Number.NEGATIVE_INFINITY?E.neginf:0===d?-Infinity===
1/d?eb:Gb:new E(d)};E.prototype.isExact=function(){return!1};E.prototype.isInexact=function(){return!0};E.prototype.isFinite=function(){return isFinite(this.n)||this===Eb||this===Fb};E.prototype.toExact=function(){isFinite(this.n)&&!isNaN(this.n)||h("toExact: no exact representation for "+this,this);var d=this.n.toString().match(/^(.*)\.(.*)$/);return d?(parseInt(d[1]),parseInt(d[2]),d=Math.pow(10,d[2].length),R.makeInstance(Math.round(this.n*d),d)):this.n};E.prototype.toInexact=function(){return this};
E.prototype.isInexact=function(){return!0};E.prototype.level=2;E.prototype.liftTo=function(d){return 3===d.level?new L(this,0):h("invalid level of Number",this,d)};E.prototype.toString=function(){if(isNaN(this.n))return"+nan.0";if(this.n===Number.POSITIVE_INFINITY)return"+inf.0";if(this.n===Number.NEGATIVE_INFINITY)return"-inf.0";if(this===eb)return"-0.0";var d=this.n.toString();return d.match("\\.")?d:d+".0"};E.prototype.equals=function(d,g){return d instanceof E&&this.n===d.n};E.prototype.isRational=
function(){return this.isFinite()};E.prototype.isInteger=function(){return this.isFinite()&&this.n===Math.floor(this.n)};E.prototype.isReal=function(){return!0};var wb=function(d){return oa(d,0)?-1:F(d,0)?1:d===eb?-1:0};E.prototype.add=function(d){return this.isFinite()&&d.isFinite()?E.makeInstance(this.n+d.n):isNaN(this.n)||isNaN(d.n)?vb:this.isFinite()&&!d.isFinite()?d:!this.isFinite()&&d.isFinite()?this:1===wb(this)*wb(d)?this:vb};E.prototype.subtract=function(d){return this.isFinite()&&d.isFinite()?
E.makeInstance(this.n-d.n):isNaN(this.n)||isNaN(d.n)?vb:this.isFinite()||d.isFinite()?this.isFinite()?I(d,-1):this:wb(this)===wb(d)?vb:this};E.prototype.negate=function(){return E.makeInstance(-this.n)};E.prototype.multiply=function(d){return E.makeInstance(this.n*d.n)};E.prototype.divide=function(d){return E.makeInstance(this.n/d.n)};E.prototype.toFixnum=function(){return this.n};E.prototype.numerator=function(){var g=this.n.toString().match(/^(.*)\.(.*)$/);if(g){var b=parseInt(g[2]);g=Math.pow(10,
g[2].length);b=d(g,b);return E.makeInstance(Math.round(g/b*this.n))}return this};E.prototype.denominator=function(){var g=this.n.toString().match(/^(.*)\.(.*)$/);if(g){var b=parseInt(g[2]);g=Math.pow(10,g[2].length);b=d(g,b);return E.makeInstance(Math.round(g/b))}return E.makeInstance(1)};E.prototype.floor=function(){return E.makeInstance(Math.floor(this.n))};E.prototype.ceiling=function(){return E.makeInstance(Math.ceil(this.n))};E.prototype.greaterThan=function(d){return this.n>d.n};E.prototype.greaterThanOrEqual=
function(d){return this.n>=d.n};E.prototype.lessThan=function(d){return this.n<d.n};E.prototype.lessThanOrEqual=function(d){return this.n<=d.n};E.prototype.integerSqrt=function(){if(this===eb)return this;if(sa(this))return 0<=this.n?E.makeInstance(Math.floor(Math.sqrt(this.n))):L.makeInstance(Gb,E.makeInstance(Math.floor(Math.sqrt(-this.n))));h("integerSqrt: can only be applied to an integer",this)};E.prototype.sqrt=function(){return 0>this.n?L.makeInstance(0,E.makeInstance(Math.sqrt(-this.n))):E.makeInstance(Math.sqrt(this.n))};
E.prototype.abs=function(){return E.makeInstance(Math.abs(this.n))};E.prototype.log=function(){return 0>this.n?(new L(this,0)).log():E.makeInstance(Math.log(this.n))};E.prototype.angle=function(){return 0===this.n?0:0<this.n?0:E.pi};E.prototype.tan=function(){return E.makeInstance(Math.tan(this.n))};E.prototype.atan=function(){return E.makeInstance(Math.atan(this.n))};E.prototype.cos=function(){return E.makeInstance(Math.cos(this.n))};E.prototype.sin=function(){return E.makeInstance(Math.sin(this.n))};
E.prototype.expt=function(d){return 1===this.n?(d.isFinite()||isNaN(d.n),this):E.makeInstance(Math.pow(this.n,d.n))};E.prototype.exp=function(){return E.makeInstance(Math.exp(this.n))};E.prototype.acos=function(){return E.makeInstance(Math.acos(this.n))};E.prototype.asin=function(){return E.makeInstance(Math.asin(this.n))};E.prototype.imaginaryPart=function(){return 0};E.prototype.realPart=function(){return this};E.prototype.round=function(){return isFinite(this.n)?this===eb?this:.5===Math.abs(Math.floor(this.n)-
this.n)?0===Math.floor(this.n)%2?E.makeInstance(Math.floor(this.n)):E.makeInstance(Math.ceil(this.n)):E.makeInstance(Math.round(this.n)):this};E.prototype.conjugate=function(){return this};E.prototype.magnitude=E.prototype.abs;var L=function(d,g){this.r=d;this.i=g};L.makeInstance=function(d,g){void 0===g&&(g=0);if(Ga(g)&&sa(g)&&p(g))return d;if(ta(d)||ta(g))d=Aa(d),g=Aa(g);return new L(d,g)};L.prototype.toString=function(){var d=this.r.toString(),g=this.i.toString();return"-"===g[0]||"+"===g[0]?d+
g+"i":d+"+"+g+"i"};L.prototype.isFinite=function(){return qb(this.r)&&qb(this.i)};L.prototype.isRational=function(){return O(this.r)&&Da(this.i,0)};L.prototype.isInteger=function(){return sa(this.r)&&Da(this.i,0)};L.prototype.toExact=function(){return L.makeInstance(za(this.r),za(this.i))};L.prototype.toInexact=function(){return L.makeInstance(Aa(this.r),Aa(this.i))};L.prototype.isExact=function(){return Ga(this.r)&&Ga(this.i)};L.prototype.isInexact=function(){return ta(this.r)||ta(this.i)};L.prototype.level=
3;L.prototype.liftTo=function(d){h("Don't know how to lift Complex number",this,d)};L.prototype.equals=function(d){return d instanceof L&&Ca(this.r,d.r)&&Ca(this.i,d.i)};L.prototype.greaterThan=function(d){this.isReal()&&d.isReal()||h(">: expects argument of type real number",this,d);return F(this.r,d.r)};L.prototype.greaterThanOrEqual=function(d){this.isReal()&&d.isReal()||h(">=: expects argument of type real number",this,d);return $a(this.r,d.r)};L.prototype.lessThan=function(d){this.isReal()&&
d.isReal()||h("<: expects argument of type real number",this,d);return oa(this.r,d.r)};L.prototype.lessThanOrEqual=function(d){this.isReal()&&d.isReal()||h("<=: expects argument of type real number",this,d);return z(this.r,d.r)};L.prototype.abs=function(){Ca(this.i,0).valueOf()||h("abs: expects argument of type real number",this);return Ma(this.r)};L.prototype.toFixnum=function(){Ca(this.i,0).valueOf()||h("toFixnum: expects argument of type real number",this);return Ea(this.r)};L.prototype.numerator=
function(){this.isReal()||h("numerator: can only be applied to real number",this);return db(this.n)};L.prototype.denominator=function(){this.isReal()||h("floor: can only be applied to real number",this);return sb(this.n)};L.prototype.add=function(d){return L.makeInstance(k(this.r,d.r),k(this.i,d.i))};L.prototype.subtract=function(d){return L.makeInstance(va(this.r,d.r),va(this.i,d.i))};L.prototype.negate=function(){return L.makeInstance(Ka(this.r),Ka(this.i))};L.prototype.multiply=function(d){if(d.isReal())return L.makeInstance(I(this.r,
d.r),I(this.i,d.r));var g=va(I(this.r,d.r),I(this.i,d.i));d=k(I(this.r,d.i),I(this.i,d.r));return L.makeInstance(g,d)};L.prototype.divide=function(d){if(d.isReal())return L.makeInstance(J(this.r,d.r),J(this.i,d.r));if(this.isInexact()||d.isInexact()){var g=this.r;var b=this.i;var p=d.r;var c=d.i;if(z(Ma(c),Ma(p))){var t=J(c,p);d=J(k(g,I(b,t)),k(p,I(c,t)));g=J(va(b,I(g,t)),k(p,I(c,t)))}else t=J(p,c),d=J(k(I(g,t),b),k(I(p,t),c)),g=J(va(I(b,t),g),k(I(p,t),c));return L.makeInstance(d,g)}b=Ha(d);g=I(this,
b);b=Ra(I(d,b));return L.makeInstance(J(Ra(g),b),J(fb(g),b))};L.prototype.conjugate=function(){return L.makeInstance(this.r,va(0,this.i))};L.prototype.magnitude=function(){var d=k(I(this.r,this.r),I(this.i,this.i));return wa(d)};L.prototype.isReal=function(){return Da(this.i,0)};L.prototype.integerSqrt=function(){if(sa(this))return ib(this.r);h("integerSqrt: can only be applied to an integer",this)};L.prototype.sqrt=function(){if(this.isReal())return wa(this.r);var d=k(this.magnitude(),this.r),g=
wa(J(d,2));d=J(this.i,wa(I(d,2)));return L.makeInstance(g,d)};L.prototype.log=function(){var d=this.magnitude(),g=this.angle();return k(ya(d),I(g,bb))};L.prototype.angle=function(){if(this.isReal())return Ja(this.r);if(Ca(0,this.r)){var d=J(E.pi,2);return F(this.i,0)?d:Ka(d)}d=cb(J(Ma(this.i),Ma(this.r)));return F(this.r,0)?F(this.i,0)?d:Ka(d):F(this.i,0)?va(E.pi,d):va(d,E.pi)};var bb=L.makeInstance(0,1),Hb=L.makeInstance(0,-1);L.prototype.tan=function(){return J(this.sin(),this.cos())};L.prototype.atan=
function(){return Ca(this,bb)||Ca(this,Hb)?Db:I(bb,I(E.makeInstance(.5),ya(J(k(bb,this),k(bb,va(0,this))))))};L.prototype.cos=function(){if(this.isReal())return gb(this.r);var d=I(this,bb),g=Ka(d);return J(k(Oa(d),Oa(g)),2)};L.prototype.sin=function(){if(this.isReal())return mb(this.r);var d=I(this,bb),g=Ka(d),b=L.makeInstance(0,2);d=va(Oa(d),Oa(g));return J(d,b)};L.prototype.expt=function(d){if(xa(d)&&$a(d,0))return tb(this,d);d=I(d,this.log());return Oa(d)};L.prototype.exp=function(){var d=Oa(this.r),
g=gb(this.i),b=mb(this.i);return I(d,k(g,I(b,bb)))};L.prototype.acos=function(){if(this.isReal())return hb(this.r);var d=J(E.pi,2),g=I(this,bb),b=wa(va(1,ab(this)));g=I(ya(k(g,b)),bb);return k(d,g)};L.prototype.asin=function(){if(this.isReal())return nb(this.r);var d=va(1,ab(this));d=wa(d);return I(2,cb(J(this,k(1,d))))};L.prototype.ceiling=function(){this.isReal()||h("ceiling: can only be applied to real number",this);return l(this.r)};L.prototype.floor=function(){this.isReal()||h("floor: can only be applied to real number",
this);return S(this.r)};L.prototype.imaginaryPart=function(){return this.i};L.prototype.realPart=function(){return this.r};L.prototype.round=function(){this.isReal()||h("round: can only be applied to real number",this);return ob(this.r)};var Lb=/^(#[ei]#[bodx]|#[bodx]#[ei]|#[bodxei])(.*)$/;v.def=new v(0);v.on=new v(1);v.off=new v(2);v.prototype.intAsExactp=function(){return this.defaultp()||this.exactp()};v.prototype.floatAsInexactp=function(){return this.defaultp()||this.inexactp()};if("undefined"!==
typeof navigator&&"Microsoft Internet Explorer"==navigator.appName){m.prototype.am=V;var lb=30}else"undefined"!==typeof navigator&&"Netscape"!=navigator.appName?(m.prototype.am=C,lb=26):(m.prototype.am=G,lb=28);m.prototype.DB=lb;m.prototype.DM=(1<<lb)-1;m.prototype.DV=1<<lb;m.prototype.FV=Math.pow(2,52);m.prototype.F1=52-lb;m.prototype.F2=2*lb-52;var yb=[],Ya;var xb=48;for(Ya=0;9>=Ya;++Ya)yb[xb++]=Ya;xb=97;for(Ya=10;36>Ya;++Ya)yb[xb++]=Ya;xb=65;for(Ya=10;36>Ya;++Ya)yb[xb++]=Ya;na.prototype.convert=
function(d){return 0>d.s||0<=d.compareTo(this.m)?d.mod(this.m):d};na.prototype.revert=function(d){return d};na.prototype.reduce=function(d){d.divRemTo(this.m,null,d)};na.prototype.mulTo=function(d,g,b){d.multiplyTo(g,b);this.reduce(b)};na.prototype.sqrTo=function(d,g){d.squareTo(g);this.reduce(g)};ha.prototype.convert=function(d){var g=q();d.abs().dlShiftTo(this.m.t,g);g.divRemTo(this.m,null,g);0>d.s&&0<g.compareTo(m.ZERO)&&this.m.subTo(g,g);return g};ha.prototype.revert=function(d){var g=q();d.copyTo(g);
this.reduce(g);return g};ha.prototype.reduce=function(d){for(;d.t<=this.mt2;)d[d.t++]=0;for(var g=0;g<this.m.t;++g){var b=d[g]&32767,p=b*this.mpl+((b*this.mph+(d[g]>>15)*this.mpl&this.um)<<15)&d.DM;b=g+this.m.t;for(d[b]+=this.m.am(0,p,d,g,0,this.m.t);d[b]>=d.DV;)d[b]-=d.DV,d[++b]++}d.clamp();d.drShiftTo(this.m.t,d);0<=d.compareTo(this.m)&&d.subTo(this.m,d)};ha.prototype.mulTo=function(d,g,b){d.multiplyTo(g,b);this.reduce(b)};ha.prototype.sqrTo=function(d,g){d.squareTo(g);this.reduce(g)};m.prototype.copyTo=
function(d){for(var g=this.t-1;0<=g;--g)d[g]=this[g];d.t=this.t;d.s=this.s};m.prototype.fromInt=function(d){this.t=1;this.s=0>d?-1:0;0<d?this[0]=d:-1>d?this[0]=d+DV:this.t=0};m.prototype.fromString=function(d,g){if(16==g)g=4;else if(8==g)g=3;else if(256==g)g=8;else if(2==g)g=1;else if(32==g)g=5;else if(4==g)g=2;else{this.fromRadix(d,g);return}this.s=this.t=0;for(var b=d.length,p=!1,c=0;0<=--b;){var t=8==g?d[b]&255:B(d,b);0>t?"-"==d.charAt(b)&&(p=!0):(p=!1,0==c?this[this.t++]=t:c+g>this.DB?(this[this.t-
1]|=(t&(1<<this.DB-c)-1)<<c,this[this.t++]=t>>this.DB-c):this[this.t-1]|=t<<c,c+=g,c>=this.DB&&(c-=this.DB))}8==g&&0!=(d[0]&128)&&(this.s=-1,0<c&&(this[this.t-1]|=(1<<this.DB-c)-1<<c));this.clamp();p&&m.ZERO.subTo(this,this)};m.prototype.clamp=function(){for(var d=this.s&this.DM;0<this.t&&this[this.t-1]==d;)--this.t};m.prototype.dlShiftTo=function(d,g){var b;for(b=this.t-1;0<=b;--b)g[b+d]=this[b];for(b=d-1;0<=b;--b)g[b]=0;g.t=this.t+d;g.s=this.s};m.prototype.drShiftTo=function(d,g){for(var b=d;b<
this.t;++b)g[b-d]=this[b];g.t=Math.max(this.t-d,0);g.s=this.s};m.prototype.lShiftTo=function(d,g){var b=d%this.DB,p=this.DB-b,c=(1<<p)-1;d=Math.floor(d/this.DB);var t=this.s<<b&this.DM,h;for(h=this.t-1;0<=h;--h)g[h+d+1]=this[h]>>p|t,t=(this[h]&c)<<b;for(h=d-1;0<=h;--h)g[h]=0;g[d]=t;g.t=this.t+d+1;g.s=this.s;g.clamp()};m.prototype.rShiftTo=function(d,g){g.s=this.s;var b=Math.floor(d/this.DB);if(b>=this.t)g.t=0;else{d%=this.DB;var p=this.DB-d,c=(1<<d)-1;g[0]=this[b]>>d;for(var t=b+1;t<this.t;++t)g[t-
b-1]|=(this[t]&c)<<p,g[t-b]=this[t]>>d;0<d&&(g[this.t-b-1]|=(this.s&c)<<p);g.t=this.t-b;g.clamp()}};m.prototype.subTo=function(d,g){for(var b=0,p=0,c=Math.min(d.t,this.t);b<c;)p+=this[b]-d[b],g[b++]=p&this.DM,p>>=this.DB;if(d.t<this.t){for(p-=d.s;b<this.t;)p+=this[b],g[b++]=p&this.DM,p>>=this.DB;p+=this.s}else{for(p+=this.s;b<d.t;)p-=d[b],g[b++]=p&this.DM,p>>=this.DB;p-=d.s}g.s=0>p?-1:0;-1>p?g[b++]=this.DV+p:0<p&&(g[b++]=p);g.t=b;g.clamp()};m.prototype.multiplyTo=function(d,g){var b=this.abs(),p=
d.abs(),c=b.t;for(g.t=c+p.t;0<=--c;)g[c]=0;for(c=0;c<p.t;++c)g[c+b.t]=b.am(0,p[c],g,c,0,b.t);g.s=0;g.clamp();this.s!=d.s&&m.ZERO.subTo(g,g)};m.prototype.squareTo=function(d){for(var g=this.abs(),b=d.t=2*g.t;0<=--b;)d[b]=0;for(b=0;b<g.t-1;++b){var p=g.am(b,g[b],d,2*b,0,1);(d[b+g.t]+=g.am(b+1,2*g[b],d,2*b+1,p,g.t-b-1))>=g.DV&&(d[b+g.t]-=g.DV,d[b+g.t+1]=1)}0<d.t&&(d[d.t-1]+=g.am(b,g[b],d,2*b,0,1));d.s=0;d.clamp()};m.prototype.divRemTo=function(d,g,b){var p=d.abs();if(!(0>=p.t)){var c=this.abs();if(c.t<
p.t)null!=g&&g.fromInt(0),null!=b&&this.copyTo(b);else{null==b&&(b=q());var t=q(),h=this.s;d=d.s;var z=this.DB-U(p[p.t-1]);0<z?(p.lShiftTo(z,t),c.lShiftTo(z,b)):(p.copyTo(t),c.copyTo(b));p=t.t;c=t[p-1];if(0!=c){var ja=c*(1<<this.F1)+(1<p?t[p-2]>>this.F2:0),k=this.FV/ja;ja=(1<<this.F1)/ja;var l=1<<this.F2,La=b.t,F=La-p,w=null==g?q():g;t.dlShiftTo(F,w);0<=b.compareTo(w)&&(b[b.t++]=1,b.subTo(w,b));m.ONE.dlShiftTo(p,w);for(w.subTo(t,t);t.t<p;)t[t.t++]=0;for(;0<=--F;){var P=b[--La]==c?this.DM:Math.floor(b[La]*
k+(b[La-1]+l)*ja);if((b[La]+=t.am(0,P,b,F,0,p))<P)for(t.dlShiftTo(F,w),b.subTo(w,b);b[La]<--P;)b.subTo(w,b)}null!=g&&(b.drShiftTo(p,g),h!=d&&m.ZERO.subTo(g,g));b.t=p;b.clamp();0<z&&b.rShiftTo(z,b);0>h&&m.ZERO.subTo(b,b)}}}};m.prototype.invDigit=function(){if(1>this.t)return 0;var d=this[0];if(0==(d&1))return 0;var g=d&3;g=g*(2-(d&15)*g)&15;g=g*(2-(d&255)*g)&255;g=g*(2-((d&65535)*g&65535))&65535;g=g*(2-d*g%this.DV)%this.DV;return 0<g?this.DV-g:-g};m.prototype.isEven=function(){return 0==(0<this.t?
this[0]&1:this.s)};m.prototype.bnpExp=function(d,g){if(4294967295<d||1>d)return m.ONE;var b=q(),p=q(),c=g.convert(this),t=U(d)-1;for(c.copyTo(b);0<=--t;)if(g.sqrTo(b,p),0<(d&1<<t))g.mulTo(p,c,b);else{var h=b;b=p;p=h}return g.revert(b)};m.prototype.toString=function(d){if(0>this.s)return"-"+this.negate().toString(d);if(16==d)d=4;else if(8==d)d=3;else if(2==d)d=1;else if(32==d)d=5;else if(4==d)d=2;else return this.toRadix(d);var g=(1<<d)-1,b,p=!1,c=[],t=this.t,h=this.DB-t*this.DB%d;if(0<t--)for(h<this.DB&&
0<(b=this[t]>>h)&&(p=!0,c.push("0123456789abcdefghijklmnopqrstuvwxyz".charAt(b)));0<=t;)h<d?(b=(this[t]&(1<<h)-1)<<d-h,b|=this[--t]>>(h+=this.DB-d)):(b=this[t]>>(h-=d)&g,0>=h&&(h+=this.DB,--t)),0<b&&(p=!0),p&&c.push("0123456789abcdefghijklmnopqrstuvwxyz".charAt(b));return p?c.join(""):"0"};m.prototype.negate=function(){var d=q();m.ZERO.subTo(this,d);return d};m.prototype.abs=function(){return 0>this.s?this.negate():this};m.prototype.compareTo=T;m.prototype.bitLength=function(){return 0>=this.t?0:
this.DB*(this.t-1)+U(this[this.t-1]^this.s&this.DM)};m.prototype.mod=X;m.prototype.modPowInt=function(d,g){g=256>d||g.isEven()?new na(g):new ha(g);return this.exp(d,g)};m.ZERO=aa(0);m.ONE=aa(1);Y.prototype.convert=M;Y.prototype.revert=M;Y.prototype.mulTo=function(d,g,b){d.multiplyTo(g,b)};Y.prototype.sqrTo=function(d,g){d.squareTo(g)};ua.prototype.convert=function(d){if(0>d.s||d.t>2*this.m.t)return d.mod(this.m);if(0>d.compareTo(this.m))return d;var g=q();d.copyTo(g);this.reduce(g);return g};ua.prototype.revert=
function(d){return d};ua.prototype.reduce=function(d){d.drShiftTo(this.m.t-1,this.r2);d.t>this.m.t+1&&(d.t=this.m.t+1,d.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>d.compareTo(this.r2);)d.dAddOffset(1,this.m.t+1);for(d.subTo(this.r2,d);0<=d.compareTo(this.m);)d.subTo(this.m,d)};ua.prototype.mulTo=function(d,g,b){d.multiplyTo(g,b);this.reduce(b)};ua.prototype.sqrTo=function(d,g){d.squareTo(g);this.reduce(g)};var Ta=[2,3,5,7,
11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Mb=67108864/Ta[Ta.length-1];m.prototype.chunkSize=function(d){return Math.floor(Math.LN2*this.DB/Math.log(d))};m.prototype.toRadix=function(d){null==
d&&(d=10);if(0==this.signum()||2>d||36<d)return"0";var g=this.chunkSize(d);g=Math.pow(d,g);var b=aa(g),p=q(),c=q(),t="";for(this.divRemTo(b,p,c);0<p.signum();)t=(g+c.intValue()).toString(d).substr(1)+t,p.divRemTo(b,p,c);return c.intValue().toString(d)+t};m.prototype.fromRadix=function(d,g){this.fromInt(0);null==g&&(g=10);for(var b=this.chunkSize(g),p=Math.pow(g,b),c=!1,t=0,h=0,z=0;z<d.length;++z){var ja=B(d,z);0>ja?"-"==d.charAt(z)&&0==this.signum()&&(c=!0):(h=g*h+ja,++t>=b&&(this.dMultiply(p),this.dAddOffset(h,
0),h=t=0))}0<t&&(this.dMultiply(Math.pow(g,t)),this.dAddOffset(h,0));c&&m.ZERO.subTo(this,this)};m.prototype.fromNumber=function(d,g,b){if("number"==typeof g)if(2>d)this.fromInt(1);else for(this.fromNumber(d,b),this.testBit(d-1)||this.bitwiseTo(m.ONE.shiftLeft(d-1),ca,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(g);)this.dAddOffset(2,0),this.bitLength()>d&&this.subTo(m.ONE.shiftLeft(d-1),this);else{b=[];var p=d&7;b.length=(d>>3)+1;g.nextBytes(b);b[0]=0<p?b[0]&(1<<p)-1:0;this.fromString(b,
256)}};m.prototype.bitwiseTo=function(d,g,b){var p,c=Math.min(d.t,this.t);for(p=0;p<c;++p)b[p]=g(this[p],d[p]);if(d.t<this.t){var t=d.s&this.DM;for(p=c;p<this.t;++p)b[p]=g(this[p],t);b.t=this.t}else{t=this.s&this.DM;for(p=c;p<d.t;++p)b[p]=g(t,d[p]);b.t=d.t}b.s=g(this.s,d.s);b.clamp()};m.prototype.changeBit=function(d,g){d=m.ONE.shiftLeft(d);this.bitwiseTo(d,g,d);return d};m.prototype.addTo=function(d,g){for(var b=0,p=0,c=Math.min(d.t,this.t);b<c;)p+=this[b]+d[b],g[b++]=p&this.DM,p>>=this.DB;if(d.t<
this.t){for(p+=d.s;b<this.t;)p+=this[b],g[b++]=p&this.DM,p>>=this.DB;p+=this.s}else{for(p+=this.s;b<d.t;)p+=d[b],g[b++]=p&this.DM,p>>=this.DB;p+=d.s}g.s=0>p?-1:0;0<p?g[b++]=p:-1>p&&(g[b++]=this.DV+p);g.t=b;g.clamp()};m.prototype.dMultiply=function(d){this[this.t]=this.am(0,d-1,this,0,0,this.t);++this.t;this.clamp()};m.prototype.dAddOffset=function(d,g){if(0!=d){for(;this.t<=g;)this[this.t++]=0;for(this[g]+=d;this[g]>=this.DV;)this[g]-=this.DV,++g>=this.t&&(this[this.t++]=0),++this[g]}};m.prototype.multiplyLowerTo=
function(d,g,b){var p=Math.min(this.t+d.t,g);b.s=0;for(b.t=p;0<p;)b[--p]=0;var c;for(c=b.t-this.t;p<c;++p)b[p+this.t]=this.am(0,d[p],b,p,0,this.t);for(c=Math.min(d.t,g);p<c;++p)this.am(0,d[p],b,p,0,g-p);b.clamp()};m.prototype.multiplyUpperTo=function(d,g,b){--g;var p=b.t=this.t+d.t-g;for(b.s=0;0<=--p;)b[p]=0;for(p=Math.max(g-this.t,0);p<d.t;++p)b[this.t+p-g]=this.am(g-p,d[p],b,0,0,this.t+p-g);b.clamp();b.drShiftTo(1,b)};m.prototype.modInt=function(d){if(0>=d)return 0;var g=this.DV%d,b=0>this.s?d-
1:0;if(0<this.t)if(0==g)b=this[0]%d;else for(var p=this.t-1;0<=p;--p)b=(g*b+this[p])%d;return b};m.prototype.millerRabin=function(d){var g=this.subtract(m.ONE),b=g.getLowestSetBit();if(0>=b)return!1;var p=g.shiftRight(b);d=d+1>>1;d>Ta.length&&(d=Ta.length);for(var c=q(),t=0;t<d;++t){c.fromInt(Ta[t]);var h=c.modPow(p,this);if(0!=h.compareTo(m.ONE)&&0!=h.compareTo(g)){for(var z=1;z++<b&&0!=h.compareTo(g);)if(h=h.modPowInt(2,this),0==h.compareTo(m.ONE))return!1;if(0!=h.compareTo(g))return!1}}return!0};
m.prototype.clone=function(){var d=q();this.copyTo(d);return d};m.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]};m.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24};m.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16};m.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?
0:1};m.prototype.toByteArray=function(){var d=this.t,g=[];g[0]=this.s;var b=this.DB-d*this.DB%8,p,c=0;if(0<d--)for(b<this.DB&&(p=this[d]>>b)!=(this.s&this.DM)>>b&&(g[c++]=p|this.s<<this.DB-b);0<=d;)if(8>b?(p=(this[d]&(1<<b)-1)<<8-b,p|=this[--d]>>(b+=this.DB-8)):(p=this[d]>>(b-=8)&255,0>=b&&(b+=this.DB,--d)),0!=(p&128)&&(p|=-256),0==c&&(this.s&128)!=(p&128)&&++c,0<c||p!=this.s)g[c++]=p;return g};m.prototype.equals=ea;m.prototype.min=function(d){return 0>this.compareTo(d)?this:d};m.prototype.max=function(d){return 0<
this.compareTo(d)?this:d};m.prototype.and=function(d){var g=q();this.bitwiseTo(d,Ba,g);return g};m.prototype.or=function(d){var g=q();this.bitwiseTo(d,ca,g);return g};m.prototype.xor=function(d){var g=q();this.bitwiseTo(d,K,g);return g};m.prototype.andNot=function(d){var g=q();this.bitwiseTo(d,W,g);return g};m.prototype.not=function(){for(var d=q(),g=0;g<this.t;++g)d[g]=this.DM&~this[g];d.t=this.t;d.s=~this.s;return d};m.prototype.shiftLeft=function(d){var g=q();0>d?this.rShiftTo(-d,g):this.lShiftTo(d,
g);return g};m.prototype.shiftRight=function(d){var g=q();0>d?this.lShiftTo(-d,g):this.rShiftTo(d,g);return g};m.prototype.getLowestSetBit=function(){for(var d=0;d<this.t;++d)if(0!=this[d]){var g=d*this.DB;d=this[d];if(0==d)d=-1;else{var b=0;0==(d&65535)&&(d>>=16,b+=16);0==(d&255)&&(d>>=8,b+=8);0==(d&15)&&(d>>=4,b+=4);0==(d&3)&&(d>>=2,b+=2);0==(d&1)&&++b;d=b}return g+d}return 0>this.s?this.t*this.DB:-1};m.prototype.bitCount=function(){for(var d=0,g=this.s&this.DM,b=0;b<this.t;++b){for(var p=this[b]^
g,c=0;0!=p;)p&=p-1,++c;d+=c}return d};m.prototype.testBit=function(d){var g=Math.floor(d/this.DB);return g>=this.t?0!=this.s:0!=(this[g]&1<<d%this.DB)};m.prototype.setBit=function(d){return this.changeBit(d,ca)};m.prototype.clearBit=function(d){return this.changeBit(d,W)};m.prototype.flipBit=function(d){return this.changeBit(d,K)};m.prototype.add=pa;m.prototype.subtract=la;m.prototype.multiply=qa;m.prototype.divide=Z;m.prototype.remainder=ba;m.prototype.divideAndRemainder=ra;m.prototype.modPow=function(d,
g){var b=d.bitLength(),p=aa(1);if(0>=b)return p;var c=18>b?1:48>b?3:144>b?4:768>b?5:6;g=8>b?new na(g):g.isEven()?new ua(g):new ha(g);var t=[],h=3,z=c-1,ja=(1<<c)-1;t[1]=g.convert(this);if(1<c)for(b=q(),g.sqrTo(t[1],b);h<=ja;)t[h]=q(),g.mulTo(b,t[h-2],t[h]),h+=2;var k=d.t-1,l=!0,La=q();for(b=U(d[k])-1;0<=k;){if(b>=z)var F=d[k]>>b-z&ja;else F=(d[k]&(1<<b+1)-1)<<z-b,0<k&&(F|=d[k-1]>>this.DB+b-z);for(h=c;0==(F&1);)F>>=1,--h;0>(b-=h)&&(b+=this.DB,--k);if(l)t[F].copyTo(p),l=!1;else{for(;1<h;)g.sqrTo(p,
La),g.sqrTo(La,p),h-=2;0<h?g.sqrTo(p,La):(h=p,p=La,La=h);g.mulTo(La,t[F],p)}for(;0<=k&&0==(d[k]&1<<b);)g.sqrTo(p,La),h=p,p=La,La=h,0>--b&&(b=this.DB-1,--k)}return g.revert(p)};m.prototype.modInverse=function(d){var g=d.isEven();if(this.isEven()&&g||0==d.signum())return m.ZERO;for(var b=d.clone(),p=this.clone(),c=aa(1),t=aa(0),h=aa(0),z=aa(1);0!=b.signum();){for(;b.isEven();)b.rShiftTo(1,b),g?(c.isEven()&&t.isEven()||(c.addTo(this,c),t.subTo(d,t)),c.rShiftTo(1,c)):t.isEven()||t.subTo(d,t),t.rShiftTo(1,
t);for(;p.isEven();)p.rShiftTo(1,p),g?(h.isEven()&&z.isEven()||(h.addTo(this,h),z.subTo(d,z)),h.rShiftTo(1,h)):z.isEven()||z.subTo(d,z),z.rShiftTo(1,z);0<=b.compareTo(p)?(b.subTo(p,b),g&&c.subTo(h,c),t.subTo(z,t)):(p.subTo(b,p),g&&h.subTo(c,h),z.subTo(t,z))}if(0!=p.compareTo(m.ONE))return m.ZERO;if(0<=z.compareTo(d))return z.subtract(d);if(0>z.signum())z.addTo(d,z);else return z;return 0>z.signum()?z.add(d):z};m.prototype.pow=N;m.prototype.expt=N;m.prototype.gcd=ia;m.prototype.isProbablePrime=function(d){var g,
b=this.abs();if(1==b.t&&b[0]<=Ta[Ta.length-1]){for(g=0;g<Ta.length;++g)if(b[0]==Ta[g])return!0;return!1}if(b.isEven())return!1;for(g=1;g<Ta.length;){for(var p=Ta[g],c=g+1;c<Ta.length&&p<Mb;)p*=Ta[c++];for(p=b.modInt(p);g<c;)if(0==p%Ta[g++])return!1}return b.millerRabin(d)};m.NEGATIVE_ONE=m.ONE.negate();var Ia=function(d){"number"===typeof d&&(d+="");d=A(d);return new m(d,10)};m.prototype.level=0;m.prototype.liftTo=function(d){return 1===d.level?new R(this,1):2===d.level?(d=this.toFixnum(),d===Number.POSITIVE_INFINITY?
Eb:d===Number.NEGATIVE_INFINITY?Fb:new E(d)):3===d.level?new L(this,0):h("invalid level for BigInteger lift",this,d)};m.prototype.isFinite=function(){return!0};m.prototype.isInteger=function(){return!0};m.prototype.isRational=function(){return!0};m.prototype.isReal=function(){return!0};m.prototype.isExact=function(){return!0};m.prototype.isInexact=function(){return!1};m.prototype.toExact=function(){return this};m.prototype.toInexact=function(){return E.makeInstance(this.toFixnum())};m.prototype.toFixnum=
function(){var d=0,g=this.toString(),b;if("-"===g[0]){for(b=1;b<g.length;b++)d=10*d+Number(g[b]);return-d}for(b=0;b<g.length;b++)d=10*d+Number(g[b]);return d};m.prototype.greaterThan=function(d){return 0<this.compareTo(d)};m.prototype.greaterThanOrEqual=function(d){return 0<=this.compareTo(d)};m.prototype.lessThan=function(d){return 0>this.compareTo(d)};m.prototype.lessThanOrEqual=function(d){return 0>=this.compareTo(d)};m.prototype.divide=function(d){var g=ra.call(this,d);return 0===g[1].compareTo(m.ZERO)?
g[0]:k(g[0],R.makeInstance(g[1],d))};m.prototype.numerator=function(){return this};m.prototype.denominator=function(){return 1};(function(){var d=function(d,g){for(;!z(ab(g),d)||!oa(d,ab(k(g,1)));)g=S(J(k(g,S(J(d,g))),2));return g};m.prototype.integerSqrt=function(){if(0<=wb(this))return d(this,this);var g=this.negate();return L.makeInstance(0,d(g,g))}})();(function(){m.prototype.sqrt=function(){var d=this.integerSqrt();if(Da(ab(d),this))return d;var g=Ea(this);return isFinite(g)?0<=g?E.makeInstance(Math.sqrt(g)):
L.makeInstance(0,E.makeInstance(Math.sqrt(-g))):d}})();m.prototype.floor=function(){return this};m.prototype.ceiling=function(){return this};m.prototype.conjugate=H("conjugate");m.prototype.magnitude=H("magnitude");m.prototype.log=H("log");m.prototype.angle=H("angle");m.prototype.atan=H("atan");m.prototype.acos=H("acos");m.prototype.asin=H("asin");m.prototype.tan=H("tan");m.prototype.cos=H("cos");m.prototype.sin=H("sin");m.prototype.exp=H("exp");m.prototype.imaginaryPart=function(){return 0};m.prototype.realPart=
function(){return this};m.prototype.round=function(){return this};var Nb=function(){return function(d,g,b){var p=512;b&&"undefined"!==typeof b.limit&&(p=b.limit);sa(d)||h("toRepeatingDecimal: n "+d.toString()+" is not an integer.");sa(g)||h("toRepeatingDecimal: d "+g.toString()+" is not an integer.");Ca(g,0)&&h("toRepeatingDecimal: d equals 0");oa(g,0)&&h("toRepeatingDecimal: d < 0");b=oa(d,0)?"-":"";d=Ma(d);b+=jb(d,g);a:{d=kb(d,g);var c=p;p=[];var t={};for(t[d]=!0;;){if(0>=c--){g=[p.join(""),"..."];
break a}var z=jb(I(d,10),g);d=kb(I(d,10),g);p.push(z.toString());if(t[d])break;else t[d]=!0}t=d;for(c=[];z=jb(I(d,10),g),d=kb(I(d,10),g),c.push(z.toString()),!Ca(d,t););g=p.join("");for(d=c.join("");g.length>=d.length&&g.substring(g.length-d.length)===d;)g=g.substring(0,g.length-d.length);g=[g,d]}return[b].concat(g)}}();D.fromFixnum=function(d){if(isNaN(d)||!isFinite(d))return E.makeInstance(d);var g=Math.floor(d);return g===d?Sa(g)?Ia(A(d+"")):g:E.makeInstance(d)};D.fromString=function(d,g){var p=
10;g="undefined"===typeof g?v.def:!0===g?v.on:!1===g?v.off:h("exactness must be true or false",this,r);var t=d.toLowerCase().match(Lb);if(t){var z=t[1].toLowerCase(),ja=z.match(/(#[ei])/);z=z.match(/(#[bodx])/);ja&&(ja=ja[1].charAt(1),g="e"===ja?v.on:"i"===ja?v.off:h("invalid exactness flag",this,r));z&&(ja=z[1].charAt(1),p="b"===ja?2:"o"===ja?8:"d"===ja?10:"x"===ja?16:h("invalid radix flag",this,r))}d=t?t[2]:d;t=t?!0:!1;z=b(p);var k="["+c(p)+"]",l="["+z+"]+";ja=l+"/"+l;z="(?:(?:"+(l+"|["+(z+"]*\\.["+
z+"]+|[")+(z+"]+\\.["+z+"]*)|"))+ja+")(?:"+k+"[+-]?"+l+")?";k="(?:[+-]?"+z+"|[+-](?:inf.0|nan.0|inf.f|nan.f))";z=new RegExp("^("+k+")?([+-](?:"+(z+"|(?:inf.0|nan.0|inf.f|nan.f))?)i$"));k=new RegExp("^("+k+")@("+k+")$");ja=d.match(new RegExp("^([+-]?"+ja+")([+-]"+ja+"?)i$"));z=d.match(z);k=d.match(k);d=(ja=ja?ja:z?z:k?k:!1)?L.makeInstance(Q(ja[1]||"0",p,g),Q("+"===ja[2]?"1":"-"===ja[2]?"-1":ja[2],p,g)):Q(d,p,g,t);return d};D.makeBignum=Ia;D.makeRational=R.makeInstance;D.makeFloat=E.makeInstance;D.makeComplex=
L.makeInstance;D.makeComplexPolar=function(d,g){return Da(g,0)?d:L.makeInstance(I(d,gb(g)),I(d,mb(g)))};D.pi=E.pi;D.e=E.e;D.nan=E.nan;D.negative_inf=E.neginf;D.inf=E.inf;D.negative_one=-1;D.zero=0;D.one=1;D.i=bb;D.negative_i=Hb;D.negative_zero=eb;D.onThrowRuntimeError=function(d,g,b){throw Error(d);};D.isSchemeNumber=w;D.isRational=O;D.isReal=ka;D.isExact=Ga;D.isInexact=ta;D.isInteger=sa;D.toFixnum=Ea;D.toExact=za;D.toInexact=Aa;D.add=k;D.subtract=va;D.multiply=I;D.divide=J;D.equals=Ca;D.eqv=Da;D.approxEquals=
function(d,g,b){return oa(Ma(va(d,g)),b)};D.greaterThanOrEqual=$a;D.lessThanOrEqual=z;D.greaterThan=F;D.lessThan=oa;D.expt=Ua;D.exp=Oa;D.modulo=Za;D.numerator=db;D.denominator=sb;D.integerSqrt=ib;D.sqrt=wa;D.abs=Ma;D.quotient=jb;D.remainder=kb;D.floor=S;D.ceiling=l;D.conjugate=Ha;D.magnitude=function(d){return"number"===typeof d?Math.abs(d):d.magnitude()};D.log=ya;D.angle=Ja;D.tan=Xa;D.atan=cb;D.cos=gb;D.sin=mb;D.tan=Xa;D.acos=hb;D.asin=nb;D.cosh=function(d){return Da(d,0)?E.makeInstance(1):J(k(Oa(d),
Oa(Ka(d))),2)};D.sinh=function(d){return J(va(Oa(d),Oa(Ka(d))),2)};D.imaginaryPart=fb;D.realPart=Ra;D.round=ob;D.sqr=ab;D.gcd=function(d,b){sa(d)||h("gcd: the argument "+d.toString()+" is not an integer.",d);d=Ma(d);for(var c,t,z=0;z<b.length;z++)for(t=Ma(b[z]),sa(t)||h("gcd: the argument "+t.toString()+" is not an integer.",t);!p(t);)c=d,d=t,t=g(c,t);return d};D.lcm=function(g,b){sa(g)||h("lcm: the argument "+g.toString()+" is not an integer.",g);g=Ma(g);if(p(g))return 0;for(var c=0;c<b.length;c++){sa(b[c])||
h("lcm: the argument "+b[c].toString()+" is not an integer.",b[c]);var t=d(g,b[c]);if(p(t))return 0;g=J(I(g,b[c]),t)}return g};D.toRepeatingDecimal=Nb;D.BigInteger=m;D.Rational=R;D.FloatPoint=E;D.Complex=L;D.MIN_FIXNUM=-9E15;D.MAX_FIXNUM=9E15})();
var _Hashtable=function(){function e(b){return"function"===typeof b}function u(b){return"string"===typeof b?b:e(b.hashCode)?(b=b.hashCode(),"string"!==typeof b?u(b):b):e(b.toString)?b.toString():String(b)}function y(b,c){return b.equals(c)}function b(b,c){return e(c.equals)?c.equals(b):b===c}function c(b,c){return b===c}function v(b,c,e,q,m){for(var C,v=0,B=b.length;v<B;v++)if(C=b[v],m(c,e(C)))return q?[v,C]:!0;return!1}function Q(b,c){if(e(b.splice))b.splice(c,1);else if(c===b.length-1)b.length=
c;else{var q=b.slice(c+1);b.length=c;for(var m=0,C=q.length;m<C;m++)b[c+m]=q[m]}}function m(b,c){if(null===b)throw Error("null is not a valid "+c);if("undefined"===typeof b)throw Error(c+" must not be undefined");}function q(b,c,e){this.entries=[];this.addEntry(b,c);null!==e&&(this.getEqualityFunction=function(){return e})}function C(b){return b[0]}function V(b){return b[1]}function G(){}function B(b){return b[0]}function aa(b,c){return(b=b[c])&&b instanceof G?b[1]:null}q.prototype={getEqualityFunction:function(c){return e(c.equals)?
y:b},searchForEntry:function(b){return v(this.entries,b,C,!0,this.getEqualityFunction(b))},getEntryForKey:function(b){return this.searchForEntry(b)[1]},getEntryIndexForKey:function(b){return this.searchForEntry(b)[0]},removeEntryForKey:function(b){return(b=this.searchForEntry(b))?(Q(this.entries,b[0]),!0):!1},addEntry:function(b,c){this.entries[this.entries.length]=[b,c]},size:function(){return this.entries.length},keys:function(b){for(var c=b.length,e=0,q=this.entries.length;e<q;e++)b[c+e]=this.entries[e][0]},
values:function(b){for(var c=b.length,e=0,q=this.entries.length;e<q;e++)b[c+e]=this.entries[e][1]},containsKey:function(b){return v(this.entries,b,C,!1,this.getEqualityFunction(b))},containsValue:function(b){return v(this.entries,b,V,!1,c)}};G.prototype=[];return function(b,c){var C=[],V={};b=e(b)?b:u;c=e(c)?c:null;this.put=function(e,v){m(e,"key");m(v,"value");var B=b(e),y=aa(V,B);y?(B=y.getEntryForKey(e))?B[1]=v:y.addEntry(e,v):(y=new G,y[0]=B,y[1]=new q(e,v,c),C[C.length]=y,V[B]=y)};this.get=function(c){m(c,
"key");var e=b(c);if(e=aa(V,e))if(c=e.getEntryForKey(c))return c[1];return null};this.containsKey=function(c){m(c,"key");var e=b(c);return(e=aa(V,e))?e.containsKey(c):!1};this.containsValue=function(b){m(b,"value");for(var c=0,e=C.length;c<e;c++)if(C[c][1].containsValue(b))return!0;return!1};this.clear=function(){C.length=0;V={}};this.isEmpty=function(){return 0===C.length};this.keys=function(){for(var b=[],c=0,e=C.length;c<e;c++)C[c][1].keys(b);return b};this.values=function(){for(var b=[],c=0,e=
C.length;c<e;c++)C[c][1].values(b);return b};this.remove=function(c){m(c,"key");var e=b(c),q=aa(V,e);q&&q.removeEntryForKey(c)&&0===q.size()&&(c=q.getEqualityFunction(c),c=v(C,e,B,!0,c),Q(C,c[0]),delete V[e])};this.size=function(){for(var b=0,c=0,e=C.length;c<e;c++)b+=C[c][1].size();return b}}}(),types={};
(function(){function e(b,c,h){var z=document.createElement("span");z.className=c;z.ariaText=h;z.setAttribute("aria-label",h);z.appendChild(document.createTextNode(b));return z}function u(){var b=document.createElement("span");b.appendChild(document.createTextNode("("));b.className="lParen";return b}function y(){var b=document.createElement("span");b.appendChild(document.createTextNode(")"));b.className="rParen";return b}function b(b){return b.replace(/\\u[\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef][\dABCDEFabcdef]/g,
function(b){return String.fromCharCode(parseInt(b.replace(/\\u/g,""),16))})}var c={}.hasOwnProperty,v=0;makeEqHashCode=function(){v++;return v};getEqHashCode=function(b){b&&!b._eqHashCode&&(b._eqHashCode=makeEqHashCode());return b&&b._eqHashCode?b._eqHashCode:"string"==typeof b?b:0};var Q=function(){this.parentMap=V()};Q.prototype.find=function(b){var c=this.parentMap.containsKey(b)?this.parentMap.get(b):b;if(c===b)return c;c=this.find(c);this.parentMap.put(b,c);return c};Q.prototype.merge=function(b,
c){this.parentMap.put(this.find(b),this.find(c))};var m=function(){var b=!1,c=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,h=function(){};h.extend=function(h){var z=this.prototype;b=!0;var k=new this;b=!1;for(var F in h)k[F]="function"==typeof h[F]&&"function"==typeof z[F]&&c.test(h[F])?function(b,c){return function(){var h=this._super;this._super=z[b];var k=c.apply(this,arguments);this._super=h;return k}}(F,h[F]):h[F];F=function(){!b&&this.init&&this.init.apply(this,arguments)};F.prototype=k;F.constructor=
F;F.extend=arguments.callee;return F};return h}();StructType=function(b,c,h,k,w,e,q,m,O){this.name=b;this.type=c;this.numberOfArgs=h;this.numberOfFields=k;this.firstField=w;this.constructor=e;this.predicate=q;this.accessor=m;this.mutator=O};StructType.prototype.toString=function(){return"#<struct-type:"+this.name+">"};StructType.prototype.isEqual=function(b,c){return this===b};var q=function(b,c,h,k,w,e){c||(c={type:C,numberOfArgs:0,numberOfFields:0,firstField:0});var z=c.numberOfArgs,F=c.type.extend({init:function(b,
c){e||(e=function(b){if(3==arguments.length)b(arguments[1]);else{var c=[],h;for(h=1;h<arguments.length-1;h++)c.push(arguments[h]);b(new ra(c))}});var F=this;c.unshift(function(c){c=c instanceof ra?c.elts:[c];var l=c.slice(0,z);F._super(b,l);for(l=0;l<h;l++)F._fields.push(c[l+z]);for(l=0;l<k;l++)F._fields.push(w)});c.push(T.makeInstance(b));e.apply(null,c)}});F.prototype.type=F;return new StructType(b,F,h+z,h+k,c.firstField+c.numberOfFields,function(){for(var c=[],h=0;h<arguments.length;h++)c.push(arguments[h]);
return new F(b,c)},function(b){return b instanceof F},function(b,c){return b._fields[c+this.firstField]},function(b,c,h){b._fields[c+this.firstField]=h})},C=m.extend({init:function(b,c){this._constructorName=b;this._fields=[]},toWrittenString:function(b){var c=[],h;c.push("(");c.push(this._constructorName);for(h=0;h<this._fields.length;h++)c.push(" "),c.push(K(this._fields[h],b));c.push(")");return c.join("")},toDisplayedString:this.toWrittenString,toDomNode:function(b){var c=document.createElement("span"),
h=document.createElement("span");h.appendChild(document.createTextNode(this._constructorName));ariaText=this._constructorName+":";c.appendChild(u());c.appendChild(h);for(h=0;h<this._fields.length;h++){var z=W(this._fields[h],b);ariaText+=" "+z.ariaText;c.appendChild(z)}c.appendChild(y());c.ariaText=ariaText;c.setAttribute("aria-label",ariaText);return c},isEqual:function(b,c){if(void 0==b.type||this.type!==b.type||!(b instanceof this.type))return!1;for(var h=0;h<this._fields.length;h++)if(!ba(this._fields[h],
b._fields[h],c))return!1;return!0}});C.prototype.type=C;var V=function(){return new _Hashtable(function(b){return getEqHashCode(b)},function(b,c){return b===c})},G=function(b){this.hash=V();this.mutable=!0};G.prototype.toWrittenString=function(b){for(var c=this.hash.keys(),h=[],z=0;z<c.length;z++){var k=types.toWrittenString(c[z],b),w=types.toWrittenString(this.hash.get(c[z]),b);h.push("("+k+" . "+w+")")}return"#hasheq("+h.join(" ")+")"};G.prototype.toDisplayedString=G.prototype.toWrittenString;G.prototype.isEqual=
function(b,c){if(!(b instanceof G)||this.hash.keys().length!=b.hash.keys().length)return!1;for(var h=this.hash.keys(),z=0;z<h.length;z++)if(!b.hash.containsKey(h[z])||!ba(this.hash.get(h[z]),b.hash.get(h[z]),c))return!1;return!0};var B=function(b){this.hash=new _Hashtable(function(b){return K(b)},function(b,c){return ba(b,c,new Q)});this.mutable=!0};B.prototype.toWrittenString=function(b){for(var c=this.hash.keys(),h=[],z=0;z<c.length;z++){var k=types.toWrittenString(c[z],b),w=types.toWrittenString(this.hash.get(c[z]),
b);h.push("("+k+" . "+w+")")}return"#hash("+h.join(" ")+")"};B.prototype.toDisplayedString=B.prototype.toWrittenString;B.prototype.toDomNode=function(b){var c=document.createElement("span");document.createElement("span");var h=this.hash.keys(),z="hashtable with "+h.length+" item"+(1==h.length?"":"s")+": ";c.appendChild(document.createTextNode(this.toDisplayedString()));for(var k=0;k<h.length;k++){var w=W(h[k],b),e=W(this.hash.get(h[k]),b);z+=" "+w.ariaText+" maps to "+e.ariaText}c.ariaText=z;c.setAttribute("aria-label",
z);return c};B.prototype.isEqual=function(b,c){if(!(b instanceof B)||this.hash.keys().length!=b.hash.keys().length)return!1;for(var h=this.hash.keys(),z=0;z<h.length;z++)if(!b.hash.containsKey(h[z])||!ba(this.hash.get(h[z]),b.hash.get(h[z]),c))return!1;return!0};var aa=function(b,c){this.val=b;this.mutable=c};aa.prototype.unbox=function(){return this.val};aa.prototype.set=function(b){this.mutable&&(this.val=b)};aa.prototype.toString=function(){return"#&"+this.val.toString()};aa.prototype.toWrittenString=
function(b){return"#&"+K(this.val,b)};aa.prototype.toDisplayedString=this.toWrittenString;aa.prototype.toDomNode=function(b){var c=document.createElement("span"),h=document.createElement("span");h.appendChild(document.createTextNode("#&"));var z="a box containing: "+W(this.val).ariaText;c.className="wescheme-box";c.ariaText=z;c.setAttribute("aria-label",z);c.appendChild(h);c.appendChild(W(this.val,b));return c};Logic={TRUE:!0,FALSE:!1};Boolean.prototype.toString=function(){return this.valueOf()?"true":
"false"};Boolean.prototype.toWrittenString=Boolean.prototype.toString;Boolean.prototype.toDisplayedString=Boolean.prototype.toString;Boolean.prototype.toDomNode=function(){return e(this.toString(),"wescheme-boolean",this.toString()+", a Boolean")};Boolean.prototype.isEqual=function(b,c){return this==b};Char=function(b){this.val=b};Char.makeInstance=function(b){return new Char(b)};Char.prototype.toString=function(){var b=this.val.charCodeAt(0);switch(b){case 0:b="#\\nul";break;case 8:b="#\\backspace";
break;case 9:b="#\\tab";break;case 10:b="#\\newline";break;case 11:b="#\\vtab";break;case 12:b="#\\page";break;case 13:b="#\\return";break;case 20:b="#\\space";break;case 127:b="#\\rubout";break;default:if(32<=b&&126>=b)b="#\\"+this.val;else{for(b=b.toString(16).toUpperCase();4>b.length;)b="0"+b;b="#\\u"+b}}return b};Char.prototype.toWrittenString=Char.prototype.toString;Char.prototype.toDisplayedString=function(b){return this.val};Char.prototype.toDomNode=function(){return e(this.toString(),"wescheme-character",
this.toString().substring(2)+", a Character")};Char.prototype.getValue=function(){return this.val};Char.prototype.isEqual=function(b,c){return b instanceof Char&&this.val==b.val};var T=function(b){this.val=b},U={};T.makeInstance=function(b){c.call(U,b)||(U[b]=new T(b));return U[b]};T.prototype.isEqual=function(b,c){return b instanceof T&&this.val==b.val};T.prototype.toString=function(){return this.val};T.prototype.toWrittenString=function(b){return this.val};T.prototype.toDisplayedString=this.toWrittenString;
T.prototype.toDomNode=function(b){b=e(this.toString(),"wescheme-symbol","'"+this.val+", a Symbol");b.style.fontFamily="monospace";b.style.whiteSpace="pre";return b};Empty=function(){};Empty.EMPTY=new Empty;Empty.prototype.isEqual=function(b,c){return b instanceof Empty};Empty.prototype.reverse=function(){return this};Empty.prototype.first=function(){throw Error("first can't be applied on empty.");};Empty.prototype.rest=function(){throw Error("rest can't be applied on empty.");};Empty.prototype.isEmpty=
function(){return!0};Empty.prototype.toWrittenString=function(b){return"empty"};Empty.prototype.toDisplayedString=this.toWrittenString;Empty.prototype.toString=function(b){return"()"};Empty.prototype.toDomNode=function(b){document.createElement("span");b=e("empty","wescheme-symbol","empty");b.style.fontFamily="monospace";b.style.whiteSpace="pre";return b};Empty.prototype.append=function(b){return b};Cons=function(b,c){this.f=b;this.r=c};Cons.prototype.reverse=function(){for(var b=this,c=Empty.EMPTY;!b.isEmpty();)c=
Cons.makeInstance(b.first(),c),b=b.rest();return c};Cons.makeInstance=function(b,c){return new Cons(b,c)};Cons.prototype.isEqual=function(b,c){return b instanceof Cons?ba(this.first(),b.first(),c)&&ba(this.rest(),b.rest(),c):Logic.FALSE};Cons.prototype.first=function(){return this.f};Cons.prototype.rest=function(){return this.r};Cons.prototype.isEmpty=function(){return!1};Cons.prototype.append=function(b){if(b===Empty.EMPTY)return this;for(var c=this.reverse();!c.isEmpty();)b=Cons.makeInstance(c.first(),
b),c=c.rest();return b};Cons.prototype.toWrittenString=function(b){for(var c=["list"],h=this;h instanceof Cons;)c.push(K(h.first(),b)),h=h.rest();if(h!==Empty.EMPTY){c=this;h=K;for(var z=[],k=[];c instanceof Cons;)z.push("(cons "),z.push(h(c.first(),b)),z.push(" "),k.push(")"),c=c.rest();z.push(h(c,b));return z.join("")+k.join("")}return"("+c.join(" ")+")"};Cons.prototype.toString=Cons.prototype.toWrittenString;Cons.prototype.toDisplayedString=this.toWrittenString;Cons.prototype.toDomNode=function(b){var c=
document.createElement("span"),h=document.createElement("span");c.className="wescheme-cons";h.appendChild(document.createTextNode("list"));c.appendChild(u());c.appendChild(h);h=this;for(var z=0,k="";h instanceof Cons;){var w=W(h.first(),b);c.appendChild(w);z++;k+=", "+w.ariaText||w.textContent;h=h.rest()}if(h!==Empty.EMPTY){z=this;h=c=document.createElement("span");k=document.createElement("span");k.appendChild(document.createTextNode("cons"));trailingRParens=ariaText="";for(h.className="wescheme-cons";z instanceof
Cons;)h.appendChild(u()),h.appendChild(k.cloneNode(!0)),ariaText+=" (cons",trailingRParens+=")",w=W(z.first(),b),ariaText+=" "+w.ariaText||w.textContent,h.appendChild(w),w=document.createElement("span"),h.appendChild(w),h.appendChild(y()),h=w,z=z.rest();b=W(z,b);ariaText+=" "+(b.ariaText||b.textContent)+")"+trailingRParens;h.appendChild(b);c.ariaText=ariaText;c.setAttribute("aria-label",ariaText);return c}c.appendChild(y());b="list of "+z+" element"+(1==z?"":"s")+": "+k;c.setAttribute("aria-label",
b);c.ariaText=b;return c};Vector=function(b,c){this.elts=Array(b);if(c)for(var h=0;h<b;h++)this.elts[h]=c[h];else for(h=0;h<b;h++)this.elts[h]=void 0;this.mutable=!0};Vector.makeInstance=function(b,c){return new Vector(b,c)};Vector.prototype.length=function(){return this.elts.length};Vector.prototype.ref=function(b){return this.elts[b]};Vector.prototype.set=function(b,c){this.elts[b]=c};Vector.prototype.isEqual=function(b,c){if(null!=b&&void 0!=b&&b instanceof Vector){if(b.length()!=this.length())return!1;
for(var h=0;h<this.length();h++)if(!ba(this.elts[h],b.elts[h],c))return!1;return!0}return!1};Vector.prototype.toList=function(){for(var b=Empty.EMPTY,c=this.length()-1;0<=c;c--)b=Cons.makeInstance(this.elts[c],b);return b};Vector.prototype.toWrittenString=function(b){for(var c=[],h=0;h<this.length();h++)c.push(K(this.ref(h),b));return"#("+c.join(" ")+")"};Vector.prototype.toDisplayedString=this.toWrittenString;Vector.prototype.toDomNode=function(b){var c=document.createElement("span"),h=document.createElement("span"),
z=document.createElement("span");h.appendChild(document.createTextNode("#("));h.className="lParen";z.appendChild(document.createTextNode(")"));z.className="rParen";c.className="wescheme-vector";c.appendChild(h);h="a vector of size "+this.length()+": ";for(var k=0;k<this.length();k++){var w=W(this.ref(k),b);h+=" "+w.ariaText;c.appendChild(w)}c.appendChild(z);c.setAttribute("aria-label",h);c.ariaText=h;return c};var X=function(b){this.chars=b;this.length=b.length;this.mutable=!0};X.makeInstance=function(b){return new X(b)};
X.fromString=function(b){return X.makeInstance(b.split(""))};X.prototype.toString=function(){return this.chars.join("")};X.prototype.toWrittenString=function(b){return'"'+na(this.toString())+'"'};X.prototype.toDisplayedString=X.prototype.toString;X.prototype.copy=function(){return X.makeInstance(this.chars.slice(0))};X.prototype.substring=function(b,c){if(null==c||void 0==c)c=this.length;return X.makeInstance(this.chars.slice(b,c))};X.prototype.charAt=function(b){return this.chars[b]};X.prototype.charCodeAt=
function(b){return this.chars[b].charCodeAt(0)};X.prototype.replace=function(b,c){return X.fromString(this.toString().replace(b,c))};X.prototype.isEqual=function(b,c){return b instanceof X||"string"==typeof b?this.toString()===b.toString():!1};X.prototype.set=function(b,c){this.chars[b]=c};X.prototype.toUpperCase=function(){return X.fromString(this.chars.join("").toUpperCase())};X.prototype.toLowerCase=function(){return X.fromString(this.chars.join("").toLowerCase())};X.prototype.match=function(b){return this.toString().match(b)};
var na=function(b){for(var c=[],h=0;h<b.length;h++){var k=b.charCodeAt(h);switch(k){case 7:c.push("\\a");break;case 8:c.push("\\b");break;case 9:c.push("\\t");break;case 10:c.push("\\n");break;case 11:c.push("\\v");break;case 12:c.push("\\f");break;case 13:c.push("\\r");break;case 34:c.push('\\"');break;case 92:c.push("\\\\");break;default:if(32<=k&&126>=k)c.push(b.charAt(h));else{for(k=k.toString(16).toUpperCase();4>k.length;)k="0"+k;c.push("\\u"+k)}}}return c.join("")},ha=function(b,c){this.name=
b;this.obj=c};ha.prototype.toString=function(){return"#<js-object:"+typeof this.obj+":"+this.name+">"};ha.prototype.isEqual=function(b,c){return this.obj===b.obj};var ea=function(b,c,h){this.startup=b;this.shutdown=c;this.startupArgs=h;this.shutdownArg=void 0};ea.prototype.toString=function(){return"#<world-config>"};ea.prototype.isEqual=function(b,c){if(!ba(this.startup,b.startup,c)||!ba(this.shutdown,b.shutdown,c)||this.startupArgs.length!=b.startupArgs.length||!ba(this.shutdownArg,b.shutdownArg,
c))return!1;for(var h=0;h<args.length;h++)if(!ba(this.startupArgs[h],b.startupArgs[h],c))return!1;return!0};var Ba=q("effect",!1,0,0,!1,!1);Ba.type.prototype.invokeEffect=function(b){helpers.raise(types.incompleteExn(types.exnFail,"effect type created without using make-effect-type",[]))};var ca=q("render-effect",!1,0,0,!1,!1);ca.type.prototype.callImplementation=function(b,c){helpers.raise(types.incompleteExn(types.exnFail,"render effect created without using make-render-effect-type",[]))};var K=
function(b,c){c||(c=V());if("object"==typeof b){if(c.containsKey(b))return"...";c.put(b,!0)}if(void 0==b||null==b)return"#<undefined>";if("string"==typeof b)return'"'+na(b.toString())+'"';if("object"!=typeof b&&"function"!=typeof b)return b.toString();var h="undefined"!==typeof b.toWrittenString?b.toWrittenString(c):"undefined"!==typeof b.toDisplayedString?b.toDisplayedString(c):b.toString();c.remove(b);return h},W=function(b,c){c||(c=V());if("undefined"!==typeof b.toDomNode)return b.toDomNode(c);
if(qa(b)){a:{c=b.toString();if(jsnums.isExact(b))if(jsnums.isInteger(b)){var h="wescheme-number Integer";c+=""}else if(jsnums.isRational(b)){b=node=la(b);break a}else b instanceof jsnums.Complex?(h="wescheme-number Complex",c+=", Complex Number"):c+=", Number";else b instanceof jsnums.Complex?(h=" wescheme-numberComplex",c+=", a Complex Number"):c+=", a Number";b=e(b.toString(),h,c)}return b}if("object"==typeof b){if(c.containsKey(b))return b=document.createElement("span"),b.style["font-family"]=
"monospace",b.appendChild(document.createTextNode("...")),b;c.put(b,!0)}if(void 0==b||null==b)return b=document.createElement("span"),b.style["font-family"]="monospace",b.appendChild(document.createTextNode("#<undefined>")),b;if("string"==typeof b)return pa(K(b));if("object"!=typeof b&&"function"!=typeof b)return pa(b.toString());h=b.nodeType?b:"undefined"!==typeof b.toWrittenString?pa(b.toWrittenString(c)):"undefined"!==typeof b.toDisplayedString?pa(b.toDisplayedString(c)):pa(b.toString());c.remove(b);
return h},pa=function(c){var h=c.split("\n"),k=h.map(b),z,w=document.createElement("span"),e=document.createElement("span"),q=document.createElement("span");q.style.paddingLeft=e.style.paddingLeft="0px";0<h.length&&(e.appendChild(document.createTextNode(k[0])),q.appendChild(document.createTextNode(h[0])));for(z=1;z<h.length;z++){var m=document.createElement("br");m.style.clear="left";e.appendChild(m);e.appendChild(document.createTextNode(k[z]));q.appendChild(document.createTextNode(h[z]))}w.className=
"wescheme-string";h=k.join(" ")+", a String";w.ariaText=h;w.setAttribute("aria-label",h);w.style.fontFamily="monospace";w.style.whiteSpace="pre-wrap";w.appendChild(q);if(c!==b(c)){w.appendChild(e);var O=!0;q.style.display="none";w.onclick=function(b){O=!O;q.style.display=O?"none":"inline";e.style.display=O?"inline":"none"};w.style.cursor="pointer"}return w},la=function(b){var c=document.createElement("span"),h=jsnums.toRepeatingDecimal(jsnums.numerator(b),jsnums.denominator(b),{limit:25}),k=document.createElement("span");
k.appendChild(document.createTextNode(h[0]+"."+h[1]));c.appendChild(k);c.ariaText=h[0]+" point "+h[1];"..."===h[2]?(k.appendChild(document.createTextNode(h[2])),c.ariaText+=" , (truncated)"):"0"!==h[2]&&(k=document.createElement("span"),k.style.textDecoration="overline",k.appendChild(document.createTextNode(h[2])),c.appendChild(k),c.ariaText+=h[1]?" with repeating "+h[2]:h[2]+" repeating");c.setAttribute("aria-hidden",!0);var z=document.createElement("span");h=document.createElement("sup");h.appendChild(document.createTextNode(String(jsnums.numerator(b))));
k=document.createElement("sub");k.appendChild(document.createTextNode(String(jsnums.denominator(b))));var w=document.createElement("span");w.appendChild(document.createTextNode("/"));z.appendChild(h);z.appendChild(w);z.appendChild(k);z.ariaText=String(jsnums.numerator(b))+" over "+String(jsnums.denominator(b));var e=document.createElement("span");e.appendChild(c);e.appendChild(z);z.style.display="none";z.setAttribute("aria-hidden",!0);var q=!0;e.onclick=function(b){q=!q;c.style.display=q?"inline":
"none";z.style.display=q?"none":"inline";e.setAttribute("aria-label",(q?c:z).ariaText)};e.ariaText=c.ariaText;e.style.cursor="pointer";e.className="wescheme-number Rational";return e},qa=jsnums.isSchemeNumber,Z=function(b){return"string"===typeof b||b instanceof X},ba=function(b,c,h){if(b===c)return!0;if(qa(b)&&qa(c))return jsnums.equals(b,c);if(Z(b)&&Z(c))return b.toString()===c.toString();if(void 0==b||null==b)return void 0==c||null==c;if("object"==typeof b&&"object"==typeof c&&b.isEqual&&c.isEqual){if(h.find(b)===
h.find(c))return!0;h.merge(b,c);return b.isEqual(c,h)}return!1},ra=function(b){this.elts=b};ra.prototype.toDomNode=function(b){var c=document.createElement("span");c.style.whiteSpace="pre";if(0<this.elts.length){c.appendChild(W(this.elts[0],b));for(var h=1;h<this.elts.length;h++){var k=W(this.elts[h],b);c.appendChild(document.createTextNode("\n"));c.appendChild(k)}}return c};var Y=function(){};Y.prototype.toString=function(){return"#<undefined>"};Y=new Y;var M=function(){};M.prototype.toString=function(){return"#<void>"};
var N=new M;M=function(){};M.prototype.toString=function(){return"#<eof>"};M=new M;var ua=function(b,c,h,k,w,e,q){this.name=b;this.locs=c;this.numParams=h;this.paramTypes=k;this.isRest=w;this.closureVals=e;this.body=q};ua.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<function:~a>",[this.name]):"#<function>"};ua.prototype.toDomNode=function(){return e(this.toString(),"wescheme-primproc",this.name===Empty.EMPTY?"anonymous function":this.name+", a function")};var ia=
function(b,c){this.name=b;this.closures=c};ia.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<case-lambda-procedure:~a>",[this.name]):"#<case-lambda-procedure>"};var H=function(b,c){this.name=!1;this.vstack=b.slice(0);this.cstack=c.slice(0)};H.prototype.toString=function(){return this.name!==Empty.EMPTY?helpers.format("#<function:~a>",[this.name]):"#<function>"};H.prototype.toDomNode=function(){return e(this.toWrittenString(),"wescheme-primproc",this.name===Empty.EMPTY?
"anonymous function":this.name+", a function")};var D=function(){this.slots=[];this.definedMask=[]};D.prototype.addSlot=function(b){void 0===b?(this.slots.push(types.UNDEFINED),this.definedMask.push(!1)):(this.slots.push(b),b instanceof fa?b.value===types.UNDEFINED?this.definedMask.push(!1):this.definedMask.push(!0):this.definedMask.push(!0))};D.prototype.ref=function(b,c){if(this.slots[b]instanceof fa){if(this.definedMask[b])return this.slots[b].value;helpers.raise(types.incompleteExn(types.exnFailContractVariable,
new Ga([new ta(this.slots[b].name,c),": this variable is not defined"]),[this.slots[b].name]))}else{if(this.definedMask[b])return this.slots[b];helpers.raise(types.incompleteExn(types.exnFailContractVariable,"variable has not been defined",[!1]))}};D.prototype.set=function(b,c){this.slots[b]instanceof fa?this.slots[b].value=c:this.slots[b]=c;this.definedMask[b]=!0};D.prototype.length=function(){return this.slots.length};var fa=function(b,c){this.name=b;this.value=c},A=function(b,c){this.prefix=b;
this.pos=c};A.prototype.ref=function(){return this.prefix.ref(this.pos)};A.prototype.set=function(b){this.prefix.set(this.pos,b)};var Fa=function(b){this.dict=b||{}};Fa.prototype.invoke=function(b){};Fa.prototype.update=function(b,c){this.dict[b.val]=c;return this};var da=function(b){this.dict=b};da.prototype.toDomNode=function(b){b=document.createElement("span");b.appendChild(document.createTextNode("#<continuation-mark-set>"));return b};da.prototype.toWrittenString=function(b){return"#<continuation-mark-set>"};
da.prototype.toDisplayedString=this.toWrittenString;da.prototype.ref=function(b){return this.dict.containsKey(b)?this.dict.get(b):[]};var h=function(){},w=new h,O=function(b,c,h,k,w){this.name=b;this.numParams=c;this.isRest=h;this.assignsToValueRegister=k;this.impl=w};O.prototype.toString=function(){return"#<function:"+this.name+">"};O.prototype.toWrittenString=O.prototype.toString;O.prototype.toDisplayedString=O.prototype.toString;O.prototype.toDomNode=function(b){return e(this.toString(),"wescheme-primproc",
this.name+", a function")};var ka=function(b,c){this.name=b;this.cases=c};ka.prototype.toString=function(b){return"#<function:"+this.name+">"};ka.prototype.toWrittenString=ka.prototype.toString;ka.prototype.toDisplayedString=ka.prototype.toString;ka.prototype.toDomNode=function(b){return e(this.toString(),"wescheme-caseprimitive",this.name+", a function")};var Ga=function(b){this.args=b};Ga.prototype.toString=function(){var b=[],c;for(c=0;c<this.args.length;c++)b.push(""+this.args[c]);return b.join("")};
var ta=function(b,c){this.text=b;this.location=c};ta.prototype.toString=function(){return this.text+""};var sa=function(b){this.coloredParts=b};sa.prototype.toString=function(){var b,c=[];for(b=0;b<this.coloredParts.length;b++)c.push(this.coloredParts[b].text+"");return c.join("")};var xa=function(b,c,h){this.text=b;this.locations=c;this.solid=h};xa.prototype.toString=function(){return this.text};var Ea=function(b){return Vector.makeInstance(b.length,b)},za=Ea(["<no-location>",0,0,0,0]),Aa=q("posn",
!1,2,0,!1,!1),k=q("color",!1,4,0,!1,!1),ma=q("arity-at-least",!1,1,0,!1,function(b,c,h){helpers.check(void 0,c,function(b){return jsnums.isExact(b)&&jsnums.isInteger(b)&&jsnums.greaterThanOrEqual(b,0)},h,"exact non-negative integer",1);b(c)});types.symbol=T.makeInstance;types.rational=jsnums.makeRational;types["float"]=jsnums.makeFloat;types.complex=jsnums.makeComplex;types.bignum=jsnums.makeBignum;types.list=function(b){var c=Empty.EMPTY,h;for(h=b.length-1;0<=h;h--)c=Cons.makeInstance(b[h],c);return c};
types.vector=Ea;types["char"]=Char.makeInstance;types.string=function(b){if(b instanceof X)return b;if(b instanceof Array)return X.makeInstance(b);if("string"===typeof b)return X.fromString(b);throw types.internalError("makeString expects and array of 1-character strings or a string; given "+b.toString(),!1);};types.box=function(b){return new aa(b,!0)};types.boxImmutable=function(b){return new aa(b,!1)};types.pair=function(b,c){return Cons.makeInstance(b,c)};types.hash=function(b){for(var c=new B;!b.isEmpty();)c.hash.put(b.first().first(),
b.first().rest()),b=b.rest();return c};types.hashEq=function(b){for(var c=new G;!b.isEmpty();)c.hash.put(b.first().first(),b.first().rest()),b=b.rest();return c};types.jsObject=function(b,c){return new ha(b,c)};types.toWrittenString=K;types.toDisplayedString=function(b,c){c||(c=V());if("object"==typeof b){if(c.containsKey(b))return"...";c.put(b,!0)}if(void 0==b||null==b)return"#<undefined>";if("string"==typeof b)return b;if("object"!=typeof b&&"function"!=typeof b)return b.toString();var h="undefined"!==
typeof b.toDisplayedString?b.toDisplayedString(c):"undefined"!==typeof b.toWrittenString?b.toWrittenString(c):b.toString();c.remove(b);return h};types.toDomNode=W;types.posn=Aa.constructor;types.posnX=function(b){return Aa.accessor(b,0)};types.posnY=function(b){return Aa.accessor(b,1)};types.color=function(b,c,h,w){void 0===w&&(w=255);return k.constructor(b,c,h,w)};types.colorRed=function(b){return k.accessor(b,0)};types.colorGreen=function(b){return k.accessor(b,1)};types.colorBlue=function(b){return k.accessor(b,
2)};types.colorAlpha=function(b){return k.accessor(b,3)};types.arityAtLeast=ma.constructor;types.arityValue=function(b){return ma.accessor(b,0)};types.FALSE=Logic.FALSE;types.TRUE=Logic.TRUE;types.EMPTY=Empty.EMPTY;types.isEqual=ba;types.isNumber=qa;types.isSymbol=function(b){return b instanceof T};types.isChar=function(b){return b instanceof Char};types.isString=Z;types.isPair=function(b){return b instanceof Cons};types.isVector=function(b){return b instanceof Vector};types.isBox=function(b){return b instanceof
aa};types.isHash=function(b){return b instanceof G||b instanceof B};types.isStruct=function(b){return b instanceof C};types.isPosn=Aa.predicate;types.isArityAtLeast=ma.predicate;types.isColor=k.predicate;types.isFunction=function(b){return b instanceof O||b instanceof ka||b instanceof ua||b instanceof ia||b instanceof H};types.getProcedureType=function(b){return b instanceof O?"PrimProc":b instanceof ka?"CasePrimitive":b instanceof ua?"ClosureValue":b instanceof ia?"CaseLambdaValue":b instanceof H?
"ContinuationClosureValue":!1};types.isJsObject=function(b){return b instanceof ha};types.UnionFind=Q;types.cons=Cons.makeInstance;types.UNDEFINED=Y;types.VOID=N;types.EOF=M;types.ValuesWrapper=ra;types.ClosureValue=ua;types.ContinuationPrompt=h;types.defaultContinuationPrompt=w;types.ContinuationClosureValue=H;types.CaseLambdaValue=ia;types.PrimProc=O;types.CasePrimitive=ka;types.contMarkRecordControl=function(b){return new Fa(b)};types.isContMarkRecordControl=function(b){return b instanceof Fa};
types.continuationMarkSet=function(b){return new da(b)};types.isContinuationMarkSet=function(b){return b instanceof da};types.PrefixValue=D;types.GlobalBucket=fa;types.ModuleVariableRecord=function(b,c){this.resolvedModuleName=b;this.variableName=c};types.VariableReference=A;types.Box=aa;types.ThreadCell=function(b,c){this.v=b;this.isPreserved=c||!1};types.Class=m;types.makeStructureType=q;types.isStructType=function(b){return b instanceof StructType};types.makeLowLevelEqHash=V;var va=function(b,
c){this.val=b;this.contMarks=c?c:!1};types.internalError=function(b,c){return new va(b,c)};types.isInternalError=function(b){return b instanceof va};var I=function(b){this.val=b};types.schemeError=function(b){return new I(b)};types.isSchemeError=function(b){return b instanceof I};var Pa=function(b,c,h){this.constructor=b;this.msg=c;this.otherArgs=h};types.incompleteExn=function(b,c,h){return new Pa(b,c,h)};types.isIncompleteExn=function(b){return b instanceof Pa};var J=q("exn",!1,2,0,!1,function(b,
c,h,k){helpers.check(void 0,h,types.isContinuationMarkSet,k,"continuation mark set",2);b(new ra([c,h]))});types.exn=J.constructor;types.isExn=J.predicate;types.exnMessage=function(b){return J.accessor(b,0)};types.exnContMarks=function(b){return J.accessor(b,1)};types.exnSetContMarks=function(b,c){J.mutator(b,1,c)};var Ca=q("exn:break",J,1,0,!1,function(b,c,h,k,w){b(new ra([c,h,k]))});types.exnBreak=Ca.constructor;types.isExnBreak=Ca.predicate;types.exnBreakContinuation=function(b){return Ca.accessor(b,
0)};m=q("exn:fail",J,0,0,!1,!1);types.exnFail=m.constructor;types.isExnFail=m.predicate;Y=q("exn:fail:contract",m,0,0,!1,!1);types.exnFailContract=Y.constructor;types.isExnFailContract=Y.predicate;m=q("exn:fail:contract:arity",Y,0,0,!1,!1);types.exnFailContractArity=Y.constructor;types.isExnFailContractArity=Y.predicate;var Da=q("exn:fail:contract:variable",Y,1,0,!1,!1);types.exnFailContractVariable=Y.constructor;types.isExnFailContractVariable=Y.predicate;types.exnFailContractVariableId=function(b){return Da.accessor(b,
0)};Y=q("exn:fail:contract:division-by-zero",Y,0,0,!1,!1);types.exnFailContractDivisionByZero=Y.constructor;types.isExnFailContractDivisionByZero=Y.predicate;var $a=q("exn:fail:contract:arity:position",m,1,0,!1,!1);types.exnFailContractArityWithPosition=$a.constructor;types.isExnFailContractArityWithPosition=$a.predicate;types.exnFailContractArityWithPositionLocations=function(b){return $a.accessor(b,0)};types.worldConfig=function(b,c,h){return new ea(b,c,h)};types.isWorldConfig=function(b){return b instanceof
ea};types.makeEffectType=function(b,c,h,k,w,e){c||(c=Ba);b=q(b,c,h,0,!1,w);var m=b.firstField+b.numberOfFields;b.type.prototype.invokeEffect=function(b,c){var h=new O("update-world",1,!1,!0,function(c,h){helpers.check(c,h,helpers.procArityContains(1),"update-world","procedure (arity 1)",1);b(function(b,k){interpret.call(c,h,[b],k,function(b){throw b;})},function(){c.v=N})}),w=this._fields.slice(0,m);w.unshift(h);e(k,w,c)};return b};types.isEffectType=function(b){return b instanceof StructType&&b.type.prototype.invokeEffect?
!0:!1};types.isEffect=Ba.predicate;types.makeRenderEffectType=function(b,c,h,k,w){c||(c=ca);b=q(b,c,h,0,!1,w);var e=b.firstField+b.numberOfFields;b.type.prototype.callImplementation=function(b,c){var h=this._fields.slice(0,e);b(k,h,c)};return b};types.isRenderEffectType=function(b){return b instanceof StructType&&b.type.prototype.callImplementation?!0:!1};types.isRenderEffect=ca.predicate;types.NoLocation=za;types.isNoLocation=function(b){return b===za};types.ColoredPart=ta;types.Message=Ga;types.isColoredPart=
function(b){return b instanceof ta};types.isMessage=function(b){return b instanceof Ga};types.GradientPart=sa;types.isGradientPart=function(b){return b instanceof sa};types.MultiPart=xa;types.isMultiPart=function(b){return b instanceof xa}})();var state={};
(function(){var e=function(b){sys.print(types.toWrittenString(b)+"\n")},u=function(){throw Error("There is a software configuration error by the system's maintainer: the toplevel node has not been initialized yet.");},y=function(b,c,e){e(b+" not known")},b=function(){this.v=[];this.vstack=[];this.cstack=[];this.heap={};this.globals={};this.hooks={printHook:e,displayHook:e,toplevelNodeHook:u,imageProxyHook:!1,dynamicModuleLoader:y};this.invokedModules={};this.breakRequested=!1;this.breakRequestedListeners=
[]};b.prototype.clearForEval=function(b){this.v=[];this.vstack=[];this.cstack=[];b&&b.preserveBreak||(this.breakRequested=!1,this.breakRequestedListeners=[]);b&&b.clearGlobals&&(this.globals={})};b.prototype.save=function(){return{v:this.v,vstack:this.vstack.slice(0),cstack:this.cstack.slice(0),heap:this.heap,globals:v(this.globals),hooks:this.hooks,breakRequested:this.breakRequested,breakRequestedListeners:v(this.breakRequestedListeners),invokedModules:this.invokedModules}};var c={}.hasOwnProperty,
v=function(b){var e={},q;for(q in b)c.call(b,q)&&(e[q]=b[q]);return e};b.prototype.restore=function(b){this.v=b.v;this.vstack=b.vstack;this.cstack=b.cstack;this.heap=b.heap;this.globals=b.globals;this.hooks=b.hooks;this.breakRequestListeners=b.breakRequestListeners;this.invokedModules=b.invokedModules};b.prototype.requestBreak=function(){this.breakRequested=!0;for(var b=0;b<this.breakRequestedListeners.length;b++)try{this.breakRequestedListeners[b]()}catch(C){helpers.reportError(C)}};b.prototype.addBreakRequestedListener=
function(b){this.breakRequestedListeners.push(b)};b.prototype.removeBreakRequestedListener=function(b){for(var c=this.breakRequestedListeners.length-1;0<=c;c--)this.breakRequestedListeners[c]===b&&this.breakRequestedListeners.splice(c,1)};b.prototype.pushControl=function(b){this.cstack.push(b)};b.prototype.pushManyControls=function(b){for(var c=0;c<b.length;c++)this.cstack.push(b[b.length-1-c])};b.prototype.isStuck=function(){return 0===this.cstack.length};b.prototype.popControl=function(){if(0===
this.cstack.length)throw types.internalError("cstack empty",Q(this));return this.cstack.pop()};b.prototype.pushValue=function(b){this.vstack.push(b)};b.prototype.popValue=function(){if(0===this.vstack.length)throw types.internalError("vstack empty",Q(this));return this.vstack.pop()};b.prototype.pushn=function(b){for(var c=0;c<b;c++)this.vstack.push(types.UNDEFINED)};b.prototype.popn=function(b){for(var c=[],e=0;e<b;e++){if(0===this.vstack.length)throw types.internalError("vstack empty",Q(this));c.push(this.vstack.pop())}return c};
b.prototype.peekn=function(b){if(0>this.vstack.length-1-(b||0))throw types.internalError("vstack not long enough",Q(this));return this.vstack[this.vstack.length-1-(b||0)]};b.prototype.setn=function(b,c){this.vstack[this.vstack.length-1-(b||0)]=c};b.prototype.refPrefix=function(b,c,e){b=this.vstack[this.vstack.length-1-b].ref(c,e);if(b instanceof types.ModuleVariableRecord&&this.invokedModules[b.resolvedModuleName]){c=this.invokedModules[b.resolvedModuleName];if("undefined"!==typeof c.providedValues[b.variableName])return c.providedValues[b.variableName];
throw types.schemeError(types.exnFailContractVariable("reference to an identifier before its definition: "+b.variableName,!1,b.variableName));}return b};b.prototype.setPrefix=function(b,c,e){this.vstack[this.vstack.length-1-b].set(c,e)};b.prototype.setPrintHook=function(b){this.hooks.printHook=b};b.prototype.getPrintHook=function(){return this.hooks.printHook};b.prototype.setDisplayHook=function(b){this.hooks.displayHook=b};b.prototype.setImageProxyHook=function(b){this.hooks.imageProxyHook=b};b.prototype.getImageProxyHook=
function(){return this.hooks.imageProxyHook};b.prototype.getDisplayHook=function(){return this.hooks.displayHook};b.prototype.getToplevelNodeHook=function(){return this.hooks.toplevelNodeHook};b.prototype.setToplevelNodeHook=function(b){this.hooks.toplevelNodeHook=b};var Q=function(b){for(var c=types.makeLowLevelEqHash(),e=0;e<b.cstack.length;e++)if(types.isContMarkRecordControl(b.cstack[e])){var m=b.cstack[e].dict,v;for(v in m)c.put(v,[m[v]]),c.get(v).push(m[v])}return types.continuationMarkSet(c)},
m=function(b,e){for(var m in b)if(c.call(b,m))if(c.call(e,m)){if(b[m]!==e[m])return!1}else return!1;for(m in e)if(c.call(e,m))if(c.call(b,m)){if(b[m]!==e[m])return!1}else return!1;return!0};state.State=b;state.isState=function(c){return c instanceof b};state.captureCurrentContinuationMarks=Q;state.getStackTraceFromContinuationMarks=function(b){var c=[];b=b.ref("moby-stack-record-continuation-mark-key");for(var e=b.length-1;0<=e;e--){var v=b[e],q=v.ref(0),y=v.ref(1),u=v.ref(2),Q=v.ref(3);v=v.ref(4);
q={id:q,offset:y,line:u,column:Q,span:v};0!==c.length&&m(c[c.length-1],q)||c.push(q)}return c}})();"undefined"===typeof world&&(world={});
(function(e){var u=function(e,C){var q=e[0],G=e[1],B=e[2],u=e[3];q=b(q,G,B,u,C[0],7,-680876936);u=b(u,q,G,B,C[1],12,-389564586);B=b(B,u,q,G,C[2],17,606105819);G=b(G,B,u,q,C[3],22,-1044525330);q=b(q,G,B,u,C[4],7,-176418897);u=b(u,q,G,B,C[5],12,1200080426);B=b(B,u,q,G,C[6],17,-1473231341);G=b(G,B,u,q,C[7],22,-45705983);q=b(q,G,B,u,C[8],7,1770035416);u=b(u,q,G,B,C[9],12,-1958414417);B=b(B,u,q,G,C[10],17,-42063);G=b(G,B,u,q,C[11],22,-1990404162);q=b(q,G,B,u,C[12],7,1804603682);u=b(u,q,G,B,C[13],12,-40341101);
B=b(B,u,q,G,C[14],17,-1502002290);G=b(G,B,u,q,C[15],22,1236535329);q=c(q,G,B,u,C[1],5,-165796510);u=c(u,q,G,B,C[6],9,-1069501632);B=c(B,u,q,G,C[11],14,643717713);G=c(G,B,u,q,C[0],20,-373897302);q=c(q,G,B,u,C[5],5,-701558691);u=c(u,q,G,B,C[10],9,38016083);B=c(B,u,q,G,C[15],14,-660478335);G=c(G,B,u,q,C[4],20,-405537848);q=c(q,G,B,u,C[9],5,568446438);u=c(u,q,G,B,C[14],9,-1019803690);B=c(B,u,q,G,C[3],14,-187363961);G=c(G,B,u,q,C[8],20,1163531501);q=c(q,G,B,u,C[13],5,-1444681467);u=c(u,q,G,B,C[2],9,-51403784);
B=c(B,u,q,G,C[7],14,1735328473);G=c(G,B,u,q,C[12],20,-1926607734);q=y(G^B^u,q,G,C[5],4,-378558);u=y(q^G^B,u,q,C[8],11,-2022574463);B=y(u^q^G,B,u,C[11],16,1839030562);G=y(B^u^q,G,B,C[14],23,-35309556);q=y(G^B^u,q,G,C[1],4,-1530992060);u=y(q^G^B,u,q,C[4],11,1272893353);B=y(u^q^G,B,u,C[7],16,-155497632);G=y(B^u^q,G,B,C[10],23,-1094730640);q=y(G^B^u,q,G,C[13],4,681279174);u=y(q^G^B,u,q,C[0],11,-358537222);B=y(u^q^G,B,u,C[3],16,-722521979);G=y(B^u^q,G,B,C[6],23,76029189);q=y(G^B^u,q,G,C[9],4,-640364487);
u=y(q^G^B,u,q,C[12],11,-421815835);B=y(u^q^G,B,u,C[15],16,530742520);G=y(B^u^q,G,B,C[2],23,-995338651);q=v(q,G,B,u,C[0],6,-198630844);u=v(u,q,G,B,C[7],10,1126891415);B=v(B,u,q,G,C[14],15,-1416354905);G=v(G,B,u,q,C[5],21,-57434055);q=v(q,G,B,u,C[12],6,1700485571);u=v(u,q,G,B,C[3],10,-1894986606);B=v(B,u,q,G,C[10],15,-1051523);G=v(G,B,u,q,C[1],21,-2054922799);q=v(q,G,B,u,C[8],6,1873313359);u=v(u,q,G,B,C[15],10,-30611744);B=v(B,u,q,G,C[6],15,-1560198380);G=v(G,B,u,q,C[13],21,1309151649);q=v(q,G,B,u,
C[4],6,-145523070);u=v(u,q,G,B,C[11],10,-1120210379);B=v(B,u,q,G,C[2],15,718787259);G=v(G,B,u,q,C[9],21,-343485551);e[0]=m(q,e[0]);e[1]=m(G,e[1]);e[2]=m(B,e[2]);e[3]=m(u,e[3])},y=function(b,c,e,v,u,y){c=m(m(c,b),m(v,y));return m(c<<u|c>>>32-u,e)},b=function(b,c,e,m,v,u,Q){return y(c&e|~c&m,b,c,v,u,Q)},c=function(b,c,e,m,v,u,Q){return y(c&m|e&~m,b,c,v,u,Q)},v=function(b,c,e,m,v,u,Q){return y(e^(c|~m),b,c,v,u,Q)},Q="0123456789abcdef".split(""),m=function(b,c){return b+c&4294967295};"5d41402abc4b2a76b9719d911017c592"!=
(e.md5=function(b){var c=b,e=c.length;b=[1732584193,-271733879,-1732584194,271733878];var m;for(m=64;m<=c.length;m+=64){var q,v=c.substring(m-64,m),y=[];for(q=0;64>q;q+=4)y[q>>2]=v.charCodeAt(q)+(v.charCodeAt(q+1)<<8)+(v.charCodeAt(q+2)<<16)+(v.charCodeAt(q+3)<<24);u(b,y)}c=c.substring(m-64);q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(m=0;m<c.length;m++)q[m>>2]|=c.charCodeAt(m)<<(m%4<<3);q[m>>2]|=128<<(m%4<<3);if(55<m)for(u(b,q),m=0;16>m;m++)q[m]=0;q[14]=8*e;u(b,q);for(c=0;c<b.length;c++){e=b;m=c;q=b[c];
v="";for(y=0;4>y;y++)v+=Q[q>>8*y+4&15]+Q[q>>8*y&15];e[m]=v}return b.join("")})("hello")&&(m=function(b,c){var e=(b&65535)+(c&65535);return(b>>16)+(c>>16)+(e>>16)<<16|e&65535})})(world);"undefined"===typeof world&&(world={});
(function(){world.config={};var e=function(){this.vals={changeWorld:!1,shutdownWorld:!1,initialEffect:!1,onRedraw:!1,onDraw:!1,onDrawCss:!1,tickDelay:!1,onTick:!1,onTickEffect:!1,onKey:!1,onKeyEffect:!1,onMouse:!1,onTilt:!1,onTiltEffect:!1,onTap:!1,onTapEffect:!1,onAcceleration:!1,onAccelerationEffect:!1,onShake:!1,onShakeEffect:!1,onSmsReceive:!1,onSmsReceiveEffect:!1,onLocationChange:!1,onLocationChangeEffect:!1,onAnnounce:!1,onAnnounceEffect:!1,stopWhen:!1,stopWhenEffect:!1,connectToGame:!1,onGameStart:!1,
onOpponentTurn:!1,onMyTurn:!1,afterMyTurn:!1,onGameFinish:!1}};e.prototype.lookup=function(e){if(e in this.vals)return this.vals[e];throw Error("Can't find "+e+" in the configuration");};e.prototype.updateAll=function(u){var y=new e,b=this.vals,c={},v;for(v in b)Object.hasOwnProperty.call(b,v)&&(c[v]=b[v]);for(v in u)Object.hasOwnProperty.call(u,v)&&(c[v]=u[v]);y.vals=c;return y};world.config.WorldConfig=e;world.config.CONFIG=new e;world.config.Kernel=world.config.Kernel||{};world.config.Kernel.getNoneEffect=
function(){throw Error("getNoneEffect: We should not be calling effects!");}})();
(function(){world.stimuli={};var e=[],u=function(){},y=function(b,c,m){this.config=b;this.caller=c;this.restarter=m;e.push(this)};y.prototype.doStimuli=function(b,c,e,q){var m=this;try{m.change(function(b,q){var v=[b].concat(e);c?m.caller(c,v,q):q(b)},q)}catch(V){this.onShutdown()}};y.prototype.onTilt=function(c,e){var m=this.lookup("onTilt"),q=this.lookup("onTiltEffect");this.doStimuli(q,m,helpers.map(b,c),e)};y.prototype.onAcceleration=function(c,e){var m=this.lookup("onAcceleration"),q=this.lookup("onAccelerationEffect");
this.doStimuli(q,m,helpers.map(b,c),e)};y.prototype.onShake=function(b,c){b=this.lookup("onShake");var e=this.lookup("onShakeEffect");this.doStimuli(e,b,[],c)};y.prototype.onSmsReceive=function(b,c){var e=this.lookup("onSmsReceive"),q=this.lookup("onSmsReceiveEffect");this.doStimuli(q,e,[b[0]+"",b[1]+""],c)};y.prototype.onLocation=function(c,e){var m=this.lookup("onLocationChange"),q=this.lookup("onLocationChangeEffect");this.doStimuli(q,m,helpers.map(b,c),e)};y.prototype.onKey=function(b,c){b=helpers.getKeyCodeName(b[0]);
var e=this.lookup("onKey"),q=this.lookup("onKeyEffect");this.doStimuli(q,e,[b],c)};y.prototype.onAnnounce=function(b,c){for(var e=b[1],q=types.EMPTY,v=0;v<e.length;v++)q=types.cons(e[e.length-v-1],q);e=this.lookup("onAnnounce");v=this.lookup("onAnnounceEffect");this.doStimuli(e,v,[b[0],q],c)};y.prototype.onShutdown=function(){var b=e.indexOf(this);-1!=b&&e.splice(b,1);(b=this.lookup("shutdownWorld"))&&b()};var b=types["float"];y.prototype.lookup=function(b){return this.config.lookup(b)};y.prototype.change=
function(b,c){this.lookup("changeWorld")?this.lookup("changeWorld")(b,c):c()};var c=function(b){return function(){for(var c=arguments,m=0;m<e.length;m++)e[m][b](c,u)}};world.stimuli.StimuliHandler=y;world.stimuli.onTilt=c("onTilt");world.stimuli.onAcceleration=c("onAcceleration");world.stimuli.onShake=c("onShake");world.stimuli.onSmsReceive=c("onSmsReceive");world.stimuli.onLocation=c("onLocation");world.stimuli.onKey=c("onKey");world.stimuli.onAnnounce=c("onAnnounce");world.stimuli.massShutdown=
function(){for(var b=0;b<e.length;b++){var c=e[b].lookup("shutdownWorld");c&&c()}e=[]}})();"undefined"===typeof world&&(world={});
(function(){function e(){setTimeout(e,X);if(myEditor.getScreenreader()){var b=[];for(m in U)U.hasOwnProperty(m)&&!U[m].labeled&&b.push(U[m]);if(0!==b.length){var c=[];b.forEach(function(b){c.push({image:{source:{imageUri:b.originalURI}},features:[{type:"LABEL_DETECTION",maxResults:10}]})});var m=JSON.stringify({requests:c});try{var q=new XMLHttpRequest;q.onload=function(){var c=JSON.parse(this.responseText);if(c.responses)console.log("successful load from VisionAPI. set timeout to ",X,"ms"),X=5E3;
else throw X*=2,console.log("no response from VisionAPI. set timeout to ",X,"ms"),"No response from Google Vision API";c.responses.forEach(function(c,h){c.labelAnnotations.sort(function(b,c){return b.confidence<c.confidence?1:-1});var e=c.labelAnnotations[0].description;U[b[h].originalURI].labeled=!0;U[b[h].originalURI].getAriaText=function(){" a picture of a "+e}});console.log("after load(), timeout is",X)};q.onerror=function(){console.log("Google VisionAPI post() failure")};q.open("POST","https://vision.googleapis.com/v1/images:annotate?key="+
plt.config.API_KEY);q.setRequestHeader("content-type","application/json");q.send(m)}catch(Ga){console.log("Setting up XHR for Google Vision API failed",Ga),X*=2}}}}function u(b){b=b.replace(/^\s*/,"");return(b.match(/^[aeiouAEIOU]/)?" an ":" a ")+b}function y(c,e){if(0===e)return" transparent ";var h=b(types.colorRed(c),types.colorGreen(c),types.colorBlue(c));c=world.Kernel.colorLabs.map(function(b){return{l:b.l,a:b.a,b:b.b,name:b.name,d:Math.sqrt(Math.pow(h.l-b.l,2)+Math.pow(h.a-b.a,2)+Math.pow(h.b-
b.b,2))}});c=c.sort(function(b,c){return b.d<c.d?-1:b.d>c.d?1:0});c=c[0].name;return(""==e||isNaN(e)?e=" "+e:" translucent ")+" "+c.toLowerCase()}function b(b,c,e){b=function(b,c,h){function e(b){b=parseFloat(b/255);return 100*(.04045<b?Math.pow((b+.055)/1.055,2.4):b/12.92)}b=e(b);c=e(c);h=e(h);return[.4124*b+.3576*c+.1805*h,.2126*b+.7152*c+.0722*h,.0193*b+.1192*c+.9505*h]}(b,c,e);b=function(b,c,h){function e(b){return.008856<b?Math.pow(b,1/3):7.787*b+16/116}c/=100;h/=108.883;b=e(b/95.047);c=e(c);
h=e(h);return[116*c-16,500*(b-c),200*(c-h)]}(b[0],b[1],b[2]);return{l:b[0],a:b[1],b:b[2]}}world.Kernel={};var c=[],v=function(b){var c=function(){};c.prototype=b;return new c},Q=[];world.Kernel.addAnnounceListener=function(b){Q.push(b)};world.Kernel.removeAnnounceListener=function(b){b=Q.indexOf(b);-1!==b&&Q.splice(b,1)};world.Kernel.announce=function(b,c){var h;for(h=0;h<Q.length;h++)try{Q[h](b,c)}catch(ka){}};world.Kernel.updateWorld=function(b){world=b(world);for(b=0;b<c.length;b++)c[b](world)};
world.Kernel.shutdownWorld=function(){};var m=function(b,c){if(b.length!==c.length)return!1;b=b.map(function(b){return"x:"+b.x+",y:"+b.y}).join(",");c=c.map(function(b){return"x:"+b.x+",y:"+b.y}).join(",");return(b+","+b).includes(c)},q=function(b){return{xs:b.map(function(b){return b.x}),ys:b.map(function(b){return b.y})}},C=function(b){b=q(b).xs;return Math.max.apply(Math,b)-Math.min.apply(Math,b)},V=function(b){b=q(b).ys;return Math.max.apply(Math,b)-Math.min.apply(Math,b)},G=function(b){var c=
q(b),h=-Math.min.apply(Math,c.xs),e=-Math.min.apply(Math,c.ys);return b.map(function(b){return{x:b.x+h,y:b.y+e}})},B=function(){};world.Kernel.BaseImage=B;B.prototype.getHeight=function(){return Math.round(this.height)};B.prototype.getWidth=function(){return Math.round(this.width)};B.prototype.getBaseline=function(){return Math.round(this.height)};B.prototype.getVertices=function(){return this.vertices?this.vertices:[{x:0,y:0},{x:this.width,y:0},{x:0,y:this.height},{x:this.width,y:this.height}]};
B.prototype.render=function(b,c,e){if(!this.vertices)throw Error("BaseImage.render is not implemented for this type!");b.save();b.beginPath();var h="outline"!==this.style.toString().toLowerCase();if(b.isEqualityTest||h)var w=this.vertices;else{var m=C(this.vertices)/2,q=V(this.vertices)/2;w=this.vertices.map(function(b){return{x:b.x+(b.x<m?.5:-.5),y:b.y+(b.y<q?.5:-.5)}})}b.moveTo(c+w[0].x,e+w[0].y);w.forEach(function(h){b.lineTo(c+h.x,e+h.y)});b.closePath();h?(b.fillStyle=ba(this.color,this.style),
b.fill()):(b.strokeStyle=ba(this.color),b.stroke());b.restore()};world.Kernel.makeCanvas=makeCanvas=function(b,c){var h=document.createElement("canvas");h.width=b;h.height=c;h.style.width=h.width+"px";h.style.height=h.height+"px";return h};B.prototype.toDomNode=function(b){var c=this;b=c.getWidth();var h=c.getHeight(),e=world.Kernel.makeCanvas(b,h),m;e.afterAttach=function(){m=e.getContext("2d");c.render(m,0,0)};e.ariaText=this.getAriaText(B.ariaNestingDepth);return e};B.ariaNestingDepth=6;B.prototype.toWrittenString=
function(b){return"<image>"};B.prototype.toDisplayedString=this.toWrittenString;B.prototype.getAriaText=function(b){return"image"};B.prototype.isEqual=function(b,c){if(!(b instanceof B)||this.getWidth()!==b.getWidth()||this.getHeight()!==b.getHeight())return!1;if(this.vertices&&b.vertices&&this.style===b.style&&types.isEqual(this.color,b.color,c)&&m(this.vertices,b.vertices))return console.log("Using fast path for image equality check"),!0;console.log("Using slow path for image equality check");c=
this.toDomNode();var h=b.toDomNode();c.style.visibility=h.style.visibility="hidden";if(c.width!==h.width||c.height!==h.height)return!1;try{var e=c.getContext("2d"),w=h.getContext("2d");e.isEqualityTest=!0;w.isEqualityTest=!0;this.render(e,0,0);b.render(w,0,0);var q=document.createElement("canvas").getContext("2d"),v=document.createElement("canvas").getContext("2d"),u=Math.min(1E4,c.width),y=Math.min(1E4,c.height);for(b=0;b<c.height;b+=y)for(e=0;e<c.width;e+=u){u=Math.min(u,c.width-e);y=Math.min(y,
c.height-b);q.canvas.width=v.canvas.width=u;q.canvas.height=v.canvas.height=y;console.log("processing chunk from ("+e+","+b+") to ("+(e+u)+","+(b+y)+")");q.clearRect(0,0,u,y);q.drawImage(c,e,b,u,y,0,0,u,y);v.clearRect(0,0,u,y);v.drawImage(h,e,b,u,y,0,0,u,y);var A=q.canvas.toDataURL(),C=v.canvas.toDataURL(),k=world.md5(A),ma=world.md5(C);if(k!==ma)return!1}}catch(va){return console.log("Couldn't compare images:",va),!1}return!0};var aa=function(b,c,e,m,q){this.width=b;this.height=c;this.children=e;
this.withBorder=m;this.color=q};aa.prototype=v(B.prototype);aa.prototype.add=function(b,c,e){return new aa(this.width,this.height,this.children.concat([[b,c-b.getWidth()/2,e-b.getHeight()/2]]),this.withBorder,this.color)};aa.prototype.getAriaText=function(b){if(0>=b)return"scene image";var c=" a Scene that is "+this.width+" by "+this.height+". children are: ";return c+=this.children.map(function(c,h){return"child "+(h+1)+": "+c[0].getAriaText(b-1)+", positioned at "+c[1]+","+c[2]+" "}).join(". ")};
aa.prototype.render=function(b,c,e){var h,w,m;b.save();b.fillStyle=this.color?ba(this.color):"transparent";b.fillRect(c,e,this.width,this.height);b.restore();b.save();b.beginPath();b.rect(c,e,this.width,this.height);b.clip();this.children.forEach(function(q){h=q[0];w=q[1];m=q[2];h.render(b,w+c,m+e)});b.restore();this.withBorder&&(b.strokeStyle="black",b.strokeRect(c,e,this.width,this.height))};aa.prototype.isEqual=function(b,c){return b instanceof aa&&this.width==b.width&&this.height==b.height&&this.children.length==
b.children.length&&this.children.every(function(h,e){e=b.children[e];return h[1]==e[1]&&h[2]==e[2]&&types.isEqual(h[0],e[0],c)})||B.prototype.isEqual.call(this,b,c)};var T=function(b,c,e){function h(){w.isLoaded=!0;w.width=w.img.width;w.height=w.img.height}var w=this;this.src=b;this.isLoaded=!1;this.originalURI=decodeURIComponent(b).slice(16);this.labeled=!1;this.animationHackImg=void 0;c&&c.complete?(w.img=c,h()):(w.img=new Image,w.img.onload=h,w.img.onerror=function(b){w.img.onerror="";w.img.src=
"http://www.wescheme.org/images/broken.png"},w.img.src=b);this.installHackToSupportAnimatedGifs(e)};T.prototype=v(B.prototype);T.prototype.getAriaText=function(b){return U&&U[this.originalURI]&&U[this.originalURI].labeled?U[this.originalURI].getAriaText():" an image file from "+this.originalURI};var U={},X=5E3;window.myEditor&&setTimeout(e,X);T.makeInstance=function(b,c,e){var h=decodeURIComponent(b).slice(16);h in U?e(U[h]):U[h]=new T(b,c,e);return U[h]};T.prototype.render=function(b,c,e){b.drawImage(this.animationHackImg,
c,e);setTimeout(function(){},5E3)};T.prototype.installHackToSupportAnimatedGifs=function(b){var c=this;this.animationHackImg=this.img.cloneNode(!0);document.body.appendChild(this.animationHackImg);this.animationHackImg.style.position="absolute";this.animationHackImg.style.top="-50000px";this.animationHackImg.complete?b(c):this.animationHackImg.onload=function(){b(c)}};T.prototype.getWidth=function(){return Math.round(this.img.width)};T.prototype.getHeight=function(){return Math.round(this.img.height)};
T.prototype.isEqual=function(b,c){return b instanceof T&&this.src===b.src||B.prototype.isEqual.call(this,b,c)};var na=function(b,c){var h=this;this.src=b;c?(this.video=c,this.width=h.video.videoWidth,this.height=h.video.videoHeight,this.video.volume=1,this.video.poster="http://www.wescheme.org/images/broken.png",this.video.autoplay=!0,this.video.autobuffer=!0,this.video.loop=!0,this.video.play()):(this.video=document.createElement("video"),this.video.src=b,this.video.addEventListener("canplay",function(){this.width=
h.video.videoWidth;this.height=h.video.videoHeight;this.video.poster="http://www.wescheme.org/images/broken.png";this.video.autoplay=!0;this.video.autobuffer=!0;this.video.loop=!0;this.video.play()}),this.video.addEventListener("error",function(b){h.video.onerror="";h.video.poster="http://www.wescheme.org/images/broken.png"}))};na.prototype=v(B.prototype);na.prototype.getAriaText=function(b){return" a video file from "+decodeURIComponent(this.src).slice(16)};var ha={};na.makeInstance=function(b,c){b in
na||(ha[b]=new na(b,c));return ha[b]};na.prototype.render=function(b,c,e){b.drawImage(this.video,c,e)};na.prototype.isEqual=function(b,c){return b instanceof na&&this.src===b.src||B.prototype.isEqual.call(this,b,c)};var ea=function(b,c,e){this.src=b;var h=this;e&&4===e.readyState?(h.audio=e,h.audio.autoplay=!0,h.audio.autobuffer=!0,h.audio.currentTime=0,h.audio.loop=c,h.audio.play()):(h.audio=document.createElement("audio"),h.audio.src=b,h.audio.addEventListener("canplay",function(){h.audio.autoplay=
!0;h.audio.autobuffer=!0;h.audio.currentTime=0;h.audio.loop=c;h.audio.play()}));return!0},Ba={};ea.makeInstance=function(b,c,e){b in Ba?(Ba[b].audio.play(),afterInit(Ba[b])):Ba[b]=new ea(b,c,e,afterInit);return Ba[b]};var ca=function(b){this.imageData=b;this.width=b.width;this.height=b.height};ca.prototype=v(B.prototype);ca.prototype.render=function(b,c,e){b.putImageData(this.imageData,c,e)};var K=function(b,c,e,m){var h,w;if("left"===e)var q=h=0;else"right"===e?(h=Math.max(b.width,c.width)-b.width,
q=Math.max(b.width,c.width)-c.width):"beside"===e?(h=0,q=b.width):"middle"===e||"center"===e?(h=Math.max(b.width,c.width)/2-b.width/2,q=Math.max(b.width,c.width)/2-c.width/2):(h=Math.max(e,0)-e,q=Math.max(e,0));if("top"===m)var v=w=0;else"bottom"===m?(w=Math.max(b.height,c.height)-b.height,v=Math.max(b.height,c.height)-c.height):"above"===m?(w=0,v=b.height):"baseline"===m?(w=Math.max(b.getBaseline(),c.getBaseline())-b.getBaseline(),v=Math.max(b.getBaseline(),c.getBaseline())-c.getBaseline()):"middle"===
m||"center"===m?(w=Math.max(b.height,c.height)/2-b.height/2,v=Math.max(b.height,c.height)/2-c.height/2):(w=Math.max(m,0)-m,v=Math.max(m,0));var u=b.getVertices(),y=c.getVertices();u=u.map(function(b){return{x:b.x+h,y:b.y+w}});y=y.map(function(b){return{x:b.x+q,y:b.y+v}});this._vertices=u.concat(y);this.x1=h;this.y1=w;this.x2=q;this.y2=v;this.img1=b;this.img2=c;var A;-1<["middle","center"].indexOf(e)&&-1<["middle","center"].indexOf(m)?A=" centered ":"left"===e?A=" left-aligned ":"right"===e?A=" right-aligned ":
"beside"===e?A=" beside ":isNaN(e)||(A=" shifted left by "+e);"top"===m?A+=" top-aligned ":"bottom"===m?A+=" bottom-aligned ":"above"===m?A+=" above ":isNaN(m)||(A+=" , shifted up by "+m);this.width=C(this._vertices);this.height=V(this._vertices);this.positionText=A};K.prototype=v(B.prototype);K.prototype.getAriaText=function(b){return 0>=b?"overlay image":" an overlay: "+this.img1.getAriaText(b-1)+this.positionText+" above "+this.img2.getAriaText(b-1)};K.prototype.getVertices=function(){return this._vertices};
K.prototype.render=function(b,c,e){b.save();this.img2.render(b,c+this.x2,e+this.y2);this.img1.render(b,c+this.x1,e+this.y1);b.restore()};K.prototype.isEqual=function(b,c){return b instanceof K&&this.width===b.width&&this.height===b.height&&this.x1===b.x1&&this.y1===b.y1&&this.x2===b.x2&&this.y2===b.y2&&types.isEqual(this.img1,b.img1,c)&&types.isEqual(this.img2,b.img2,c)||B.prototype.isEqual.call(this,b,c)};var W=function(b,c){c instanceof D&&c.width==c.height&&(b=0);var h=Math.sin(b*Math.PI/180),
e=Math.cos(b*Math.PI/180),w=c.getVertices().map(function(b){return{x:b.x*e-b.y*h,y:b.x*h+b.y*e}}),m=q(w);this._vertices=G(w);this.img=c;this.width=C(w);this.height=V(w);this.angle=Math.round(b);this.translateX=-Math.min.apply(Math,m.xs);this.translateY=-Math.min.apply(Math,m.ys)};W.prototype=v(B.prototype);W.prototype.getAriaText=function(b){return 0>=b?"rotated image":"Rotated image, "+-1*this.angle+" degrees: "+this.img.getAriaText(b-1)};W.prototype.getVertices=function(){return this._vertices};
W.prototype.render=function(b,c,e){b.save();b.translate(c+this.translateX,e+this.translateY);b.rotate(this.angle*Math.PI/180);this.img.render(b,0,0);b.restore()};W.prototype.isEqual=function(b,c){return b instanceof W&&this.width===b.width&&this.height===b.height&&this.angle===b.angle&&this.translateX===b.translateX&&this.translateY===b.translateY&&types.isEqual(this.img,b.img,c)||B.prototype.isEqual.call(this,b,c)};var pa=function(b,c,e){this._vertices=e.getVertices().map(function(h){return{x:h.x*
b,y:h.y*c}});this.img=e;this.width=e.width*b;this.height=e.height*c;this.xFactor=b;this.yFactor=c};pa.prototype=v(B.prototype);pa.prototype.getAriaText=function(b){return 0>=b?"scaled image":"Scaled Image, "+(this.xFactor===this.yFactor?"by "+this.xFactor:"horizontally by "+this.xFactor+" and vertically by "+this.yFactor)+". "+this.img.getAriaText(b-1)};pa.prototype.getVertices=function(){return this._vertices};pa.prototype.render=function(b,c,e){b.save();b.scale(this.xFactor,this.yFactor);this.img.render(b,
c/this.xFactor,e/this.yFactor);b.restore()};pa.prototype.isEqual=function(b,c){return b instanceof pa&&this.width===b.width&&this.height===b.height&&this.xFactor===b.xFactor&&this.yFactor===b.yFactor&&types.isEqual(this.img,b.img,c)||B.prototype.isEqual.call(this,b,c)};var la=function(b,c,e,m,q){this.x=b;this.y=c;this.width=e;this.height=m;this.img=q};la.prototype=v(B.prototype);la.prototype.getAriaText=function(b){return 0>=b?"cropped image":"Cropped image, from "+this.x+", "+this.y+" to "+(this.x+
this.width)+", "+(this.y+this.height)+": "+this.img.getAriaText(b-1)};la.prototype.render=function(b,c,e){b.save();b.beginPath();b.rect(c,e,this.width,this.height);b.clip();b.translate(-this.x,-this.y);this.img.render(b,c,e);b.restore()};la.prototype.isEqual=function(b,c){return b instanceof la&&this.width===b.width&&this.height===b.height&&this.x===b.x&&this.y===b.y&&types.isEqual(this.img,b.img,c)||B.prototype.isEqual.call(this,b,c)};var qa=function(b){this.img=b;this.width=b.width;this.height=
b.height};qa.prototype=v(B.prototype);qa.prototype.getAriaText=function(b){return 0>=b?"framed image":" Framed image: "+this.img.getAriaText(b-1)};qa.prototype.render=function(b,c,e){b.save();this.img.render(b,c,e);b.beginPath();b.strokeStyle="black";b.strokeRect(c,e,this.width,this.height);b.closePath();b.restore()};qa.prototype.isEqual=function(b,c){return b instanceof qa&&types.isEqual(this.img,b.img,c)||B.prototype.isEqual.call(this,b,c)};var Z=function(b,c){this.img=b;this.width=b.getWidth();
this.height=b.getHeight();this.direction=c};Z.prototype=v(B.prototype);Z.prototype.getAriaText=function(b){return 0>=b?"flipped image":u(this.direction)+"ly flipped image: "+this.img.getAriaText(b-1)};Z.prototype.render=function(b,c,e){b.save();"horizontal"===this.direction&&(b.scale(-1,1),b.translate(-(this.width+2*c),0));"vertical"===this.direction&&(b.scale(1,-1),b.translate(0,-(this.height+2*e)));this.img.render(b,c,e);b.restore()};Z.prototype.isEqual=function(b,c){return b instanceof Z&&this.width===
b.width&&this.height===b.height&&this.direction===b.direction&&types.isEqual(this.img,b.img,c)||B.prototype.isEqual.call(this,b,c)};var ba=function(b,c){c=isNaN(c)?1:c/255;var h=types.colorAlpha(b)/255;return"rgba("+types.colorRed(b)+", "+types.colorGreen(b)+", "+types.colorBlue(b)+", "+c*h+")"},ra=function(b,c,e,m){this.width=b;this.height=c;this.style=e;this.color=m;this.vertices=[{x:0,y:c},{x:0,y:0},{x:b,y:0},{x:b,y:c}]};ra.prototype=v(B.prototype);ra.prototype.getAriaText=function(b){return u(y(this.color,
this.style))+(this.width===this.height?" square of size "+this.width:" rectangle of width "+this.width+" and height "+this.height)};var Y=function(b,c,e,m){this.width=Math.sin(c/2*Math.PI/180)*b*2;this.height=Math.abs(Math.cos(c/2*Math.PI/180))*b*2;this.style=e;this.color=m;this.side=b;this.angle=c;this.vertices=[{x:this.width/2,y:0},{x:this.width,y:this.height/2},{x:this.width/2,y:this.height},{x:0,y:this.height/2}]};Y.prototype=v(B.prototype);Y.prototype.getAriaText=function(b){return u(y(this.color,
this.style))+" rhombus of size "+this.side+" and angle "+this.angle};var M=function(b,c,e){b=b.map(function(b){return{x:jsnums.toFixnum(types.posnX(b)),y:jsnums.toFixnum(types.posnY(b))}});console.log("vertices are",b);this.width=C(b);this.height=V(b);this.style=c;this.color=e;this.vertices=G(b)};M.prototype=v(B.prototype);M.prototype.getAriaText=function(b){return u(y(this.color,this.style))+", "+this.vertices.length+"-pointed polygon "};var N=function(b,c,e,m,q,v){this.outerRadius=Math.round(b/
(2*Math.sin(Math.PI/c)));this.innerRadius=Math.round(b/(2*Math.tan(Math.PI/c)));for(var h=3*Math.PI/2+Math.PI/c,w=0,u=[],y=0;y<c;y++)w+=2*e*Math.PI/c,u.push({x:Math.round(this.outerRadius*Math.cos(w-h)),y:Math.round(this.outerRadius*Math.sin(w-h))});this.width=C(u);this.height=V(u);this.length=b;this.count=c;this.style=m;this.color=q;this.vertices=G(u);this.ariaOverride=v};N.prototype=v(B.prototype);N.prototype.getAriaText=function(b){return u(y(this.color,this.style))+(this.ariaOverride?" "+this.ariaOverride+
" of size "+this.length:", "+this.count+" sided polygon with each side of length "+this.length)};var ua=function(b,c,e,m,q,v,u,y,A){b=JSON.stringify(b);this.str=b.substring(1,b.length-1);this.size=c;this.color=e;this.face=m;this.family=q;this.outline=A||!1;this.style="slant"===v?"oblique":v;this.weight="light"===u?"lighter":u;this.underline=y;this.font=this.style+" "+this.weight+" "+this.size+'px "'+this.face+'", '+this.family;b=document.createElement("div");c=document.createElement("span");e=document.createElement("img");
c.style.font=this.font;e.width=42;e.height=1;e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQIHWM4MbPgPwAGzwLR05RbqwAAAABJRU5ErkJggg==";b.style.cssText="position: absolute; top: 0px; left: 0px; zIndex=-1; white-space: pre;";c.appendChild(document.createTextNode(this.str));c.appendChild(e);b.appendChild(c);document.body.appendChild(b);e.style.display="none";c.style.display="inline";this.alphaBaseline=0;this.width=c.offsetWidth;this.height=c.offsetHeight;document.body.removeChild(b)};
ua.prototype=v(B.prototype);ua.prototype.getAriaText=function(b){return" a string "+this.str+", colored "+y(this.color,"solid")+" of size "+this.size};ua.prototype.render=function(b,c,e){b.save();b.textAlign="left";b.textBaseline="top";b.font=this.font;b.fillStyle=this.outline?"white":ba(this.color);b.fillText(this.str,c,e);this.outline&&(b.strokeStyle=ba(this.color),b.strokeText(this.str,c,e));this.underline&&(b.beginPath(),b.moveTo(c,e+this.size),b.lineTo(c+this.width,e+this.size),b.closePath(),
b.strokeStyle=ba(this.color),b.stroke());b.restore()};ua.prototype.getBaseline=function(){return this.alphaBaseline};ua.prototype.isEqual=function(b,c){return b instanceof ua&&this.str===b.str&&this.size===b.size&&this.face===b.face&&this.family===b.family&&this.style===b.style&&this.weight===b.weight&&this.underline===b.underline&&this.font===b.font&&types.isEqual(this.color,b.color,c)||B.prototype.isEqual.call(this,b,c)};var ia=function(b,c,e,m,q){for(var h=Math.max(e,c),w=[],v=Math.PI/180,u=0;u<
2*b+1;u++){var y=360/(2*b)*u*v-.5,A=1===u%2?c:e;w.push({x:h+Math.sin(y)*A,y:h+Math.cos(y)*A})}this.width=C(w);this.height=V(w);this.style=m;this.color=q;this.points=b;this.inner=e;this.outer=c;this.vertices=G(w)};ia.prototype=v(B.prototype);ia.prototype.getAriaText=function(b){return u(y(this.color,this.style))+", "+this.points+"-pointed star with inner radius "+this.inner+" and outer radius "+this.outer};var H=function(b,c,e,m,q){this.sideC=b;this.sideB=e;this.angleA=c;var h=e*Math.cos(c*Math.PI/
180);c=e*Math.sin(c*Math.PI/180);e=0-Math.min(0,h);var w=[];0<c?(w.push({x:e+0,y:0}),w.push({x:e+b,y:0}),w.push({x:e+h,y:c})):(w.push({x:e+0,y:-c}),w.push({x:e+b,y:-c}),w.push({x:e+h,y:0}));this.width=Math.max(b,h)+e;this.height=Math.abs(c);this.style=m;this.color=q;this.vertices=w};H.prototype=v(B.prototype);H.prototype.getAriaText=function(b){b=u(y(this.color,this.style));return b=270===this.angleA?b+(" right triangle whose base is of length "+this.sideC+" and height of "+this.sideB):300===this.angleA&&
this.sideC===this.sideB?b+(" equilateral triangle with sides of length "+this.sideC):b+(" triangle whose base is of length "+this.sideC+", with an angle of "+this.angleA%180+" degrees between it and a side of length "+this.sideB)};var D=function(b,c,e,m){this.width=b;this.height=c;this.style=e;this.color=m};D.prototype=v(B.prototype);D.prototype.getAriaText=function(b){return u(y(this.color,this.style))+(this.width===this.height?" circle of radius "+this.width/2:" ellipse of width "+this.width+" and height "+
this.height)};D.prototype.render=function(b,c,e){b.save();b.beginPath();var h="outline"!==this.style.toString().toLowerCase()?0:.5,m=this.width-2*h,q=this.height-2*h;c+=h;e+=h;h=m/2*.5522848;var w=q/2*.5522848,v=c+m,u=e+q;m=c+m/2;q=e+q/2;b.moveTo(c,q);b.bezierCurveTo(c,q-w,m-h,e,m,e);b.bezierCurveTo(m+h,e,v,q-w,v,q);b.bezierCurveTo(v,q+w,m+h,u,m,u);b.bezierCurveTo(m-h,u,c,q+w,c,q);b.closePath();"outline"===this.style.toString().toLowerCase()?(b.strokeStyle=ba(this.color),b.stroke()):(b.fillStyle=
ba(this.color,this.style),b.fill());b.restore()};D.prototype.isEqual=function(b,c){return b instanceof D&&this.width===b.width&&this.height===b.height&&this.style===b.style&&types.isEqual(this.color,b.color,c)||B.prototype.isEqual.call(this,b,c)};var fa=function(b,c,e){var h=0<=b?0<=c?[{x:0,y:0},{x:b,y:c}]:[{x:0,y:-c},{x:b,y:0}]:0<=c?[{x:-b,y:0},{x:0,y:c}]:[{x:-b,y:-c},{x:0,y:0}];this.x=b;this.y=c;this.width=Math.abs(b);this.height=Math.abs(c);this.style="outline";this.color=e;this.vertices=h};fa.prototype=
v(B.prototype);fa.prototype.getAriaText=function(b){return u(y(this.color,""))+" line of width "+this.x+" and height "+this.y};world.Kernel.applyEffect=function(b){if(b!==types.EMPTY){if(types.isPair(b))return world.Kernel.applyEffect(b.first).concat(world.Kernel.applyEffect(b.rest));if(b=b.run())return b}return[]};v=function(){this.colors={}};v.prototype.put=function(b,c){this.colors[b]=c};v.prototype.get=function(b){if(b.toString)return this.colors[b.toString().replace(/\s/g,"").toUpperCase()]};


var A=new v;A.put("ORANGE",types.color(255,165,0,255));A.put("LIGHTORANGE",types.color(255,216,51,255));A.put("MEDIUMORANGE",types.color(255,165,0,255));A.put("ORANGERED",types.color(255,69,0,255));A.put("TOMATO",types.color(255,99,71,255));A.put("RED",types.color(255,0,0,255));A.put("LIGHTRED",types.color(255,102,102,255));A.put("MEDIUMRED",types.color(255,0,0,255));A.put("DARKRED",types.color(139,0,0,255));A.put("FIREBRICK",types.color(178,34,34,255));A.put("CRIMSON",types.color(220,20,60,255));
A.put("DEEPPINK",types.color(255,20,147,255));A.put("MAROON",types.color(176,48,96,255));A.put("INDIANRED",types.color(205,92,92,255));A.put("MEDIUMVIOLETRED",types.color(199,21,133,255));A.put("VIOLETRED",types.color(208,32,144,255));A.put("LIGHTCORAL",types.color(240,128,128,255));A.put("HOTPINK",types.color(255,105,180,255));A.put("PALEVIOLETRED",types.color(219,112,147,255));A.put("LIGHTPINK",types.color(255,182,193,255));A.put("ROSYBROWN",types.color(188,143,143,255));A.put("PINK",types.color(255,
192,203,255));A.put("MEDIUMPINK",types.color(255,192,203,255));A.put("DARKPINK",types.color(204,141,152,255));A.put("ORCHID",types.color(218,112,214,255));A.put("LAVENDERBLUSH",types.color(255,240,245,255));A.put("SNOW",types.color(255,250,250,255));A.put("CHOCOLATE",types.color(210,105,30,255));A.put("SADDLEBROWN",types.color(139,69,19,255));A.put("BROWN",types.color(132,60,36,255));A.put("LIGHTBROWN",types.color(183,111,87,255));A.put("MEDIUMBROWN",types.color(132,60,36,255));A.put("DARKBROWN",
types.color(81,9,0,255));A.put("DARKORANGE",types.color(255,140,0,255));A.put("CORAL",types.color(255,127,80,255));A.put("SIENNA",types.color(160,82,45,255));A.put("ORANGE",types.color(255,165,0,255));A.put("SALMON",types.color(250,128,114,255));A.put("PERU",types.color(205,133,63,255));A.put("GOLDENROD",types.color(218,165,32,255));A.put("LIGHTGOLDENROD",types.color(255,216,83,255));A.put("DARKGOLDENROD",types.color(184,134,11,255));A.put("SANDYBROWN",types.color(244,164,96,255));A.put("LIGHTSALMON",
types.color(255,160,122,255));A.put("DARKSALMON",types.color(233,150,122,255));A.put("GOLD",types.color(255,215,0,255));A.put("YELLOW",types.color(255,255,0,255));A.put("LIGHTYELLOW",types.color(255,255,51,255));A.put("MEDIUMYELLOW",types.color(255,255,0,255));A.put("DARKYELLOW",types.color(204,204,0,255));A.put("OLIVE",types.color(128,128,0,255));A.put("BURLYWOOD",types.color(222,184,135,255));A.put("TAN",types.color(210,180,140,255));A.put("NAVAJOWHITE",types.color(255,222,173,255));A.put("PEACHPUFF",
types.color(255,218,185,255));A.put("KHAKI",types.color(240,230,140,255));A.put("DARKKHAKI",types.color(189,183,107,255));A.put("MOCCASIN",types.color(255,228,181,255));A.put("WHEAT",types.color(245,222,179,255));A.put("BISQUE",types.color(255,228,196,255));A.put("PALEGOLDENROD",types.color(238,232,170,255));A.put("BLANCHEDALMOND",types.color(255,235,205,255));A.put("MEDIUMGOLDENROD",types.color(234,234,173,255));A.put("PAPAYAWHIP",types.color(255,239,213,255));A.put("MISTYROSE",types.color(255,228,
225,255));A.put("LEMONCHIFFON",types.color(255,250,205,255));A.put("ANTIQUEWHITE",types.color(250,235,215,255));A.put("CORNSILK",types.color(255,248,220,255));A.put("LIGHTGOLDENRODYELLOW",types.color(250,250,210,255));A.put("OLDLACE",types.color(253,245,230,255));A.put("LINEN",types.color(250,240,230,255));A.put("LIGHTYELLOW",types.color(255,255,224,255));A.put("SEASHELL",types.color(255,245,238,255));A.put("BEIGE",types.color(245,245,220,255));A.put("FLORALWHITE",types.color(255,250,240,255));A.put("IVORY",
types.color(255,255,240,255));A.put("GREEN",types.color(0,255,0,255));A.put("MEDIUMGREEN",types.color(0,255,0,255));A.put("LAWNGREEN",types.color(124,252,0,255));A.put("CHARTREUSE",types.color(127,255,0,255));A.put("GREENYELLOW",types.color(173,255,47,255));A.put("YELLOWGREEN",types.color(154,205,50,255));A.put("OLIVEDRAB",types.color(107,142,35,255));A.put("MEDIUMFORESTGREEN",types.color(107,142,35,255));A.put("DARKOLIVEGREEN",types.color(85,107,47,255));A.put("DARKSEAGREEN",types.color(143,188,
139,255));A.put("LIME",types.color(0,255,0,255));A.put("DARKGREEN",types.color(0,100,0,255));A.put("LIMEGREEN",types.color(50,205,50,255));A.put("FORESTGREEN",types.color(34,139,34,255));A.put("SPRING GREEN",types.color(0,255,127,255));A.put("SPRINGGREEN",types.color(0,255,127,255));A.put("MEDIUMSPRINGGREEN",types.color(0,250,154,255));A.put("SEAGREEN",types.color(46,139,87,255));A.put("MEDIUMSEAGREEN",types.color(60,179,113,255));A.put("AQUAMARINE",types.color(112,216,144,255));A.put("LIGHTGREEN",
types.color(144,238,144,255));A.put("PALEGREEN",types.color(152,251,152,255));A.put("MEDIUM AQUAMARINE",types.color(102,205,170,255));A.put("MEDIUMAQUAMARINE",types.color(102,205,170,255));A.put("TURQUOISE",types.color(64,224,208,255));A.put("LIGHTTURQUOISE",types.color(155,255,255,255));A.put("MEDIUMTURQUOISE",types.color(72,209,204,255));A.put("LIGHTSEAGREEN",types.color(32,178,170,255));A.put("HONEYDEW",types.color(240,255,240,255));A.put("MINTCREAM",types.color(245,255,250,255));A.put("ROYALBLUE",
types.color(65,105,225,255));A.put("DODGERBLUE",types.color(30,144,255,255));A.put("DEEPSKYBLUE",types.color(0,191,255,255));A.put("CORNFLOWERBLUE",types.color(100,149,237,255));A.put("STEELBLUE",types.color(70,130,180,255));A.put("LIGHTSKYBLUE",types.color(135,206,250,255));A.put("DARKTURQUOISE",types.color(0,206,209,255));A.put("CYAN",types.color(0,255,255,255));A.put("LIGHTCYAN",types.color(224,255,255,255));A.put("MEDIUMCYAN",types.color(0,255,255,255));A.put("DARKCYAN",types.color(0,139,139,
255));A.put("AQUA",types.color(0,255,255,255));A.put("TEAL",types.color(0,128,128,255));A.put("SKYBLUE",types.color(135,206,235,255));A.put("CADETBLUE",types.color(95,158,160,255));A.put("DARKSLATEGRAY",types.color(47,79,79,255));A.put("LIGHTSLATEGRAY",types.color(119,136,153,255));A.put("SLATEGRAY",types.color(112,128,144,255));A.put("LIGHTSTEELBLUE",types.color(176,196,222,255));A.put("LIGHTBLUE",types.color(173,216,230,255));A.put("POWDERBLUE",types.color(176,224,230,255));A.put("PALETURQUOISE",
types.color(175,238,238,255));A.put("ALICEBLUE",types.color(240,248,255,255));A.put("AZURE",types.color(240,255,255,255));A.put("MEDIUMBLUE",types.color(0,0,205,255));A.put("DARKBLUE",types.color(0,0,139,255));A.put("MIDNIGHTBLUE",types.color(25,25,112,255));A.put("NAVY",types.color(36,36,140,255));A.put("BLUE",types.color(0,0,255,255));A.put("INDIGO",types.color(75,0,130,255));A.put("BLUEVIOLET",types.color(138,43,226,255));A.put("MEDIUMSLATEBLUE",types.color(123,104,238,255));A.put("SLATEBLUE",
types.color(106,90,205,255));A.put("PURPLE",types.color(160,32,240,255));A.put("LIGHTPURPLE",types.color(211,83,255,255));A.put("MEDIUMPURPLE",types.color(147,112,219,255));A.put("DARKPURPLE",types.color(109,0,189,255));A.put("DARKSLATEBLUE",types.color(72,61,139,255));A.put("DARKVIOLET",types.color(148,0,211,255));A.put("DARKORCHID",types.color(153,50,204,255));A.put("MEDIUMORCHID",types.color(186,85,211,255));A.put("MAGENTA",types.color(255,0,255,255));A.put("FUCHSIA",types.color(255,0,255,255));
A.put("DARKMAGENTA",types.color(139,0,139,255));A.put("VIOLET",types.color(238,130,238,255));A.put("PLUM",types.color(221,160,221,255));A.put("LAVENDER",types.color(230,230,250,255));A.put("THISTLE",types.color(216,191,216,255));A.put("GHOSTWHITE",types.color(248,248,255,255));A.put("WHITE",types.color(255,255,255,255));A.put("WHITESMOKE",types.color(245,245,245,255));A.put("GAINSBORO",types.color(220,220,220,255));A.put("LIGHTGRAY",types.color(211,211,211,255));A.put("LIGHTGREY",types.color(211,
211,211,255));A.put("SILVER",types.color(192,192,192,255));A.put("GRAY",types.color(190,190,190,255));A.put("GREY",types.color(190,190,190,255));A.put("MEDIUMGRAY",types.color(190,190,190,255));A.put("MEDIUMGREY",types.color(190,190,190,255));A.put("DARKGRAY",types.color(169,169,169,255));A.put("DARKGREY",types.color(169,169,169,255));A.put("DIMGRAY",types.color(105,105,105,255));A.put("DIMGREY",types.color(105,105,105,255));A.put("BLACK",types.color(0,0,0,255));A.put("TRANSPARENT",types.color(0,
0,0,0));

A.put("ALICE-BLUE", types.color(240, 248, 255, 1));
A.put("ANTIQUE-WHITE", types.color(250, 235, 215, 1));
A.put("BLANCHED-ALMOND", types.color(255, 235, 205, 1));
A.put("BLUE-VIOLET", types.color(138, 43, 226, 1));
A.put("CADET-BLUE", types.color(95, 158, 160, 1));
A.put("CORNFLOWER-BLUE", types.color(100, 149, 237, 1));
A.put("DARK-BLUE", types.color(0, 0, 139, 1));
A.put("DARK-CYAN", types.color(0, 139, 139, 1));
A.put("DARK-GOLDENROD", types.color(184, 134, 11, 1));
A.put("DARK-GRAY", types.color(169, 169, 169, 1));
A.put("DARK-GREEN", types.color(0, 100, 0, 1));
A.put("DARK-GREY", types.color(169, 169, 169, 1));
A.put("DARK-KHAKI", types.color(189, 183, 107, 1));
A.put("DARK-MAGENTA", types.color(139, 0, 139, 1));
A.put("DARK-OLIVE-GREEN", types.color(85, 107, 47, 1));
A.put("DARK-ORANGE", types.color(255, 140, 0, 1));
A.put("DARK-ORCHID", types.color(153, 50, 204, 1));
A.put("DARK-RED", types.color(139, 0, 0, 1));
A.put("DARK-SALMON", types.color(233, 150, 122, 1));
A.put("DARK-SEA-GREEN", types.color(143, 188, 139, 1));
A.put("DARK-SLATE-BLUE", types.color(72, 61, 139, 1));
A.put("DARK-SLATE-GRAY", types.color(47, 79, 79, 1));
A.put("DARK-SLATE-GREY", types.color(47, 79, 79, 1));
A.put("DARK-TURQUOISE", types.color(0, 206, 209, 1));
A.put("DARK-VIOLET", types.color(148, 0, 211, 1));
A.put("DEEP-PINK", types.color(255, 20, 147, 1));
A.put("DEEP-SKY-BLUE", types.color(0, 191, 255, 1));
A.put("DIM-GRAY", types.color(105, 105, 105, 1));
A.put("DIM-GREY", types.color(105, 105, 105, 1));
A.put("DODGER-BLUE", types.color(30, 144, 255, 1));
A.put("FIRE-BRICK", types.color(178, 34, 34, 1));
A.put("FLORAL-WHITE", types.color(255, 250, 240, 1));
A.put("FOREST-GREEN", types.color(34, 139, 34, 1));
A.put("GHOST-WHITE", types.color(248, 248, 255, 1));
A.put("GREEN-YELLOW", types.color(173, 255, 47, 1));
A.put("HOT-PINK", types.color(255, 105, 180, 1));
A.put("INDIAN-RED", types.color(205, 92, 92, 1));
A.put("LAVENDER-BLUSH", types.color(255, 240, 245, 1));
A.put("LAWN-GREEN", types.color(124, 252, 0, 1));
A.put("LEMON-CHIFFON", types.color(255, 250, 205, 1));
A.put("LIGHT-BLUE", types.color(173, 216, 230, 1));
A.put("LIGHT-CORAL", types.color(240, 128, 128, 1));
A.put("LIGHT-CYAN", types.color(224, 255, 255, 1));
A.put("LIGHT-GOLDENROD-YELLOW", types.color(250, 250, 210, 1));
A.put("LIGHT-GRAY", types.color(211, 211, 211, 1));
A.put("LIGHT-GREEN", types.color(144, 238, 144, 1));
A.put("LIGHT-GREY", types.color(211, 211, 211, 1));
A.put("LIGHT-PINK", types.color(255, 182, 193, 1));
A.put("LIGHT-SALMON", types.color(255, 160, 122, 1));
A.put("LIGHT-SEA-GREEN", types.color(32, 178, 170, 1));
A.put("LIGHT-SKY-BLUE", types.color(135, 206, 250, 1));
A.put("LIGHT-SLATE-GRAY", types.color(119, 136, 153, 1));
A.put("LIGHT-SLATE-GREY", types.color(119, 136, 153, 1));
A.put("LIGHT-STEEL-BLUE", types.color(176, 196, 222, 1));
A.put("LIGHT-YELLOW", types.color(255, 255, 224, 1));
A.put("LIME-GREEN", types.color(50, 205, 50, 1));
A.put("MEDIUM-AQUAMARINE", types.color(102, 205, 170, 1));
A.put("MEDIUM-BLUE", types.color(0, 0, 205, 1));
A.put("MEDIUM-FOREST-GREEN", types.color(107, 142, 35, 1));
A.put("MEDIUM-GOLDENROD", types.color(234, 234, 173, 1));
A.put("MEDIUM-ORCHID", types.color(186, 85, 211, 1));
A.put("MEDIUM-PURPLE", types.color(147, 112, 219, 1));
A.put("MEDIUM-SEA-GREEN", types.color(60, 179, 113, 1));
A.put("MEDIUM-SLATE-BLUE", types.color(123, 104, 238, 1));
A.put("MEDIUM-SPRING-GREEN", types.color(0, 250, 154, 1));
A.put("MEDIUM-TURQUOISE", types.color(72, 209, 204, 1));
A.put("MEDIUM-VIOLET-RED", types.color(199, 21, 133, 1));
A.put("MIDNIGHT-BLUE", types.color(25, 25, 112, 1));
A.put("MINT-CREAM", types.color(245, 255, 250, 1));
A.put("MISTY-ROSE", types.color(255, 228, 225, 1));
A.put("NAVAJO-WHITE", types.color(255, 222, 173, 1));
A.put("OLD-LACE", types.color(253, 245, 230, 1));
A.put("OLIVE-DRAB", types.color(107, 142, 35, 1));
A.put("ORANGE-RED", types.color(255, 69, 0, 1));
A.put("PALE-GOLDENROD", types.color(238, 232, 170, 1));
A.put("PALE-GREEN", types.color(152, 251, 152, 1));
A.put("PALE-TURQUOISE", types.color(175, 238, 238, 1));
A.put("PALE-VIOLET-RED", types.color(219, 112, 147, 1));
A.put("PAPAYA-WHIP", types.color(255, 239, 213, 1));
A.put("PEACH-PUFF", types.color(255, 218, 185, 1));
A.put("POWDER-BLUE", types.color(176, 224, 230, 1));
A.put("ROSY-BROWN", types.color(188, 143, 143, 1));
A.put("ROYAL-BLUE", types.color(65, 105, 225, 1));
A.put("SADDLE-BROWN", types.color(139, 69, 19, 1));
A.put("SANDY-BROWN", types.color(244, 164, 96, 1));
A.put("SEA-GREEN", types.color(46, 139, 87, 1));
A.put("SKY-BLUE", types.color(135, 206, 235, 1));
A.put("SLATE-BLUE", types.color(106, 90, 205, 1));
A.put("SLATE-GRAY", types.color(112, 128, 144, 1));
A.put("SLATE-GREY", types.color(112, 128, 144, 1));
A.put("SPRING-GREEN", types.color(0, 255, 127, 1));
A.put("STEEL-BLUE", types.color(70, 130, 180, 1));
A.put("VIOLET-RED", types.color(208, 32, 144, 1));
A.put("WHITE-SMOKE", types.color(245, 245, 245, 1));
A.put("YELLOW-GREEN", types.color(154, 205, 50, 1));

v=[];ca=A.colors;for(var Fa in ca)if(ca.hasOwnProperty(Fa)){var da=b(types.colorRed(ca[Fa]),types.colorGreen(ca[Fa]),types.colorBlue(ca[Fa]));v.push({name:Fa,l:da.l,a:da.a,b:da.b})}world.Kernel.isImage=function(b){return null!==b&&void 0!==b&&b instanceof B};world.Kernel.isScene=function(b){return void 0!==b&&null!==b&&b instanceof aa};world.Kernel.isColor=function(b){return types.isColor(b)||(types.isString(b)||types.isSymbol(b))&&"undefined"!==typeof A.get(b)};world.Kernel.nameToColor=function(b){return A.get(""+
b)};world.Kernel.colorDb=A;world.Kernel.colorLabs=v;world.Kernel.sceneImage=function(b,c,e,m,q){return new aa(b,c,e,m,q)};world.Kernel.circleImage=function(b,c,e){return new D(2*b,2*b,c,e)};world.Kernel.starImage=function(b,c,e,m,q){return new ia(b,c,e,m,q)};world.Kernel.rectangleImage=function(b,c,e,m){return new ra(b,c,e,m)};world.Kernel.rhombusImage=function(b,c,e,m){return new Y(b,c,e,m)};world.Kernel.polygonImage=function(b,c,e,m,q,v){return new N(b,c,e,m,q,v)};world.Kernel.posnImage=function(b,
c,e){return new M(b,c,e)};world.Kernel.squareImage=function(b,c,e){return new ra(b,b,c,e)};world.Kernel.triangleImage=function(b,c,e,m,q){return new H(b,c,e,m,q)};world.Kernel.ellipseImage=function(b,c,e,m){return new D(b,c,e,m)};world.Kernel.lineImage=function(b,c,e){return new fa(b,c,e)};world.Kernel.overlayImage=function(b,c,e,m){return new K(b,c,e,m)};world.Kernel.rotateImage=function(b,c){return new W(b,c)};world.Kernel.scaleImage=function(b,c,e){return new pa(b,c,e)};world.Kernel.cropImage=
function(b,c,e,m,q){return new la(b,c,e,m,q)};world.Kernel.frameImage=function(b){return new qa(b)};world.Kernel.flipImage=function(b,c){return new Z(b,c)};world.Kernel.textImage=function(b,c,e,m,q,v,u,y,A){return new ua(b,c,e,m,q,v,u,y,A)};world.Kernel.fileImage=function(b,c,e){return T.makeInstance(b,c,e)};world.Kernel.fileVideo=function(b,c){return na.makeInstance(b,c)};world.Kernel.fileAudio=function(b,c,e){return ea.makeInstance(b,c,e)};world.Kernel.isSceneImage=function(b){return b instanceof
aa};world.Kernel.isStarImage=function(b){return b instanceof ia};world.Kernel.isRectangleImage=function(b){return b instanceof ra};world.Kernel.isPolygonImage=function(b){return b instanceof N};world.Kernel.isRhombusImage=function(b){return b instanceof Y};world.Kernel.isTriangleImage=function(b){return b instanceof H};world.Kernel.isEllipseImage=function(b){return b instanceof D};world.Kernel.isLineImage=function(b){return b instanceof fa};world.Kernel.isOverlayImage=function(b){return b instanceof
K};world.Kernel.isRotateImage=function(b){return b instanceof W};world.Kernel.isScaleImage=function(b){return b instanceof pa};world.Kernel.isCropImage=function(b){return b instanceof la};world.Kernel.isFrameImage=function(b){return b instanceof qa};world.Kernel.isFlipImage=function(b){return b instanceof Z};world.Kernel.isTextImage=function(b){return b instanceof ua};world.Kernel.isFileImage=function(b){return b instanceof T};world.Kernel.isFileVideo=function(b){return b instanceof na}})();
(function(){var e=jsworld.MobyJsworld={},u=jsworld.Jsworld;(function(){for(var b=0,c=["ms","moz","webkit","o"],e=0;e<c.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[c[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[e]+"CancelAnimationFrame"]||window[c[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(c,e){var m=(new Date).getTime(),q=Math.max(0,16-(m-b));e=window.setTimeout(function(){c(m+q)},q);
b=m+q;return e});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(b){clearTimeout(b)})})();document.getElementById("bigBangLog");var y,b=function(b){y=function(c,e,m){b(c,e,m,ea)}},c=function(){y=function(){throw Error("caller not defined!");}};c();var v,Q=function(b){var c=!1;v=function(e){if(c)throw Error("Cannot restart twice!");c=!0;b(e)}};(function(){v=function(){throw Error("restarter not defined!");}})();var m,q=function(){m=function(){throw Error("terminator not defined!");
}};q();var C=[],V=function(b){helpers.forEachK(C,function(b,c){y(b.startup,b.startupArgs,function(e){b.shutdownArg=e;c()})},ea,b)},G=function(b){var c=C;C=[];helpers.forEachK(c,function(b,c){y(b.shutdown,[b.shutdownArg],c)},ea,b)},B=function(b){return types.jsObject("function",function(){for(var c=[],m=0;m<arguments.length;m++)c.push(helpers.wrapJsObject(arguments[m]));e.updateWorld(function(e,m){e=[e].concat(c);y(b,e,m)},function(){})})},aa=function(b,c){types.isJsObject(b)?c(b.obj):types.isRenderEffect(b)?
b.callImplementation(y,function(b){aa(b,c)}):types.isPair(b)?aa(b.first(),function(e){aa(b.rest(),function(b){c(types.cons(e,b))})}):c(b)},T=types.isPair,U=function(b){return T(b)||b===types.EMPTY};e.printWorldHook=function(b,c){null==c.lastChild?(b=types.toDomNode(b),c.appendChild(b)):(b=types.toDomNode(b),c.replaceChild(b,c.lastChild));helpers.maybeCallAfterAttach(b)};var X=function(b,c,e){var m=function(b,c){throw types.schemeError(types.incompleteExn(types.exnFailContract,helpers.format(b,c),
[]));};if(!u.isPage(b))if(types.isPair(b)){var q=b.first();e=b.rest();"undefined"==typeof q.nodeType&&m("on-draw: expected a dom-element, but received ~s instead, the first element within ~s",[q,c]);q.nodeType!=Node.TEXT_NODE||e.isEmpty()||m("on-draw: the text node ~s must not have children.  It has ~s",[q,e]);for(c=2;!e.isEmpty();)X(e.first(),b,c),e=e.rest(),c++}else q="on-draw: expected a dom-s-expression, but received ~s instead",b=[b],void 0!=e&&(q+=", the ~a element within ~s",b.push(helpers.ordinalize(e)),
b.push(c)),m(q+".",b)},na=function(b,c,e){b.addEventListener?b.addEventListener(c,e,!1):b.attachEvent("on"+c,e,!1);return function(){ha(b,c,e)}},ha=function(b,c,e){b.addEventListener?b.removeEventListener(c,e,!1):b.detachEvent("on"+c,e,!1)};e.bigBang=function(T,ca,K,W,pa){b(W);Q(pa);m=function(b){ha(ca,"click",qa);G(function(){c();q();v(b)})};var Ba=types.EMPTY;ca.tabIndex=0;var qa=function(b){b.preventDefault?b.preventDefault():b.returnValue=!1;b.stopPropagation?b.stopPropagation():b.cancelBubble=
!0;return!1};na(ca,"click",qa);[].push(function(){ha(ca,"click",qa)});var Z=new world.config.WorldConfig;for(W=0;W<K.length;W++)U(K[W])?Ba=K[W]:"function"==typeof K[W]?Z=K[W](Z):types.isWorldConfig(K[W])&&(K[W].startupArgs=helpers.map(B,K[W].startupArgs),C.push(K[W]));Z=Z.updateAll({changeWorld:e.updateWorld,shutdownWorld:e.shutdownWorld});new world.stimuli.StimuliHandler(Z,y,v);var ba=[],ra=[];if(Z.lookup("onDraw"))K=function(b,c){try{y(Z.lookup("onDraw"),[b],function(b){aa(b,function(b){X(b,b,void 0);
b=[ca,helpers.deepListToArray(b)];c(b)})})}catch(H){ea(H)}},W=Z.lookup("onDrawCss")?function(b,c){try{y(Z.lookup("onDrawCss"),[b],function(b){b=helpers.deepListToArray(b);c(b)})}catch(H){ea(H)}}:function(b,c){c([])},ba.push(u.on_draw(K,W));else if(Z.lookup("onRedraw")){var Y=void 0,M=void 0;K=function(b,c){window.requestAnimationFrame(function(e){ra=[e/1E3].concat(ra);ra=ra.slice(0,3);try{b=u.getCurrentWorld(),y(Z.lookup("onRedraw"),[b],function(b){if(world.Kernel.isImage(b)){var e=b.getWidth(),m=
b.getHeight();Y||(Y=world.Kernel.makeCanvas(e,m),Y.jsworldOpaque=!0,M=u.node_to_tree(Y));setTimeout(function(){Y.width=e;Y.height=m;var c=Y.getContext("2d");b.render(c,0,0);c=document.createElement("span");c.className="screenreader-only";c.appendChild(document.createTextNode(b.getAriaText(6)));ca.appendChild(c)},0);c([ca,M])}else ea("to-draw handler: is expected to return a scene or image")})}catch(D){ea(D)}})};W=function(b,c){c([[Y,["width",Y.width+"px"],["height",Y.height+"px"]]])};ba.push(u.on_draw(K,
W))}else ba.push(u.on_world_change(function(b,c){e.printWorldHook(b,ca);c()}));Z.lookup("tickDelay")&&(K=jsnums.toFixnum(Z.lookup("tickDelay")),ba.push(u.on_tick(K,function(b,c){y(Z.lookup("onTick"),[b],c)})));Z.lookup("stopWhen")&&ba.push(u.stop_when(function(b,c){y(Z.lookup("stopWhen"),[b],function(b){c(b)})},void 0,function(b,c){lastPictureCss=function(b,c){c([[Y,["width",Y.width+"px"],["height",Y.height+"px"]]])};return u.on_draw(function(c){try{Z.lookup("lastPicture")&&(b=u.getCurrentWorld(),
y(Z.lookup("lastPicture"),[b],function(b){world.Kernel.isImage(b)?setTimeout(function(){Y.width=b.getWidth();Y.height=b.getHeight();var c=Y.getContext("2d");b.render(c,0,0)},0):ea("stop-when handler: is expected to return a scene or image")}))}catch(D){ea(D)}},lastPictureCss)()}));Z.lookup("onKey")&&(ba.push(u.on_key(function(b,c,e){c="keydown"===c.type?helpers.getKeyCodeName(c):String.fromCharCode(c.which).replace(/[^\x00-\xFE]+/g,"");y(Z.lookup("onKey"),[b,c],e)})),ca.focus());var N=!1;Z.lookup("onMouse")&&
(Z.lookup("onRedraw")||Z.lookup("onDraw")||ea("a mouse handler cannot be used without a draw handler"),ba.push(u.on_mouse(function(b,c,e){"mousedown"===c.type&&(N=!0);if("mouseup"===c.type||"mouseleave"===c.type)N=!1;var m=c.pageX,q=c.pageY,v="mousedown"===c.type?"button-down":"mouseup"===c.type?"button-up":"mouseenter"===c.type?"enter":"mouseleave"===c.type?"leave":"mousemove"===c.type&&N?"drag":"mousemove"===c.type?"move":c.type,u=c.target;do m-=u.offsetLeft,q-=u.offsetTop,u=u.offsetParent;while(u);
m=m*c.target.width/c.target.offsetWidth;scaledY=q*c.target.height/c.target.offsetHeight;y(Z.lookup("onMouse"),[b,m,scaledY,v],e)})));Z.lookup("onTap")&&ba.push(u.on_tap(function(b,c,e){var m=c.pageX,q=c.pageY;c=c.target;do m-=c.offsetLeft,q-=c.offsetTop,c=c.offsetParent;while(c);y(Z.lookup("onTap"),[b,m,q],e)}));Z.lookup("onTilt")&&(ba.push(u.on_tilt(function(b,c,e,m){y(Z.lookup("onTilt"),[b,jsnums.makeFloat(c),jsnums.makeFloat(e)],m)})),ca.focus());V(function(){u.big_bang(ca,T,ba,helpers.assocListToHash(Ba),
m)});return{breaker:function(){ea(types.schemeError(types.incompleteExn(types.exnBreak,"user break",[])))}}};var ea=function(b){console.log("handling error",b);world.stimuli.massShutdown();G(function(){types.isSchemeError(b)?(console.log(1),m(b)):types.isInternalError(b)?(console.log(2),m(b)):"string"==typeof b?(console.log(3),m(types.schemeError(types.incompleteExn(types.exnFail,b,[])))):b instanceof Error?(console.log(4),m(types.schemeError(types.incompleteExn(types.exnFail,b.message,[])))):(console.log(5),
m(types.schemeError(b)))})};e.updateWorld=function(b,c){u.change_world(function(c,e){try{b(c,e)}catch(pa){ea(pa)}},c)};e.shutdownWorld=function(){u.shutdown()};e.p=u.p;e.div=u.div;e.buttonBang=function(b,c,e){return u.button(function(c,e,m){try{y(b,[c],function(b){m(b)})}catch(qa){ea(qa)}},e)};e.input=function(b,c,e){return u.input(b,function(b,e,m){y(c,[b,e],m)},e)};e.get_dash_input_dash_value=function(b){return types.isString(b)?document.getElementById(b).value||"":b.value||""};e.img=u.img;e.text=
u.text;e.select=function(b,c,e){return u.select(e,b,function(b,e,m){y(c,[b,e.target.value],m)})};e.emptyPage=u.emptyPage;e.placeOnPage=function(b,c,e,m){b=types.toDomNode(aa(b));return u.placeOnPage(b,c,e,m)}})();var primitive={};
(function(){function e(b,d,c,t){b=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");var g=b[b.length-1];b=g.first();g=g.rest().first();t!==c&&(d=new types.Message([new types.ColoredPart(d,b),": expected a "+c+"-argument function as input, but given",new types.ColoredPart("a function",g),"of "+t+" arguments"]),K(types.incompleteExn(types.exnFailContract,d,[])))}var u,y,b={},c=types.PrimProc,v=types.CasePrimitive,Q=function(b){return b},m=function(b,d){return d instanceof
types.ValuesWrapper?u(b,d.elts,Q):u(b,[d],Q)},q=function(b,d){l(b,d,k,"procedure-arity","function",1,[d]);b=function(b){return b instanceof types.ContinuationClosureValue?types.arityAtLeast(0):b.isRest?types.arityAtLeast(b.numParams):b.numParams};if(d instanceof c||d instanceof types.ClosureValue||d instanceof types.ContinuationClosureValue)return b(d);if(d instanceof v)d=d.cases;else if(d instanceof types.CaseLambdaValue)d=d.closures;else throw types.internalError("procedure-arity given wrong type that passed isFunction!",
!1);for(var g=[],t=0;t<d.length;t++)g.push(b(d[t]));g=C(g);return 1==g.length?g[0]:types.list(g)},C=function(b){b=b.splice(0);b.sort(function(b,d){return types.isArityAtLeast(b)&&types.isArityAtLeast(d)?types.arityValue(b)-types.arityValue(d):types.isArityAtLeast(b)?types.arityValue(b)-d-.5:types.isArityAtLeast(d)?b-types.arityValue(d)+.5:b-d});for(var d=0;d<b.length-1;d++)if(types.isArityAtLeast(b[d]))return b.splice(0,d+1);return b},V=helpers.procArityContains,G=function(b){for(var d=0;!b.isEmpty();b=
b.rest())d+=1;return d},B=function(b,d){if(0==d.length)return types.EMPTY;var g=d.slice(0,d.length-1),c=d[d.length-1];S(g,function(g,c){ya(b,g,"append",c+1,d)});for(var e=g.length-1;0<=e;e--)c=g[e].append(c);return c},aa=function(b,d,c){if(c[0].isEmpty())return d;for(var g=[],p=[],e=0;e<c.length;e++)g.push(c[e].first()),p.push(c[e].rest());g.push(d);return u(b,g,function(d){return aa(b,d,p)})},T=function(g){return function(d,p,t){ya(d,p,g,1,arguments);l(d,t,V(2),g,"procedure (arity 2)",2,arguments);
var e=function(d,g){if(g.isEmpty())return types.EMPTY;var p=new c("compYes",1,!1,!1,function(b,d){return u(t,[d,g.first()],Q)}),h=new c("compNo",1,!1,!1,function(b,d){return u(t,[d,g.first()],function(b){return!b})}),k=new c("quicksort",1,!1,!1,e);return u(b.filter,[p,g.rest()],function(c){return u(k,[c],function(c){return u(b.filter,[h,g.rest()],function(b){return u(k,[b],function(b){return B(d,[c,types.list([g.first()]),b])})})})})};return e(d,p)}},U=function(b,d){for(var g=b[0],c=1;c<b.length;c++){if(!d(g,
b[c]))return!1;g=b[c]}return!0},X=function(b){var d;for(d=0;d<b.length;d++)if(!("a"<=b.charAt(d)&&"z">=b.charAt(d)||"A"<=b.charAt(d)&&"Z">=b.charAt(d)))return!1;return!0},na=function(){var b=/^\s*$/;return function(d){return d.match(b)?!0:!1}}(),ha=types.Class.extend({init:function(b){this.name=b},configure:function(b){throw types.internalError("unimplemented",!1);},toWrittenString:function(b){return"("+this.name+" ...)"},toDisplayedString:this.toWrittenString,toDomNode:function(b){b=document.createElement("div");
b.appendChild(document.createTextNode(this.toWrittenString()));return b}}),ea=function(b,d,p){return function(g,h){e(g,b,p,h.numParams);return Ba(b,d)(g,h,new c("",p,!1,!1,function(b){return types.EMPTY}))}},Ba=function(b,d){return function(c,g,e){l(c,g,k,b,"function",1,arguments);l(c,e,k,b,"function",2,arguments);return new (ha.extend({init:function(){this._super(b)},configure:function(b){var c={};c[d]=g;c[d+"Effect"]=e;return b.updateAll(c)}}))}},ca=helpers.assocListToHash,K=helpers.raise,W=function(b){var d=
function(b){"undefined"!==typeof console&&console.log&&(console.log("There was an error in a procedure converted from scheme to javascript"),b.stack?console.log(b.stack):console.log(b));throw b;};return function(c,g,e){return interpret.call(b,c,g,e,d)}},pa=function(b,d){var c=function(d,c,g){return interpret.call(b,d,c,g,function(b){throw b;})};return function(b){for(var g=[],p=1;p<arguments.length;p++)g.push(arguments[p]);c(d,g,b)}},la=function(b,d,p,t,e,h){c.call(this,d,p,t,e,h);this.typeName=b};
la.prototype=c.prototype;var qa=function(){la.apply(this,arguments)};qa.prototype=la.prototype;var Z=function(){la.apply(this,arguments)};Z.prototype=la.prototype;var ba=function(){la.apply(this,arguments)};ba.prototype=la.prototype;var ra=function(){la.apply(this,arguments)};ra.prototype=la.prototype;var Y=function(b){var d=b.name;return new types.ValuesWrapper([b,new qa(d,"make-"+d,b.numberOfArgs,!1,!1,function(d){return b.constructor.apply(null,[].slice.call(arguments,1))}),new Z(d,d+"?",1,!1,
!1,function(d,c){return b.predicate(c)}),new ba(d,d+"-ref",2,!1,!1,function(c,g,e){l(c,g,b.predicate,d+"-ref","struct:"+d,1,arguments);l(c,e,H,d+"-ref","non-negative exact integer",2,arguments);var p=b.numberOfFields;jsnums.greaterThanOrEqual(e,p)&&K(types.incompleteExn(types.exnFailContract,d+"-ref: slot index for <struct:"+d+"> not in [0, "+(p-1)+"]: "+e,[]));return b.accessor(g,jsnums.toFixnum(e))}),new ra(d,d+"-set!",3,!1,!1,function(c,g,e,h){l(c,g,b.predicate,d+"-set!","struct:"+d,1,arguments);
l(c,e,H,d+"-set!","non-negative exact integer",2,arguments);var p=b.numberOfFields;jsnums.greaterThanOrEqual(e,p)&&K(types.incompleteExn(types.exnFailContract,d+"-set!: slot index for <struct"+d+"> not in [0, "+(p-1)+"]: "+e,[]));b.mutator(g,jsnums.toFixnum(e),h)})])},M=jsnums.isSchemeNumber,N=jsnums.isReal,ua=jsnums.isRational,ia=jsnums.isInteger,H=function(b){return jsnums.isExact(b)&&ia(b)&&jsnums.greaterThanOrEqual(b,0)},D=function(b){return N(b)&&jsnums.greaterThanOrEqual(b,0)},fa=function(b){return N(b)&&
!(jsnums.equals(b,jsnums.inf)||jsnums.equals(b,jsnums.negative_inf))&&jsnums.lessThan(b,180)&&jsnums.greaterThan(b,0)},A=function(b){return ia(b)&&jsnums.greaterThanOrEqual(b,3)},Fa=function(b){return ia(b)&&jsnums.greaterThanOrEqual(b,1)},da=types.isSymbol,h=types.isChar,w=types.isString,O=types.isPair,ka=helpers.isList,Ga=helpers.isListOf,ta=types.isVector,sa=types.isBox,xa=types.isHash,Ea=types.isByteString,za=function(b){return H(b)&&jsnums.lessThanOrEqual(b,255)},Aa=function(b){return!0===b||
!1===b},k=types.isFunction,ma=function(b,d){return types.isEqual(b,d,new types.UnionFind)},va=function(b,d){return M(b)&&M(d)?jsnums.eqv(b,d):h(b)&&h(d)?b.val===d.val:b===d},I=world.Kernel.isImage,Pa=world.Kernel.isScene,J=world.Kernel.isColor,Ca=world.Kernel.nameToColor,Da=function(b){return(w(b)||da(b))&&("default"==b.toString().toLowerCase()||"decorative"==b.toString().toLowerCase()||"roman"==b.toString().toLowerCase()||"script"==b.toString().toLowerCase()||"swiss"==b.toString().toLowerCase()||
"modern"==b.toString().toLowerCase()||"symbol"==b.toString().toLowerCase()||"system"==b.toString().toLowerCase())||!b},$a=function(b){return(w(b)||da(b))&&("normal"==b.toString().toLowerCase()||"italic"==b.toString().toLowerCase()||"slant"==b.toString().toLowerCase())||!b},z=function(b){return(w(b)||da(b))&&("normal"==b.toString().toLowerCase()||"bold"==b.toString().toLowerCase()||"light"==b.toString().toLowerCase())||!b},F=world.Kernel.colorDb,oa=function(b){return(w(b)||da(b))&&("solid"==b.toString().toLowerCase()||
"outline"==b.toString().toLowerCase())||N(b)&&jsnums.greaterThanOrEqual(b,0)&&jsnums.lessThanOrEqual(b,255)},Ua=function(b){return(w(b)||da(b))&&("left"==b.toString().toLowerCase()||"right"==b.toString().toLowerCase()||"center"==b.toString().toLowerCase()||"middle"==b.toString().toLowerCase())},Oa=function(b){return(w(b)||da(b))&&("top"==b.toString().toLowerCase()||"bottom"==b.toString().toLowerCase()||"baseline"==b.toString().toLowerCase()||"center"==b.toString().toLowerCase()||"middle"==b.toString().toLowerCase())},
Za=function(b){return O(b)&&O(b.rest())&&b.rest().rest()===types.EMPTY},db=function(b){return-1<"button-down button-up drag move enter leave".split(" ").indexOf(b)},sb=function(b){return types.isEffect(b)||Ga(b,sb)},wa=types.isJsObject,Ma=function(b){return wa(b)&&"function"==typeof b.obj},S=function(b,d){for(var c=0;c<b.length;c++)d.call(null,b[c],c)},l=helpers.check,Ha=helpers.checkVarArity,ya=function(b,d,c,t,e){ka(d)||helpers.throwCheckError(b,{functionName:c,typeName:"list",ordinalPosition:helpers.ordinalize(t),
actualValue:d},t,e)},Ja=helpers.checkListOf,Xa=function(b,d,c,t,e,h){(!ka(d)||G(d)<c)&&helpers.throwCheckError(b,{functionName:t,typeName:"list with "+c+" or more elements",ordinalPosition:helpers.ordinalize(e),actualValue:d},e,h)},cb=function(b,d,c,t){if(0!==d.length){var g=G(d[0]);S(d,function(b,d){G(b)!=g&&(b=helpers.map(function(b){return" ~s"},t).join(""),b=helpers.format(c+": all lists must have the same size; arguments were:"+b,t),K(types.incompleteExn(types.exnFailContract,b,[])))})}},gb=
function(b){window.plt&&window.plt.wescheme&&plt.wescheme.WeSchemeIntentBus?(b=b.substring(0,20)+"..."+b.substring(b.length-20),plt.wescheme.WeSchemeIntentBus.notify("load-file",b)):console.log("Loading from "+b)};b["verify-boolean-branch-value"]=new c("verify-boolean-branch-value",4,!1,!1,function(b,d,c,t,e){!0!==t&&!1!==t&&(state.captureCurrentContinuationMarks(b).ref("moby-application-position-key"),K(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart(d,c),": expected a boolean value, but found: ",
new types.ColoredPart(types.toWrittenString(t),e)]),[])));return t});b["throw-cond-exhausted-error"]=new c("throw-cond-exhausted-error",1,!1,!1,function(b,d){K(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("cond",d),": all question results were false"]),[]))});b["print-values"]=new c("print-values",0,!0,!1,function(b,d){for(var c=!1,g=0;g<d.length;g++)d[g]!==types.VOID&&(b.getPrintHook()(d[g]),c=!0);c&&b.getDisplayHook()("\n");return types.VOID});b["check-expect"]=
new c("check-expect",2,!1,!1,function(b,d,c){(k(d)||k(c))&&K(types.incompleteExn(types.exnFailContract,"check-expect cannot compare functions",[]));if(!ma(d,c))for(d=helpers.format("check-expect: actual value ~s differs from ~s, the expected value.\n",[d,c]),b.getDisplayHook()(d),d=state.getStackTraceFromContinuationMarks(state.captureCurrentContinuationMarks(b)),c=0;c<d.length;c++)b.getPrintHook()(helpers.makeLocationDom(d[c]));return types.VOID});b.EXAMPLE=new c("EXAMPLE",2,!1,!1,function(b,d,c){(k(d)||
k(c))&&K(types.incompleteExn(types.exnFailContract,"EXAMPLE cannot compare functions",[]));if(!ma(d,c)){var g="EXAMPLE failed: ";g="<image>"===types.toWrittenString(d)&&"<image>"===types.toWrittenString(c)?g+"Expected the two <image>s to match.":g+helpers.format("Got ~s, but expected ~s.\n",[d,c]);b.getDisplayHook()(g);d=state.getStackTraceFromContinuationMarks(state.captureCurrentContinuationMarks(b));for(c=0;c<d.length;c++)b.getPrintHook()(helpers.makeLocationDom(d[c]))}return types.VOID});b["check-within"]=
new c("check-within",3,!1,!1,function(b,d,c,t){if(!D(t)){var g=helpers.format("check-within requires a non-negative real number for range, but given ~s.",[t]);K(types.incompleteExn(types.exnFailContract,g,[]))}(k(d)||k(c))&&K(types.incompleteExn(types.exnFailContract,"check-within cannot compare functions",[]));if(!(ma(d,c)||N(d)&&N(c)&&jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(d,c)),t)))for(g=helpers.format("check-within: actual value ~s is not within ~s of expected value ~s.",[d,t,c]),b.getDisplayHook()(g),
d=state.getStackTraceFromContinuationMarks(state.captureCurrentContinuationMarks(b)),c=0;c<d.length;c++)b.getPrintHook()(helpers.makeLocationDom(d[c]));return types.VOID});var mb=new c("print",1,!1,!1,function(b,d){b.getPrintHook()(types.toWrittenString(d));return types.VOID});b.write=new v("write",[new c("write",1,!1,!1,function(b,d){b.getPrintHook()(d);return types.VOID}),new c("write",2,!1,!0,function(b,d,c){throw types.internalError("write to a port not implemented yet.",state.captureCurrentContinuationMarks(b));
})]);b.display=new v("display",[new c("display",1,!1,!1,function(b,d){b.getDisplayHook()(types.toDisplayedString(d));return types.VOID}),new c("display",2,!1,!0,function(b,d,c){throw types.internalError("display to a port not implemented yet.",state.captureCurrentContinuationMarks(b));})]);b.newline=new v("newline",[new c("newline",0,!1,!0,function(b){b.getDisplayHook()("\n");b.v=types.VOID}),new c("newline",1,!1,!1,function(b,d){throw types.internalError("newline to a port not implemented yet.",
state.captureCurrentContinuationMarks(b));})]);b["current-print"]=new c("current-print",0,!1,!1,function(b){return mb});b["current-continuation-marks"]=new c("current-continuation-marks",0,!1,!1,function(b){return state.captureCurrentContinuationMarks(b)});b["continuation-mark-set->list"]=new c("continuation-mark-set->list",2,!1,!1,function(b,d,c){l(b,d,types.isContinuationMarkSet,"continuation-mark-set->list","continuation-mark-set",1,[d,c]);return types.list(d.ref(c))});b["for-each"]=new c("for-each",
2,!0,!1,function(b,d,c,t){var g=[d,c].concat(t);t.unshift(c);l(b,d,k,"for-each","function",1,g);S(t,function(d,c){ya(b,d,"for-each",c+2,g)});cb(b,t,"for-each",g);var p=function(b){if(b[0].isEmpty())return types.VOID;for(var c=[],g=[],t=0;t<b.length;t++)c.push(b[t].first()),g.push(b[t].rest());return u(d,c,function(b){return p(g)})};return p(t)});b["make-thread-cell"]=new v("make-thread-cell",[new c("make-thread-cell",1,!1,!1,function(b,d){return new types.ThreadCell(d,!1)}),new c("make-thread-cell",
2,!1,!1,function(b,d,c){return new types.ThreadCell(d,c)})]);b["make-continuation-prompt-tag"]=new v("make-continuation-prompt-tag",[new c("make-continuation-prompt-tag",0,!1,!1,function(b){return new types.ThreadCell}),new c("make-continuation-prompt-tag",1,!1,!1,function(b,d){return new types.ThreadCell(d)})]);var hb=function(b,d,p,t,e){for(var g=function(g){return new c(b,d+g,!1,t,function(b){assert.equal(arguments.length,d+g+1);for(var c=[arguments],t=0;t<arguments.length;t++)c.push(arguments[t]);
return e.apply(e,c.concat(p.slice(t-d-1)))})},h=[],k=0;k<=p.length;k++)h.push(g(k));return new v(b,h)};b["make-struct-type"]=hb("make-struct-type",4,[!1,types.EMPTY,types.symbol("prefab"),!1,types.EMPTY,!1],!1,function(b,d,c,t,e,h,m,q,v,u,w,ma){l(d,c,da,"make-struct-type","symbol",1,b);l(d,t,function(b){return!1===b||types.isStructType(b)},"make-struct-type","struct-type or #f",2,b);l(d,e,H,"make-struct-type","exact non-negative integer",3,b);l(d,h,H,"make-struct-type","exact non-negative integer",
4,b);Ja(d,w,H,"make-struct-type","exact non-negative integer",9,b);l(d,ma,function(b){return!1===b||k(b)},"make-struct-type","procedure or #f",10,b);b=e+1+(t?t.numberOfArgs:0);ma&&!V(b)(ma)&&K(types.incompleteExn(types.exnFailContract,helpers.format("make-struct-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",[b,ma]),[]));d=ma?pa(d,ma):!1;c=types.makeStructureType(c.toString(),t,jsnums.toFixnum(e),jsnums.toFixnum(h),m,d);return Y(c)});b["make-struct-field-accessor"]=
hb("make-struct-field-accessor",2,[!1],!1,function(b,d,c,t,e){l(d,c,function(b){return b instanceof ba&&1<b.numParams},"make-struct-field-accessor","accessor procedure that requires a field index",1,b);l(d,t,H,"make-struct-field-accessor","exact non-negative integer",2,b);l(d,e,function(b){return!1===b||da(b)},"make-struct-field-accessor","symbol or #f",3,b);var g=jsnums.toFixnum(t);return new ba(c.typeName,c.typeName+"-"+(e?e.toString():"field"+g),1,!1,!1,function(b,d){return c.impl(b,d,g)})});b["make-struct-field-mutator"]=
hb("make-struct-field-mutator",2,[!1],!1,function(b,d,c,t,e){l(d,c,function(b){return b instanceof ra&&1<b.numParams},"make-struct-field-mutator","mutator procedure that requires a field index",1,b);l(d,t,H,"make-struct-field-mutator","exact non-negative integer",2,b);l(d,e,function(b){return!1===b||da(b)},"make-struct-field-mutator","symbol or #f",3,b);var g=jsnums.toFixnum(t);return new ra(c.typeName,c.typeName+"-"+(e?e.toString():"field"+g),2,!1,!1,function(b,p){return c.impl(d,b,g,p)})});b["struct-type?"]=
new c("struct-type?",1,!1,!1,function(b,d){return types.isStructType(d)});b["struct-constructor-procedure?"]=new c("struct-constructor-procedure?",1,!1,!1,function(b,d){return d instanceof qa});b["struct-predicate-procedure?"]=new c("struct-predicate-procedure?",1,!1,!1,function(b,d){return d instanceof Z});b["struct-accessor-procedure?"]=new c("struct-accessor-procedure?",1,!1,!1,function(b,d){return d instanceof ba});b["struct-mutator-procedure?"]=new c("struct-mutator-procedure?",1,!1,!1,function(b,
d){return d instanceof ra});b["procedure-arity"]=new c("procedure-arity",1,!1,!1,function(b,d){return q(b,d)});b.apply=new c("apply",2,!0,!1,function(b,d,c,t){var g=[d,c].concat(t);l(b,d,k,"apply","function",1,g);t.unshift(c);c=t.pop();ya(b,c,"apply",t.length+2,g);t=t.concat(helpers.schemeListToArray(c));return u(d,t,Q)});b.values=new c("values",0,!0,!1,function(b,d){return 1===d.length?d[0]:new types.ValuesWrapper(d)});b["call-with-values"]=new c("call-with-values",2,!1,!1,function(b,d,c){l(b,d,
V(0),"call-with-values","procedure (arity 0)",1,arguments);l(b,c,k,"call-with-values","function",2,arguments);return u(d,[],function(b){return m(c,b)})});b.compose=new c("compose",0,!0,!1,function(g,d){S(d,function(b,c){l(g,b,k,"compose","function",c+1,d)});if(0==d.length)return b.values;var p=types.list(d).reverse(),t=function(b,d){return d.isEmpty()?b:u(new c("",1,!1,!1,function(b,c){return m(d.first(),c)}),[b],function(b){return t(b,d.rest())})};return new c("",0,!0,!1,function(b,d){return 1===
d.length?t(d[0],p):t(new types.ValuesWrapper(d),p)})});b["current-inexact-milliseconds"]=new c("current-inexact-milliseconds",0,!1,!1,function(b){return jsnums.makeFloat((new Date).valueOf())});b["current-seconds"]=new c("current-seconds",0,!1,!1,function(b){return Math.floor((new Date).getTime()/1E3)});b.not=new c("not",1,!1,!1,function(b,d){return!1===d});b["void"]=new c("void",0,!0,!1,function(b,d){return types.VOID});b.random=new v("random",[new c("random",0,!1,!1,function(b){return types["float"](Math.random())}),
new c("random",1,!1,!1,function(b,d){l(b,d,H,"random","non-negative exact integer",1,arguments);return Math.floor(Math.random()*jsnums.toFixnum(d))})]);b.sleep=new v("sleep",[new c("sleep",0,!1,!1,function(b){return types.VOID}),new c("sleep",1,!1,!1,function(b,d){l(b,d,D,"sleep","non-negative real number",1);var c=jsnums.toFixnum(jsnums.multiply(d,1E3));return y(function(b,d){setTimeout(function(){b(types.VOID)},c)})})]);b.identity=new c("identity",1,!1,!1,function(b,d){return d});b.raise=new c("raise",
1,!1,!1,function(b,d){return K(d)});b.error=new c("error",1,!0,!0,function(b,d,c){var g=[d].concat(c);l(b,d,function(b){return da(b)||w(b)},"error","symbol or string",1,g);if(da(d)){0===c.length&&K(types.incompleteExn(types.exnFail,"error: "+d.val,[]));var p=c.shift();l(b,p,w,"error","string",2,g);c.unshift(d);K(types.incompleteExn(types.exnFail,helpers.format("~s: "+p.toString(),c),[]))}else{b=[d.toString()];for(d=0;d<c.length;d++)b.push(types.toWrittenString(c[d]));K(types.incompleteExn(types.exnFail,
b.join(""),[]))}});b["make-exn"]=new c("make-exn",2,!1,!1,function(b,d,c){return types.exn(d,c)});b["exn-message"]=new c("exn-message",1,!1,!1,function(b,d){l(b,d,types.isExn,"exn-message","exn",1,[d]);return""+types.exnMessage(d)});b["exn-continuation-marks"]=new c("exn-continuation-marks",1,!1,!1,function(b,d){l(b,d,types.isExn,"exn-continuation-marks","exn",1,[d]);return types.exnContMarks(d)});b["make-exn:fail"]=new c("make-exn:fail",2,!1,!1,function(b,d,c){return types.exnFail(d,c)});b["make-exn:fail:contract"]=
new c("make-exn:fail:contract",2,!1,!1,function(b,d,c){return types.exnFailContract(d,c)});b["make-exn:fail:contract:division-by-zero"]=new c("make-exn:fail:contract:division-by-zero",2,!1,!1,function(b,d,c){return types.exnFailContractDivisionByZero(d,c)});b["*"]=new c("*",0,!0,!1,function(b,d){S(d,function(c,g){l(b,c,M,"*","number",g+1,d)});var c=types.rational(1),g;for(g=0;g<d.length;g++)c=jsnums.multiply(d[g],c);return c});b["-"]=new c("-",1,!0,!1,function(b,d,c){var g=[d].concat(c);l(b,d,M,"-",
"number",1,g);S(c,function(d,c){l(b,d,M,"-","number",c+2,g)});if(0==c.length)return jsnums.subtract(0,d);for(var p=0;p<c.length;p++)d=jsnums.subtract(d,c[p]);return d});b["+"]=new c("+",0,!0,!1,function(b,d){S(d,function(c,g){l(b,c,M,"+","number",g+1,d)});if(0==d.length)return 0;for(var c=d[0],g=1;g<d.length;g++)c=jsnums.add(c,d[g]);return c});b["="]=new c("=",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);S(t,function(d,c){l(b,d,M,"=","number",c+1,t)});return U(t,jsnums.equals)});b["<>"]=new c("<>",
2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);S(t,function(d,c){l(b,d,M,"<>","number",c+1,t)});return!U(t,jsnums.equals)});b["=~"]=new c("=~",3,!1,!1,function(b,d,c,t){l(b,d,N,"=~","real",1,arguments);l(b,c,N,"=~","real",2,arguments);l(b,t,D,"=~","non-negative-real",3,arguments);return jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(d,c)),t)});b["/"]=new c("/",2,!0,!1,function(b,d,c,t){var g=[d,c].concat(t);S(g,function(d,c){l(b,d,M,"/","number",c+1,g)});var p=function(d){var c;try{var g=
state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");var p=g[g.length-1];var t=p.first();p=p.rest();for(c=0;c<d;c++)p=p.rest();var e=new types.Message([new types.ColoredPart("/",t),": cannot divide by ",new types.ColoredPart("zero",p.first())])}catch(zb){e=new types.Message(["/: cannot divide by zero"])}K(types.incompleteExn(types.exnFailContractDivisionByZero,e,[]))};jsnums.equals(c,0)&&p(1);d=jsnums.divide(d,c);for(c=0;c<t.length;c++)jsnums.equals(t[c],0)&&p(2+c),d=jsnums.divide(d,
t[c]);return d});b.sub1=new c("sub1",1,!1,!1,function(b,d){l(b,d,M,"sub1","number",1,arguments);return jsnums.subtract(d,1)});b.add1=new c("add1",1,!1,!1,function(b,d){l(b,d,M,"add1","number",1,arguments);return jsnums.add(d,1)});b["<"]=new c("<",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);S(t,function(d,c){l(b,d,M,"<","number",c+1,t)});return U(t,jsnums.lessThan)});b[">"]=new c(">",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);S(t,function(d,c){l(b,d,M,">","number",c+1,t)});return U(t,
jsnums.greaterThan)});b["<="]=new c("<=",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);S(t,function(d,c){l(b,d,M,"<=","number",c+1,t)});return U(t,jsnums.lessThanOrEqual)});b[">="]=new c(">=",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);S(t,function(d,c){l(b,d,M,">=","number",c+1,t)});return U(t,jsnums.greaterThanOrEqual)});b.abs=new c("abs",1,!1,!1,function(b,d){l(b,d,N,"abs","real",1);return jsnums.abs(d)});b.quotient=new c("quotient",2,!1,!1,function(b,d,c){l(b,d,ia,"quotient","integer",
1,arguments);l(b,c,ia,"quotient","integer",2,arguments);return jsnums.quotient(d,c)});b.remainder=new c("remainder",2,!1,!1,function(b,d,c){l(b,d,ia,"remainder","integer",1,arguments);l(b,c,ia,"remainder","integer",2,arguments);return jsnums.remainder(d,c)});b.modulo=new c("modulo",2,!1,!1,function(b,d,c){l(b,d,ia,"modulo","integer",1,arguments);l(b,c,ia,"modulo","integer",2,arguments);return jsnums.modulo(d,c)});b.max=new c("max",1,!0,!1,function(b,d,c){c.unshift(d);S(c,function(d,g){l(b,d,N,"max",
"real",g+1,c)});for(var g=1;g<c.length;g++)jsnums.greaterThan(c[g],d)&&(d=c[g]);return d});b.min=new c("min",1,!0,!1,function(b,d,c){c.unshift(d);S(c,function(d,g){l(b,d,N,"min","real",g+1,c)});for(var g=1;g<c.length;g++)jsnums.lessThan(c[g],d)&&(d=c[g]);return d});b.gcd=new c("gcd",1,!0,!1,function(b,d,c){var g=[d].concat(c);l(b,d,ia,"gcd","integer",1,g);S(c,function(d,c){l(b,d,ia,"gcd","integer",c+2,g)});return jsnums.gcd(d,c)});b.lcm=new c("lcm",1,!0,!1,function(b,d,c){var g=[d].concat(c);l(b,
d,ia,"lcm","integer",1,g);S(c,function(d,c){l(b,d,ia,"lcm","integer",c+2,g)});return jsnums.lcm(d,c)});b.floor=new c("floor",1,!1,!1,function(b,d){l(b,d,N,"floor","real",1);return jsnums.floor(d)});b.ceiling=new c("ceiling",1,!1,!1,function(b,d){l(b,d,N,"ceiling","real",1);return jsnums.ceiling(d)});b.round=new c("round",1,!1,!1,function(b,d){l(b,d,N,"round","real",1);return jsnums.round(d)});b.numerator=new c("numerator",1,!1,!1,function(b,d){l(b,d,ua,"numerator","rational number",1);return jsnums.numerator(d)});
b.denominator=new c("denominator",1,!1,!1,function(b,d){l(b,d,ua,"denominator","rational number",1);return jsnums.denominator(d)});b.expt=new c("expt",2,!1,!1,function(b,d,c){l(b,d,M,"expt","number",1,arguments);l(b,c,M,"expt","number",2,arguments);return jsnums.expt(d,c)});b.exp=new c("exp",1,!1,!1,function(b,d){l(b,d,M,"exp","number",1);return jsnums.exp(d)});b.log=new c("log",1,!1,!1,function(b,d){l(b,d,M,"log","number",1);return jsnums.log(d)});b.sin=new c("sin",1,!1,!1,function(b,d){l(b,d,M,
"sin","number",1);return jsnums.sin(d)});b.cos=new c("cos",1,!1,!1,function(b,d){l(b,d,M,"cos","number",1);return jsnums.cos(d)});b.tan=new c("tan",1,!1,!1,function(b,d){l(b,d,M,"tan","number",1);return jsnums.tan(d)});b.asin=new c("asin",1,!1,!1,function(b,d){l(b,d,M,"asin","number",1);return jsnums.asin(d)});b.acos=new c("acos",1,!1,!1,function(b,d){l(b,d,M,"acos","number",1);return jsnums.acos(d)});b.atan=new c("atan",1,!1,!1,function(b,d){l(b,d,M,"atan","number",1);return jsnums.atan(d)});b.sinh=
new c("sinh",1,!1,!1,function(b,d){l(b,d,M,"sinh","number",1);return jsnums.sinh(d)});b.cosh=new c("cosh",1,!1,!1,function(b,d){l(b,d,M,"cosh","number",1);return jsnums.cosh(d)});b.sqr=new c("sqr",1,!1,!1,function(b,d){l(b,d,M,"sqr","number",1);return jsnums.sqr(d)});b.sqrt=new c("sqrt",1,!1,!1,function(b,d){l(b,d,M,"sqrt","number",1);return jsnums.sqrt(d)});b["nth-root"]=new c("nth-root",2,!1,!1,function(b,d,c){l(b,d,M,"nth-root","number",1,arguments);l(b,c,M,"nth-root","number",2,arguments);var g=
jsnums.expt(d,jsnums.divide(1,c)),p=jsnums.round(g),e=jsnums.subtract(g,p);return jsnums.lessThan(e,1E-11)?jsnums.toExact(p):g});b["integer-sqrt"]=new c("integer-sqrt",1,!1,!1,function(b,d){l(b,d,ia,"integer-sqrt","integer",1);return jsnums.integerSqrt(d)});b["make-rectangular"]=new c("make-rectangular",2,!1,!1,function(b,d,c){l(b,d,N,"make-rectangular","real",1,arguments);l(b,c,N,"make-rectangular","real",2,arguments);return types.complex(d,c)});b["make-polar"]=new c("make-polar",2,!1,!1,function(b,
d,c){l(b,d,N,"make-polar","real",1,arguments);l(b,c,N,"make-polar","real",2,arguments);return jsnums.makeComplexPolar(d,c)});b["real-part"]=new c("real-part",1,!1,!1,function(b,d){l(b,d,M,"real-part","number",1);return jsnums.realPart(d)});b["imag-part"]=new c("imag-part",1,!1,!1,function(b,d){l(b,d,M,"imag-part","number",1);return jsnums.imaginaryPart(d)});b.angle=new c("angle",1,!1,!1,function(b,d){l(b,d,M,"angle","number",1);return jsnums.angle(d)});b.magnitude=new c("magnitude",1,!1,!1,function(b,
d){l(b,d,M,"magnitude","number",1);return jsnums.magnitude(d)});b.conjugate=new c("conjugate",1,!1,!1,function(b,d){l(b,d,M,"conjugate","number",1);return jsnums.conjugate(d)});b.sgn=new c("sgn",1,!1,!1,function(b,d){l(b,d,N,"sgn","real number",1);return jsnums.greaterThan(d,0)?1:jsnums.lessThan(d,0)?-1:0});b["inexact->exact"]=new c("inexact->exact",1,!1,!1,function(b,d){l(b,d,M,"inexact->exact","number",1);try{return jsnums.toExact(d)}catch(p){K(types.exnFailContract("inexact->exact: no exact representation for "+
types.toWrittenString(d),!1))}});b["exact->inexact"]=new c("exact->inexact",1,!1,!1,function(b,d){l(b,d,M,"exact->inexact","number",1);return jsnums.toInexact(d)});b["number->string"]=new c("number->string",1,!1,!1,function(b,d){l(b,d,M,"number->string","number",1);return types.string(d+"")});b["string->number"]=new c("string->number",1,!1,!1,function(b,d){l(b,d,w,"string->number","string",1);return(b=jsnums.fromString(d))?jsnums.toExact(b):b});b["xml->s-exp"]=new c("xml->s-exp",1,!1,!1,function(b,
d){l(b,d,w,"xml->s-exp","string",1);if(0==d.length)return types.string("");try{var c=new ActiveXObject("Microsoft.XMLDOM");c.async="false";c.loadXML(s)}catch(La){c=(new DOMParser).parseFromString(s,"text/xml")}var g=function(b){for(var d=types.EMPTY,c=0;c<b.length;c++){var g=types.cons(types.symbol(b.item(c).nodeName),types.cons(b.item(c).nodeValue,types.EMPTY));d=types.cons(g,d)}return types.cons(types.symbol("@"),d).reverse()},e=function(b){if(b.nodeType==Node.ELEMENT_NODE){for(var d=types.EMPTY,
c=b.firstChild;null!=c;){var p=e(c);d=w(p)&&!d.isEmpty()&&w(d.first())?types.cons(d.first()+p,d.rest()):types.cons(p,d);c=c.nextSibling}d=d.reverse();d=types.cons(g(b.attributes),d);return d=types.cons(types.symbol(b.nodeName),d)}return b.nodeType==Node.TEXT_NODE?b.textContent:b.nodeType==Node.CDATA_SECTION_NODE?b.data:types.EMPTY};return e(c.firstChild)});b["procedure?"]=new c("procedure?",1,!1,!1,function(b,d){return k(d)});b["pair?"]=new c("pair?",1,!1,!1,function(b,d){return O(d)});b["cons?"]=
new c("cons?",1,!1,!1,function(b,d){return O(d)});b["empty?"]=new c("empty?",1,!1,!1,function(b,d){return d===types.EMPTY});b["null?"]=new c("null?",1,!1,!1,function(b,d){return d===types.EMPTY});b["undefined?"]=new c("undefined?",1,!1,!1,function(b,d){return d===types.UNDEFINED});b["void?"]=new c("void?",1,!1,!1,function(b,d){return d===types.VOID});b["symbol?"]=new c("symbol?",1,!1,!1,function(b,d){return da(d)});b["string?"]=new c("string?",1,!1,!1,function(b,d){return w(d)});b["char?"]=new c("char?",
1,!1,!1,function(b,d){return h(d)});b["boolean?"]=new c("boolean?",1,!1,!1,function(b,d){return Aa(d)});b["vector?"]=new c("vector?",1,!1,!1,function(b,d){return ta(d)});b["struct?"]=new c("struct?",1,!1,!1,function(b,d){return types.isStruct(d)});b["eof-object?"]=new c("eof-object?",1,!1,!1,function(b,d){return d===types.EOF});b["color?"]=new c("color?",1,!1,!1,function(b,d){return types.isColor(d)});b["posn?"]=new c("posn?",1,!1,!1,function(b,d){return types.isPosn(d)});b["bytes?"]=new c("bytes?",
1,!1,!1,function(b,d){return Ea(d)});b["byte?"]=new c("byte?",1,!1,!1,function(b,d){return za(d)});b["number?"]=new c("number?",1,!1,!1,function(b,d){return M(d)});b["complex?"]=new c("complex?",1,!1,!1,function(b,d){return void 0!==d.i?types.TRUE:types.FALSE});b["real?"]=new c("real?",1,!1,!1,function(b,d){return N(d)});b["rational?"]=new c("rational?",1,!1,!1,function(b,d){return ua(d)});b["integer?"]=new c("integer?",1,!1,!1,function(b,d){return ia(d)});b["exact?"]=new c("exact?",1,!1,!1,function(b,
d){l(b,d,M,"exact?","number",1);return jsnums.isExact(d)});b["inexact?"]=new c("inexact?",1,!1,!1,function(b,d){l(b,d,M,"inexact?","number",1);return jsnums.isInexact(d)});b["odd?"]=new c("odd?",1,!1,!1,function(b,d){l(b,d,ia,"odd?","integer",1);return jsnums.equals(jsnums.modulo(d,2),1)});b["even?"]=new c("even?",1,!1,!1,function(b,d){l(b,d,ia,"even?","integer",1);return jsnums.equals(jsnums.modulo(d,2),0)});b["zero?"]=new c("zero?",1,!1,!1,function(b,d){l(b,d,M,"zero?","number",1);return jsnums.equals(0,
d)});b["positive?"]=new c("positive?",1,!1,!1,function(b,d){l(b,d,N,"positive?","real",1);return jsnums.greaterThan(d,0)});b["negative?"]=new c("negative?",1,!1,!1,function(b,d){l(b,d,N,"negative?","real",1);return jsnums.lessThan(d,0)});b["box?"]=new c("box?",1,!1,!1,function(b,d){return sa(d)});b["hash?"]=new c("hash?",1,!1,!1,function(b,d){return xa(d)});b["eq?"]=new c("eq?",2,!1,!1,function(b,d,c){return d===c});b["eqv?"]=new c("eqv?",2,!1,!1,function(b,d,c){return va(d,c)});b["equal?"]=new c("equal?",
2,!1,!1,function(b,d,c){return ma(d,c)});b["equal~?"]=new c("equal~?",3,!1,!1,function(b,d,c,t){l(b,t,D,"equal~?","non-negative number",3,arguments);return ma(d,c)||N(d)&&N(c)&&jsnums.lessThanOrEqual(jsnums.abs(jsnums.subtract(d,c)),t)});b["false?"]=new c("false?",1,!1,!1,function(b,d){return!1===d});b["boolean=?"]=new c("boolean=?",2,!1,!1,function(b,d,c){l(b,d,Aa,"boolean=?","boolean",1,arguments);l(b,c,Aa,"boolean=?","boolean",2,arguments);return d===c});b["symbol=?"]=new c("symbol=?",2,!1,!1,
function(b,d,c){l(b,d,da,"symbol=?","symbol",1,arguments);l(b,c,da,"symbol=?","symbol",2,arguments);return ma(d,c)});b["js-object?"]=new c("js-object?",1,!1,!1,function(b,d){return wa(d)});b.cons=new c("cons",2,!1,!1,function(b,d,c){return types.cons(d,c)});b.car=new c("car",1,!1,!1,function(b,d){l(b,d,O,"car","pair",1);return d.first()});b.cdr=new c("cdr",1,!1,!1,function(b,d){l(b,d,O,"cdr","pair",1);return d.rest()});b.caar=new c("caar",1,!1,!1,function(b,d){l(b,d,function(b){return O(b)&&O(b.first())},
"caar","caarable value",1);return d.first().first()});b.cadr=new c("cadr",1,!1,!1,function(b,d){l(b,d,function(b){return O(b)&&O(b.rest())},"cadr","cadrable value",1);return d.rest().first()});b.cdar=new c("cdar",1,!1,!1,function(b,d){l(b,d,function(b){return O(b)&&O(b.first())},"cdar","cdarable value",1);return d.first().rest()});b.cddr=new c("cddr",1,!1,!1,function(b,d){l(b,d,function(b){return O(b)&&O(b.rest())},"cddr","cddrable value",1);return d.rest().rest()});b.caaar=new c("caaar",1,!1,!1,
function(b,d){l(b,d,function(b){return O(b)&&O(b.first())&&O(b.first().first())},"caaar","caaarable value",1);return d.first().first().first()});b.caadr=new c("caadr",1,!1,!1,function(b,d){l(b,d,function(b){return O(b)&&O(b.rest())&&O(b.rest().first())},"caadr","caadrable value",1);return d.rest().first().first()});b.cadar=new c("cadar",1,!1,!1,function(b,d){l(b,d,function(b){return O(b)&&O(b.first())&&O(b.first().rest())},"cadar","cadarable value",1);return d.first().rest().first()});b.cdaar=new c("cdaar",
1,!1,!1,function(b,d){l(b,d,function(b){return O(b)&&O(b.first())&&O(b.first().first())},"cdaar","cdaarable value",1);return d.first().first().rest()});b.cdadr=new c("cdadr",1,!1,!1,function(b,d){l(b,d,function(b){return O(b)&&O(b.rest())&&O(b.rest().first())},"cdadr","cdadrable value",1);return d.rest().first().rest()});b.cddar=new c("cddar",1,!1,!1,function(b,d){l(b,d,function(b){return O(b)&&O(b.first())&&O(b.first().rest())},"cddar","cddarable value",1);return d.first().rest().rest()});b.caddr=
new c("caddr",1,!1,!1,function(b,d){l(b,d,function(b){return O(b)&&O(b.rest())&&O(b.rest().rest())},"caddr","caddrable value",1);return d.rest().rest().first()});b.cdddr=new c("cdddr",1,!1,!1,function(b,d){l(b,d,function(b){return O(b)&&O(b.rest())&&O(b.rest().rest())},"cdddr","cdddrable value",1);return d.rest().rest().rest()});b.cadddr=new c("cadddr",1,!1,!1,function(b,d){l(b,d,function(b){return O(b)&&O(b.rest())&&O(b.rest().rest())&&O(b.rest().rest().rest())},"cadddr","cadddrable value",1);return d.rest().rest().rest().first()});
b.rest=new c("rest",1,!1,!1,function(b,d){l(b,d,function(b){return ka(b)&&b!==types.EMPTY},"rest","non-empty list",1);return d.rest()});b.first=new c("first",1,!1,!1,function(b,d){l(b,d,function(b){return ka(b)&&b!==types.EMPTY},"first","non-empty list",1);return d.first()});b.second=new c("second",1,!1,!1,function(b,d){Xa(b,d,2,"second",1);return d.rest().first()});b.third=new c("third",1,!1,!1,function(b,d){Xa(b,d,3,"third",1);return d.rest().rest().first()});b.fourth=new c("fourth",1,!1,!1,function(b,
d){Xa(b,d,4,"fourth",1);return d.rest().rest().rest().first()});b.fifth=new c("fifth",1,!1,!1,function(b,d){Xa(b,d,5,"fifth",1);return d.rest().rest().rest().rest().first()});b.sixth=new c("sixth",1,!1,!1,function(b,d){Xa(b,d,6,"sixth",1);return d.rest().rest().rest().rest().rest().first()});b.seventh=new c("seventh",1,!1,!1,function(b,d){Xa(b,d,7,"seventh",1);return d.rest().rest().rest().rest().rest().rest().first()});b.eighth=new c("eighth",1,!1,!1,function(b,d){Xa(b,d,8,"eighth",1);return d.rest().rest().rest().rest().rest().rest().rest().first()});
b.length=new c("length",1,!1,!1,function(b,d){ya(b,d,"length",1,arguments);return jsnums.makeRational(G(d))});b["list?"]=new c("list?",1,!1,!1,function(b,d){return ka(d)});b.list=new c("list",0,!0,!1,function(b,d){return types.list(d)});b["make-list"]=new c("make-list",2,!1,!1,function(b,d,c){l(b,d,H,"make-list","non-negative exact integer",1,arguments);for(var g=[],p=0;p<d;p++)g.push(c);return types.list(g)});b.range=new c("range",3,!1,!1,function(b,d,c,t){l(b,d,M,"range","number",1,arguments);l(b,
c,M,"range","number",2,arguments);l(b,t,M,"range","number",3,arguments);var g=[];if(jsnums.lessThan(d,c)&&jsnums.greaterThan(t,0))for(var p=d;jsnums.lessThanOrEqual(p,c);p=jsnums.add(p,t))g.push(p);else if(jsnums.greaterThan(d,c)&&jsnums.lessThan(t,0))for(p=d;jsnums.greaterThanOrEqual(p,c);p=jsnums.add(p,t))g.push(p);return types.list(g)});b["list*"]=new c("list*",1,!0,!1,function(b,d,c){var g=[d].concat(c);if(0==c.length)return d;var p=c.pop();ya(b,p,"list*",c.length+2,g);c.unshift(d);return B(b,
[types.list(c),p])});b["list-ref"]=new c("list-ref",2,!1,!1,function(b,d,c){ya(b,d,"list-ref",1,arguments);l(b,c,H,"list-ref","non-negative exact integer",2,arguments);var g=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");g=g[g.length-1];for(var p=d,e=jsnums.toFixnum(c),h=0;h<e;h++)(p.isEmpty()||p.rest().isEmpty())&&K(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("list-ref",g.first()),": index ",new types.ColoredPart(e,g.rest().rest().first()),
" is too large for list: ",new types.ColoredPart(types.toWrittenString(d),g.rest().first())]),[])),p=p.rest();return p.first()});b["list-tail"]=new c("list-tail",2,!1,!1,function(b,d,c){ya(b,d,"list-tail",1,arguments);l(b,x,H,"list-tail","non-negative exact integer",2,arguments);d=origList;for(var g=jsnums.toFixnum(c),p=0;p<g;p++){if(d.isEmpty()){var e="list-tail: index "+g+" is too large for list: "+types.toWrittenString(origList);K(types.incompleteExn(types.exnFailContract,e,[]))}d=d.rest()}return d});
b.append=new c("append",0,!0,!1,function(b,d){return B(b,d)});b.reverse=new c("reverse",1,!1,!1,function(b,d){ya(b,d,"reverse",1);return d.reverse()});b.map=new c("map",2,!0,!1,function(b,d,c,t){var g=[d,c].concat(t);t.unshift(c);l(b,d,k,"map","function",1,g);S(t,function(d,c){ya(b,d,"map",c+2,g)});cb(b,t,"map",g);var p=function(b,d,c){if(d[0].isEmpty())return c.reverse();for(var g=[],t=[],e=0;e<d.length;e++)g.push(d[e].first()),t.push(d[e].rest());return u(b,g,function(d){return p(b,t,types.cons(d,
c))})};return p(d,t,types.EMPTY)});b.andmap=new c("andmap",2,!0,!1,function(b,d,c,t){var g=[d,c].concat(t);t.unshift(c);l(b,d,k,"andmap","function",1,g);S(t,function(d,c){ya(b,d,"andmap",c+2,g)});cb(b,t,"andmap",g);var p=function(b,d){if(d[0].isEmpty())return!0;for(var c=[],g=[],t=0;t<d.length;t++)c.push(d[t].first()),g.push(d[t].rest());return u(b,c,function(d){return d&&p(b,g)})};return p(d,t)});b.ormap=new c("ormap",2,!0,!1,function(b,d,c,t){var g=[d,c].concat(t);t.unshift(c);l(b,d,k,"ormap","function",
1,g);S(t,function(d,c){ya(b,d,"ormap",c+2,g)});cb(b,t,"ormap",g);var p=function(b,d){if(d[0].isEmpty())return!1;for(var c=[],g=[],t=0;t<d.length;t++)c.push(d[t].first()),g.push(d[t].rest());return u(b,c,function(d){return d||p(b,g)})};return p(d,t)});b.memq=new c("memq",2,!1,!1,function(b,d,c){for(ya(b,c,"memq",2,arguments);!c.isEmpty();){var g=c.first();if(d===g)return c;c=c.rest()}return!1});b.memv=new c("memv",2,!1,!1,function(b,d,c){for(ya(b,c,"memv",2,arguments);!c.isEmpty();){if(va(d,c.first()))return c;
c=c.rest()}return!1});b.member=new c("member",2,!1,!1,function(b,d,c){for(ya(b,c,"member",2,arguments);!c.isEmpty();){if(ma(d,c.first()))return c;c=c.rest()}return!1});b["member?"]=new c("member?",2,!1,!1,function(b,d,c){for(ya(b,c,"member?",2,arguments);!c.isEmpty();){if(ma(d,c.first()))return!0;c=c.rest()}return!1});b.memf=new c("memf",2,!1,!0,function(b,d,c){l(b,d,k,"memf","function",1,arguments);ya(b,c,"memf",2,arguments);var g=function(b){return b.isEmpty()?!1:u(d,[b.first()],function(d){return d?
b:g(b.rest())})};return g(c)});b.assq=new c("assq",2,!1,!1,function(b,d,c){for(Ja(b,c,O,"assq","pair",2,arguments);!c.isEmpty();){var g=c.first().first();if(d===g)return c.first();c=c.rest()}return!1});b.assv=new c("assv",2,!1,!1,function(b,d,c){for(Ja(b,c,O,"assv","pair",2,arguments);!c.isEmpty();){if(va(d,c.first().first()))return c.first();c=c.rest()}return!1});b.assoc=new c("assoc",2,!1,!1,function(b,d,c){for(Ja(b,c,O,"assoc","pair",2,arguments);!c.isEmpty();){if(ma(d,c.first().first()))return c.first();
c=c.rest()}return!1});b.remove=new c("remove",2,!1,!1,function(b,d,c){ya(b,c,"remove",2,arguments);for(var g=c,p=types.EMPTY;!c.isEmpty();){if(ma(d,c.first()))return B(b,[p.reverse(),c.rest()]);p=types.cons(c.first(),p);c=c.rest()}return g});b["remove-all"]=new c("remove-all",2,!1,!1,function(b,d,c){ya(b,c,"remove-all",2,arguments);for(var g=types.EMPTY;!c.isEmpty();)ma(d,c.first())||(g=types.cons(c.first(),g)),c=c.rest();return g.reverse()});b.filter=new c("filter",2,!1,!1,function(b,d,c){l(b,d,
V(1),"filter","function (arity 1)",1,arguments);ya(b,c,"filter",2);var g=function(b,d,c){return d.isEmpty()?c.reverse():u(b,[d.first()],function(p){return p?g(b,d.rest(),types.cons(d.first(),c)):g(b,d.rest(),c)})};return g(d,c,types.EMPTY)});b.foldl=new c("foldl",3,!0,!1,function(b,d,c,t,e){e.unshift(t);var g=[d,c].concat(e);l(b,d,k,"foldl","function",1,g);S(e,function(d,c){ya(b,d,"foldl",c+3,g)});cb(b,e,"foldl",g);return aa(d,c,e)});b.foldr=new c("foldr",3,!0,!1,function(b,d,c,t,e){e.unshift(t);
var g=[d,c].concat(e);l(b,d,k,"foldr","function",1,g);S(e,function(d,c){ya(b,d,"foldr",c+3,g)});cb(b,e,"foldr",g);for(t=0;t<e.length;t++)e[t]=e[t].reverse();return aa(d,c,e)});b.quicksort=new c("quicksort",2,!1,!1,T("quicksort"));b.sort=new c("sort",2,!1,!1,T("sort"));b.argmax=new c("argmax",2,!1,!1,function(b,d,c){var g=arguments;l(b,d,k,"argmax","function",1,g);l(b,c,O,"argmax","non-empty list",2,g);var p=function(c,t,e){return c.isEmpty()?e:u(d,[c.first()],function(d){l(b,d,N,"argmax","procedure that returns real numbers",
1,g);return jsnums.greaterThan(d,t)?p(c.rest(),d,c.first()):p(c.rest(),t,e)})};return u(d,[c.first()],function(d){l(b,d,N,"argmax","procedure that returns real numbers",1,g);return p(c.rest(),d,c.first())})});b.argmin=new c("argmin",2,!1,!1,function(b,d,c){var g=arguments;l(b,d,k,"argmin","function",1,g);l(b,c,O,"argmin","non-empty list",2,g);var p=function(c,t,e){return c.isEmpty()?e:u(d,[c.first()],function(d){l(b,d,N,"argmin","procedure that returns real numbers",1,g);return jsnums.lessThan(d,
t)?p(c.rest(),d,c.first()):p(c.rest(),t,e)})};return u(d,[c.first()],function(d){l(b,d,N,"argmin","procedure that returns real numbers",1,g);return p(c.rest(),d,c.first())})});b["build-list"]=new c("build-list",2,!1,!1,function(b,d,c){l(b,d,H,"build-list","non-negative exact integer",1,arguments);l(b,c,k,"build-list","function",2,arguments);var g=function(b,p){return jsnums.greaterThanOrEqual(b,d)?p.reverse():u(c,[b],function(d){return g(b+1,types.cons(d,p))})};return g(0,types.EMPTY)});b.box=new c("box",
1,!1,!1,function(b,d){return types.box(d)});b["box-immutable"]=new c("box-immutable",1,!1,!1,function(b,d){return types.boxImmutable(d)});b.unbox=new c("unbox",1,!1,!1,function(b,d){l(b,d,sa,"unbox","box",1);return d.unbox()});b["set-box!"]=new c("set-box!",2,!1,!1,function(b,d,c){l(b,d,function(b){return sa(b)&&b.mutable},"set-box!","mutable box",1,arguments);d.set(c);return types.VOID});b["make-hash"]=new v("make-hash",[new c("make-hash",0,!1,!1,function(){return types.hash(types.EMPTY)}),new c("make-hash",
1,!1,!1,function(b,d){Ja(b,d,O,"make-hash","list of pairs",1);return types.hash(d)})]);b["make-hasheq"]=new v("make-hasheq",[new c("make-hasheq",0,!1,!1,function(b){return types.hashEq(types.EMPTY)}),new c("make-hasheq",1,!1,!1,function(b,d){Ja(b,d,O,"make-hasheq","list of pairs",1);return types.hashEq(d)})]);b["hash-set!"]=new c("hash-set!",3,!1,!1,function(b,d,c,t){l(b,d,xa,"hash-set!","hash",1,arguments);d.hash.put(c,t);return types.VOID});b["hash-ref"]=new v("hash-ref",[new c("hash-ref",2,!1,
!1,function(b,d,c){l(b,d,xa,"hash-ref","hash",1,arguments);if(!d.hash.containsKey(c)){var g=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");g=g[g.length-1];K(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("hash-ref",g.first()),": no value found for key ",new types.ColoredPart(types.toWrittenString(c),g.rest().rest().first())]),[]))}return d.hash.get(c)}),new c("hash-ref",3,!1,!1,function(b,d,c,t){l(b,d,xa,"hash-ref","hash",1,arguments);
return d.hash.containsKey(c)?d.hash.get(c):k(t)?u(t,[],Q):t})]);b["hash-remove!"]=new c("hash-remove",2,!1,!1,function(b,d,c){l(b,d,xa,"hash-remove!","hash",1,arguments);d.hash.remove(c);return types.VOID});b["hash-map"]=new c("hash-map",2,!1,!1,function(b,d,c){l(b,d,xa,"hash-map","hash",1,arguments);l(b,c,k,"hash-map","function",2,arguments);var g=d.hash.keys(),p=function(b,t){if(b>=g.length)return t;var e=d.hash.get(g[b]);return u(c,[g[b],e],function(d){return p(b+1,types.cons(d,t))})};return p(0,
types.EMPTY)});b["hash-for-each"]=new c("hash-for-each",2,!1,!1,function(b,d,c){l(b,d,xa,"hash-for-each","hash",1,arguments);l(b,c,k,"hash-for-each","function",2,arguments);var g=d.hash.keys(),p=function(b){if(b>=g.length)return types.VOID;var t=d.hash.get(g[b]);return u(c,[g[b],t],function(d){return p(b+1)})};return p(0)});b["make-string"]=new c("make-string",2,!1,!1,function(b,d,c){l(b,d,H,"make-string","non-negative exact integer",1,arguments);l(b,c,h,"make-string","character",2,arguments);for(var g=
[],p=0;jsnums.lessThan(p,d);p++)g.push(c.val);return types.string(g)});b.replicate=new c("replicate",2,!1,!1,function(b,d,c){l(b,d,H,"replicate","non-negative exact integer",1,arguments);l(b,c,w,"replicate","string",2,arguments);for(var g="",p=c.toString(),e=0;jsnums.lessThan(e,d);e++)g+=p;return types.string(g)});b.string=new c("string",0,!0,!1,function(b,d){S(d,function(c,g){l(b,c,h,"string","character",g+1,d)});for(var c=[],g=0;g<d.length;g++)c.push(d[g].val);return types.string(c)});b["string-length"]=
new c("string-length",1,!1,!1,function(b,d){l(b,d,w,"string-length","string",1);return d.length});b["string-contains?"]=new c("string-contains?",2,!1,!1,function(b,d,c){l(b,d,w,"string-contains?","string",1);l(b,c,w,"string-contains?","string",2);return-1<d.toString().indexOf(c.toString())});b["string-ref"]=new c("string-ref",2,!1,!1,function(b,d,c){l(b,d,w,"string-ref","string",1,arguments);l(b,c,H,"string-ref","non-negative exact integer",2,arguments);var g=jsnums.toFixnum(c);if(g>=d.length){types.toWrittenString(d);
var p=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");p=p[p.length-1];K(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("string-ref",p.first()),": index ",g," out of range [0, ",d.length-1,"] for string: ",new types.ColoredPart(types.toWrittenString(d),p.rest().first())]),[]))}return types["char"](d.charAt(g))});b["string=?"]=new c("string=?",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);S(t,function(d,c){l(b,d,w,"string=?","string",
c+1,t)});return U(t,function(b,d){return b.toString()===d.toString()})});b["string<>?"]=new c("string<>?",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);S(t,function(d,c){l(b,d,w,"string<>?","string",c+1,t)});return!U(t,function(b,d){return b.toString()===d.toString()})});b["string-ci=?"]=new c("string-ci=?",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);for(d=0;d<t.length;d++)l(b,t[d],w,"string-ci=?","string",d+1,t),t[d]=t[d].toString().toLowerCase();return U(t,function(b,d){return b===
d})});b["string-ci<>?"]=new c("string-ci<>?",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);for(d=0;d<t.length;d++)l(b,t[d],w,"string-ci<>?","string",d+1,t),t[d]=t[d].toString().toLowerCase();return!U(t,function(b,d){return b===d})});b["string<?"]=new c("string<?",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);S(t,function(d,c){l(b,d,w,"string<?","string",c+1,t)});return U(t,function(b,d){return b.toString()<d.toString()})});b["string>?"]=new c("string>?",2,!0,!1,function(b,d,c,t){t.unshift(c);
t.unshift(d);S(t,function(d,c){l(b,d,w,"string>?","string",c+1,t)});return U(t,function(b,d){return b.toString()>d.toString()})});b["string<=?"]=new c("string<=?",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);S(t,function(d,c){l(b,d,w,"string<=?","string",c+1,t)});return U(t,function(b,d){return b.toString()<=d.toString()})});b["string>=?"]=new c("string>=?",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);S(t,function(d,c){l(b,d,w,"string>=?","string",c+1,t)});return U(t,function(b,d){return b.toString()>=
d.toString()})});b["string-ci<?"]=new c("string-ci<?",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);for(d=0;d<t.length;d++)l(b,t[d],w,"string-ci<?","string",d+1,t),t[d]=t[d].toString().toLowerCase();return U(t,function(b,d){return b<d})});b["string-ci>?"]=new c("string-ci>?",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);for(d=0;d<t.length;d++)l(b,t[d],w,"string-ci>?","string",d+1,t),t[d]=t[d].toString().toLowerCase();return U(t,function(b,d){return b>d})});b["string-ci<=?"]=new c("string-ci<=?",
2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);for(d=0;d<t.length;d++)l(b,t[d],w,"string-ci<=?","string",d+1,t),t[d]=t[d].toString().toLowerCase();return U(t,function(b,d){return b<=d})});b["string-ci>=?"]=new c("string-ci>=?",2,!0,!1,function(b,d,c,t){t.unshift(c);t.unshift(d);for(d=0;d<t.length;d++)l(b,t[d],w,"string-ci>=?","string",d+1,t),t[d]=t[d].toString().toLowerCase();return U(t,function(b,d){return b>=d})});b.substring=new v("substring",[new c("substring",2,!1,!1,function(b,d,c){l(b,
d,w,"substring","string",1,arguments);l(b,c,H,"substring","non-negative exact integer",2,arguments);var g=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");g=g[g.length-1];var p=jsnums.toFixnum(c);if(p>d.length)K(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("substring",g.first()),": starting index ",new types.ColoredPart(p,g.rest().rest().first())," out of range ","[0, ",d.length,"] for string: ",new types.ColoredPart(types.toWrittenString(d),
g.rest().first())]),[]));else return types.string(d.substring(jsnums.toFixnum(p)))}),new c("substring",3,!1,!1,function(b,d,c,t){l(b,d,w,"substring","string",1,arguments);l(b,c,H,"substring","non-negative exact integer",2,arguments);l(b,t,H,"substring","non-negative exact integer",3,arguments);var g=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");g=g[g.length-1];var p=jsnums.toFixnum(c),e=jsnums.toFixnum(t);p>d.length&&K(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("substring",
g.first()),": starting index ",new types.ColoredPart(p,g.rest().rest().first())," out of range ","[0, ",d.length,"] for string: ",new types.ColoredPart(types.toWrittenString(d),g.rest().first())]),[]));(e<p||e>d.length)&&K(types.incompleteExn(types.exnFailContract,new types.Message([new types.ColoredPart("substring",g.first()),": ending index ",new types.ColoredPart(e,g.rest().rest().rest().first())," out of range ","[0, ",d.length,"] for string: ",new types.ColoredPart(types.toWrittenString(d),g.rest().first())]),
[]));return types.string(d.substring(p,e))})]);b["string-append"]=new c("string-append",0,!0,!1,function(b,d){S(d,function(c,g){l(b,c,w,"string-append","string",g+1,d)});for(var c=0;c<d.length;c++)d[c]=d[c].toString();return types.string(d.join(""))});b["string->list"]=new c("string->list",1,!1,!1,function(b,d){l(b,d,w,"string->list","string",1);b=types.EMPTY;for(var c=d.length-1;0<=c;c--)b=types.cons(types["char"](d.charAt(c)),b);return b});b["list->string"]=new c("list->string",1,!1,!1,function(b,
d){Ja(b,d,h,"list->string","character",1);for(b=[];!d.isEmpty();)b.push(d.first().val),d=d.rest();return types.string(b)});b["string-copy"]=new c("string-copy",1,!1,!1,function(b,d){l(b,d,w,"string-copy","string",1);return types.string(d.toString())});b["string->symbol"]=new c("string->symbol",1,!1,!1,function(b,d){l(b,d,w,"string->symbol","string",1);return types.symbol(d.toString())});b["symbol->string"]=new c("symbol->string",1,!1,!1,function(b,d){l(b,d,da,"symbol->string","symbol",1);return types.string(d.toString())});
b.format=new c("format",1,!0,!1,function(b,d,c){l(b,d,w,"format","string",1,[d].concat(c));return types.string(helpers.format(d,c,"format"))});b.printf=new c("printf",1,!0,!1,function(b,d,c){l(b,d,w,"printf","string",1,[d].concat(c));d=helpers.format(d,c,"printf");b.getDisplayHook()(d);return types.VOID});b["string->int"]=new c("string->int",1,!1,!1,function(b,d){l(b,d,function(b){return w(b)&&1==b.length},"string->int","1-letter string",1);return d.charCodeAt(0)});b["int->string"]=new c("int->string",
1,!1,!1,function(b,d){l(b,d,function(b){if(!ia(b))return!1;b=jsnums.toFixnum(b);return 0<=b&&55296>b||57343<b&&1114111>=b},"int->string","exact integer in [0,55295] or [57344,1114111]",1);return types.string(String.fromCharCode(jsnums.toFixnum(d)))});b.explode=new c("explode",1,!1,!1,function(b,d){l(b,d,w,"explode","string",1);b=types.EMPTY;for(var c=d.length-1;0<=c;c--)b=types.cons(types.string(d.charAt(c)),b);return b});b.implode=new c("implode",1,!1,!1,function(b,d){Ja(b,d,function(b){return w(b)&&
1==b.length},"implode","1-letter strings",1);for(b=[];!d.isEmpty();)b.push(d.first().toString()),d=d.rest();return types.string(b)});b["string-alphabetic?"]=new c("string-alphabetic?",1,!1,!1,function(b,d){l(b,d,w,"string-alphabetic?","string",1);return X(d)});b["string-ith"]=new c("string-ith",2,!1,!1,function(b,d,c){l(b,d,w,"string-ith","string",1,arguments);l(b,c,function(b){return H(b)&&jsnums.lessThan(b,d.length)},"string-ith","exact integer in [0, length of the given string minus 1 ("+(d.length-
1)+")]",2,arguments);return types.string(d.charAt(jsnums.toFixnum(c)))});b["string-lower-case?"]=new c("string-lower-case?",1,!1,!1,function(b,d){l(b,d,w,"string-lower-case?","string",1);b=d.toString();return X(d)&&b.toLowerCase()===b});b["string-numeric?"]=new c("string-numeric?",1,!1,!1,function(b,d){l(b,d,w,"string-numeric?","string",1);a:{for(b=0;b<d.length;b++)if(!("0"<=d.charAt(b)&&"9">=d.charAt(b))){d=!1;break a}d=!0}return d});b["string-upper-case?"]=new c("string-upper-case?",1,!1,!1,function(b,
d){l(b,d,w,"string-upper-case?","string",1);b=d.toString();return X(d)&&b.toUpperCase()===b});b["string-whitespace?"]=new c("string-whitespace?",1,!1,!1,function(b,d){l(b,d,w,"string-whitespace?","string",1);return na(d)});b["build-string"]=new c("build-string",2,!1,!1,function(b,d,c){l(b,d,H,"build-string","non-negative exact integer",1,arguments);l(b,c,k,"build-string","function",2,arguments);var g=function(p,t){return jsnums.greaterThanOrEqual(p,d)?types.string(t):u(c,[p],function(d){l(b,d,h,"build-string",
"procedure that returns a char",2);return g(p+1,t.push(d.val))})};return g(0,[])});b["string->immutable-string"]=new c("string->immutable-string",1,!1,!1,function(b,d){l(b,d,w,"string->immutable-string","string",1);return d.toString()});b["string-set!"]=new c("string-set!",3,!1,!1,function(b,d,c,t){l(b,d,function(b){return w(b)&&"string"!=typeof b},"string-set!","mutable string",1,arguments);l(b,c,H,"string-set!","non-negative exact integer",2,arguments);l(b,t,h,"string-set!","character",3,arguments);
if(jsnums.greaterThanOrEqual(c,d.length)){var g="string-set!: index "+n+" out of range [0, "+(d.length-1)+"] for string: "+types.toWrittenString(d);K(types.incompleteExn(types.exnFailContract,g,[]))}d.set(jsnums.toFixnum(c),t.val);return types.VOID});b["string-fill!"]=new c("string-fill!",2,!1,!1,function(b,d,c){l(b,d,function(b){return w(b)&&"string"!=typeof b},"string-fill!","mutable string",1,arguments);l(b,c,h,"string-fill!","character",2,arguments);for(var g=0;g<d.length;g++)d.set(g,c.val);return types.VOID});
b["make-vector"]=new c("make-vector",2,!1,!1,function(b,d,c){l(b,d,H,"make-vector","non-negative exact integer",1,arguments);for(var g=jsnums.toFixnum(d),p=[],e=0;e<g;e++)p.push(c);return types.vector(p)});b.vector=new c("vector",0,!0,!1,function(b,d){return types.vector(d)});b["vector-length"]=new c("vector-length",1,!1,!1,function(b,d){l(b,d,ta,"vector-length","vector",1);return d.length()});b["vector-ref"]=new c("vector-ref",2,!1,!1,function(b,d,c){l(b,d,ta,"vector-ref","vector",1,arguments);l(b,
c,H,"vector-ref","non-negative exact integer",2,arguments);var g=jsnums.toFixnum(c);if(g>=d.length()){var p="vector-ref: index "+g+" out of range [0, "+(d.length()-1)+"] for vector: "+types.toWrittenString(d);K(types.incompleteExn(types.exnFailContract,p,[]))}return d.ref(g)});b["vector-set!"]=new c("vector-set!",3,!1,!1,function(b,d,c,e){l(b,d,ta,"vector-set!","vector",1,arguments);l(b,c,H,"vector-set!","non-negative exact integer",2,arguments);var g=jsnums.toFixnum(c);if(g>=d.length()){var p="vector-set!: index "+
g+" out of range [0, "+(d.length()-1)+"] for vector: "+types.toWrittenString(d);K(types.incompleteExn(types.exnFailContract,p,[]))}d.set(g,e);return types.VOID});b["vector->list"]=new c("vector->list",1,!1,!1,function(b,d){l(b,d,ta,"vector->list","vector",1);return d.toList()});b["list->vector"]=new c("list->vector",1,!1,!1,function(b,d){ya(b,d,"list->vector",1);return types.vector(helpers.schemeListToArray(d))});b["build-vector"]=new c("build-vector",2,!1,!1,function(b,d,c){l(b,d,H,"build-vector",
"non-negative exact integer",1,arguments);l(b,c,k,"build-vector","function",2,arguments);var g=function(b,p){return jsnums.greaterThanOrEqual(b,d)?types.vector(p):u(c,[b],function(d){p.push(d);return g(b+1,p)})};return g(0,[])});b["char=?"]=new c("char=?",2,!0,!1,function(b,d,c,e){e.unshift(c);e.unshift(d);S(e,function(d,c){l(b,d,h,"char=?","character",c+1,e)});return U(e,function(b,d){return b.val===d.val})});b["char<?"]=new c("char<?",2,!0,!1,function(b,d,c,e){e.unshift(c);e.unshift(d);S(e,function(d,
c){l(b,d,h,"char<?","character",c+1,e)});return U(e,function(b,d){return b.val<d.val})});b["char>?"]=new c("char>?",2,!0,!1,function(b,d,c,e){e.unshift(c);e.unshift(d);S(e,function(d,c){l(b,d,h,"char>?","character",c+1,e)});return U(e,function(b,d){return b.val>d.val})});b["char<=?"]=new c("char<=?",2,!0,!1,function(b,d,c,e){e.unshift(c);e.unshift(d);S(e,function(d,c){l(b,d,h,"char<=?","character",c+1,e)});return U(e,function(b,d){return b.val<=d.val})});b["char>=?"]=new c("char>=?",2,!0,!1,function(b,
d,c,e){e.unshift(c);e.unshift(d);S(e,function(d,c){l(b,d,h,"char>=?","character",c+1,e)});return U(e,function(b,d){return b.val>=d.val})});b["char-ci=?"]=new c("char-ci=?",2,!0,!1,function(b,d,c,e){e.unshift(c);e.unshift(d);S(e,function(d,c){l(b,d,h,"char-ci=?","character",c+1,e)});return U(e,function(b,d){return b.val.toLowerCase()===d.val.toLowerCase()})});b["char-ci<?"]=new c("char-ci<?",2,!0,!1,function(b,d,c,e){e.unshift(c);e.unshift(d);S(e,function(d,c){l(b,d,h,"char-ci<?","character",c+1,e)});
return U(e,function(b,d){return b.val.toLowerCase()<d.val.toLowerCase()})});b["char-ci>?"]=new c("char-ci>?",2,!0,!1,function(b,d,c,e){e.unshift(c);e.unshift(d);S(e,function(d,c){l(b,d,h,"char-ci>?","character",c+1,e)});return U(e,function(b,d){return b.val.toLowerCase()>d.val.toLowerCase()})});b["char-ci<=?"]=new c("char-ci<=?",2,!0,!1,function(b,d,c,e){e.unshift(c);e.unshift(d);S(e,function(d,c){l(b,d,h,"char-ci<=?","character",c+1,e)});return U(e,function(b,d){return b.val.toLowerCase()<=d.val.toLowerCase()})});
b["char-ci>=?"]=new c("char-ci>=?",2,!0,!1,function(b,d,c,e){e.unshift(c);e.unshift(d);S(e,function(d,c){l(b,d,h,"char-ci>=?","character",c+1,e)});return U(e,function(b,d){return b.val.toLowerCase()>=d.val.toLowerCase()})});b["char-alphabetic?"]=new c("char-alphabetic?",1,!1,!1,function(b,d){l(b,d,h,"char-alphabetic?","character",1);return X(d.val)});b["char-numeric?"]=new c("char-numeric?",1,!1,!1,function(b,d){l(b,d,h,"char-numeric?","character",1);return"0"<=d.val&&"9">=d.val});b["char-whitespace?"]=
new c("char-whitespace?",1,!1,!1,function(b,d){l(b,d,h,"char-whitespace?","character",1);return na(d.val)});b["char-upper-case?"]=new c("char-upper-case?",1,!1,!1,function(b,d){l(b,d,h,"char-upper-case?","character",1);return X(d.val)&&d.val.toUpperCase()===d.val});b["char-lower-case?"]=new c("char-lower-case?",1,!1,!1,function(b,d){l(b,d,h,"char-lower-case?","character",1);return X(d.val)&&d.val.toLowerCase()===d.val});b["char->integer"]=new c("char->integer",1,!1,!1,function(b,d){l(b,d,h,"char->integer",
"character",1);return d.val.charCodeAt(0)});b["integer->char"]=new c("integer->char",1,!1,!1,function(b,d){l(b,d,function(b){if(!ia(b))return!1;b=jsnums.toFixnum(b);return 0<=b&&55296>b||57343<b&&1114111>=b},"integer->char","exact integer in [0,#x10FFFF], not in [#xD800,#xDFFF]",1);return types["char"](String.fromCharCode(jsnums.toFixnum(d)))});b["char-upcase"]=new c("char-upcase",1,!1,!1,function(b,d){l(b,d,h,"char-upcase","character",1);return types["char"](d.val.toUpperCase())});b["char-downcase"]=
new c("char-downcase",1,!1,!1,function(b,d){l(b,d,h,"char-downcase","character",1);return types["char"](d.val.toLowerCase())});b["make-posn"]=new c("make-posn",2,!1,!1,function(b,d,c){return types.posn(d,c)});b["posn-x"]=new c("posn-x",1,!1,!1,function(b,d){l(b,d,types.isPosn,"posn-x","posn",1);return types.posnX(d)});b["posn-y"]=new c("posn-y",1,!1,!1,function(b,d){l(b,d,types.isPosn,"posn-y","posn",1);return types.posnY(d)});b["key=?"]=new c("key=?",2,!1,!1,function(b,d,c){types.isChar(d)&&(d=d.getValue());
types.isChar(c)&&(c=c.getValue());return d.toString().toLowerCase()===c.toString().toLowerCase()});b["image?"]=new c("image?",1,!1,!1,function(b,d){return I(d)});b["image=?"]=new c("image=?",2,!1,!1,function(b,d,c){l(b,d,I,"image=?","image",1);l(b,c,I,"image=?","image",2);return ma(d,c)});b["make-color"]=new v("make-color",[new c("make-color",3,!1,!1,function(b,d,c,e){l(b,d,za,"make-color","exact number between 0 and 255",1,arguments);l(b,c,za,"make-color","exact number between 0 and 255",2,arguments);
l(b,e,za,"make-color","exact number between 0 and 255",3,arguments);return types.color(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(e))}),new c("make-color",4,!1,!1,function(b,d,c,e,h){l(b,d,za,"make-color","exact number between 0 and 255",1,arguments);l(b,c,za,"make-color","exact number between 0 and 255",2,arguments);l(b,e,za,"make-color","exact number between 0 and 255",3,arguments);l(b,h,za,"make-color","exact number between 0 and 255",4,arguments);return types.color(jsnums.toFixnum(d),
jsnums.toFixnum(c),jsnums.toFixnum(e),jsnums.toFixnum(h))})]);b["color-red"]=new c("color-red",1,!1,!1,function(b,d){l(b,d,types.isColor,"color-red","color",1);return types.colorRed(d)});b["color-green"]=new c("color-green",1,!1,!1,function(b,d){l(b,d,types.isColor,"color-green","color",1);return types.colorGreen(d)});b["color-blue"]=new c("color-blue",1,!1,!1,function(b,d){l(b,d,types.isColor,"color-blue","color",1);return types.colorBlue(d)});b["color-alpha"]=new c("color-alpha",1,!1,!1,function(b,
d){l(b,d,types.isColor,"color-alpha","color",1);return types.colorAlpha(d)});b["empty-scene"]=new v("empty-scene",[new c("empty-scene",2,!1,!1,function(b,d,c){l(b,d,D,"empty-scene","non-negative number",1,arguments);l(b,c,D,"empty-scene","non-negative number",2,arguments);var g=F.get("white");return world.Kernel.sceneImage(jsnums.toFixnum(d),jsnums.toFixnum(c),[],!0,g)}),new c("empty-scene",3,!1,!1,function(b,d,c,e){l(b,d,D,"empty-scene","non-negative number",1,arguments);l(b,c,D,"empty-scene","non-negative number",
2,arguments);l(b,e,J,"empty-scene","color",3,arguments);F.get(e)&&(e=F.get(e));return world.Kernel.sceneImage(jsnums.toFixnum(d),jsnums.toFixnum(c),[],!0,e)})]);

b["put-image"]=new c("put-image",4,!1,!1,function(b,d,c,e,h){l(b,d,I,"put-image","image",1,arguments);l(b,c,N,"put-image","real",2,arguments);l(b,e,N,"put-image","real",3,arguments);l(b,h,function(b){return Pa(b)||I(b)},"put-image","image",4,arguments);c=jsnums.toFixnum(c);e=jsnums.toFixnum(e);if(Pa(h))return h.add(d,c,h.getHeight()-e);var g=
world.Kernel.sceneImage(h.getWidth(),h.getHeight(),[],!1,null);g=g.add(h,h.getWidth()/2,h.getHeight()/2);return g=g.add(d,c,h.getHeight()-e)});

b["translate"]=new c("translate",4,!1,!1,function(b,d,c,e,h){l(b,d,I,"translate","image",1,arguments);l(b,c,N,"translate","real",2,arguments);l(b,e,N,"translate","real",3,arguments);l(b,h,function(b){return Pa(b)||I(b)},"translate","image",4,arguments);c=jsnums.toFixnum(c);e=jsnums.toFixnum(e);if(Pa(h))return h.add(d,c,h.getHeight()-e);var g=
world.Kernel.sceneImage(h.getWidth(),h.getHeight(),[],!1,null);g=g.add(h,h.getWidth()/2,h.getHeight()/2);return g=g.add(d,c,h.getHeight()-e)});

b["place-image"]=new c("place-image",4,!1,!1,function(b,d,c,e,h){l(b,d,I,"place-image","image",1,arguments);l(b,c,N,"place-image","real",2,arguments);l(b,e,N,"place-image","real",3,arguments);l(b,h,function(b){return Pa(b)||I(b)},"place-image","image",4,arguments);c=jsnums.toFixnum(c);e=jsnums.toFixnum(e);if(Pa(h))return h.add(d,c,e);var g=world.Kernel.sceneImage(h.getWidth(),
h.getHeight(),[],!1,null);g=g.add(h,h.getWidth()/2,h.getHeight()/2);return g=g.add(d,c,e)});b["place-image/align"]=new c("place-image/align",6,!1,!1,function(b,d,c,e,h,k,m){l(b,d,I,"place-image/align","image",1,arguments);l(b,c,N,"place-image/align","real number",2,arguments);l(b,e,N,"place-image/align","real number",3,arguments);l(b,h,Ua,"place-image/align","x-place",4,arguments);l(b,k,Oa,"place-image/align","y-place",5,arguments);l(b,m,function(b){return Pa(b)||I(b)},"place-image/align","image",
6,arguments);c=jsnums.toFixnum(c);e=jsnums.toFixnum(e);"left"==h?c+=d.getWidth()/2:"right"==h&&(c-=d.getWidth()/2);"top"==k?e+=d.getHeight()/2:"bottom"==k&&(e-=d.getHeight()/2);if(Pa(m))return m.add(d,c,e);var g=world.Kernel.sceneImage(m.getWidth(),m.getHeight(),[],!1,null);g=g.add(m,m.getWidth()/2,m.getHeight()/2);return g=g.add(d,c,e)});b["scene+line"]=new c("scene+line",6,!1,!1,function(b,d,c,e,h,k,m){l(b,d,I,"scene+line","image",1,arguments);l(b,c,N,"scene+line","finite real number",2,arguments);
l(b,e,N,"scene+line","finite real number",3,arguments);l(b,h,N,"scene+line","finite real number",4,arguments);l(b,k,N,"scene+line","finite real number",5,arguments);l(b,m,J,"scene+line","color",6,arguments);F.get(m)&&(m=F.get(m));newScene=world.Kernel.sceneImage(jsnums.toFixnum(d.getWidth()),jsnums.toFixnum(d.getHeight()),[],!1,null);newScene=newScene.add(d,d.getWidth()/2,d.getHeight()/2);line=world.Kernel.lineImage(jsnums.toFixnum(h-c),jsnums.toFixnum(k-e),m);leftMost=Math.min(c,h);topMost=Math.min(e,
k);return newScene.add(line,line.getWidth()/2+leftMost,line.getHeight()/2+topMost)});b["put-pinhole"]=new c("put-pinhole",3,!1,!1,function(b,d,c,e){l(b,d,I,"put-pinhole","image",1,arguments);l(b,c,N,"put-pinhole","real",2,arguments);l(b,e,N,"put-pinhole","real",3,arguments);return d.updatePinhole(jsnums.toFixnum(c),jsnums.toFixnum(e))});b.circle=new c("circle",3,!1,!1,function(b,d,c,e){l(b,d,D,"circle","non-negative number",1,arguments);l(b,c,oa,"circle",'style ("solid" / "outline") or an opacity value [0-255])',
2,arguments);l(b,e,J,"circle","color",3,arguments);F.get(e)&&(e=F.get(e));return world.Kernel.circleImage(jsnums.toFixnum(d),c.toString(),e)});b.star=new v("star",[new c("star",5,!1,!1,function(b,d,c,e,h,k){l(b,d,A,"star","positive integer greater than or equal to 3",1,arguments);l(b,c,D,"star","non-negative number",2,arguments);l(b,e,D,"star","non-negative number",3,arguments);l(b,h,oa,"star",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,J,"star","color",5,arguments);
F.get(k)&&(k=F.get(k));return world.Kernel.starImage(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(e),h.toString(),k)}),new c("star",3,!1,!1,function(b,d,c,e){l(b,d,D,"star","non-negative number",1,arguments);l(b,c,oa,"star",'style ("solid" / "outline") or an opacity value [0-255])',2,arguments);l(b,e,J,"star","color",3,arguments);F.get(e)&&(e=F.get(e));return world.Kernel.polygonImage(jsnums.toFixnum(d),jsnums.toFixnum(5),jsnums.toFixnum(2),c.toString(),e,"star")})]);b["radial-star"]=new c("radial-star",
5,!1,!1,function(b,d,c,e,h,k){l(b,d,function(b){return H(b)&&jsnums.greaterThanOrEqual(b,2)},"radial-star","positive integer greater than or equal to 2",1,arguments);l(b,c,function(b){return N(b)&&jsnums.greaterThan(b,0)},"radial-star","positive number",2,arguments);l(b,e,function(b){return N(b)&&jsnums.greaterThan(b,0)},"radial-star","positive number",3,arguments);l(b,h,oa,"radial-star",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,J,"radial-star","color",5,arguments);
F.get(k)&&(k=F.get(k));return world.Kernel.starImage(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(e),h.toString(),k)});b.rectangle=new c("rectangle",4,!1,!1,function(b,d,c,e,h){l(b,d,D,"rectangle","non-negative number",1,arguments);l(b,c,D,"rectangle","non-negative number",2,arguments);l(b,e,oa,"rectangle",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);l(b,h,J,"rectangle","color",4,arguments);F.get(h)&&(h=F.get(h));return world.Kernel.rectangleImage(jsnums.toFixnum(d),
jsnums.toFixnum(c),e.toString(),h)});b.polygon=new c("polygon",3,!1,!1,function(b,d,c,e){Xa(b,d,3,"polygon",1);l(b,d,function(b){return Ga(b,types.isPosn)},"polygon","list of posns",1,arguments);l(b,c,oa,"polygon",'style ("solid" / "outline") or an opacity value [0-255])',2,arguments);l(b,e,J,"polygon","color",3,arguments);F.get(e)&&(e=F.get(e));return world.Kernel.posnImage(helpers.flattenSchemeListToArray(d),c.toString(),e)});b["regular-polygon"]=new c("regular-polygon",4,!1,!1,function(b,d,c,e,
h){l(b,d,D,"regular-polygon","non-negative number",1,arguments);l(b,c,A,"regular-polygon","positive integer greater than or equal to 3",2,arguments);l(b,e,oa,"regular-polygon",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);l(b,h,J,"regular-polygon","color",4,arguments);F.get(h)&&(h=F.get(h));return world.Kernel.polygonImage(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(1),e.toString(),h)});b["add-polygon"]=new c("add-polygon",4,!1,!1,function(b,d,c,e,h){Xa(b,c,3,"add-polygon",
1);l(b,d,I,"add-polygon","image",1,arguments);l(b,c,function(b){return Ga(b,types.isPosn)},"add-polygon","list of posns",2,arguments);l(b,e,oa,"add-polygon",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);l(b,h,J,"add-polygon","color",4,arguments);F.get(h)&&(h=F.get(h));var g=helpers.flattenSchemeListToArray(c),p=g.map(function(b){return b._fields[0]}),t=g.map(function(b){return b._fields[1]});p=p.map(function(b){return jsnums.toFixnum(b)});t=t.map(function(b){return jsnums.toFixnum(b)});
p=-Math.round(Math.min.apply(null,p));t=-Math.round(Math.min.apply(null,t));console.log("deltaX",p,"deltaY",t);var k=world.Kernel.posnImage(g,e.toString(),h);console.log("primitve is passing posns",g);return world.Kernel.overlayImage(k,d,p,t)});b["star-polygon"]=new c("star-polygon",5,!1,!1,function(b,d,c,e,h,k){l(b,d,D,"star-polygon","non-negative number",1,arguments);l(b,c,A,"star-polygon","positive integer greater than or equal to 3",2,arguments);l(b,e,Fa,"star-polygon","positive integer greater than or equal to 1",
3,arguments);l(b,h,oa,"star-polygon",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,J,"star-polygon","color",5,arguments);F.get(k)&&(k=F.get(k));return world.Kernel.polygonImage(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(e),h.toString(),k)});b.rhombus=new c("rhombus",4,!1,!1,function(b,d,c,e,h){l(b,d,D,"rhombus","non-negative number",1,arguments);l(b,c,D,"rhombus","non-negative number",2,arguments);l(b,e,oa,"rhombus",'style ("solid" / "outline") or an opacity value [0-255])',
3,arguments);l(b,h,J,"rhombus","color",4,arguments);F.get(h)&&(h=F.get(h));return world.Kernel.rhombusImage(jsnums.toFixnum(d),jsnums.toFixnum(c),e.toString(),h)});b.square=new c("square",3,!1,!1,function(b,d,c,e){l(b,d,D,"square","non-negative number",1,arguments);l(b,c,oa,"square",'style ("solid" / "outline") or an opacity value [0-255])',2,arguments);l(b,e,J,"square","color",3,arguments);F.get(e)&&(e=F.get(e));return world.Kernel.squareImage(jsnums.toFixnum(d),c.toString(),e)});b.triangle=new c("triangle",
3,!1,!1,function(b,d,c,e){l(b,d,D,"triangle","non-negative number",1,arguments);l(b,c,oa,"triangle",'style ("solid" / "outline") or an opacity value [0-255])',2,arguments);l(b,e,J,"triangle","color",3,arguments);F.get(e)&&(e=F.get(e));return world.Kernel.triangleImage(jsnums.toFixnum(d),jsnums.toFixnum(300),jsnums.toFixnum(d),c.toString(),e)});b["triangle/sas"]=new c("triangle/sas",5,!1,!1,function(b,d,c,e,h,k){l(b,d,D,"triangle/sas","non-negative number",1,arguments);l(b,c,fa,"triangle/sas","angle less than 180 degrees and greater than 0 degrees",
2,arguments);l(b,e,D,"triangle/sas","non-negative number",3,arguments);l(b,h,oa,"triangle/sas",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,J,"triangle/sas","color",5,arguments);F.get(k)&&(k=F.get(k));d=jsnums.toFixnum(d);c=jsnums.toFixnum(c%360);e=jsnums.toFixnum(e);var g=d*d+e*e-2*d*e*Math.cos(c*Math.PI/180),p=Math.sqrt(g);0>=g?K(types.incompleteExn(types.exnFailContract,"The given side, angle and side will not form a triangle: "+d+", "+c+", "+e,[])):(1E-5<p-(d+
e)||1E-5<d-(p+e)||1E-5<e-(d+p))&&K(types.incompleteExn(types.exnFailContract,"The given side, angle and side will not form a triangle: "+d+", "+c+", "+e,[]));g=180/Math.PI*Math.acos((p*p+e*e-d*d)/(2*p*e));return world.Kernel.triangleImage(jsnums.toFixnum(e),jsnums.toFixnum(g),jsnums.toFixnum(p),h.toString(),k)});b["triangle/sss"]=new c("triangle/sss",5,!1,!1,function(b,d,c,e,h,k){l(b,d,D,"triangle/sss","non-negative number",1,arguments);l(b,c,D,"triangle/sss","non-negative number",2,arguments);l(b,
e,D,"triangle/sss","non-negative number",3,arguments);l(b,h,oa,"triangle/sss",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,J,"triangle/sss","color",5,arguments);F.get(k)&&(k=F.get(k));d=jsnums.toFixnum(d);c=jsnums.toFixnum(c);e=jsnums.toFixnum(e);(1E-5<e-(d+c)||1E-5<d-(e+c)||1E-5<c-(d+e))&&K(types.incompleteExn(types.exnFailContract,"The given sides will not form a triangle: "+d+", "+c+", "+e,[]));var g=180/Math.PI*Math.acos((c*c+e*e-d*d)/(2*c*e));return world.Kernel.triangleImage(jsnums.toFixnum(e),
jsnums.toFixnum(g),jsnums.toFixnum(c),h.toString(),k)});b["triangle/ass"]=new c("triangle/ass",5,!1,!1,function(b,d,c,e,h,k){l(b,d,fa,"triangle/ass","angle less than 180 degrees and greater than 0 degrees",1,arguments);l(b,c,D,"triangle/ass","non-negative number",2,arguments);l(b,e,D,"triangle/ass","non-negative number",3,arguments);l(b,h,oa,"triangle/ass",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,J,"triangle/ass","color",5,arguments);d=jsnums.toFixnum(d%360);c=
jsnums.toFixnum(c);e=jsnums.toFixnum(e);F.get(k)&&(k=F.get(k));1E-5<d-180&&K(types.incompleteExn(types.exnFailContract,"The given angle, side and side will not form a triangle: "+d+", "+c+", "+e,[]));return world.Kernel.triangleImage(jsnums.toFixnum(e),jsnums.toFixnum(d),jsnums.toFixnum(c),h.toString(),k)});b["triangle/ssa"]=new c("triangle/ssa",5,!1,!1,function(b,d,c,e,h,k){l(b,d,D,"triangle/ssa","non-negative number",1,arguments);l(b,c,D,"triangle/ssa","non-negative number",2,arguments);l(b,e,fa,
"triangle/ssa","angle less than 180 degrees and greater than 0 degrees",3,arguments);l(b,h,oa,"triangle/ssa",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,J,"triangle/ssa","color",5,arguments);F.get(k)&&(k=F.get(k));d=jsnums.toFixnum(d);c=jsnums.toFixnum(c);e=jsnums.toFixnum(e%360);1E-5<e-180&&K(types.incompleteExn(types.exnFailContract,"The given side, side and angle will not form a triangle: "+d+", "+c+", "+e,[]));var g=d*d+c*c-2*d*c*Math.cos(e*Math.PI/180),p=Math.sqrt(g);
0>=g?K(types.incompleteExn(types.exnFailContract,"The given side, side and angle will not form a triangle: "+d+", "+c+", "+e,[])):(1E-5<p-(d+c)||1E-5<d-(p+c)||1E-5<c-(d+p))&&K(types.incompleteExn(types.exnFailContract,"The given side, side and angle will not form a triangle: "+d+", "+c+", "+e,[]));g=180/Math.PI*Math.acos((c*c+p*p-d*d)/(2*c*p));return world.Kernel.triangleImage(jsnums.toFixnum(p),jsnums.toFixnum(g),jsnums.toFixnum(c),h.toString(),k)});b["triangle/aas"]=new c("triangle/aas",5,!1,!1,
function(b,d,c,e,h,k){l(b,d,fa,"triangle/aas","angle less than 180 degrees and greater than 0 degrees",1,arguments);l(b,c,fa,"triangle/aas","angle less than 180 degrees and greater than 0 degrees",2,arguments);l(b,e,D,"triangle/aas","non-negative number",3,arguments);l(b,h,oa,"triangle/aas",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,J,"triangle/aas","color",5,arguments);F.get(k)&&(k=F.get(k));d=jsnums.toFixnum(d%360);c=jsnums.toFixnum(c%360);e=jsnums.toFixnum(e);
var g=180-d-c;1E-5<0-g&&K(types.incompleteExn(types.exnFailContract,"The given angle, angle and side will not form a triangle: "+d+", "+c+", "+e,[]));g=e/Math.sin(g*Math.PI/180)*Math.sin(c*Math.PI/180);return world.Kernel.triangleImage(jsnums.toFixnum(e),d,jsnums.toFixnum(g),h.toString(),k)});b["triangle/asa"]=new c("triangle/asa",5,!1,!1,function(b,d,c,e,h,k){l(b,d,fa,"triangle/asa","angle less than 180 degrees and greater than 0 degrees",1,arguments);l(b,c,D,"triangle/asa","non-negative number",
2,arguments);l(b,e,fa,"triangle/asa","angle less than 180 degrees and greater than 0 degrees",3,arguments);l(b,h,oa,"triangle/asa",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,k,J,"triangle/asa","color",5,arguments);F.get(k)&&(k=F.get(k));d=jsnums.toFixnum(d%360);c=jsnums.toFixnum(c);e=jsnums.toFixnum(e%360);var g=180-(d+e);1E-5<0-g&&K(types.incompleteExn(types.exnFailContract,"The given angle, side and angle will not form a triangle: "+d+", "+c+", "+e,[]));return world.Kernel.triangleImage(jsnums.toFixnum(c*
Math.sin(e*Math.PI/180)/Math.sin(g*Math.PI/180)),d,jsnums.toFixnum(c),h.toString(),k)});b["triangle/saa"]=new c("triangle/saa",5,!1,!1,function(b,d,c,e,h,k){l(b,d,D,"triangle/saa","non-negative number",1,arguments);l(b,c,fa,"triangle/saa","angle less than 180 degrees and greater than 0 degrees",2,arguments);l(b,e,fa,"triangle/saa","angle less than 180 degrees and greater than 0 degrees",3,arguments);l(b,h,oa,"triangle/saa",'style ("solid" / "outline") or an opacity value [0-255])',4,arguments);l(b,
k,J,"triangle/saa","color",5,arguments);F.get(k)&&(k=F.get(k));d=jsnums.toFixnum(d);c=jsnums.toFixnum(c%360);e=jsnums.toFixnum(e%360);var g=180-e-c,p=d/Math.sin(g*Math.PI/180),t=p*Math.sin(c*Math.PI/180);return world.Kernel.triangleImage(jsnums.toFixnum(p*Math.sin(e*Math.PI/180)),g,jsnums.toFixnum(t),h.toString(),k)});b["right-triangle"]=new c("right-triangle",4,!1,!1,function(b,d,c,e,h){l(b,d,D,"right-triangle","non-negative number",1,arguments);l(b,c,D,"right-triangle","non-negative number",2,arguments);
l(b,e,oa,"right-triangle",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);l(b,h,J,"right-triangle","color",4,arguments);F.get(h)&&(h=F.get(h));return world.Kernel.triangleImage(jsnums.toFixnum(d),jsnums.toFixnum(270),jsnums.toFixnum(c),e.toString(),h)});b["isosceles-triangle"]=new c("isosceles-triangle",4,!1,!1,function(b,d,c,e,h){l(b,d,D,"isosceles-triangle","non-negative number",1,arguments);l(b,c,fa,"isosceles-triangle","angle less than 180 degrees and greater than 0 degrees",
2,arguments);l(b,e,oa,"isosceles-triangle",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);l(b,h,J,"isosceles-triangle","color",4,arguments);F.get(h)&&(h=F.get(h));var g=0>c?-1:1,p=(180-Math.abs(c))/2;return world.Kernel.triangleImage(jsnums.toFixnum(2*d*Math.sin(Math.abs(c)*Math.PI/180/2)),jsnums.toFixnum(360-p)*g,jsnums.toFixnum(d),e.toString(),h)});b.ellipse=new c("ellipse",4,!1,!1,function(b,d,c,e,h){l(b,d,D,"ellipse","non-negative number",1,arguments);l(b,c,D,"ellipse",
"non-negative number",2,arguments);l(b,e,oa,"ellipse",'style ("solid" / "outline") or an opacity value [0-255])',3,arguments);l(b,h,J,"ellipse","color",4,arguments);F.get(h)&&(h=F.get(h));return world.Kernel.ellipseImage(jsnums.toFixnum(d),jsnums.toFixnum(c),e.toString(),h)});b.line=new c("line",3,!1,!1,function(b,d,c,e){l(b,d,N,"line","finite real number",1,arguments);l(b,c,N,"line","finite real number",2,arguments);l(b,e,J,"line","color",3,arguments);F.get(e)&&(e=F.get(e));return world.Kernel.lineImage(jsnums.toFixnum(d),
jsnums.toFixnum(c),e)});b["add-line"]=new c("add-line",6,!1,!1,function(b,d,c,e,h,k,m){l(b,d,I,"add-line","image",1,arguments);l(b,c,N,"add-line","finite real number",2,arguments);l(b,e,N,"add-line","finite real number",3,arguments);l(b,h,N,"add-line","finite real number",4,arguments);l(b,k,N,"add-line","finite real number",5,arguments);l(b,m,J,"add-line","color",6,arguments);F.get(m)&&(m=F.get(m));c=jsnums.toFixnum(c);h=jsnums.toFixnum(h);e=jsnums.toFixnum(e);k=jsnums.toFixnum(k);var g=world.Kernel.lineImage(h-
c,k-e,m);return world.Kernel.overlayImage(g,d,-Math.min(c,h),-Math.min(e,k))});b.overlay=new c("overlay",2,!0,!1,function(b,d,c,e){var g=[d,c].concat(e);l(b,d,I,"overlay","image",1,g);l(b,c,I,"overlay","image",2,g);S(e,function(d,c){l(b,d,I,"overlay","image",c+3)},arguments);g=world.Kernel.overlayImage(d,c,"middle","middle");for(var h=0;h<e.length;h++)g=world.Kernel.overlayImage(g,e[h],"middle","middle");return g});b["overlay/xy"]=new c("overlay/xy",4,!1,!1,function(b,d,c,e,h){l(b,d,I,"overlay/xy",
"image",1,arguments);l(b,c,N,"overlay/xy","finite real number",2,arguments);l(b,e,N,"overlay/xy","finite real number",3,arguments);l(b,h,I,"overlay/xy","image",4,arguments);return world.Kernel.overlayImage(d,h,jsnums.toFixnum(c),jsnums.toFixnum(e))});b["overlay/align"]=new c("overlay/align",4,!0,!1,function(b,d,c,e,h,k){Ha(b,d,Ua,"overlay/align","x-place",1,arguments);Ha(b,c,Oa,"overlay/align","y-place",2,arguments);Ha(b,e,I,"overlay/align","image",3,arguments);Ha(b,h,I,"overlay/align","image",4,
arguments);S(k,function(d,c){l(b,d,I,"overlay/align","image",c+4)},arguments);for(var g=world.Kernel.overlayImage(e,h,d.toString(),c.toString()),p=0;p<k.length;p++)g=world.Kernel.overlayImage(g,k[p],d.toString(),c.toString());return g});b.underlay=new c("underlay",2,!0,!1,function(b,d,c,e){Ha(b,d,I,"underlay","image",1,arguments);Ha(b,c,I,"underlay","image",2,arguments);S(e,function(d,c){l(b,d,I,"underlay","image",c+3)},arguments);for(var g=world.Kernel.overlayImage(c,d,"middle","middle"),h=0;h<e.length;h++)g=
world.Kernel.overlayImage(e[h],g,"middle","middle");return g});b["underlay/xy"]=new c("underlay/xy",4,!1,!1,function(b,d,c,e,h){l(b,d,I,"underlay/xy","image",1,arguments);l(b,c,N,"underlay/xy","finite real number",2,arguments);l(b,e,N,"underlay/xy","finite real number",3,arguments);l(b,h,I,"underlay/xy","image",4,arguments);return world.Kernel.overlayImage(h,d,-jsnums.toFixnum(c),-jsnums.toFixnum(e))});b["underlay/align"]=new c("underlay/align",4,!0,!1,function(b,d,c,e,h,k){Ha(b,d,Ua,"underlay/align",
"x-place",1,arguments);Ha(b,c,Oa,"underlay/align","y-place",2,arguments);Ha(b,e,I,"underlay/align","image",3,arguments);Ha(b,h,I,"underlay/align","image",4,arguments);S(k,function(d,c){l(b,d,I,"underlay/align","image",c+4)},arguments);for(var g=world.Kernel.overlayImage(h,e,d.toString(),c.toString()),p=0;p<k.length;p++)g=world.Kernel.overlayImage(k[p],g,d.toString(),c.toString());return g});b.beside=new c("beside",2,!0,!1,function(b,d,c,e){Ha(b,d,I,"beside","image",1,arguments);Ha(b,c,I,"beside",
"image",2,arguments);S(e,function(d,c){l(b,d,I,"beside","image",c+4)},arguments);for(var g=world.Kernel.overlayImage(d,c,"beside","middle"),h=0;h<e.length;h++)g=world.Kernel.overlayImage(g,e[h],"beside","middle");return g});b["beside/align"]=new c("beside/align",3,!0,!1,function(b,d,c,e,h){Ha(b,d,Oa,"beside/align","y-place",1,arguments);Ha(b,c,I,"beside/align","image",2,arguments);Ha(b,e,I,"beside/align","image",3,arguments);S(h,function(d,c){l(b,d,I,"beside","image",c+3)},arguments);for(var g=world.Kernel.overlayImage(c,
e,"beside",d.toString()),k=0;k<h.length;k++)g=world.Kernel.overlayImage(g,h[k],"beside",d.toString());return g});b.above=new c("above",2,!0,!1,function(b,d,c,e){Ha(b,d,I,"above","image",1,arguments);Ha(b,c,I,"above","image",2,arguments);S(e,function(d,c){l(b,d,I,"above","image",c+4)},arguments);for(var g=world.Kernel.overlayImage(d,c,"middle","above"),h=0;h<e.length;h++)g=world.Kernel.overlayImage(g,e[h],"middle","above");return g});b["above/align"]=new c("above/align",3,!0,!1,function(b,d,c,e,h){Ha(b,
d,Ua,"above/align","x-place",1,arguments);Ha(b,c,I,"above/align","image",1,arguments);Ha(b,e,I,"above/align","image",2,arguments);S(h,function(d,c){l(b,d,I,"above/align","image",c+4)},arguments);var g,k=world.Kernel.overlayImage(c,e,d.toString(),"above");for(g=0;g<h.length;g++)k=world.Kernel.overlayImage(k,h[g],d.toString(),"above");return k});b.rotate=new c("rotate",2,!1,!1,function(b,d,c){l(b,d,N,"rotate","finite real number",1,arguments);l(b,c,I,"rotate","image",2,arguments);d=jsnums.toFixnum(d)%
360;return world.Kernel.rotateImage(-1*d,c)});

b["scale/xy"]=new c("scale/xy",3,!1,!1,function(b,d,c,e){l(b,d,D,"scale/xy","non-negative number",1,arguments);l(b,c,D,"scale/xy","non-negative number",2,arguments);l(b,e,I,"scale/xy","image",3,arguments);return world.Kernel.scaleImage(jsnums.toFixnum(d),jsnums.toFixnum(c),e)});

b.scale=new c("scale",2,!1,!1,function(b,d,c){l(b,d,D,"scale","non-negative number",1,arguments);l(b,c,I,"scale","image",2,arguments);return world.Kernel.scaleImage(jsnums.toFixnum(d),
jsnums.toFixnum(d),c)});

b.dilate=new c("dilate",2,!1,!1,function(b,d,c){l(b,d,D,"dilate","non-negative number",1,arguments);l(b,c,I,"dilate","image",2,arguments);return world.Kernel.scaleImage(jsnums.toFixnum(d),
jsnums.toFixnum(d),c)});

b.crop=new c("crop",5,!1,!1,function(b,d,c,e,h,k){l(b,d,N,"crop","finite real number",1,arguments);l(b,c,N,"crop","finite real number",2,arguments);l(b,e,D,"crop","non-negative number",3,arguments);l(b,h,D,"crop","non-negative number",4,arguments);l(b,k,I,"crop","image",5,arguments);return world.Kernel.cropImage(jsnums.toFixnum(d),jsnums.toFixnum(c),jsnums.toFixnum(e),jsnums.toFixnum(h),k)});b.frame=new c("frame",1,!1,!1,function(b,d){l(b,d,I,"frame","image",1,arguments);return world.Kernel.frameImage(d)});
b["flip-vertical"]=new c("flip-vertical",1,!1,!1,function(b,d){l(b,d,I,"flip-vertical","image",1,arguments);return world.Kernel.flipImage(d,"vertical")});b["flip-horizontal"]=new c("flip-horizontal",1,!1,!1,function(b,d){l(b,d,I,"flip-horizontal","image",1,arguments);return world.Kernel.flipImage(d,"horizontal")});b["reflect-x"]=new c("reflect-x",1,!1,!1,function(b,d){l(b,d,I,"reflect-x","image",1,arguments);return world.Kernel.flipImage(d,"vertical")});b["reflect-y"]=new c("reflect-y",1,!1,!1,function(b,
d){l(b,d,I,"reflect-y","image",1,arguments);return world.Kernel.flipImage(d,"horizontal")});b.text=new c("text",3,!1,!1,function(b,d,c,e){l(b,d,w,"text","string",1,arguments);l(b,c,function(b){return H(b)&&jsnums.greaterThan(b,0)&&za(b)},"text","exact integer between 1 and 255",2,arguments);l(b,e,J,"text","color",3,arguments);F.get(e)&&(e=F.get(e));return world.Kernel.textImage(d.toString(),jsnums.toFixnum(c),e,"normal","Arial","","",!1)});b["text/font"]=new v("text/font",[new c("text/font",8,!1,
!1,function(b,d,c,e,h,k,m,q,v){l(b,d,w,"text/font","string",1,arguments);l(b,c,function(b){return H(b)&&jsnums.greaterThan(b,0)&&za(b)},"text/font","exact integer between 1 and 255",2,arguments);l(b,e,J,"text/font","color",3,arguments);l(b,h,function(b){return w(b)||!b},"text/font","face",4,arguments);l(b,k,Da,"text/font","family",5,arguments);l(b,m,$a,"text/font",'style ("solid" or "outline")',6,arguments);l(b,q,z,"text/font","weight",7,arguments);l(b,v,Aa,"text/font","underline?",8,arguments);F.get(e)&&
(e=F.get(e));return world.Kernel.textImage(d.toString(),jsnums.toFixnum(c),e,h.toString(),k.toString(),m.toString(),q.toString(),v)}),new c("text/font",9,!1,!1,function(b,d,c,e,h,k,m,q,v,u){l(b,d,w,"text/font","string",1,arguments);l(b,c,function(b){return H(b)&&jsnums.greaterThan(b,0)&&za(b)},"text/font","exact integer between 1 and 255",2,arguments);l(b,e,J,"text/font","color",3,arguments);l(b,h,function(b){return w(b)||!b},"text/font","face",4,arguments);l(b,k,Da,"text/font","family",5,arguments);
l(b,m,$a,"text/font",'style ("solid" or "outline")',6,arguments);l(b,q,z,"text/font","weight",7,arguments);l(b,v,Aa,"text/font","underline?",8,arguments);l(b,u,Aa,"text/font","outline?",9,arguments);F.get(e)&&(e=F.get(e));return world.Kernel.textImage(d.toString(),jsnums.toFixnum(c),e,h.toString(),k.toString(),m.toString(),q.toString(),v,u)})]);b["play-sound"]=new c("play-sound",2,!1,!1,function(b,d,c){l(b,d,w,"play-sound","string",1);l(b,c,Aa,"play-sound","boolean",2);return y(function(g,e){gb(d.toString());
var h=document.createElement("audio");h.src=d.toString();h.addEventListener("canplay",function(){var e=new world.Kernel.fileAudio(d.toString(),!1,h);b.addBreakRequestedListener(function(){e.audio.pause();return!0});if(c)return g(!0);h.addEventListener("ended",function(){return g(!0)})});h.addEventListener("error",function(b){g(!1)});h.src=d.toString()})});b["bitmap/url"]=b["image-url"]=new c("bitmap/url",1,!1,!1,function(b,d){l(b,d,w,"bitmap/url","string",1);var c=d.toString();d=b.getImageProxyHook()?
b.getImageProxyHook()+"?url="+encodeURIComponent(d.toString()):d.toString();return y(function(b,g){gb(c);var e=new Image;e.onload=function(){world.Kernel.fileImage(d,e,b)};e.onerror=function(d){b(types.schemeError(types.incompleteExn(types.exnFail," (unable to load: "+c+")",[])))};e.src=d})});b["video/url"]=new c("video/url",1,!1,!1,function(b,d){l(b,d,w,"video-url","string",1);return y(function(c,g){gb(d.toString());var e=document.createElement("video");e.src=d.toString();e.addEventListener("canplay",
function(){c(world.Kernel.fileVideo(d.toString(),e));b.addBreakRequestedListener(function(){e.pause();return!0})});e.addEventListener("error",function(b){c(types.schemeError(types.incompleteExn(types.exnFail," (unable to load: "+d+")",[])))});e.src=d.toString()})});b["image-width"]=new c("image-width",1,!1,!1,function(b,d){l(b,d,I,"image-width","image",1);return d.getWidth()});b["image-height"]=new c("image-height",1,!1,!1,function(b,d){l(b,d,I,"image-height","image",1);return d.getHeight()});b["image-baseline"]=
new c("image-baseline",1,!1,!1,function(b,d){l(b,d,I,"image-baseline","image",1);return d.getBaseline()});b["image->color-list"]=new c("image->color-list",1,!1,!1,function(b,d){l(b,d,I,"image->color-list","image",1);b=d.getWidth();var c=d.getHeight(),g=world.Kernel.makeCanvas(b,c).getContext("2d");d.render(g,0,0);d=g.getImageData(0,0,b,c).data;var e=[];for(b=0;b<d.length;b+=4){c=d[b];g=d[b+1];var h=d[b+2];var k=d[b+3];e.push(types.color(c,g,h,k))}return types.list(e)});var nb=function(b,d,c,e,h,k){Ja(b,
d,J,"color-list->image","image",1);l(b,c,D,"color-list->image","non-negative number",2);l(b,e,D,"color-list->image","non-negative number",3);l(b,h,H,"color-list->image","natural",4);l(b,k,H,"color-list->image","natural",5);c=Math.max(jsnums.toFixnum(c),1);e=Math.max(jsnums.toFixnum(e),1);b=world.Kernel.makeCanvas(c,e);h=b.getContext("2d");c=h.createImageData(c,e);e=c.data;for(var g=0;d!==types.EMPTY;)k=d.first(),e[g]=jsnums.toFixnum(types.colorRed(k)),e[g+1]=jsnums.toFixnum(types.colorGreen(k)),e[g+
2]=jsnums.toFixnum(types.colorBlue(k)),e[g+3]=jsnums.toFixnum(types.colorAlpha(k)),g+=4,d=d.rest();h.putImageData(c,0,0);var p=b.toDataURL("image/png");return y(function(b,d){var c=new Image;c.onload=function(){world.Kernel.fileImage(p,c,b)};c.onerror=function(d){b(types.schemeError(types.incompleteExn(types.exnFail," (unable to load image from color-list)",[])))};c.src=p})};b["color-list->image"]=new c("color-list->image",5,!1,!1,function(b,d,c,e,h,k){return nb(b,d,c,e,h,k)});b["color-list->image"]=
new c("color-list->image",5,!1,!1,function(b,d,c,e,h,k){return nb(b,d,c,e,h,k)});b["color-list->bitmap"]=new c("color-list->bitmap",3,!1,!1,function(b,d,c,e){return nb(b,d,c,e,0,0)});b["mode?"]=new c("mode?",1,!1,!1,function(b,d){return oa(d)});b["image-color?"]=new c("image-color?",1,!1,!1,function(b,d){return J(d)});b["name->color"]=new c("name->color",1,!1,!1,function(b,d){return Ca(d)||!1});b["x-place?"]=new c("x-place?",1,!1,!1,function(b,d){return Ua(d)});b["y-place?"]=new c("y-place?",1,!1,
!1,function(b,d){return Oa(d)});b["angle?"]=new c("angle?",1,!1,!1,function(b,d){return fa(d)});b["side-count?"]=new c("side-count?",1,!1,!1,function(b,d){return A(d)});b["step-count?"]=new c("step-count?",1,!1,!1,function(b,d){return Fa(d)});var fb=ha.extend({init:function(b,d){this._super("stop-when");this.handler=b;this.last_picture=d},configure:function(b){return b.updateAll({stopWhen:this.handler,lastPicture:this.last_picture})}}),Ra=ha.extend({init:function(b,d,c){this._super("on-tick");this.handler=
b;this.effectHandler=d;this.aDelay=c},configure:function(b){var d={onTick:this.handler,onTickEffect:this.effectHandler,tickDelay:jsnums.toFixnum(jsnums.multiply(1E3,this.aDelay))};return b.updateAll(d)}}),ob=ha.extend({init:function(b){this._super("on-redraw");this.handler=b},configure:function(b){return b.updateAll({onRedraw:this.handler})}}),ab=!1;void 0!==window.plt&&(T=plt.wescheme.BrowserDetect,ab="Explorer"===T.browser&&11>T.version);var ib=ab?types.rational(1,8):types.rational(1,28);b["on-tick"]=
new v("on-tick",[new c("on-tick",1,!1,!1,function(b,d){l(b,d,k,"on-tick","function",1);e(b,"on-tick",1,d.numParams);return new Ra(d,new c("",1,!1,!1,function(b,d){return types.effectDoNothing()}),ib)}),new c("on-tick",2,!1,!1,function(b,d,h){l(b,d,k,"on-tick","function",1,arguments);e(b,"on-tick",1,d.numParams);l(b,h,D,"on-tick","non-negative number",2,arguments);return new Ra(d,new c("",1,!1,!1,function(b,d){return types.effectDoNothing()}),ab?Math.max(jsnums.toFixnum(h),jsnums.toFixnum(ib)):h)})]);
b["on-tick!"]=new v("on-tick!",[new c("on-tick!",2,!1,!1,function(b,d,c){l(b,d,k,"on-tick!","function",1,arguments);e(b,"on-tick!",1,d.numParams);l(b,c,k,"on-tick!","function",2,arguments);return new Ra(d,c,ib)}),new c("on-tick!",3,!1,!1,function(b,d,c,h){l(b,d,k,"on-tick!","function",1,arguments);e(b,"on-tick!",1,d.numParams);l(b,c,k,"on-tick!","function",2,arguments);l(b,h,D,"on-tick!","non-negative number",3,arguments);return new Ra(d,c,ab?Math.max(jsnums.toFixnum(h),jsnums.toFixnum(ib)):h)})]);
b["on-tap"]=new c("on-tap",1,!1,!1,ea("on-tap","onTap",3));b["on-tilt"]=new c("on-tilt",1,!1,!1,ea("on-tilt","onTilt",3));b["on-key"]=new c("on-key",1,!1,!1,ea("on-key","onKey",2));b["on-key!"]=new c("on-key!",2,!1,!1,Ba("on-key!","onKey"));b["on-mouse"]=new c("on-mouse",1,!1,!1,ea("on-mouse","onMouse",4));b["mouse-event?"]=new c("mouse-event?",1,!0,!1,function(b,d){return db(d)});b["mouse=?"]=new c("mouse=?",2,!0,!1,function(b,d,c){l(b,d,db,"mouse-event?","mouse-event",1);l(b,c,db,"mouse-event?",
"mouse-event",2);return d===c});b["stop-when"]=new v("stop-when",[new c("stop-when",1,!1,!1,function(b,d){l(b,d,k,"stop-when","function",1);e(b,"stop-when",1,d.numParams);return new fb(d,null)}),new c("stop-when",2,!1,!1,function(b,d,c){l(b,d,k,"stop-when","function",1);e(b,"stop-when",1,d.numParams);l(b,c,k,"stop-when","function",2);return new fb(d,c)})]);b["stop-when!"]=new c("stop-when!",2,!1,!1,Ba("stop-when!","stopWhen"));b["on-redraw"]=new c("on-redraw",1,!1,!1,function(b,d){l(b,d,k,"on-redraw",
"function",1);e(b,"on-redraw",1,d.numParams);return new ob(d)});b["to-draw"]=new c("to-draw",1,!1,!1,function(b,d){l(b,d,k,"to-draw","function",1);e(b,"to-draw",1,d.numParams);return new ob(d)});b["on-draw"]=new v("on-draw",[new c("on-draw",1,!1,!1,function(b,d){l(b,d,k,"on-draw","function",1);e(b,"on-draw",1,d.numParams);return new (ha.extend({init:function(){this._super("on-draw")},configure:function(b){return b.updateAll({onDraw:d})}}))}),new c("on-draw",2,!1,!1,function(b,d,c){l(b,d,k,"on-draw",
"function",1,arguments);l(b,c,k,"on-draw","function",2,arguments);e(b,"on-draw",1,d.numParams);return new (ha.extend({init:function(){this._super("on-draw")},configure:function(b){return b.updateAll({onDraw:d,onDrawCss:c})}}))})]);b["initial-effect"]=new c("initial-effect",1,!1,!1,function(b,d){return new (ha.extend({init:function(){this._super("initial-effect")},configure:function(b){return b.updateAll({initialEffect:d})}}))});var jb=function(b){Ja(void 0,b,function(b){return ka(b)&&2==G(b)},"js-p",
"list of (list of X Y)",1);b=ca(b);var d=jsworld.MobyJsworld.p(b);d.toWrittenString=function(b){return"(js-p)"};d.toDisplayedString=d.toWrittenString;d.toDomNode=function(b){return d};return helpers.wrapJsObject(d)};b["js-p"]=new v("js-p",[new c("js-p",0,!1,!1,function(b){return jb(types.EMPTY)}),new c("js-p",1,!1,!1,function(b,d){return jb(d)})]);var kb=function(b){Ja(void 0,b,Za,"js-div","(listof X Y)",1);b=ca(b);var d=jsworld.MobyJsworld.div(b);d.toWrittenString=function(b){return"(js-div)"};d.toDisplayedString=
d.toWrittenString;d.toDomNode=function(b){return d};return helpers.wrapJsObject(d)};b["js-div"]=new v("js-div",[new c("js-div",0,!1,!1,function(b){return kb(types.EMPTY)}),new c("js-div",1,!1,!1,function(b,d){return kb(d)})]);var qb=function(b){return function(d,c,g,e){l(d,c,k,b,"function",1);l(d,g,k,b,"function",2);Ja(void 0,e,Za,b,"(listof X Y)",3);d=e?ca(e):{};var h=jsworld.MobyJsworld.buttonBang(c,g,d);h.toWrittenString=function(d){return"("+b+" ...)"};h.toDisplayedString=h.toWrittenString;h.toDomNode=
function(b){return h};return helpers.wrapJsObject(h)}},Sa=function(b,d,c){var g=new types.PrimProc("",1,!1,!1,function(b,d){return types.EMPTY});return qb("js-button")(b,d,g,c)};b["js-button"]=new v("js-button",[new c("js-button",1,!1,!1,function(b,d){return Sa(b,d)}),new c("js-button",2,!1,!1,function(b,d,c){return Sa(b,d,c)})]);b["js-button!"]=new v("js-button!",[new c("js-button!",2,!1,!1,qb("js-button!")),new c("js-button!",3,!1,!1,qb("js-button!"))]);var Ka=function(b,d,c){l(aState,b,w,"js-input",
"string",1);l(aState,d,k,"js-input","function",2);Ja(void 0,c,Za,"js-input","(listof X Y)",3);c=c?ca(c):{};var g=jsworld.MobyJsworld.input(b,d,c);g.toWrittenString=function(b){return"(js-input ...)"};g.toDisplayedString=g.toWrittenString;g.toDomNode=function(b){return g};return helpers.wrapJsObject(g)};b["js-input"]=new v("js-input",[new c("js-input",2,!1,!1,function(b,d,c){return Ka(d,c)}),new c("js-input",3,!1,!1,function(b,d,c,e){return Ka(d,updateF,e)})]);var tb=function(b,d){l(aState,b,w,"js-img",
"string",1);Ja(void 0,d,Za,"js-img","(listof X Y)",2);d=ca(d);var c=jsworld.MobyJsworld.img(b,d);c.toWrittenString=function(b){return"(js-img ...)"};c.toDisplayedString=c.toWrittenString;c.toDomNode=function(b){return c};return helpers.wrapJsObject(c)};b["js-img"]=new v("js-img",[new c("js-img",1,!1,!1,function(b,d){return tb(d,types.EMPTY)}),new c("js-img",2,!1,!1,function(b,d,c){return tb(d,c)})]);b["js-text"]=new c("js-text",1,!1,!1,function(b,d){l(b,d,w,"js-text","string",1);var c=jsworld.MobyJsworld.text(d,
[]);c.toWrittenString=function(b){return"(js-text ...)"};c.toDisplayedString=c.toWrittenString;c.toDomNode=function(b){return c};return helpers.wrapJsObject(c)});var Qa=function(b,d,c){Ja(void 0,b,w,"js-select","listof string",1);l(aState,d,k,"js-select","function",2);Ja(void 0,c,Za,"js-select","(listof X Y)",3);c=c?ca(c):{};b=helpers.deepListToArray(b);var g=jsworld.MobyJsworld.select(b,d,c);g.toWrittenString=function(b){return"(js-select ...)"};g.toDisplayedString=g.toWrittenString;g.toDomNode=
function(b){return g};return helpers.wrapJsObject(g)};b["js-select"]=new v("js-select",[new c("js-select",2,!1,!1,function(b,d,c){return Qa(d,c)}),new c("js-select",3,!1,!1,function(b,d,c,e){return Qa(d,c,e)})]);b["big-bang"]=b["js-big-bang"]=new c("big-bang",1,!0,!1,function(b,d,c){S(c,function(g,e){l(b,g,function(b){return b instanceof ha||ka(b)||types.isWorldConfig(b)},"big-bang","handler",e+2,[b,d].concat(c))});var g=helpers.map(function(b){return b instanceof ha?function(d){return b.configure(d)}:
b},c);return y(function(c,e){var h=function(){k.breaker()};b.addBreakRequestedListener(h);var k=jsworld.MobyJsworld.bigBang(d,b.getToplevelNodeHook()(),g,e,function(d){b.removeBreakRequestedListener(h);c(d)})})});b.animate=new c("animate",1,!1,!1,function(g,d){l(g,d,k,"animate","function",1);l(g,d,V(1),"animate","1-argument function",1);d=[new Ra(b.add1,new c("",1,!1,!1,function(b,d){return types.effectDoNothing()}),ib),new ob(d)];var e=helpers.map(function(b){return b instanceof ha?function(d){return b.configure(d)}:
b},d);return y(function(b,d){var c=function(){h.breaker()};g.addBreakRequestedListener(c);var h=jsworld.MobyJsworld.bigBang(1,g.getToplevelNodeHook()(),e,d,function(d){g.removeBreakRequestedListener(c);b(d)})})});var rb=function(b){Ja(void 0,b,Za,"empty-page","(listof X Y)",1);b=ca(b);return jsworld.MobyJsworld.emptyPage(b)};b["empty-page"]=new v("empty-page",[new c("empty-page",0,!1,!1,function(b){return rb(types.EMPTY)}),new c("empty-page",1,!1,!1,function(b,d){return rb(d)})]);b["place-on-page"]=
new c("empty-page",4,!1,!1,function(b,d,c,e,h){return jsworld.MobyJsworld.placeOnPage(d,c,e,h)});b["make-world-config"]=new c("make-world-config",2,!0,!1,function(b,d,c,e){var g=[d,c].concat(e);l(b,d,k,"make-world-config","function",1,g);l(b,c,V(1),"make-world-config","function (arity 1)",2,g);S(e,function(d,c){l(b,d,k,"make-world-config","handler",c+3,g)});V(e.length)(d)||K(types.incompleteExn(types.exnFailContract,"make-world-config: 1st argument must have arity equal to the number of arguments after the second",
[]));return types.worldConfig(d,c,e)});b["make-effect-type"]=hb("make-effect-type",4,[!1],!1,function(b,d,c,e,h,m,q){l(d,c,da,"make-effect-type","string",1,b);l(d,e,function(b){return!1===b||types.isEffectType(b)},"make-effect-type","effect type or #f",2,b);l(d,h,H,"make-effect-type","exact non-negative integer",3,b);l(d,m,k,"make-effect-type","function",4,b);l(d,q,function(b){return!1===b||k(b)},"make-effect-type","procedure or #f",6,b);b=h+1+(e?e.numberOfArgs:0);q&&!V(b)(q)&&K(types.incompleteExn(types.exnFailContract,
helpers.format("make-effect-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",[b,q]),[]));q=q?pa(d,q):!1;d=types.makeEffectType(c.toString(),e,h,m,q,W(d));return Y(d)});b["effect-type?"]=new c("effect-type?",1,!1,!1,function(b,d){return types.isEffectType(d)});b["effect?"]=new c("effect?",1,!1,!1,function(b,d){return types.isEffect(d)});b["make-render-effect-type"]=hb("make-render-effect-type",4,[!1],!1,function(b,d,c,e,h,m,q){l(d,c,da,"make-render-effect-type",
"string",1,b);l(d,e,function(b){return!1===b||types.isEffectType(b)},"make-render-effect-type","effect type or #f",2,b);l(d,h,H,"make-render-effect-type","exact non-negative integer",3,b);l(d,m,k,"make-render-effect-type","function",4,b);l(d,q,function(b){return!1===b||k(b)},"make-render-effect-type","procedure or #f",6,b);b=h+1+(e?e.numberOfArgs:0);q&&!V(b)(q)&&K(types.incompleteExn(types.exnFailContract,helpers.format("make-effect-type: guard procedure does not accept ~a arguments (one more than the number constructor arguments): ~s",
[b,q]),[]));d=q?pa(d,q):!1;c=types.makeRenderEffectType(c.toString(),e,h,m,d);return Y(c)});b["render-effect-type?"]=new c("render-effect-type?",1,!1,!1,function(b,d){return types.isRenderEffectType(d)});b["render-effect?"]=new c("render-effect?",1,!1,!1,function(b,d){return types.isRenderEffect(d)});b["world-with-effects"]=new c("world-with-effects",2,!1,!1,function(b,d,c){l(b,d,sb,"world-with-effects","compound effect",1,arguments);return jsworld.Jsworld.with_multiple_effects(c,helpers.flattenSchemeListToArray(d))});
b["make-render-effect"]=new c("make-render-effect",2,!1,!1,function(b,d,c){return types.makeRenderEffect(d,c)});b["render-effect?"]=new c("render-effect?",1,!1,!1,function(b,d){return types.isRenderEffect(d)});b["render-effect-dom-node"]=new c("render-effect-dom-node",1,!1,!1,function(b,d){l(b,d,types.isRenderEffect,"render-effect-dom-node","render-effect",1);return types.renderEffectDomNode(d)});b["render-effect-effects"]=new c("render-effect-effects",1,!1,!1,function(b,d){l(b,d,types.isRenderEffect,
"render-effect-effects","render-effect",1);return types.renderEffectEffects(d)});b["scheme->prim-js"]=new c("scheme->prim-js",1,!1,!1,function(b,d){l(b,d,function(b){return N(b)||w(b)||da(b)||h(b)||Aa(b)||ta(b)},"scheme->prim-js","real number, string, symbol, char, boolean, or vector",1);if(N(d)){jsnums.equals(d,jsnums.nan)||jsnums.equals(d,jsnums.inf)||jsnums.equals(d,jsnums.negative_inf)||!jsnums.greaterThan(d,9E15)&&!jsnums.lessThan(d,-9E15)||K(types.incompleteExn(types.exnFailContract,helpers.format("scheme->primitive-js: only numbers in [-9e15, 9e15] are accurately representable in javascript; given: ~s",
[d]),[]));var c=jsnums.toFixnum(d)}else w(d)?c=d.toString():da(d)||h(d)?c=d.val:Aa(d)?c=d:ta(d)&&(c=d.elts.slice(0));return helpers.wrapJsObject(c)});b["prim-js->scheme"]=new c("prim-js->scheme",1,!1,!1,function(b,d){l(b,d,function(b){return wa(b)&&("number"==typeof b.obj||"string"==typeof b.obj||"boolean"==typeof b.obj||"function"==typeof b.obj||b.obj instanceof Array)},"prim-js->scheme","javascript number, string, boolean, function, or array",1);if("number"===typeof d.obj)return types["float"](d.obj);
if("string"===typeof d.obj||"boolean"===typeof d.obj)return d.obj;if("function"===typeof d.obj)return new c("",0,!0,!1,function(b){return d.obj.apply(null,b)});if(d.obj instanceof Array)return types.vector(d.obj.slice(0))});b["procedure->cps-js-fun"]=new c("procedure->cps-js-fun",1,!1,!1,function(b,d){l(b,d,k,"procedure->cps-js-fun","function",1);var c=W(b);return types.jsObject(d.name+" (cps)",function(){var b=helpers.map(helpers.wrapJsObject,arguments),g=0==b.length?function(){}:b.shift();c(d,b,
g)})});b["procedure->void-js-fun"]=new c("procedure->void-js-fun",1,!1,!1,function(b,d){l(b,d,k,"procedure->void-js-fun","function",1);var c=W(b);return types.jsObject(d.name+" (void)",function(){var b=helpers.map(helpers.wrapJsObject,arguments);c(d,b,function(){})})});b["js-==="]=new c("js-===",2,!1,!1,function(b,d,c){l(b,d,wa,"js-===","javascript value",1);l(b,c,wa,"js-===","javascript value",2);return d.obj===c.obj});b["js-get-named-object"]=new c("js-get-named-object",1,!1,!1,function(b,d){l(b,
d,w,"js-get-named-object","string",1);b=d.toString();return types.jsObject(b,"window"===b?window:window[b])});b["js-get-field"]=new c("js-get-field",2,!0,!1,function(b,d,c,e){e.unshift(c);var g=[d].concat(e);l(b,d,wa,"js-get-field","js-object",1,g);S(e,function(d,c){l(b,d,w,"js-get-field","string",c+2,g)});c=[d.name];d=d.obj;for(var h=0;h<e.length;h++){if(void 0===d){var k=c.join("");K(types.incompleteExn(types.exnFailContract,helpers.format("js-get-field: tried to access field ~a of ~a, but ~a was undefined",
[e[h],k,k]),[]))}c.push('["'+e[h].toString()+'"]');d=d[e[h].toString()]}return types.jsObject(c.join(""),d)});b["js-set-field!"]=new c("js-set-field!",3,!1,!1,function(b,d,c,e){l(b,d,function(b){return wa(b)&&"object"==typeof b.obj},"js-set-field!","javascript object",1,arguments);l(b,c,w,"js-set-field!","string",2,arguments);d.obj[c.toString()]=wa(e)?e.obj:e;return types.VOID});b["js-typeof"]=new c("js-typeof",1,!1,!1,function(b,d){l(b,d,wa,"js-typeof","js-object",1);return typeof d.obj});b["js-instanceof"]=
new c("js-instanceof",2,!1,!1,function(b,d,c){l(b,d,wa,"js-instanceof","js-object",1,arguments);l(b,c,Ma,"js-instanceof","javascript function",2,arguments);return d.obj instanceof c.obj});b["js-call"]=new c("js-call",2,!0,!1,function(b,d,c,e){var g=[d,c].concat(e);l(b,d,Ma,"js-call","javascript function",1,g);l(b,c,function(b){return!1===b||wa(b)&&"object"==typeof b.obj},"js-call","javascript object or false",2,g);b=helpers.map(function(b){return wa(b)?b.obj:b},e);d=d.obj.apply(c?c.obj:null,b);return void 0===
d?types.VOID:helpers.wrapJsObject(d)});b["js-new"]=new c("js-new",1,!0,!1,function(b,d,c){Ha(b,d,Ma,"js-new","javascript function",1);var e=helpers.map(function(b){return wa(b)?b.obj:b},c);b=function(){d.obj.apply(this,e)};b.prototype=d.obj.prototype;return helpers.wrapJsObject(new b)});b["js-make-hash"]=new v("js-make-hash",[new c("js-make-hash",0,!1,!1,function(){return types.jsObject("hash",{})}),new c("js-make-hash",1,!1,!1,function(b,d){Ja(b,d,function(b){return Za(b)&&w(b.first())},"js-make-hash",
"(listof string X)",1);for(b={};!d.isEmpty();){var c=d.first().first().toString(),e=d.first().rest().first();b[c]=wa(e)?e.obj:e;d=d.rest()}return types.jsObject("hash",b)})]);b.eof=types.EOF;b.e=jsnums.e;b.empty=types.EMPTY;b["false"]=!1;b["true"]=!0;b.pi=jsnums.pi;b["null"]=types.EMPTY;b["empty-image"]=world.Kernel.sceneImage(0,0,[],!0);b["js-undefined"]=types.jsObject("undefined",void 0);b["js-null"]=types.jsObject("null",null);primitive.getPrimitive=function(c,d){return b[c]};primitive.isPrimitive=
function(b){return b instanceof c};primitive.addPrimitive=function(c,d){b[c]=d};primitive.Primitive=c;primitive.CasePrimitive=v;primitive.setCALL=function(b){u=function(d,c,e){return new b(d,c,e)}};primitive.setPAUSE=function(b){y=function(d){return new b(d)}}})();var control={};
(function(){var e=function(b){this.depth=b};e.prototype.invoke=function(b){debug("SET "+this.depth);if(0>b.vstack.length-1-(this.depth||0))throw types.internalError("vstack not long enough",b.captureCurrentContinuationMarks(aState));b.setn(this.depth,b.v)};var u=function(b){this.n=b};u.prototype.invoke=function(b){b.pushn(this.n)};var y=function(b){this.depth=b};y.prototype.invoke=function(b){debug("SWAP "+this.depth);if(0>b.vstack.length-1-(this.depth||0))throw types.internalError("vstack not long enough",
b.captureCurrentContinuationMarks(aState));var c=b.vstack[b.vstack.length-1-(this.depth||0)];b.vstack[b.vstack.length-1-(this.depth||0)]=b.v;b.v=c};var b=function(b){this.n=b};b.prototype.invoke=function(b){b.popn(this.n)};var c=function(b,c){this.prefix=b;this.body=c};c.prototype.invoke=function(b){v(b,this.prefix);var c=[],e;for(e=0;e<this.body.length;e++)c.push(this.body[e]);b.pushManyControls(c)};var v=function(b,c){for(var e=c.numLifts,h=new types.PrefixValue,k=0;k<c.toplevels.length+e;k++){var m=
c.toplevels[k];if(!1===m)h.addSlot();else if("module-variable"===m.$){var q=b,v=h,u=m;m=u.modidx.path;u=u.sym+"";var w=primitive.getPrimitive(u,m);q.globals[u]="undefined"!==typeof w?new types.GlobalBucket(u,w):new types.GlobalBucket(u,new types.ModuleVariableRecord(m,u));v.addSlot(q.globals[u])}else if("global-bucket"===m.$)q=b,v=h,m=m.value+"",q.globals[m]||(q.globals[m]=new types.GlobalBucket(m,types.UNDEFINED)),v.addSlot(q.globals[m]);else throw types.internalError("unable to install toplevel element "+
m,state.captureCurrentContinuationMarks(b));}b.vstack.push(h)},Q=function(b){this.value=b};Q.prototype.invoke=function(b){b.v=this.value};var m=function(b,c,e){this.test=b;this.thenPart=c;this.elsePart=e};m.prototype.invoke=function(b){var c=[];c.push(this.test);c.push(new q(this.thenPart,this.elsePart));b.pushManyControls(c)};var q=function(b,c){this.thenPart=b;this.elsePart=c};q.prototype.invoke=function(b){debug("BRANCH");!1!==b.v&&void 0!==b.v?b.pushControl(this.thenPart):b.pushControl(this.elsePart)};
var C=function(b){this.name=b};C.prototype.invoke=function(b){var c=this;throw new Z(function(e,h){if(b.invokedModules[c.name])e(types.VOID);else{var k=function(b){return"undefined"!==typeof window.COLLECTIONS&&window.COLLECTIONS[b]},m=function(){e(types.schemeError(types.incompleteExn(types.exn,"unable to load "+c.name+": it isn't in the set of known collections",[])))};k(c.name)?V(b,window.COLLECTIONS[c.name],e):b.hooks.dynamicModuleLoader(c.name,function(){k(c.name)?V(b,window.COLLECTIONS[c.name],
e):m()},m)}});};var V=function(b,c,e){b.clearForEval({preserveBreak:!0,clearGlobals:!0});interpret.load(c.bytecode,b);interpret.run(b,function(){for(var h={},k=0;k<c.provides.length;k++){var m=c.provides[k],q=b.globals[m];if(q)h[m]=q.value;else{e(types.schemeError(types.exn("module "+c.name+" is missing an expected definition for "+m)));return}}b.invokedModules[c.name]={record:c,providedValues:h};e(types.VOID)},function(b){e(b)})},G=function(b){this.forms=b};G.prototype.invoke=function(b){for(var c=
this.forms,e=[],h=0;h<c.length;h++)e.push(c[h]);b.pushManyControls(e)};var B=function(b){this.seq=b};B.prototype.invoke=function(b){if(1===this.seq.length)b.pushControl(this.seq[0]);else{for(var c=[],e=1;e<this.seq.length;e++)c.push(this.seq[e]);b.pushManyControls([this.seq[0],new aa(c)])}};var aa=function(b){this.rest=b};aa.prototype.invoke=function(b){b.pushControl(new Q(b.v));b.pushManyControls(this.rest)};var T=function(b,c,e){this.depth=b;this.pos=c;this.loc=e};T.prototype.invoke=function(b){b.v=
b.refPrefix(this.depth,this.pos,this.loc)};var U=function(b,c){this.pos=b;this.isUnbox=c};U.prototype.invoke=function(b){var c=b.peekn(this.pos);this.isUnbox&&(c=c.unbox());b.v=c};var X=function(b){this.name=b+""};X.prototype.invoke=function(b){var c=primitive.getPrimitive(this.name,void 0);if(!c)throw types.internalError("Primitive "+this.name+" not implemented!",state.captureCurrentContinuationMarks(b));b.v=c};var na=function(b){this.name=b.name;this.locs=b.locs;this.numParams=b.numParams;this.paramTypes=
b.paramTypes;this.isRest=b.isRest;this.closureMap=b.closureMap;this.closureTypes=b.closureTypes;this.body=b.body};na.prototype.invoke=function(b){b.v=new types.ClosureValue(this.name,this.locs,this.numParams,this.paramTypes,this.isRest,ha(b,this.closureMap,this.closureTypes),this.body)};var ha=function(b,c,e){e=[];for(var h=0;h<c.length;h++){var k=b.peekn(c[h]);e.push(k)}return e},ea=function(b,c){this.procs=b;this.body=c};ea.prototype.invoke=function(b){for(var c=[],h=this.procs.length,k=0;k<h;k++)c.push(this.procs[k]),
c.push(new e(h-1-k));c.push(new Ba(this.procs));c.push(this.body);b.pushManyControls(c)};var Ba=function(b){this.procs=b};Ba.prototype.invoke=function(b){for(var c=this.procs.length,e=0;e<c;e++){var h=this.procs[e];b.peekn(c-1-e).closureVals=ha(b,h.closureMap,h.closureTypes)}};var ca=function(b,c){this.ids=b;this.body=c};ca.prototype.invoke=function(b){var c=[];c.push(this.body);c.push(new K(this.ids));b.pushManyControls(c)};var K=function(b){this.ids=b};K.prototype.invoke=function(b){debug("DEF_VALUES");
state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");var c=b.v;if(c instanceof types.ValuesWrapper){this.ids.length!==c.elts.length&&helpers.raise(types.exnFailContractArity("define-values: expected "+this.ids.length+" values, but received "+c.elts.length,state.captureCurrentContinuationMarks(b)));for(var e=0;e<this.ids.length;e++)b.setPrefix(this.ids[e].depth,this.ids[e].pos,c.elts[e])}else 1!==this.ids.length?helpers.raise(types.exnFailContractArity("define-values: expected "+
this.ids.length+" values, but only received one: "+c,state.captureCurrentContinuationMarks(b))):b.setPrefix(this.ids[0].depth,this.ids[0].pos,c)};var W=function(b,c){this.rator=b;this.rands=c};W.prototype.invoke=function(b){var c=this.rator,h=this.rands,k=[];0!==h.length&&k.push(new u(h.length));k.push(c);0!==h.length&&k.push(new e(h.length-1));for(c=0;c<h.length;c++)c!==h.length-1?(k.push(h[c]),k.push(new e(c))):(k.push(h[h.length-1]),k.push(new y(h.length-1)));k.push(new pa(h.length));b.pushManyControls(k)};
var pa=function(b){this.n=b};pa.prototype.invoke=function(b){debug("CALL "+this.n);var c=b.popn(this.n),e=b.v,h=this.n;e=ua(b,h,e,c);e.callProcedure(b,e,h,c)};var la=function(c,e,h,m){0!==c.cstack.length&&c.cstack[c.cstack.length-1]instanceof b&&c.cstack.pop().invoke(c);var k=[];k.push(c);if(h<e.numParams)var q;if(e.isRest){for(q=0;q<e.numParams;q++)k.push(m.shift());var v=[];for(q=0;q<h-e.numParams;q++)v.push(m.shift());k.push(v)}else for(q=0;q<e.numParams;q++)k.push(m.shift());h=e.impl.apply(e.impl,
k);qa(c,h,e)},qa=function(b,c,e){if(c instanceof ba){b.cstack.push(new ra(c.k,e));e=c.operands.length;var h,k=[types.NoLocation];for(h=0;h<e;h++)k.push(types.NoLocation);aHash={};aHash["moby-application-position-key"]=types.list(k);b.pushControl(types.contMarkRecordControl(aHash));e=c.operator;h=c.operands.length;c=c.operands;e=ua(b,h,e,c);e.callProcedure(b,e,h,c)}else{if(c instanceof Y)throw new Z(c.onPause);e.assignsToValueRegister||(b.v=c)}},Z=function(b){this.onPause=b},ba=function(b,c,e){this.operator=
b;this.operands=c;this.k=e},ra=function(b,c){this.k=b;this.procValue=c};ra.prototype.invoke=function(b){qa(b,this.k(b.v),this.procValue)};primitive.setCALL(ba);var Y=function(b){this.onPause=b};primitive.setPAUSE(Y);var M=function(c,e,h,m){0!==c.cstack.length&&c.cstack[c.cstack.length-1]instanceof b?(c.cstack.pop().invoke(c),h=ia(c,e,m,h),c.pushControl(new b(h))):2<=c.cstack.length&&types.isContMarkRecordControl(c.cstack[c.cstack.length-1])&&c.cstack[c.cstack.length-2]instanceof b?(c.cstack[c.cstack.length-
2].invoke(c),h=ia(c,e,m,h),c.cstack[c.cstack.length-2]=new b(h)):(h=ia(c,e,m,h),c.pushControl(new b(h)));c.pushControl(e.body)},N=function(b,c,e,h){b.v=1===e?h[0]:new types.ValuesWrapper(h);b.vstack=c.vstack;b.cstack=c.cstack},ua=function(b,c,e,h){var k=function(){var b="";if(0<h.length){b=[":"];for(var c=0;c<h.length;c++)b.push(types.toWrittenString(h[c]));b=b.join(" ")}return b},m=function(b){var c=[];if(0<h.length)for(var e=0;e<h.length;e++)c.push(new types.ColoredPart(h[e]+(e<h.length-1?" ":""),
b.first())),b=b.rest();return c},q=types.getProcedureType(e);if(!q){k("; arguments were:");k=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");for(var v=k=k[k.length-1],u;!v.isEmpty();)u=v.first().elts,v=v.rest();v=m(k.rest());v=types.vector([u[0],u[1],u[2],u[3],1]);u=types.vector([u[0],u[1]+u[4]-1,u[2],u[3]+u[4]-1,1]);var w=e.toWrittenString?e.toWrittenString():e.toString();helpers.raise(types.incompleteExn(types.exnFailContract,new types.Message([new types.MultiPart("function call",
[v,u],!0),": expected function, given: ",new types.ColoredPart(w,k.first())]),[]))}if("CaseLambdaValue"===q){for(k=0;k<e.closures.length;k++)if(c===e.closures[k].numParams||c>e.closures[k].numParams&&e.closures[k].isRest)return e.closures[k]=M,e.closures[k];u=[];for(k=0;k<e.closures.length;k++)u.push(e.closures[k].numParams+"");k=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");k=k[k.length-1];v=m(k.rest());helpers.raise(types.incompleteExn(types.exnFailContractArity,
new types.Message([new types.ColoredPart(e.name?e.name:"#<case-lambda-procedure>",k.first()),": expects [",u.join(", "),"] arguments, but given ",c,new types.GradientPart(v)]),[]))}else if("CasePrimitive"===q){for(k=0;k<e.cases.length;k++)if(c===e.cases[k].numParams||c>e.cases[k].numParams&&e.cases[k].isRest)return e.cases[k].callProcedure=la,e.cases[k];u=[];for(k=0;k<e.cases.length;k++)u.push(e.cases[k].numParams+"");k=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");
k=k[k.length-1];v=m(k.rest());helpers.raise(types.incompleteExn(types.exnFailContractArity,new types.Message([new types.ColoredPart(e.name,k.first()),": expects ",u.join(" or ")," arguments, but given ",c,0<v.length?": ":"",0<v.length?new types.GradientPart(v):""]),[]))}if("ContinuationClosureValue"===q)return e.callProcedure=N,e;if(c===e.numParams||c>e.numParams&&e.isRest)return e.callProcedure=primitive.isPrimitive(e)?la:M,e;k=state.captureCurrentContinuationMarks(b).ref("moby-application-position-key");
k=k[k.length-1];v=m(k.rest());helpers.raise(types.incompleteExn(types.exnFailContractArityWithPosition,new types.Message([new types.ColoredPart(""+(e.name!==types.EMPTY?e.name:"anonymous function"),k.first()),": expects ",e.isRest?"at least ":"",void 0!=e.locs?new types.MultiPart(e.numParams+" argument"+(1==e.numParams?"":"s"),e.locs.slice(1),!1):e.numParams+" argument"+(1==e.numParams?"":"s"),", but given ",c,0<v.length?": ":"",0<v.length?new types.GradientPart(v):""]),[]))},ia=function(b,c,e,h){var k=
0;if(c.isRest){var m=types.EMPTY,q;for(q=0;q<h-c.numParams;q++)m=types.cons(e.pop(),m);b.pushValue(m);k++}for(q=e.length-1;0<=q;q--)b.pushValue(e[q]),k++;for(q=c.closureVals.length-1;0<=q;q--)b.pushValue(c.closureVals[q]),k++;return k},H=function(b,c,e){this.key=b;this.val=c;this.body=e};H.prototype.invoke=function(b){var c=[];c.push(this.key);c.push(new D(this.val,this.body));b.pushManyControls(c)};var D=function(b,c){this.val=b;this.body=c};D.prototype.invoke=function(b){var c=b.v,e=[];e.push(this.val);
e.push(new fa(c,this.body));b.pushManyControls(e)};var fa=function(b,c){this.key=b;this.body=c};fa.prototype.invoke=function(b){var c=b.v;if(0!==b.cstack.length&&types.isContMarkRecordControl(b.cstack[b.cstack.length-1]))b.pushControl(b.cstack.pop().update(this.key,c));else{var e={};e[this.key.val]=c;b.pushControl(types.contMarkRecordControl(e))}b.pushControl(this.body)};var A=function(b,c){this.proc=b;this.argsExpr=c};A.prototype.invoke=function(b){var c=[];c.push(this.proc);c.push(new Fa(this.argsExpr));
b.pushManyControls(c)};var Fa=function(b){this.expr=b};Fa.prototype.invoke=function(b){var c=[];c.push(this.expr);c.push(new da(b.v));b.pushManyControls(c)};var da=function(b){this.procVal=b};da.prototype.invoke=function(b){var c=b.v;b.v=this.procVal;if(c instanceof types.ValuesWrapper){var e=c.elts;for(c=e.length-1;0<=c;c--)b.pushValue(e[c]);b.pushControl(new pa(e.length))}else b.pushValue(c),b.pushControl(new pa(1))};var h=function(b,c){this.rhs=b;this.body=c};h.prototype.invoke=function(c){var h=
[];c.pushn(1);h.push(this.rhs);h.push(new e(0));h.push(this.body);h.push(new b(1));c.pushManyControls(h)};var w=function(b){this.count=b.count;this.isBoxes=b.isBoxes;this.body=b.body};w.prototype.invoke=function(c){var e=[],h=this.count;c.pushn(h);if(this.isBoxes)for(var k=0;k<h;k++)c.setn(k,types.box(types.UNDEFINED));e.push(this.body);e.push(new b(h));c.pushManyControls(e)};var O=function(b,c){this.pos=b;this.body=c};O.prototype.invoke=function(b){b.setn(this.pos,types.box(b.peekn(this.pos)));b.pushControl(this.body)};
var ka=function(b){this.count=b.count;this.pos=b.pos;this.isBoxes=b.isBoxes;this.rhs=b.rhs;this.body=b.body};ka.prototype.invoke=function(b){var c=[];c.push(this.rhs);c.push(new Ga(this.count,this.pos,this.isBoxes,this.body));b.pushManyControls(c)};var Ga=function(b,c,e,h){this.count=b;this.pos=c;this.isBoxes=e;this.body=h};Ga.prototype.invoke=function(b){var c=b.v;c instanceof types.ValuesWrapper?(this.count!==c.elts.length&&helpers.raise(types.exnFailContractArity("expected "+this.count+" values, but received "+
c.elts.length,b.captureCurrentContinuationMarks(aState))),c=c.elts):(1!==this.count&&helpers.raise(types.exnFailContractArity("expected "+this.count+" values, but received one",b.captureCurrentContinuationMarks(aState))),c=[c]);if(this.isBoxes)for(var e=0;e<this.count;e++)b.peekn(e+this.pos).set(c[e]);else for(e=0;e<this.count;e++)b.setn(e+this.pos,c[e]);b.pushControl(this.body)};var ta=function(b){this.id=b.id;this.rhs=b.rhs;this.isUndefOk=b.isUndefOk};ta.prototype.invoke=function(b){var c=[];c.push(this.rhs);
c.push(new sa(this.id.depth,this.id.pos,this.isUndefOk));b.pushManyControls(c)};var sa=function(b,c,e){this.depth=b;this.pos=c;this.isUndefOk=e};sa.prototype.invoke=function(b){debug("SET_TOPLEVEL "+this.depth+", "+this.pos);if(0>b.vstack.length-1-(this.depth||0))throw types.internalError("vstack not long enough",state.captureCurrentContinuationMarks(b));b.setPrefix(this.depth,this.pos,b.v)};var xa=function(b){this.toplevel=b};xa.prototype.invoke=function(b){b.v=new types.VariableReference(b.vstack[b.vstack.length-
1-this.toplevel.depth],this.toplevel.pos)};var Ea=function(b){this.genId=b+""};Ea.prototype.invoke=function(b){b.v=b.heap[this.genId]};var za=function(b,c){this.name=b;this.clauses=c};za.prototype.invoke=function(b){var c=this.clauses;0===c.length?b.v=new types.CaseLambdaValue(this.name,[]):(b.pushControl(new Aa(this.name,types.list(c).rest(),types.list([]))),b.pushControl(c[0]))};var Aa=function(b,c,e){this.name=b;this.lamsToEvaluate=c;this.evaluatedLams=e};Aa.prototype.invoke=function(b){var c=
b.v;if(this.lamsToEvaluate.isEmpty()){c=types.cons(c,this.evaluatedLams).reverse();for(var e=[];!c.isEmpty();)e.push(c.first()),c=c.rest();b.v=new types.CaseLambdaValue(this.name,e)}else b.pushControl(new Aa(this.name,this.lamsToEvaluate.rest(),types.cons(c,this.evaluatedLams))),b.pushControl(this.lamsToEvaluate.first())};control.processPrefix=v;control.ConstantControl=Q;control.BranchControl=m;control.SeqControl=G;control.Beg0Control=B;control.ModControl=c;control.Prefix=function(b){this.numLifts=
b.numLifts;this.toplevels=b.toplevels};control.ToplevelControl=T;control.DefValuesControl=ca;control.LamControl=na;control.PrimvalControl=X;control.ApplicationControl=W;control.LocalrefControl=U;control.ApplyValuesControl=A;control.LetOneControl=h;control.LetVoidControl=w;control.BoxenvControl=O;control.InstallValueControl=ka;control.WithContMarkControl=H;control.AssignControl=ta;control.VarrefControl=xa;control.ClosureControl=Ea;control.CaseLamControl=za;control.LetRecControl=ea;control.CallControl=
pa;control.RequireControl=C;control.PauseException=Z})();var loader={};
(function(){var e=function(b,c){switch(c.$){case "mod":return new control.ModControl(y(c.prefix),u(b,c.body));case "def-values":return new control.DefValuesControl(c.ids,e(b,c.body));case "indirect":return new control.ConstantControl(b.heap[c.value]);case "apply-values":return new control.ApplyValuesControl(e(b,c.proc),e(b,c["args-expr"]));case "toplevel":return new control.ToplevelControl(c.depth,c.pos,c.loc);case "constant":return new control.ConstantControl(c.value);case "req":return new control.RequireControl(c.reqs+
"");case "seq":return new control.SeqControl(u(b,c.forms));case "application":return new control.ApplicationControl(e(b,c.rator),u(b,c.rands));case "localref":return new control.LocalrefControl(c.pos,c["unbox?"]);case "primval":return new control.PrimvalControl(c.value);case "branch":return new control.BranchControl(e(b,c.test),e(b,c.then),e(b,c["else"]));case "lam":return new control.LamControl({name:c.name,locs:c.locs,numParams:c["num-params"],paramTypes:c["param-types"],isRest:c["rest?"],closureMap:c["closure-map"],
closureTypes:c["closure-types"],body:e(b,c.body)});case "let-one":return new control.LetOneControl(e(b,c.rhs),e(b,c.body));case "let-void":return new control.LetVoidControl({count:c.count,isBoxes:c["boxes?"],body:e(b,c.body)});case "beg0":return new control.Beg0Control(u(b,c.seq));case "boxenv":return new control.BoxenvControl(c.pos,e(b,c.body));case "install-value":return new control.InstallValueControl({count:c.count,pos:c.pos,isBoxes:c["boxes?"],rhs:e(b,c.rhs),body:e(b,c.body)});case "with-cont-mark":return new control.WithContMarkControl(e(b,
c.key),e(b,c.val),e(b,c.body));case "assign":return new control.AssignControl({id:e(b,c.id),rhs:e(b,c.rhs),isUndefOk:c["undef-ok?"]});case "varref":return new control.VarrefControl(e(b,c.toplevel));case "closure":return new control.ClosureCommand(c["gen-id"]);case "case-lam":return new control.CaseLamControl(c.name,u(b,c.clauses));case "let-rec":return new control.LetRecControl(u(b,c.procs),e(b,c.body));default:throw types.internalError("I don't know how to handle "+sys.inspect(c),state.captureCurrentContinuationMarks(b));
}},u=function(b,c){for(var v=[],u=0;u<c.length;u++)v.push(e(b,c[u]));return v},y=function(b){return new control.Prefix({numLifts:b["num-lifts"],toplevels:b.toplevels})};loader.loadCode=e;loader.loadPrefix=y})();var interpret={};
(function(){var e=function(u,Q,m){function q(){for(var b=5E4;!u.isStuck()&&0<b;)c(u),b--;if(u.breakRequested)m(types.schemeError(types.exnBreak("user break",state.captureCurrentContinuationMarks(u),new types.ContinuationClosureValue(u.vstack,u.cstack))));else if(0>=b){var q=u.save();setTimeout(function(){u.restore(q);e(u,Q,m)},0)}else Q(u.v)}Q||(Q=function(b){});m||(m=function(b){throw b;});try{q()}catch(G){if(G instanceof control.PauseException){var v=b(u,Q,m),V=y(u);G.onPause(v,V)}else types.isSchemeError(G)&&
types.isIncompleteExn(G.val)&&(v=state.captureCurrentContinuationMarks(u),G=types.schemeError(G.val.constructor.apply(null,[G.val.msg,v].concat(G.val.otherArgs)))),m(G)}},u=function(b,c,m,q,u){var v=b.save();b.clearForEval({preserveBreak:!0});b.pushControl(new control.ApplicationControl(new control.ConstantControl(c),helpers.map(function(b){return new control.ConstantControl(b)},m)));try{e(b,function(c){b.restore(v);q(c)},function(c){b.restore(v);u(c)})}catch(G){throw b.restore(v),G;}},y=function(b){return function(c,
e,q,v){return u(b,c,e,q,v)}},b=function(b,c,m){var q=b.save();b.clearForEval({preserveBreak:!0});return function(u){b.restore(q);if(types.isSchemeError(u)){if(types.isIncompleteExn(u.val)){var v=state.captureCurrentContinuationMarks(b);u=types.schemeError(u.val.constructor.apply(null,[u.val.msg,v].concat(u.val.otherArgs)))}m(u)}else types.isInternalError(u)?m(u):(b.v=u,e(b,c,m))}},c=function(b){var c=b.popControl();debugF(function(){return sys.inspect(c)});if(c.invoke)c.invoke(b);else throw types.internalError("I don't know how to handle "+
sys.inspect(c),state.captureCurrentContinuationMarks(b));};primitive.addPrimitive("call/cc",new primitive.Primitive("call/cc",1,!1,!0,function(b,c){var e=new types.ContinuationClosureValue(b.vstack,b.cstack);b.pushValue(e);b.v=c;b.pushControl(new control.CallControl(1))}));interpret.load=function(b,c){c||(c=new state.State);try{for(var e=c,q=b["compiled-indirects"],u=0;u<q.length;u++){for(var v=q[u],y=v.lam,B=y["num-params"],Q=y["param-types"],T=y["rest?"],U,X=e,na=y["closure-map"],ha=[],ea=0;ea<
na.length;ea++){var Ba=X.peekn(na[ea]);ha.push(Ba)}U=ha;var ca=new control.ConstantControl(!1);e.heap[v.id]=new types.ClosureValue(v.id,B,Q,T,U,ca)}for(u=0;u<q.length;u++)v=q[u],y=v.lam,e.heap[v.id].body=loader.loadCode(e,y.body);var K=loader.loadPrefix(b.prefix);control.processPrefix(c,K);c.pushControl(loader.loadCode(c,b.code))}catch(W){throw types.isSchemeError(W)&&types.isExn(W.val)&&!types.isContinuationMarkSet(types.exnContMarks(W.val))&&types.exnSetContMarks(W.val,state.captureCurrentContinuationMarks(c)),
W;}return c};interpret.step=c;interpret.run=e;interpret.call=u})();
